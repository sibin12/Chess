function __vite__mapDeps(indexes){if(!__vite__mapDeps.viteFileDeps){__vite__mapDeps.viteFileDeps=["js/commandline.CpPfAe7E.js","js/vendor.DigDMFmG.js","js/firebase.CNfI9pH9.js","js/misc.DZYNOCdT.js","css/index.DONfPvF6.css","js/howler.BchbbeDV.js"]}
return indexes.map((i)=>__vite__mapDeps.viteFileDeps[i])}
import{c as Re,e as Qo,s as cr,t as pr,a as mi,b as Je,h as Te,g as yc,d as dA,f as Wm,i as vc,j as vt,p as Hr,k as nv,m as af,n as Q0,r as Ip,o as uA,q as On,u as Bm,v as iv,w as da,x as cA,y as we,z as Op,A as Ii,B as fr,C as Hs,D as ua,E as Gl,F as Un,G as pA,H as Zm,I as gs,J as Ql,S as Y0,K as fA,L as mA,M as hA,N as rd,O as J0,P as X0,Q as ek,R as tk,T as gA,U as yA,V as ak,W as qm,X as sk,Y as vA,Z as ho,_ as bA,$ as wA,a0 as rv,a1 as Ch,a2 as ov,a3 as Ba,a4 as kA,a5 as xA,a6 as _A,a7 as CA,a8 as nk,a9 as nw,aa as SA,ab as TA,ac as $A,ad as lv,ae as dv,af as AA,ag as MA,ah as Sh,ai as iw,aj as LA,ak as rw,al as EA,l as ow,am as IA}from"./misc.DZYNOCdT.js";import{a as ik,i as OA,g as rk,b as PA,$ as i,t as uv,U as wl,e as RA,s as DA,c as vg,d as NA,f as lw,p as dw,h as Jr,j as WA,k as BA,l as ZA,n as qA,m as FA,o as jA,q as HA,r as nt,u as zA,v as KA,z as VA,w as UA,x as GA,y as QA,A as Da,B as Bt,H as sf,C as Xa,D as YA,E as JA,F as XA,G as eM,L as tM,I as aM,J as sM,P as nM,S as iM,T as rM,K as oM,M as lM,N as dM,O as uM,Q as uw,R as ok,V as Vt,W as lk,X as cw,Y as cM,Z as pM,_ as fM,a0 as mM,a1 as hM,a2 as gM,a3 as dk,a4 as uk,a5 as ck,a6 as yM,a7 as vM,a8 as bM,a9 as pk,aa as wM,ab as cv,ac as pv,ad as fk,ae as kM,af as xM,ag as _M,ah as CM,ai as SM}from"./vendor.DigDMFmG.js";import{i as ce,g as bc,a as od,b as h,c as TM,s as $M,A as Tt,d as AM,e as MM}from"./firebase.CNfI9pH9.js";const LM="modulepreload",EM=function(t){return"/"+t},pw={},fv=function(e,a,s){let n=Promise.resolve();return a&&a.length>0&&(document.getElementsByTagName("link"),n=Promise.all(a.map(r=>{if(r=EM(r),r in pw)return;pw[r]=!0;const o=r.endsWith(".css"),l=o?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${r}"]${l}`))return;const u=document.createElement("link");if(u.rel=o?"stylesheet":LM,o||(u.as="script",u.crossOrigin=""),u.href=r,document.head.appendChild(u),o)return new Promise((c,p)=>{u.addEventListener("load",c),u.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${r}`)))})}))),n.then(()=>e()).catch(r=>{const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=r,window.dispatchEvent(o),!o.defaultPrevented)throw r})};let mk=!0;function mr(t){mk=t}function ld(){return mk}const fw="/leaderboards";class IM{constructor(e){this.httpClient=e,this.httpClient=e}async get(e){const{language:a,mode:s,mode2:n,isDaily:r,skip:o=0,limit:l=50,daysBefore:u}=e,c=(r??!1)&&(u??0)>0,p={language:a,mode:s,mode2:n,skip:Math.max(o,0),limit:Math.max(Math.min(l,50),0),...c&&{daysBefore:u}},f=`${fw}/${r?"daily":""}`;return await this.httpClient.get(f,{searchQuery:p})}async getRank(e){const{language:a,mode:s,mode2:n,isDaily:r,daysBefore:o}=e,l=(r??!1)&&(o??0)>0,u={language:a,mode:s,mode2:n,...l&&{daysBefore:o}},c=`${fw}${r?"/daily":""}/rank`;return await this.httpClient.get(c,{searchQuery:u})}}const OM="/psas";class PM{constructor(e){this.httpClient=e,this.httpClient=e}async get(){return await this.httpClient.get(OM)}}const Wn="/quotes";class RM{constructor(e){this.httpClient=e,this.httpClient=e}async get(){return await this.httpClient.get(Wn)}async isSubmissionEnabled(){return await this.httpClient.get(`${Wn}/isSubmissionEnabled`)}async submit(e,a,s,n){const r={text:e,source:a,language:s,captcha:n};return await this.httpClient.post(Wn,{payload:r})}async approveSubmission(e,a,s){const n={quoteId:e,editText:a,editSource:s};return await this.httpClient.post(`${Wn}/approve`,{payload:n})}async rejectSubmission(e){return await this.httpClient.post(`${Wn}/reject`,{payload:{quoteId:e}})}async getRating(e){const a={quoteId:e.id,language:e.language};return await this.httpClient.get(`${Wn}/rating`,{searchQuery:a})}async addRating(e,a){const s={quoteId:e.id,rating:a,language:e.language};return await this.httpClient.post(`${Wn}/rating`,{payload:s})}async report(e,a,s,n,r){const o={quoteId:e,quoteLanguage:a,reason:s,comment:n,captcha:r};return await this.httpClient.post(`${Wn}/report`,{payload:o})}}const ip="/results";class DM{constructor(e){this.httpClient=e,this.httpClient=e}async get(e){return await this.httpClient.get(ip,{searchQuery:{offset:e}})}async save(e){return await this.httpClient.post(ip,{payload:{result:e}})}async updateTags(e,a){return await this.httpClient.patch(`${ip}/tags`,{payload:{resultId:e,tagIds:a}})}async deleteAll(){return await this.httpClient.delete(ip)}}const Fe="/users";class NM{constructor(e){this.httpClient=e,this.httpClient=e}async getData(){return await this.httpClient.get(Fe)}async create(e,a,s,n){const r={email:s,name:e,uid:n,captcha:a};return await this.httpClient.post(`${Fe}/signup`,{payload:r})}async getNameAvailability(e){const a=encodeURIComponent(e);return await this.httpClient.get(`${Fe}/checkName/${a}`)}async delete(){return await this.httpClient.delete(Fe)}async reset(){return await this.httpClient.patch(`${Fe}/reset`)}async optOutOfLeaderboards(){return await this.httpClient.post(`${Fe}/optOutOfLeaderboards`)}async updateName(e){return await this.httpClient.patch(`${Fe}/name`,{payload:{name:e}})}async updateLeaderboardMemory(e,a,s,n){const r={mode:e,mode2:a,language:s,rank:n};return await this.httpClient.patch(`${Fe}/leaderboardMemory`,{payload:r})}async updateEmail(e,a){const s={newEmail:e,previousEmail:a};return await this.httpClient.patch(`${Fe}/email`,{payload:s})}async updatePassword(e){return await this.httpClient.patch(`${Fe}/password`,{payload:{newPassword:e}})}async deletePersonalBests(){return await this.httpClient.delete(`${Fe}/personalBests`)}async addResultFilterPreset(e){return await this.httpClient.post(`${Fe}/resultFilterPresets`,{payload:e})}async removeResultFilterPreset(e){const a=encodeURIComponent(e);return await this.httpClient.delete(`${Fe}/resultFilterPresets/${a}`)}async createTag(e){return await this.httpClient.post(`${Fe}/tags`,{payload:{tagName:e}})}async editTag(e,a){const s={tagId:e,newName:a};return await this.httpClient.patch(`${Fe}/tags`,{payload:s})}async deleteTag(e){const a=encodeURIComponent(e);return await this.httpClient.delete(`${Fe}/tags/${a}`)}async deleteTagPersonalBest(e){const a=encodeURIComponent(e);return await this.httpClient.delete(`${Fe}/tags/${a}/personalBest`)}async getCustomThemes(){return await this.httpClient.get(`${Fe}/customThemes`)}async editCustomTheme(e,a){const s={themeId:e,theme:{name:a.name,colors:a.colors}};return await this.httpClient.patch(`${Fe}/customThemes`,{payload:s})}async deleteCustomTheme(e){const a={themeId:e};return await this.httpClient.delete(`${Fe}/customThemes`,{payload:a})}async addCustomTheme(e){const a={name:e.name,colors:e.colors};return await this.httpClient.post(`${Fe}/customThemes`,{payload:a})}async getOauthLink(){return await this.httpClient.get(`${Fe}/discord/oauth`)}async linkDiscord(e,a,s){return await this.httpClient.post(`${Fe}/discord/link`,{payload:{tokenType:e,accessToken:a,state:s}})}async unlinkDiscord(){return await this.httpClient.post(`${Fe}/discord/unlink`)}async addQuoteToFavorites(e,a){const s={language:e,quoteId:a};return await this.httpClient.post(`${Fe}/favoriteQuotes`,{payload:s})}async removeQuoteFromFavorites(e,a){const s={language:e,quoteId:a};return await this.httpClient.delete(`${Fe}/favoriteQuotes`,{payload:s})}async getProfileByUid(e){const a=encodeURIComponent(e);return await this.httpClient.get(`${Fe}/${a}/profile?isUid`)}async getProfileByName(e){const a=encodeURIComponent(e);return await this.httpClient.get(`${Fe}/${a}/profile`)}async updateProfile(e,a){return await this.httpClient.patch(`${Fe}/profile`,{payload:{...e,selectedBadgeId:a}})}async getInbox(){return await this.httpClient.get(`${Fe}/inbox`)}async updateInbox(e){const a={mailIdsToDelete:e.mailIdsToDelete,mailIdsToMarkRead:e.mailIdsToMarkRead};return await this.httpClient.patch(`${Fe}/inbox`,{payload:a})}async report(e,a,s,n){const r={uid:e,reason:a,comment:s,captcha:n};return await this.httpClient.post(`${Fe}/report`,{payload:r})}async verificationEmail(){return await this.httpClient.get(`${Fe}/verificationEmail`)}async forgotPasswordEmail(e){return await this.httpClient.post(`${Fe}/forgotPasswordEmail`,{payload:{email:e}})}async setStreakHourOffset(e){return await this.httpClient.post(`${Fe}/setStreakHourOffset`,{payload:{hourOffset:e}})}async revokeAllTokens(){return await this.httpClient.post(`${Fe}/revokeAllTokens`)}async getTestActivity(){return await this.httpClient.get(`${Fe}/testActivity`)}}const mw="/public";class WM{constructor(e){this.httpClient=e,this.httpClient=e}async getSpeedHistogram(e){return await this.httpClient.get(`${mw}/speedHistogram`,{searchQuery:e})}async getTypingStats(){return await this.httpClient.get(`${mw}/typingStats`)}}class BM{constructor(e){this.httpClient=e,this.httpClient=e}async get(){return await this.httpClient.get("/configuration")}}const ZM="/dev";class qM{constructor(e){this.httpClient=e,this.httpClient=e}async generateData(e){return await this.httpClient.post(ZM+"/generateData",{payload:e})}}const Bn={Leaderboards:IM,Psas:PM,Public:WM,Quotes:RM,Results:DM,Users:NM,Configuration:BM,Dev:qM};async function FM(t){const e=ce()?await rk(bc()):"";return{params:t.searchQuery,data:t.payload,headers:{...t.headers,Accept:"application/json","Content-Type":"application/json",...e&&{Authorization:`Bearer ${e}`},"X-Client-Version":Qo.clientVersion}}}function ul(t,e){return async function(a,s={}){var o,l;let n="",r;try{r=await FM(s)}catch(u){return console.error("Failed to adapt request options"),console.error(u),u.message.includes("auth/network-request-failed")?{status:400,message:"Network error while trying to authenticate. Please try again.",data:null}:{status:400,message:Re(u,"Failed to adapt request options"),data:null}}try{let u;e==="get"||e==="delete"?u=await t(a,r):u=await t(a,r.data,r);const{message:c,data:p}=u.data;return{status:u.status,message:c,data:p}}catch(u){console.error(u);const c=u;if(n=c.message,OA(c)){const p=(o=c.response)==null?void 0:o.data;return{status:((l=c.response)==null?void 0:l.status)??500,message:c.message,...p}}}return{status:500,message:n,data:null}}}function hk(t,e){const a=ik.create({baseURL:t,timeout:e});return{get:ul(a.get,"get"),post:ul(a.post,"post"),put:ul(a.put,"put"),patch:ul(a.patch,"patch"),delete:ul(a.delete,"delete")}}function jM(t){const e=new AbortController;return setTimeout(()=>e.abort(new Error("request timed out")),t),e.signal}function HM(t){return async e=>{var s,n;const a=((n=(s=e.route.metadata)==null?void 0:s.authenticationOptions)==null?void 0:n.isPublic)??!1;try{const r={...e.headers,"X-Client-Version":Qo.clientVersion};if(!a){const p=ce()?await rk(bc()):"";r.Authorization=`Bearer ${p}`}const o={method:e.method,headers:r,body:e.body},l=(AbortSignal==null?void 0:AbortSignal.timeout)===void 0,u=await fetch(e.path,{...o,signal:l?jM(t):AbortSignal.timeout(t)}),c=await u.json();return u.status>=400&&console.error(`${e.method} ${e.path} failed`,{status:u.status,...c}),{status:u.status,body:c,headers:u.headers??new Headers}}catch(r){let o="Unknown error";return r instanceof Error&&(r.message.includes("timed out")?o="request took too long to complete":o=r.message),{status:500,body:{message:o},headers:new Headers}}}}function Th(t,e,a=1e4){return PA(t,{baseUrl:e,jsonQuery:!0,api:HM(a),baseHeaders:{Accept:"application/json"}})}var $h=t=>typeof(t==null?void 0:t.passthrough)=="function",zM=(t,e)=>$h(t)?$h(e)?t.merge(e):t:$h(e)?e:Object.assign({},t,e),KM=Symbol("ContractNoBody"),VM=t=>"method"in t&&"path"in t,gk=(t,e)=>Object.fromEntries(Object.entries(t).map(([a,s])=>{var n,r,o;return VM(s)?[a,{...s,path:e!=null&&e.pathPrefix?e.pathPrefix+s.path:s.path,headers:zM(e==null?void 0:e.baseHeaders,s.headers),strictStatusCodes:(n=s.strictStatusCodes)!==null&&n!==void 0?n:e==null?void 0:e.strictStatusCodes,validateResponseOnClient:(r=s.validateResponseOnClient)!==null&&r!==void 0?r:e==null?void 0:e.validateResponseOnClient,responses:{...e==null?void 0:e.commonResponses,...s.responses},metadata:e!=null&&e.metadata?{...e==null?void 0:e.metadata,...(o=s.metadata)!==null&&o!==void 0?o:{}}:s.metadata}]:[a,gk(s,e)]})),Ah=Symbol("ContractPlainType"),UM=()=>({router:(t,e)=>gk(t,e),query:t=>t,mutation:t=>t,responses:t=>t,response:()=>Ah,body:()=>Ah,type:()=>Ah,otherResponse:({contentType:t,body:e})=>({contentType:t,body:e}),noBody:()=>KM}),Ve;(function(t){t.assertEqual=n=>n;function e(n){}t.assertIs=e;function a(n){throw new Error}t.assertNever=a,t.arrayToEnum=n=>{let r={};for(let o of n)r[o]=o;return r},t.getValidEnumValues=n=>{let r=t.objectKeys(n).filter(l=>typeof n[n[l]]!="number"),o={};for(let l of r)o[l]=n[l];return t.objectValues(o)},t.objectValues=n=>t.objectKeys(n).map(function(r){return n[r]}),t.objectKeys=typeof Object.keys=="function"?n=>Object.keys(n):n=>{let r=[];for(let o in n)Object.prototype.hasOwnProperty.call(n,o)&&r.push(o);return r},t.find=(n,r)=>{for(let o of n)if(r(o))return o},t.isInteger=typeof Number.isInteger=="function"?n=>Number.isInteger(n):n=>typeof n=="number"&&isFinite(n)&&Math.floor(n)===n;function s(n,r=" | "){return n.map(o=>typeof o=="string"?`'${o}'`:o).join(r)}t.joinValues=s,t.jsonStringifyReplacer=(n,r)=>typeof r=="bigint"?r.toString():r})(Ve||(Ve={}));var bg;(function(t){t.mergeShapes=(e,a)=>({...e,...a})})(bg||(bg={}));var G=Ve.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Qn=t=>{switch(typeof t){case"undefined":return G.undefined;case"string":return G.string;case"number":return isNaN(t)?G.nan:G.number;case"boolean":return G.boolean;case"function":return G.function;case"bigint":return G.bigint;case"symbol":return G.symbol;case"object":return Array.isArray(t)?G.array:t===null?G.null:t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?G.promise:typeof Map<"u"&&t instanceof Map?G.map:typeof Set<"u"&&t instanceof Set?G.set:typeof Date<"u"&&t instanceof Date?G.date:G.object;default:return G.unknown}},O=Ve.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),GM=t=>JSON.stringify(t,null,2).replace(/"([^"]+)":/g,"$1:"),bs=class yk extends Error{constructor(e){super(),this.issues=[],this.addIssue=s=>{this.issues=[...this.issues,s]},this.addIssues=(s=[])=>{this.issues=[...this.issues,...s]};let a=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,a):this.__proto__=a,this.name="ZodError",this.issues=e}get errors(){return this.issues}format(e){let a=e||function(r){return r.message},s={_errors:[]},n=r=>{for(let o of r.issues)if(o.code==="invalid_union")o.unionErrors.map(n);else if(o.code==="invalid_return_type")n(o.returnTypeError);else if(o.code==="invalid_arguments")n(o.argumentsError);else if(o.path.length===0)s._errors.push(a(o));else{let l=s,u=0;for(;u<o.path.length;){let c=o.path[u];u===o.path.length-1?(l[c]=l[c]||{_errors:[]},l[c]._errors.push(a(o))):l[c]=l[c]||{_errors:[]},l=l[c],u++}}};return n(this),s}static assert(e){if(!(e instanceof yk))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,Ve.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=a=>a.message){let a={},s=[];for(let n of this.issues)n.path.length>0?(a[n.path[0]]=a[n.path[0]]||[],a[n.path[0]].push(e(n))):s.push(e(n));return{formErrors:s,fieldErrors:a}}get formErrors(){return this.flatten()}};bs.create=t=>new bs(t);var go=(t,e)=>{let a;switch(t.code){case O.invalid_type:t.received===G.undefined?a="Required":a=`Expected ${t.expected}, received ${t.received}`;break;case O.invalid_literal:a=`Invalid literal value, expected ${JSON.stringify(t.expected,Ve.jsonStringifyReplacer)}`;break;case O.unrecognized_keys:a=`Unrecognized key(s) in object: ${Ve.joinValues(t.keys,", ")}`;break;case O.invalid_union:a="Invalid input";break;case O.invalid_union_discriminator:a=`Invalid discriminator value. Expected ${Ve.joinValues(t.options)}`;break;case O.invalid_enum_value:a=`Invalid enum value. Expected ${Ve.joinValues(t.options)}, received '${t.received}'`;break;case O.invalid_arguments:a="Invalid function arguments";break;case O.invalid_return_type:a="Invalid function return type";break;case O.invalid_date:a="Invalid date";break;case O.invalid_string:typeof t.validation=="object"?"includes"in t.validation?(a=`Invalid input: must include "${t.validation.includes}"`,typeof t.validation.position=="number"&&(a=`${a} at one or more positions greater than or equal to ${t.validation.position}`)):"startsWith"in t.validation?a=`Invalid input: must start with "${t.validation.startsWith}"`:"endsWith"in t.validation?a=`Invalid input: must end with "${t.validation.endsWith}"`:Ve.assertNever(t.validation):t.validation!=="regex"?a=`Invalid ${t.validation}`:a="Invalid";break;case O.too_small:t.type==="array"?a=`Array must contain ${t.exact?"exactly":t.inclusive?"at least":"more than"} ${t.minimum} element(s)`:t.type==="string"?a=`String must contain ${t.exact?"exactly":t.inclusive?"at least":"over"} ${t.minimum} character(s)`:t.type==="number"?a=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="date"?a=`Date must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(t.minimum))}`:a="Invalid input";break;case O.too_big:t.type==="array"?a=`Array must contain ${t.exact?"exactly":t.inclusive?"at most":"less than"} ${t.maximum} element(s)`:t.type==="string"?a=`String must contain ${t.exact?"exactly":t.inclusive?"at most":"under"} ${t.maximum} character(s)`:t.type==="number"?a=`Number must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="bigint"?a=`BigInt must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="date"?a=`Date must be ${t.exact?"exactly":t.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(t.maximum))}`:a="Invalid input";break;case O.custom:a="Invalid input";break;case O.invalid_intersection_types:a="Intersection results could not be merged";break;case O.not_multiple_of:a=`Number must be a multiple of ${t.multipleOf}`;break;case O.not_finite:a="Number must be finite";break;default:a=e.defaultError,Ve.assertNever(t)}return{message:a}},vk=go;function QM(t){vk=t}function nf(){return vk}var rf=t=>{let{data:e,path:a,errorMaps:s,issueData:n}=t,r=[...a,...n.path||[]],o={...n,path:r};if(n.message!==void 0)return{...n,path:r,message:n.message};let l="",u=s.filter(c=>!!c).slice().reverse();for(let c of u)l=c(o,{data:e,defaultError:l}).message;return{...n,path:r,message:l}},YM=[];function F(t,e){let a=nf(),s=rf({issueData:e,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,a,a===go?void 0:go].filter(n=>!!n)});t.common.issues.push(s)}var La=class bk{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,a){let s=[];for(let n of a){if(n.status==="aborted")return ke;n.status==="dirty"&&e.dirty(),s.push(n.value)}return{status:e.value,value:s}}static async mergeObjectAsync(e,a){let s=[];for(let n of a){let r=await n.key,o=await n.value;s.push({key:r,value:o})}return bk.mergeObjectSync(e,s)}static mergeObjectSync(e,a){let s={};for(let n of a){let{key:r,value:o}=n;if(r.status==="aborted"||o.status==="aborted")return ke;r.status==="dirty"&&e.dirty(),o.status==="dirty"&&e.dirty(),r.value!=="__proto__"&&(typeof o.value<"u"||n.alwaysSet)&&(s[r.value]=o.value)}return{status:e.value,value:s}}},ke=Object.freeze({status:"aborted"}),of=t=>({status:"dirty",value:t}),ca=t=>({status:"valid",value:t}),wg=t=>t.status==="aborted",kg=t=>t.status==="dirty",dd=t=>t.status==="valid",ud=t=>typeof Promise<"u"&&t instanceof Promise;function lf(t,e,a,s){if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return e.get(t)}function wk(t,e,a,s,n){if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return e.set(t,a),a}var ne;(function(t){t.errToObj=e=>typeof e=="string"?{message:e}:e||{},t.toString=e=>typeof e=="string"?e:e==null?void 0:e.message})(ne||(ne={}));var kl,xl,Qs=class{constructor(e,a,s,n){this._cachedPath=[],this.parent=e,this.data=a,this._path=s,this._key=n}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}},hw=(t,e)=>{if(dd(e))return{success:!0,data:e.value};if(!t.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;let a=new bs(t.common.issues);return this._error=a,this._error}}};function Le(t){if(!t)return{};let{errorMap:e,invalid_type_error:a,required_error:s,description:n}=t;if(e&&(a||s))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:n}:{errorMap:(r,o)=>{var l,u;let{message:c}=t;return r.code==="invalid_enum_value"?{message:c??o.defaultError}:typeof o.data>"u"?{message:(l=c??s)!==null&&l!==void 0?l:o.defaultError}:r.code!=="invalid_type"?{message:o.defaultError}:{message:(u=c??a)!==null&&u!==void 0?u:o.defaultError}},description:n}}var De=class{constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this)}get description(){return this._def.description}_getType(e){return Qn(e.data)}_getOrReturnCtx(e,a){return a||{common:e.parent.common,data:e.data,parsedType:Qn(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new La,ctx:{common:e.parent.common,data:e.data,parsedType:Qn(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){let a=this._parse(e);if(ud(a))throw new Error("Synchronous parse encountered promise.");return a}_parseAsync(e){let a=this._parse(e);return Promise.resolve(a)}parse(e,a){let s=this.safeParse(e,a);if(s.success)return s.data;throw s.error}safeParse(e,a){var s;let n={common:{issues:[],async:(s=a==null?void 0:a.async)!==null&&s!==void 0?s:!1,contextualErrorMap:a==null?void 0:a.errorMap},path:(a==null?void 0:a.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Qn(e)},r=this._parseSync({data:e,path:n.path,parent:n});return hw(n,r)}async parseAsync(e,a){let s=await this.safeParseAsync(e,a);if(s.success)return s.data;throw s.error}async safeParseAsync(e,a){let s={common:{issues:[],contextualErrorMap:a==null?void 0:a.errorMap,async:!0},path:(a==null?void 0:a.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Qn(e)},n=this._parse({data:e,path:s.path,parent:s}),r=await(ud(n)?n:Promise.resolve(n));return hw(s,r)}refine(e,a){let s=n=>typeof a=="string"||typeof a>"u"?{message:a}:typeof a=="function"?a(n):a;return this._refinement((n,r)=>{let o=e(n),l=()=>r.addIssue({code:O.custom,...s(n)});return typeof Promise<"u"&&o instanceof Promise?o.then(u=>u?!0:(l(),!1)):o?!0:(l(),!1)})}refinement(e,a){return this._refinement((s,n)=>e(s)?!0:(n.addIssue(typeof a=="function"?a(s,n):a),!1))}_refinement(e){return new Ts({schema:this,typeName:he.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}optional(){return zs.create(this,this._def)}nullable(){return gi.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return hr.create(this,this._def)}promise(){return bo.create(this,this._def)}or(e){return yd.create([this,e],this._def)}and(e){return vd.create(this,e,this._def)}transform(e){return new Ts({...Le(this._def),schema:this,typeName:he.ZodEffects,effect:{type:"transform",transform:e}})}default(e){let a=typeof e=="function"?e:()=>e;return new xd({...Le(this._def),innerType:this,defaultValue:a,typeName:he.ZodDefault})}brand(){return new mv({typeName:he.ZodBranded,type:this,...Le(this._def)})}catch(e){let a=typeof e=="function"?e:()=>e;return new _d({...Le(this._def),innerType:this,catchValue:a,typeName:he.ZodCatch})}describe(e){let a=this.constructor;return new a({...this._def,description:e})}pipe(e){return hv.create(this,e)}readonly(){return Cd.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}},JM=/^c[^\s-]{8,}$/i,XM=/^[0-9a-z]+$/,eL=/^[0-9A-HJKMNP-TV-Z]{26}$/,tL=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,aL=/^[a-z0-9_-]{21}$/i,sL=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,nL=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,iL="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$",Mh,rL=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,oL=/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,lL=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,kk="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",dL=new RegExp(`^${kk}$`);function xk(t){let e="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return t.precision?e=`${e}\\.\\d{${t.precision}}`:t.precision==null&&(e=`${e}(\\.\\d+)?`),e}function uL(t){return new RegExp(`^${xk(t)}$`)}function _k(t){let e=`${kk}T${xk(t)}`,a=[];return a.push(t.local?"Z?":"Z"),t.offset&&a.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${a.join("|")})`,new RegExp(`^${e}$`)}function cL(t,e){return!!((e==="v4"||!e)&&rL.test(t)||(e==="v6"||!e)&&oL.test(t))}var yo=class _l extends De{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==G.string){let n=this._getOrReturnCtx(e);return F(n,{code:O.invalid_type,expected:G.string,received:n.parsedType}),ke}let a=new La,s;for(let n of this._def.checks)if(n.kind==="min")e.data.length<n.value&&(s=this._getOrReturnCtx(e,s),F(s,{code:O.too_small,minimum:n.value,type:"string",inclusive:!0,exact:!1,message:n.message}),a.dirty());else if(n.kind==="max")e.data.length>n.value&&(s=this._getOrReturnCtx(e,s),F(s,{code:O.too_big,maximum:n.value,type:"string",inclusive:!0,exact:!1,message:n.message}),a.dirty());else if(n.kind==="length"){let r=e.data.length>n.value,o=e.data.length<n.value;(r||o)&&(s=this._getOrReturnCtx(e,s),r?F(s,{code:O.too_big,maximum:n.value,type:"string",inclusive:!0,exact:!0,message:n.message}):o&&F(s,{code:O.too_small,minimum:n.value,type:"string",inclusive:!0,exact:!0,message:n.message}),a.dirty())}else if(n.kind==="email")nL.test(e.data)||(s=this._getOrReturnCtx(e,s),F(s,{validation:"email",code:O.invalid_string,message:n.message}),a.dirty());else if(n.kind==="emoji")Mh||(Mh=new RegExp(iL,"u")),Mh.test(e.data)||(s=this._getOrReturnCtx(e,s),F(s,{validation:"emoji",code:O.invalid_string,message:n.message}),a.dirty());else if(n.kind==="uuid")tL.test(e.data)||(s=this._getOrReturnCtx(e,s),F(s,{validation:"uuid",code:O.invalid_string,message:n.message}),a.dirty());else if(n.kind==="nanoid")aL.test(e.data)||(s=this._getOrReturnCtx(e,s),F(s,{validation:"nanoid",code:O.invalid_string,message:n.message}),a.dirty());else if(n.kind==="cuid")JM.test(e.data)||(s=this._getOrReturnCtx(e,s),F(s,{validation:"cuid",code:O.invalid_string,message:n.message}),a.dirty());else if(n.kind==="cuid2")XM.test(e.data)||(s=this._getOrReturnCtx(e,s),F(s,{validation:"cuid2",code:O.invalid_string,message:n.message}),a.dirty());else if(n.kind==="ulid")eL.test(e.data)||(s=this._getOrReturnCtx(e,s),F(s,{validation:"ulid",code:O.invalid_string,message:n.message}),a.dirty());else if(n.kind==="url")try{new URL(e.data)}catch{s=this._getOrReturnCtx(e,s),F(s,{validation:"url",code:O.invalid_string,message:n.message}),a.dirty()}else n.kind==="regex"?(n.regex.lastIndex=0,n.regex.test(e.data)||(s=this._getOrReturnCtx(e,s),F(s,{validation:"regex",code:O.invalid_string,message:n.message}),a.dirty())):n.kind==="trim"?e.data=e.data.trim():n.kind==="includes"?e.data.includes(n.value,n.position)||(s=this._getOrReturnCtx(e,s),F(s,{code:O.invalid_string,validation:{includes:n.value,position:n.position},message:n.message}),a.dirty()):n.kind==="toLowerCase"?e.data=e.data.toLowerCase():n.kind==="toUpperCase"?e.data=e.data.toUpperCase():n.kind==="startsWith"?e.data.startsWith(n.value)||(s=this._getOrReturnCtx(e,s),F(s,{code:O.invalid_string,validation:{startsWith:n.value},message:n.message}),a.dirty()):n.kind==="endsWith"?e.data.endsWith(n.value)||(s=this._getOrReturnCtx(e,s),F(s,{code:O.invalid_string,validation:{endsWith:n.value},message:n.message}),a.dirty()):n.kind==="datetime"?_k(n).test(e.data)||(s=this._getOrReturnCtx(e,s),F(s,{code:O.invalid_string,validation:"datetime",message:n.message}),a.dirty()):n.kind==="date"?dL.test(e.data)||(s=this._getOrReturnCtx(e,s),F(s,{code:O.invalid_string,validation:"date",message:n.message}),a.dirty()):n.kind==="time"?uL(n).test(e.data)||(s=this._getOrReturnCtx(e,s),F(s,{code:O.invalid_string,validation:"time",message:n.message}),a.dirty()):n.kind==="duration"?sL.test(e.data)||(s=this._getOrReturnCtx(e,s),F(s,{validation:"duration",code:O.invalid_string,message:n.message}),a.dirty()):n.kind==="ip"?cL(e.data,n.version)||(s=this._getOrReturnCtx(e,s),F(s,{validation:"ip",code:O.invalid_string,message:n.message}),a.dirty()):n.kind==="base64"?lL.test(e.data)||(s=this._getOrReturnCtx(e,s),F(s,{validation:"base64",code:O.invalid_string,message:n.message}),a.dirty()):Ve.assertNever(n);return{status:a.value,value:e.data}}_regex(e,a,s){return this.refinement(n=>e.test(n),{validation:a,code:O.invalid_string,...ne.errToObj(s)})}_addCheck(e){return new _l({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...ne.errToObj(e)})}url(e){return this._addCheck({kind:"url",...ne.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...ne.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...ne.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...ne.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...ne.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...ne.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...ne.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...ne.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...ne.errToObj(e)})}datetime(e){var a,s;return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,offset:(a=e==null?void 0:e.offset)!==null&&a!==void 0?a:!1,local:(s=e==null?void 0:e.local)!==null&&s!==void 0?s:!1,...ne.errToObj(e==null?void 0:e.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,...ne.errToObj(e==null?void 0:e.message)})}duration(e){return this._addCheck({kind:"duration",...ne.errToObj(e)})}regex(e,a){return this._addCheck({kind:"regex",regex:e,...ne.errToObj(a)})}includes(e,a){return this._addCheck({kind:"includes",value:e,position:a==null?void 0:a.position,...ne.errToObj(a==null?void 0:a.message)})}startsWith(e,a){return this._addCheck({kind:"startsWith",value:e,...ne.errToObj(a)})}endsWith(e,a){return this._addCheck({kind:"endsWith",value:e,...ne.errToObj(a)})}min(e,a){return this._addCheck({kind:"min",value:e,...ne.errToObj(a)})}max(e,a){return this._addCheck({kind:"max",value:e,...ne.errToObj(a)})}length(e,a){return this._addCheck({kind:"length",value:e,...ne.errToObj(a)})}nonempty(e){return this.min(1,ne.errToObj(e))}trim(){return new _l({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new _l({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new _l({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get minLength(){let e=null;for(let a of this._def.checks)a.kind==="min"&&(e===null||a.value>e)&&(e=a.value);return e}get maxLength(){let e=null;for(let a of this._def.checks)a.kind==="max"&&(e===null||a.value<e)&&(e=a.value);return e}};yo.create=t=>{var e;return new yo({checks:[],typeName:he.ZodString,coerce:(e=t==null?void 0:t.coerce)!==null&&e!==void 0?e:!1,...Le(t)})};function pL(t,e){let a=(t.toString().split(".")[1]||"").length,s=(e.toString().split(".")[1]||"").length,n=a>s?a:s,r=parseInt(t.toFixed(n).replace(".","")),o=parseInt(e.toFixed(n).replace(".",""));return r%o/Math.pow(10,n)}var cd=class xg extends De{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==G.number){let n=this._getOrReturnCtx(e);return F(n,{code:O.invalid_type,expected:G.number,received:n.parsedType}),ke}let a,s=new La;for(let n of this._def.checks)n.kind==="int"?Ve.isInteger(e.data)||(a=this._getOrReturnCtx(e,a),F(a,{code:O.invalid_type,expected:"integer",received:"float",message:n.message}),s.dirty()):n.kind==="min"?(n.inclusive?e.data<n.value:e.data<=n.value)&&(a=this._getOrReturnCtx(e,a),F(a,{code:O.too_small,minimum:n.value,type:"number",inclusive:n.inclusive,exact:!1,message:n.message}),s.dirty()):n.kind==="max"?(n.inclusive?e.data>n.value:e.data>=n.value)&&(a=this._getOrReturnCtx(e,a),F(a,{code:O.too_big,maximum:n.value,type:"number",inclusive:n.inclusive,exact:!1,message:n.message}),s.dirty()):n.kind==="multipleOf"?pL(e.data,n.value)!==0&&(a=this._getOrReturnCtx(e,a),F(a,{code:O.not_multiple_of,multipleOf:n.value,message:n.message}),s.dirty()):n.kind==="finite"?Number.isFinite(e.data)||(a=this._getOrReturnCtx(e,a),F(a,{code:O.not_finite,message:n.message}),s.dirty()):Ve.assertNever(n);return{status:s.value,value:e.data}}gte(e,a){return this.setLimit("min",e,!0,ne.toString(a))}gt(e,a){return this.setLimit("min",e,!1,ne.toString(a))}lte(e,a){return this.setLimit("max",e,!0,ne.toString(a))}lt(e,a){return this.setLimit("max",e,!1,ne.toString(a))}setLimit(e,a,s,n){return new xg({...this._def,checks:[...this._def.checks,{kind:e,value:a,inclusive:s,message:ne.toString(n)}]})}_addCheck(e){return new xg({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:ne.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:ne.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:ne.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:ne.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:ne.toString(e)})}multipleOf(e,a){return this._addCheck({kind:"multipleOf",value:e,message:ne.toString(a)})}finite(e){return this._addCheck({kind:"finite",message:ne.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:ne.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:ne.toString(e)})}get minValue(){let e=null;for(let a of this._def.checks)a.kind==="min"&&(e===null||a.value>e)&&(e=a.value);return e}get maxValue(){let e=null;for(let a of this._def.checks)a.kind==="max"&&(e===null||a.value<e)&&(e=a.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&Ve.isInteger(e.value))}get isFinite(){let e=null,a=null;for(let s of this._def.checks){if(s.kind==="finite"||s.kind==="int"||s.kind==="multipleOf")return!0;s.kind==="min"?(a===null||s.value>a)&&(a=s.value):s.kind==="max"&&(e===null||s.value<e)&&(e=s.value)}return Number.isFinite(a)&&Number.isFinite(e)}};cd.create=t=>new cd({checks:[],typeName:he.ZodNumber,coerce:(t==null?void 0:t.coerce)||!1,...Le(t)});var pd=class _g extends De{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce&&(e.data=BigInt(e.data)),this._getType(e)!==G.bigint){let n=this._getOrReturnCtx(e);return F(n,{code:O.invalid_type,expected:G.bigint,received:n.parsedType}),ke}let a,s=new La;for(let n of this._def.checks)n.kind==="min"?(n.inclusive?e.data<n.value:e.data<=n.value)&&(a=this._getOrReturnCtx(e,a),F(a,{code:O.too_small,type:"bigint",minimum:n.value,inclusive:n.inclusive,message:n.message}),s.dirty()):n.kind==="max"?(n.inclusive?e.data>n.value:e.data>=n.value)&&(a=this._getOrReturnCtx(e,a),F(a,{code:O.too_big,type:"bigint",maximum:n.value,inclusive:n.inclusive,message:n.message}),s.dirty()):n.kind==="multipleOf"?e.data%n.value!==BigInt(0)&&(a=this._getOrReturnCtx(e,a),F(a,{code:O.not_multiple_of,multipleOf:n.value,message:n.message}),s.dirty()):Ve.assertNever(n);return{status:s.value,value:e.data}}gte(e,a){return this.setLimit("min",e,!0,ne.toString(a))}gt(e,a){return this.setLimit("min",e,!1,ne.toString(a))}lte(e,a){return this.setLimit("max",e,!0,ne.toString(a))}lt(e,a){return this.setLimit("max",e,!1,ne.toString(a))}setLimit(e,a,s,n){return new _g({...this._def,checks:[...this._def.checks,{kind:e,value:a,inclusive:s,message:ne.toString(n)}]})}_addCheck(e){return new _g({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:ne.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:ne.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:ne.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:ne.toString(e)})}multipleOf(e,a){return this._addCheck({kind:"multipleOf",value:e,message:ne.toString(a)})}get minValue(){let e=null;for(let a of this._def.checks)a.kind==="min"&&(e===null||a.value>e)&&(e=a.value);return e}get maxValue(){let e=null;for(let a of this._def.checks)a.kind==="max"&&(e===null||a.value<e)&&(e=a.value);return e}};pd.create=t=>{var e;return new pd({checks:[],typeName:he.ZodBigInt,coerce:(e=t==null?void 0:t.coerce)!==null&&e!==void 0?e:!1,...Le(t)})};var fd=class extends De{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==G.boolean){let a=this._getOrReturnCtx(e);return F(a,{code:O.invalid_type,expected:G.boolean,received:a.parsedType}),ke}return ca(e.data)}};fd.create=t=>new fd({typeName:he.ZodBoolean,coerce:(t==null?void 0:t.coerce)||!1,...Le(t)});var md=class Ck extends De{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==G.date){let n=this._getOrReturnCtx(e);return F(n,{code:O.invalid_type,expected:G.date,received:n.parsedType}),ke}if(isNaN(e.data.getTime())){let n=this._getOrReturnCtx(e);return F(n,{code:O.invalid_date}),ke}let a=new La,s;for(let n of this._def.checks)n.kind==="min"?e.data.getTime()<n.value&&(s=this._getOrReturnCtx(e,s),F(s,{code:O.too_small,message:n.message,inclusive:!0,exact:!1,minimum:n.value,type:"date"}),a.dirty()):n.kind==="max"?e.data.getTime()>n.value&&(s=this._getOrReturnCtx(e,s),F(s,{code:O.too_big,message:n.message,inclusive:!0,exact:!1,maximum:n.value,type:"date"}),a.dirty()):Ve.assertNever(n);return{status:a.value,value:new Date(e.data.getTime())}}_addCheck(e){return new Ck({...this._def,checks:[...this._def.checks,e]})}min(e,a){return this._addCheck({kind:"min",value:e.getTime(),message:ne.toString(a)})}max(e,a){return this._addCheck({kind:"max",value:e.getTime(),message:ne.toString(a)})}get minDate(){let e=null;for(let a of this._def.checks)a.kind==="min"&&(e===null||a.value>e)&&(e=a.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(let a of this._def.checks)a.kind==="max"&&(e===null||a.value<e)&&(e=a.value);return e!=null?new Date(e):null}};md.create=t=>new md({checks:[],coerce:(t==null?void 0:t.coerce)||!1,typeName:he.ZodDate,...Le(t)});var df=class extends De{_parse(e){if(this._getType(e)!==G.symbol){let a=this._getOrReturnCtx(e);return F(a,{code:O.invalid_type,expected:G.symbol,received:a.parsedType}),ke}return ca(e.data)}};df.create=t=>new df({typeName:he.ZodSymbol,...Le(t)});var hd=class extends De{_parse(e){if(this._getType(e)!==G.undefined){let a=this._getOrReturnCtx(e);return F(a,{code:O.invalid_type,expected:G.undefined,received:a.parsedType}),ke}return ca(e.data)}};hd.create=t=>new hd({typeName:he.ZodUndefined,...Le(t)});var gd=class extends De{_parse(e){if(this._getType(e)!==G.null){let a=this._getOrReturnCtx(e);return F(a,{code:O.invalid_type,expected:G.null,received:a.parsedType}),ke}return ca(e.data)}};gd.create=t=>new gd({typeName:he.ZodNull,...Le(t)});var vo=class extends De{constructor(){super(...arguments),this._any=!0}_parse(e){return ca(e.data)}};vo.create=t=>new vo({typeName:he.ZodAny,...Le(t)});var Yi=class extends De{constructor(){super(...arguments),this._unknown=!0}_parse(e){return ca(e.data)}};Yi.create=t=>new Yi({typeName:he.ZodUnknown,...Le(t)});var wn=class extends De{_parse(e){let a=this._getOrReturnCtx(e);return F(a,{code:O.invalid_type,expected:G.never,received:a.parsedType}),ke}};wn.create=t=>new wn({typeName:he.ZodNever,...Le(t)});var uf=class extends De{_parse(e){if(this._getType(e)!==G.undefined){let a=this._getOrReturnCtx(e);return F(a,{code:O.invalid_type,expected:G.void,received:a.parsedType}),ke}return ca(e.data)}};uf.create=t=>new uf({typeName:he.ZodVoid,...Le(t)});var hr=class Pp extends De{_parse(e){let{ctx:a,status:s}=this._processInputParams(e),n=this._def;if(a.parsedType!==G.array)return F(a,{code:O.invalid_type,expected:G.array,received:a.parsedType}),ke;if(n.exactLength!==null){let o=a.data.length>n.exactLength.value,l=a.data.length<n.exactLength.value;(o||l)&&(F(a,{code:o?O.too_big:O.too_small,minimum:l?n.exactLength.value:void 0,maximum:o?n.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:n.exactLength.message}),s.dirty())}if(n.minLength!==null&&a.data.length<n.minLength.value&&(F(a,{code:O.too_small,minimum:n.minLength.value,type:"array",inclusive:!0,exact:!1,message:n.minLength.message}),s.dirty()),n.maxLength!==null&&a.data.length>n.maxLength.value&&(F(a,{code:O.too_big,maximum:n.maxLength.value,type:"array",inclusive:!0,exact:!1,message:n.maxLength.message}),s.dirty()),a.common.async)return Promise.all([...a.data].map((o,l)=>n.type._parseAsync(new Qs(a,o,a.path,l)))).then(o=>La.mergeArray(s,o));let r=[...a.data].map((o,l)=>n.type._parseSync(new Qs(a,o,a.path,l)));return La.mergeArray(s,r)}get element(){return this._def.type}min(e,a){return new Pp({...this._def,minLength:{value:e,message:ne.toString(a)}})}max(e,a){return new Pp({...this._def,maxLength:{value:e,message:ne.toString(a)}})}length(e,a){return new Pp({...this._def,exactLength:{value:e,message:ne.toString(a)}})}nonempty(e){return this.min(1,e)}};hr.create=(t,e)=>new hr({type:t,minLength:null,maxLength:null,exactLength:null,typeName:he.ZodArray,...Le(e)});function zr(t){if(t instanceof es){let e={};for(let a in t.shape){let s=t.shape[a];e[a]=zs.create(zr(s))}return new es({...t._def,shape:()=>e})}else return t instanceof hr?new hr({...t._def,type:zr(t.element)}):t instanceof zs?zs.create(zr(t.unwrap())):t instanceof gi?gi.create(zr(t.unwrap())):t instanceof hi?hi.create(t.items.map(e=>zr(e))):t}var es=class us extends De{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;let e=this._def.shape(),a=Ve.objectKeys(e);return this._cached={shape:e,keys:a}}_parse(e){if(this._getType(e)!==G.object){let u=this._getOrReturnCtx(e);return F(u,{code:O.invalid_type,expected:G.object,received:u.parsedType}),ke}let{status:a,ctx:s}=this._processInputParams(e),{shape:n,keys:r}=this._getCached(),o=[];if(!(this._def.catchall instanceof wn&&this._def.unknownKeys==="strip"))for(let u in s.data)r.includes(u)||o.push(u);let l=[];for(let u of r){let c=n[u],p=s.data[u];l.push({key:{status:"valid",value:u},value:c._parse(new Qs(s,p,s.path,u)),alwaysSet:u in s.data})}if(this._def.catchall instanceof wn){let u=this._def.unknownKeys;if(u==="passthrough")for(let c of o)l.push({key:{status:"valid",value:c},value:{status:"valid",value:s.data[c]}});else if(u==="strict")o.length>0&&(F(s,{code:O.unrecognized_keys,keys:o}),a.dirty());else if(u!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{let u=this._def.catchall;for(let c of o){let p=s.data[c];l.push({key:{status:"valid",value:c},value:u._parse(new Qs(s,p,s.path,c)),alwaysSet:c in s.data})}}return s.common.async?Promise.resolve().then(async()=>{let u=[];for(let c of l){let p=await c.key,f=await c.value;u.push({key:p,value:f,alwaysSet:c.alwaysSet})}return u}).then(u=>La.mergeObjectSync(a,u)):La.mergeObjectSync(a,l)}get shape(){return this._def.shape()}strict(e){return ne.errToObj,new us({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(a,s)=>{var n,r,o,l;let u=(o=(r=(n=this._def).errorMap)===null||r===void 0?void 0:r.call(n,a,s).message)!==null&&o!==void 0?o:s.defaultError;return a.code==="unrecognized_keys"?{message:(l=ne.errToObj(e).message)!==null&&l!==void 0?l:u}:{message:u}}}:{}})}strip(){return new us({...this._def,unknownKeys:"strip"})}passthrough(){return new us({...this._def,unknownKeys:"passthrough"})}extend(e){return new us({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new us({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:he.ZodObject})}setKey(e,a){return this.augment({[e]:a})}catchall(e){return new us({...this._def,catchall:e})}pick(e){let a={};return Ve.objectKeys(e).forEach(s=>{e[s]&&this.shape[s]&&(a[s]=this.shape[s])}),new us({...this._def,shape:()=>a})}omit(e){let a={};return Ve.objectKeys(this.shape).forEach(s=>{e[s]||(a[s]=this.shape[s])}),new us({...this._def,shape:()=>a})}deepPartial(){return zr(this)}partial(e){let a={};return Ve.objectKeys(this.shape).forEach(s=>{let n=this.shape[s];e&&!e[s]?a[s]=n:a[s]=n.optional()}),new us({...this._def,shape:()=>a})}required(e){let a={};return Ve.objectKeys(this.shape).forEach(s=>{if(e&&!e[s])a[s]=this.shape[s];else{let n=this.shape[s];for(;n instanceof zs;)n=n._def.innerType;a[s]=n}}),new us({...this._def,shape:()=>a})}keyof(){return Lk(Ve.objectKeys(this.shape))}};es.create=(t,e)=>new es({shape:()=>t,unknownKeys:"strip",catchall:wn.create(),typeName:he.ZodObject,...Le(e)});es.strictCreate=(t,e)=>new es({shape:()=>t,unknownKeys:"strict",catchall:wn.create(),typeName:he.ZodObject,...Le(e)});es.lazycreate=(t,e)=>new es({shape:t,unknownKeys:"strip",catchall:wn.create(),typeName:he.ZodObject,...Le(e)});var yd=class extends De{_parse(e){let{ctx:a}=this._processInputParams(e),s=this._def.options;function n(r){for(let l of r)if(l.result.status==="valid")return l.result;for(let l of r)if(l.result.status==="dirty")return a.common.issues.push(...l.ctx.common.issues),l.result;let o=r.map(l=>new bs(l.ctx.common.issues));return F(a,{code:O.invalid_union,unionErrors:o}),ke}if(a.common.async)return Promise.all(s.map(async r=>{let o={...a,common:{...a.common,issues:[]},parent:null};return{result:await r._parseAsync({data:a.data,path:a.path,parent:o}),ctx:o}})).then(n);{let r,o=[];for(let u of s){let c={...a,common:{...a.common,issues:[]},parent:null},p=u._parseSync({data:a.data,path:a.path,parent:c});if(p.status==="valid")return p;p.status==="dirty"&&!r&&(r={result:p,ctx:c}),c.common.issues.length&&o.push(c.common.issues)}if(r)return a.common.issues.push(...r.ctx.common.issues),r.result;let l=o.map(u=>new bs(u));return F(a,{code:O.invalid_union,unionErrors:l}),ke}}get options(){return this._def.options}};yd.create=(t,e)=>new yd({options:t,typeName:he.ZodUnion,...Le(e)});var Fn=t=>t instanceof bd?Fn(t.schema):t instanceof Ts?Fn(t.innerType()):t instanceof wd?[t.value]:t instanceof wc?t.options:t instanceof kd?Ve.objectValues(t.enum):t instanceof xd?Fn(t._def.innerType):t instanceof hd?[void 0]:t instanceof gd?[null]:t instanceof zs?[void 0,...Fn(t.unwrap())]:t instanceof gi?[null,...Fn(t.unwrap())]:t instanceof mv||t instanceof Cd?Fn(t.unwrap()):t instanceof _d?Fn(t._def.innerType):[],Sk=class Tk extends De{_parse(e){let{ctx:a}=this._processInputParams(e);if(a.parsedType!==G.object)return F(a,{code:O.invalid_type,expected:G.object,received:a.parsedType}),ke;let s=this.discriminator,n=a.data[s],r=this.optionsMap.get(n);return r?a.common.async?r._parseAsync({data:a.data,path:a.path,parent:a}):r._parseSync({data:a.data,path:a.path,parent:a}):(F(a,{code:O.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[s]}),ke)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,a,s){let n=new Map;for(let r of a){let o=Fn(r.shape[e]);if(!o.length)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(let l of o){if(n.has(l))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(l)}`);n.set(l,r)}}return new Tk({typeName:he.ZodDiscriminatedUnion,discriminator:e,options:a,optionsMap:n,...Le(s)})}};function Cg(t,e){let a=Qn(t),s=Qn(e);if(t===e)return{valid:!0,data:t};if(a===G.object&&s===G.object){let n=Ve.objectKeys(e),r=Ve.objectKeys(t).filter(l=>n.indexOf(l)!==-1),o={...t,...e};for(let l of r){let u=Cg(t[l],e[l]);if(!u.valid)return{valid:!1};o[l]=u.data}return{valid:!0,data:o}}else if(a===G.array&&s===G.array){if(t.length!==e.length)return{valid:!1};let n=[];for(let r=0;r<t.length;r++){let o=t[r],l=e[r],u=Cg(o,l);if(!u.valid)return{valid:!1};n.push(u.data)}return{valid:!0,data:n}}else return a===G.date&&s===G.date&&+t==+e?{valid:!0,data:t}:{valid:!1}}var vd=class extends De{_parse(e){let{status:a,ctx:s}=this._processInputParams(e),n=(r,o)=>{if(wg(r)||wg(o))return ke;let l=Cg(r.value,o.value);return l.valid?((kg(r)||kg(o))&&a.dirty(),{status:a.value,value:l.data}):(F(s,{code:O.invalid_intersection_types}),ke)};return s.common.async?Promise.all([this._def.left._parseAsync({data:s.data,path:s.path,parent:s}),this._def.right._parseAsync({data:s.data,path:s.path,parent:s})]).then(([r,o])=>n(r,o)):n(this._def.left._parseSync({data:s.data,path:s.path,parent:s}),this._def.right._parseSync({data:s.data,path:s.path,parent:s}))}};vd.create=(t,e,a)=>new vd({left:t,right:e,typeName:he.ZodIntersection,...Le(a)});var hi=class $k extends De{_parse(e){let{status:a,ctx:s}=this._processInputParams(e);if(s.parsedType!==G.array)return F(s,{code:O.invalid_type,expected:G.array,received:s.parsedType}),ke;if(s.data.length<this._def.items.length)return F(s,{code:O.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),ke;!this._def.rest&&s.data.length>this._def.items.length&&(F(s,{code:O.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),a.dirty());let n=[...s.data].map((r,o)=>{let l=this._def.items[o]||this._def.rest;return l?l._parse(new Qs(s,r,s.path,o)):null}).filter(r=>!!r);return s.common.async?Promise.all(n).then(r=>La.mergeArray(a,r)):La.mergeArray(a,n)}get items(){return this._def.items}rest(e){return new $k({...this._def,rest:e})}};hi.create=(t,e)=>{if(!Array.isArray(t))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new hi({items:t,typeName:he.ZodTuple,rest:null,...Le(e)})};var Ak=class Sg extends De{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:a,ctx:s}=this._processInputParams(e);if(s.parsedType!==G.object)return F(s,{code:O.invalid_type,expected:G.object,received:s.parsedType}),ke;let n=[],r=this._def.keyType,o=this._def.valueType;for(let l in s.data)n.push({key:r._parse(new Qs(s,l,s.path,l)),value:o._parse(new Qs(s,s.data[l],s.path,l)),alwaysSet:l in s.data});return s.common.async?La.mergeObjectAsync(a,n):La.mergeObjectSync(a,n)}get element(){return this._def.valueType}static create(e,a,s){return a instanceof De?new Sg({keyType:e,valueType:a,typeName:he.ZodRecord,...Le(s)}):new Sg({keyType:yo.create(),valueType:e,typeName:he.ZodRecord,...Le(a)})}},cf=class extends De{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:a,ctx:s}=this._processInputParams(e);if(s.parsedType!==G.map)return F(s,{code:O.invalid_type,expected:G.map,received:s.parsedType}),ke;let n=this._def.keyType,r=this._def.valueType,o=[...s.data.entries()].map(([l,u],c)=>({key:n._parse(new Qs(s,l,s.path,[c,"key"])),value:r._parse(new Qs(s,u,s.path,[c,"value"]))}));if(s.common.async){let l=new Map;return Promise.resolve().then(async()=>{for(let u of o){let c=await u.key,p=await u.value;if(c.status==="aborted"||p.status==="aborted")return ke;(c.status==="dirty"||p.status==="dirty")&&a.dirty(),l.set(c.value,p.value)}return{status:a.value,value:l}})}else{let l=new Map;for(let u of o){let c=u.key,p=u.value;if(c.status==="aborted"||p.status==="aborted")return ke;(c.status==="dirty"||p.status==="dirty")&&a.dirty(),l.set(c.value,p.value)}return{status:a.value,value:l}}}};cf.create=(t,e,a)=>new cf({valueType:e,keyType:t,typeName:he.ZodMap,...Le(a)});var pf=class Tg extends De{_parse(e){let{status:a,ctx:s}=this._processInputParams(e);if(s.parsedType!==G.set)return F(s,{code:O.invalid_type,expected:G.set,received:s.parsedType}),ke;let n=this._def;n.minSize!==null&&s.data.size<n.minSize.value&&(F(s,{code:O.too_small,minimum:n.minSize.value,type:"set",inclusive:!0,exact:!1,message:n.minSize.message}),a.dirty()),n.maxSize!==null&&s.data.size>n.maxSize.value&&(F(s,{code:O.too_big,maximum:n.maxSize.value,type:"set",inclusive:!0,exact:!1,message:n.maxSize.message}),a.dirty());let r=this._def.valueType;function o(u){let c=new Set;for(let p of u){if(p.status==="aborted")return ke;p.status==="dirty"&&a.dirty(),c.add(p.value)}return{status:a.value,value:c}}let l=[...s.data.values()].map((u,c)=>r._parse(new Qs(s,u,s.path,c)));return s.common.async?Promise.all(l).then(u=>o(u)):o(l)}min(e,a){return new Tg({...this._def,minSize:{value:e,message:ne.toString(a)}})}max(e,a){return new Tg({...this._def,maxSize:{value:e,message:ne.toString(a)}})}size(e,a){return this.min(e,a).max(e,a)}nonempty(e){return this.min(1,e)}};pf.create=(t,e)=>new pf({valueType:t,minSize:null,maxSize:null,typeName:he.ZodSet,...Le(e)});var Mk=class Rp extends De{constructor(){super(...arguments),this.validate=this.implement}_parse(e){let{ctx:a}=this._processInputParams(e);if(a.parsedType!==G.function)return F(a,{code:O.invalid_type,expected:G.function,received:a.parsedType}),ke;function s(l,u){return rf({data:l,path:a.path,errorMaps:[a.common.contextualErrorMap,a.schemaErrorMap,nf(),go].filter(c=>!!c),issueData:{code:O.invalid_arguments,argumentsError:u}})}function n(l,u){return rf({data:l,path:a.path,errorMaps:[a.common.contextualErrorMap,a.schemaErrorMap,nf(),go].filter(c=>!!c),issueData:{code:O.invalid_return_type,returnTypeError:u}})}let r={errorMap:a.common.contextualErrorMap},o=a.data;if(this._def.returns instanceof bo){let l=this;return ca(async function(...u){let c=new bs([]),p=await l._def.args.parseAsync(u,r).catch(m=>{throw c.addIssue(s(u,m)),c}),f=await Reflect.apply(o,this,p);return await l._def.returns._def.type.parseAsync(f,r).catch(m=>{throw c.addIssue(n(f,m)),c})})}else{let l=this;return ca(function(...u){let c=l._def.args.safeParse(u,r);if(!c.success)throw new bs([s(u,c.error)]);let p=Reflect.apply(o,this,c.data),f=l._def.returns.safeParse(p,r);if(!f.success)throw new bs([n(p,f.error)]);return f.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new Rp({...this._def,args:hi.create(e).rest(Yi.create())})}returns(e){return new Rp({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,a,s){return new Rp({args:e||hi.create([]).rest(Yi.create()),returns:a||Yi.create(),typeName:he.ZodFunction,...Le(s)})}},bd=class extends De{get schema(){return this._def.getter()}_parse(e){let{ctx:a}=this._processInputParams(e);return this._def.getter()._parse({data:a.data,path:a.path,parent:a})}};bd.create=(t,e)=>new bd({getter:t,typeName:he.ZodLazy,...Le(e)});var wd=class extends De{_parse(e){if(e.data!==this._def.value){let a=this._getOrReturnCtx(e);return F(a,{received:a.data,code:O.invalid_literal,expected:this._def.value}),ke}return{status:"valid",value:e.data}}get value(){return this._def.value}};wd.create=(t,e)=>new wd({value:t,typeName:he.ZodLiteral,...Le(e)});function Lk(t,e){return new wc({values:t,typeName:he.ZodEnum,...Le(e)})}var wc=class $g extends De{constructor(){super(...arguments),kl.set(this,void 0)}_parse(e){if(typeof e.data!="string"){let a=this._getOrReturnCtx(e),s=this._def.values;return F(a,{expected:Ve.joinValues(s),received:a.parsedType,code:O.invalid_type}),ke}if(lf(this,kl)||wk(this,kl,new Set(this._def.values)),!lf(this,kl).has(e.data)){let a=this._getOrReturnCtx(e),s=this._def.values;return F(a,{received:a.data,code:O.invalid_enum_value,options:s}),ke}return ca(e.data)}get options(){return this._def.values}get enum(){let e={};for(let a of this._def.values)e[a]=a;return e}get Values(){let e={};for(let a of this._def.values)e[a]=a;return e}get Enum(){let e={};for(let a of this._def.values)e[a]=a;return e}extract(e,a=this._def){return $g.create(e,{...this._def,...a})}exclude(e,a=this._def){return $g.create(this.options.filter(s=>!e.includes(s)),{...this._def,...a})}};kl=new WeakMap;wc.create=Lk;var kd=class extends De{constructor(){super(...arguments),xl.set(this,void 0)}_parse(e){let a=Ve.getValidEnumValues(this._def.values),s=this._getOrReturnCtx(e);if(s.parsedType!==G.string&&s.parsedType!==G.number){let n=Ve.objectValues(a);return F(s,{expected:Ve.joinValues(n),received:s.parsedType,code:O.invalid_type}),ke}if(lf(this,xl)||wk(this,xl,new Set(Ve.getValidEnumValues(this._def.values))),!lf(this,xl).has(e.data)){let n=Ve.objectValues(a);return F(s,{received:s.data,code:O.invalid_enum_value,options:n}),ke}return ca(e.data)}get enum(){return this._def.values}};xl=new WeakMap;kd.create=(t,e)=>new kd({values:t,typeName:he.ZodNativeEnum,...Le(e)});var bo=class extends De{unwrap(){return this._def.type}_parse(e){let{ctx:a}=this._processInputParams(e);if(a.parsedType!==G.promise&&a.common.async===!1)return F(a,{code:O.invalid_type,expected:G.promise,received:a.parsedType}),ke;let s=a.parsedType===G.promise?a.data:Promise.resolve(a.data);return ca(s.then(n=>this._def.type.parseAsync(n,{path:a.path,errorMap:a.common.contextualErrorMap})))}};bo.create=(t,e)=>new bo({type:t,typeName:he.ZodPromise,...Le(e)});var Ts=class extends De{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===he.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){let{status:a,ctx:s}=this._processInputParams(e),n=this._def.effect||null,r={addIssue:o=>{F(s,o),o.fatal?a.abort():a.dirty()},get path(){return s.path}};if(r.addIssue=r.addIssue.bind(r),n.type==="preprocess"){let o=n.transform(s.data,r);if(s.common.async)return Promise.resolve(o).then(async l=>{if(a.value==="aborted")return ke;let u=await this._def.schema._parseAsync({data:l,path:s.path,parent:s});return u.status==="aborted"?ke:u.status==="dirty"||a.value==="dirty"?of(u.value):u});{if(a.value==="aborted")return ke;let l=this._def.schema._parseSync({data:o,path:s.path,parent:s});return l.status==="aborted"?ke:l.status==="dirty"||a.value==="dirty"?of(l.value):l}}if(n.type==="refinement"){let o=l=>{let u=n.refinement(l,r);if(s.common.async)return Promise.resolve(u);if(u instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return l};if(s.common.async===!1){let l=this._def.schema._parseSync({data:s.data,path:s.path,parent:s});return l.status==="aborted"?ke:(l.status==="dirty"&&a.dirty(),o(l.value),{status:a.value,value:l.value})}else return this._def.schema._parseAsync({data:s.data,path:s.path,parent:s}).then(l=>l.status==="aborted"?ke:(l.status==="dirty"&&a.dirty(),o(l.value).then(()=>({status:a.value,value:l.value}))))}if(n.type==="transform")if(s.common.async===!1){let o=this._def.schema._parseSync({data:s.data,path:s.path,parent:s});if(!dd(o))return o;let l=n.transform(o.value,r);if(l instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:a.value,value:l}}else return this._def.schema._parseAsync({data:s.data,path:s.path,parent:s}).then(o=>dd(o)?Promise.resolve(n.transform(o.value,r)).then(l=>({status:a.value,value:l})):o);Ve.assertNever(n)}};Ts.create=(t,e,a)=>new Ts({schema:t,typeName:he.ZodEffects,effect:e,...Le(a)});Ts.createWithPreprocess=(t,e,a)=>new Ts({schema:e,effect:{type:"preprocess",transform:t},typeName:he.ZodEffects,...Le(a)});var zs=class extends De{_parse(e){return this._getType(e)===G.undefined?ca(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}};zs.create=(t,e)=>new zs({innerType:t,typeName:he.ZodOptional,...Le(e)});var gi=class extends De{_parse(e){return this._getType(e)===G.null?ca(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}};gi.create=(t,e)=>new gi({innerType:t,typeName:he.ZodNullable,...Le(e)});var xd=class extends De{_parse(e){let{ctx:a}=this._processInputParams(e),s=a.data;return a.parsedType===G.undefined&&(s=this._def.defaultValue()),this._def.innerType._parse({data:s,path:a.path,parent:a})}removeDefault(){return this._def.innerType}};xd.create=(t,e)=>new xd({innerType:t,typeName:he.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...Le(e)});var _d=class extends De{_parse(e){let{ctx:a}=this._processInputParams(e),s={...a,common:{...a.common,issues:[]}},n=this._def.innerType._parse({data:s.data,path:s.path,parent:{...s}});return ud(n)?n.then(r=>({status:"valid",value:r.status==="valid"?r.value:this._def.catchValue({get error(){return new bs(s.common.issues)},input:s.data})})):{status:"valid",value:n.status==="valid"?n.value:this._def.catchValue({get error(){return new bs(s.common.issues)},input:s.data})}}removeCatch(){return this._def.innerType}};_d.create=(t,e)=>new _d({innerType:t,typeName:he.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...Le(e)});var ff=class extends De{_parse(e){if(this._getType(e)!==G.nan){let a=this._getOrReturnCtx(e);return F(a,{code:O.invalid_type,expected:G.nan,received:a.parsedType}),ke}return{status:"valid",value:e.data}}};ff.create=t=>new ff({typeName:he.ZodNaN,...Le(t)});var fL=Symbol("zod_brand"),mv=class extends De{_parse(e){let{ctx:a}=this._processInputParams(e),s=a.data;return this._def.type._parse({data:s,path:a.path,parent:a})}unwrap(){return this._def.type}},hv=class Ek extends De{_parse(e){let{status:a,ctx:s}=this._processInputParams(e);if(s.common.async)return(async()=>{let n=await this._def.in._parseAsync({data:s.data,path:s.path,parent:s});return n.status==="aborted"?ke:n.status==="dirty"?(a.dirty(),of(n.value)):this._def.out._parseAsync({data:n.value,path:s.path,parent:s})})();{let n=this._def.in._parseSync({data:s.data,path:s.path,parent:s});return n.status==="aborted"?ke:n.status==="dirty"?(a.dirty(),{status:"dirty",value:n.value}):this._def.out._parseSync({data:n.value,path:s.path,parent:s})}}static create(e,a){return new Ek({in:e,out:a,typeName:he.ZodPipeline})}},Cd=class extends De{_parse(e){let a=this._def.innerType._parse(e),s=n=>(dd(n)&&(n.value=Object.freeze(n.value)),n);return ud(a)?a.then(n=>s(n)):s(a)}unwrap(){return this._def.innerType}};Cd.create=(t,e)=>new Cd({innerType:t,typeName:he.ZodReadonly,...Le(e)});function Ik(t,e={},a){return t?vo.create().superRefine((s,n)=>{var r,o;if(!t(s)){let l=typeof e=="function"?e(s):typeof e=="string"?{message:e}:e,u=(o=(r=l.fatal)!==null&&r!==void 0?r:a)!==null&&o!==void 0?o:!0,c=typeof l=="string"?{message:l}:l;n.addIssue({code:"custom",...c,fatal:u})}}):vo.create()}var mL={object:es.lazycreate},he;(function(t){t.ZodString="ZodString",t.ZodNumber="ZodNumber",t.ZodNaN="ZodNaN",t.ZodBigInt="ZodBigInt",t.ZodBoolean="ZodBoolean",t.ZodDate="ZodDate",t.ZodSymbol="ZodSymbol",t.ZodUndefined="ZodUndefined",t.ZodNull="ZodNull",t.ZodAny="ZodAny",t.ZodUnknown="ZodUnknown",t.ZodNever="ZodNever",t.ZodVoid="ZodVoid",t.ZodArray="ZodArray",t.ZodObject="ZodObject",t.ZodUnion="ZodUnion",t.ZodDiscriminatedUnion="ZodDiscriminatedUnion",t.ZodIntersection="ZodIntersection",t.ZodTuple="ZodTuple",t.ZodRecord="ZodRecord",t.ZodMap="ZodMap",t.ZodSet="ZodSet",t.ZodFunction="ZodFunction",t.ZodLazy="ZodLazy",t.ZodLiteral="ZodLiteral",t.ZodEnum="ZodEnum",t.ZodEffects="ZodEffects",t.ZodNativeEnum="ZodNativeEnum",t.ZodOptional="ZodOptional",t.ZodNullable="ZodNullable",t.ZodDefault="ZodDefault",t.ZodCatch="ZodCatch",t.ZodPromise="ZodPromise",t.ZodBranded="ZodBranded",t.ZodPipeline="ZodPipeline",t.ZodReadonly="ZodReadonly"})(he||(he={}));var hL=(t,e={message:`Input not instance of ${t.name}`})=>Ik(a=>a instanceof t,e),Ok=yo.create,Pk=cd.create,gL=ff.create,yL=pd.create,Rk=fd.create,vL=md.create,bL=df.create,wL=hd.create,kL=gd.create,xL=vo.create,_L=Yi.create,CL=wn.create,SL=uf.create,TL=hr.create,$L=es.create,AL=es.strictCreate,ML=yd.create,LL=Sk.create,EL=vd.create,IL=hi.create,OL=Ak.create,PL=cf.create,RL=pf.create,DL=Mk.create,NL=bd.create,WL=wd.create,BL=wc.create,ZL=kd.create,qL=bo.create,gw=Ts.create,FL=zs.create,jL=gi.create,HL=Ts.createWithPreprocess,zL=hv.create,KL=()=>Ok().optional(),VL=()=>Pk().optional(),UL=()=>Rk().optional(),GL={string:t=>yo.create({...t,coerce:!0}),number:t=>cd.create({...t,coerce:!0}),boolean:t=>fd.create({...t,coerce:!0}),bigint:t=>pd.create({...t,coerce:!0}),date:t=>md.create({...t,coerce:!0})},QL=ke,_=Object.freeze({__proto__:null,defaultErrorMap:go,setErrorMap:QM,getErrorMap:nf,makeIssue:rf,EMPTY_PATH:YM,addIssueToContext:F,ParseStatus:La,INVALID:ke,DIRTY:of,OK:ca,isAborted:wg,isDirty:kg,isValid:dd,isAsync:ud,get util(){return Ve},get objectUtil(){return bg},ZodParsedType:G,getParsedType:Qn,ZodType:De,datetimeRegex:_k,ZodString:yo,ZodNumber:cd,ZodBigInt:pd,ZodBoolean:fd,ZodDate:md,ZodSymbol:df,ZodUndefined:hd,ZodNull:gd,ZodAny:vo,ZodUnknown:Yi,ZodNever:wn,ZodVoid:uf,ZodArray:hr,ZodObject:es,ZodUnion:yd,ZodDiscriminatedUnion:Sk,ZodIntersection:vd,ZodTuple:hi,ZodRecord:Ak,ZodMap:cf,ZodSet:pf,ZodFunction:Mk,ZodLazy:bd,ZodLiteral:wd,ZodEnum:wc,ZodNativeEnum:kd,ZodPromise:bo,ZodEffects:Ts,ZodTransformer:Ts,ZodOptional:zs,ZodNullable:gi,ZodDefault:xd,ZodCatch:_d,ZodNaN:ff,BRAND:fL,ZodBranded:mv,ZodPipeline:hv,ZodReadonly:Cd,custom:Ik,Schema:De,ZodSchema:De,late:mL,get ZodFirstPartyTypeKind(){return he},coerce:GL,any:xL,array:TL,bigint:yL,boolean:Rk,date:vL,discriminatedUnion:LL,effect:gw,enum:BL,function:DL,instanceof:hL,intersection:EL,lazy:NL,literal:WL,map:PL,nan:gL,nativeEnum:ZL,never:CL,null:kL,nullable:jL,number:Pk,object:$L,oboolean:UL,onumber:VL,optional:FL,ostring:KL,pipeline:zL,preprocess:HL,promise:qL,record:OL,set:RL,strictObject:AL,string:Ok,symbol:bL,transformer:gw,tuple:IL,undefined:wL,union:ML,unknown:_L,void:SL,NEVER:QL,ZodIssueCode:O,quotelessJson:GM,ZodError:bs}),Sd=_.object({message:_.string()}),YL=Sd.extend({validationErrors:_.array(_.string()).nonempty()}),Cl=Sd,JL=Cl.extend({errorId:_.string(),uid:_.string().optional()});function XL(t){return Sd.extend({data:t.nullable()})}var eE={400:Cl.describe("Generic client error"),401:Cl.describe("Authentication required but not provided or invalid"),403:Cl.describe("Operation not permitted"),422:YL.describe("Request validation failed"),429:Cl.describe("Rate limit exceeded"),500:JL.describe("Generic server error")},Lh=_.custom(t=>typeof t=="string"?/^\d+$/.test(t):!1),kc=()=>_.string().regex(/^[a-zA-Z0-9_]+$/);kc();kc().max(50);var Dk=_.enum(["normal","expert","master"]),cl=_.object({acc:_.number().nonnegative().max(100),consistency:_.number().nonnegative().max(100),difficulty:Dk,lazyMode:_.boolean().optional(),language:_.string().max(100).regex(/[\w+]+/),punctuation:_.boolean().optional(),numbers:_.boolean().optional(),raw:_.number().nonnegative(),wpm:_.number().nonnegative(),timestamp:_.number().nonnegative()}),tE=_.object({time:_.record(Lh,_.array(cl)),words:_.record(Lh,_.array(cl)),quote:_.record(Lh,_.array(cl)),custom:_.record(_.literal("custom"),_.array(cl)),zen:_.record(_.literal("zen"),_.array(cl))}),aE=tE.keyof(),sE=_.enum(["off","slow","medium","fast"]),nE=_.enum(["off","esc","tab","enter"]),iE=_.union([_.literal(-3),_.literal(-2),_.literal(-1),_.literal(0),_.literal(1),_.literal(2),_.literal(3)]),rE=_.array(iE),yw=_.enum(["off","default","block","outline","underline","carrot","banana"]),oE=_.enum(["off","on","max"]),lE=_.enum(["off","below","replace"]),dE=_.enum(["off","bar","text","mini"]),Eh=_.enum(["off","text","mini"]),uE=_.enum(["off","on","fav","light","dark","custom"]),cE=_.enum(["black","sub","text","main"]),pE=_.enum(["0.25","0.5","0.75","1"]),fE=_.enum(["off","word","letter"]),mE=_.enum(["off","static","react","next"]),hE=_.enum(["staggered","alice","matrix","split","split_matrix","steno","steno_matrix"]),gE=_.enum(["lowercase","uppercase","blank","dynamic"]),yE=_.enum(["always","layout","never"]),vE=_.number().min(.5).max(3.5).step(.1),bE=_.enum(["manual","on"]),wE=_.enum(["off","1","2","3","4"]),kE=_.enum(["off","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15"]),xE=_.number().min(0).max(1),_E=_.enum(["off","average","pb","tagPb","last","custom","daily"]),CE=_.tuple([_.enum(["on","off"]),_.enum(["on","off"]),_.enum(["on","off"]),_.enum(["on","off"])]),SE=_.enum(["off","custom"]),TE=_.enum(["off","letter","word","next_word","next_two_words","next_three_words"]),$E=_.enum(["off","letter","word"]),AE=_.enum(["wpm","cpm","wps","cps","wph"]),ME=_.enum(["off","result","on","sellout"]),LE=_.enum(["off","custom"]),EE=_.enum(["off","typing"]),IE=_.enum(["off","on","keymap"]),OE=_.enum(["cover","contain","max"]),PE=_.tuple([_.number(),_.number(),_.number(),_.number()]),RE=_.string().regex(/^[0-9a-zA-Z_#]+$/),DE=_.enum(["off","1","2","3","4"]),NE=_.enum(["off","fixed","flex"]),WE=_.enum(["off","speed","acc","both"]),Es=_.string().regex(/^#([\da-f]{3}){1,2}$/i),BE=Dk,ZE=_.tuple([Es,Es,Es,Es,Es,Es,Es,Es,Es,Es]),qE=_.array(kc().max(50)),FE=_.string().max(100).regex(/[\w#]+/),jE=_.number().nonnegative(),HE=_.number().nonnegative(),zE=_.number().nonnegative().max(100),KE=_.number().nonnegative(),VE=_.number().int().nonnegative(),UE=_.number().int().nonnegative(),GE=_.string().max(50).regex(/^[a-zA-Z0-9_\-+.]+$/),Ih=kc().max(50),QE=_.string().max(50).regex(/^[a-zA-Z0-9_+]+$/),YE=_.string().max(50).regex(/[\w\-_]+/),JE=kc().max(50),XE=_.number().positive(),eI=_.number().min(20).max(1e3).or(_.literal(0)),tI=_.string().regex(/(https|http):\/\/(www\.|).+\..+\/.+(\.png|\.gif|\.jpeg|\.jpg)/gi).or(_.literal("")),aI=_.object({theme:Ih,themeLight:Ih,themeDark:Ih,autoSwitchTheme:_.boolean(),customTheme:_.boolean(),customThemeColors:ZE,favThemes:qE,showKeyTips:_.boolean(),smoothCaret:sE,quickRestart:nE,punctuation:_.boolean(),numbers:_.boolean(),words:UE,time:VE,mode:aE,quoteLength:rE,language:QE,fontSize:XE,freedomMode:_.boolean(),difficulty:BE,blindMode:_.boolean(),quickEnd:_.boolean(),caretStyle:yw,paceCaretStyle:yw,flipTestColors:_.boolean(),layout:JE,funbox:FE,confidenceMode:oE,indicateTypos:lE,timerStyle:dE,liveSpeedStyle:Eh,liveAccStyle:Eh,liveBurstStyle:Eh,colorfulMode:_.boolean(),randomTheme:uE,timerColor:cE,timerOpacity:pE,stopOnError:fE,showAllLines:_.boolean(),keymapMode:mE,keymapStyle:hE,keymapLegendStyle:gE,keymapLayout:YE,keymapShowTopRow:yE,keymapSize:vE,fontFamily:GE,smoothLineScroll:_.boolean(),alwaysShowDecimalPlaces:_.boolean(),alwaysShowWordsHistory:_.boolean(),singleListCommandLine:bE,capsLockWarning:_.boolean(),playSoundOnError:wE,playSoundOnClick:kE,soundVolume:xE,startGraphsAtZero:_.boolean(),showOutOfFocusWarning:_.boolean(),paceCaret:_E,paceCaretCustomSpeed:jE,repeatedPace:_.boolean(),accountChart:CE,minWpm:SE,minWpmCustomSpeed:HE,highlightMode:TE,tapeMode:$E,typingSpeedUnit:AE,ads:ME,hideExtraLetters:_.boolean(),strictSpace:_.boolean(),minAcc:LE,minAccCustom:zE,monkey:_.boolean(),repeatQuotes:EE,oppositeShiftMode:IE,customBackground:tI,customBackgroundSize:OE,customBackgroundFilter:PE,customLayoutfluid:RE,monkeyPowerLevel:DE,minBurst:NE,minBurstCustomSpeed:KE,burstHeatmap:_.boolean(),britishEnglish:_.boolean(),lazyMode:_.boolean(),showAverage:WE,maxLineWidth:eI}).strict(),Nk=aI.partial(),sI=XL(Nk),vw=UM(),nI=vw.router({get:{summary:"get config",description:"Get config of the current user.",method:"GET",path:"/",responses:{200:sI}},save:{method:"PATCH",path:"/",body:Nk.strict(),responses:{200:Sd},summary:"update config",description:"Update the config of the current user. Only provided values will be updated while the missing values will be unchanged."},delete:{method:"DELETE",path:"/",body:vw.noBody(),responses:{200:Sd},summary:"delete config",description:"Delete/reset the config for the current user."}},{pathPrefix:"/configs",strictStatusCodes:!0,metadata:{openApiTags:"configs"},commonResponses:eE}),Oh=t=>typeof(t==null?void 0:t.passthrough)=="function",iI=(t,e)=>Oh(t)?Oh(e)?t.merge(e):t:Oh(e)?e:Object.assign({},t,e),rI=Symbol("ContractNoBody"),oI=t=>"method"in t&&"path"in t,Wk=(t,e)=>Object.fromEntries(Object.entries(t).map(([a,s])=>{var n,r,o;return oI(s)?[a,{...s,path:e!=null&&e.pathPrefix?e.pathPrefix+s.path:s.path,headers:iI(e==null?void 0:e.baseHeaders,s.headers),strictStatusCodes:(n=s.strictStatusCodes)!==null&&n!==void 0?n:e==null?void 0:e.strictStatusCodes,validateResponseOnClient:(r=s.validateResponseOnClient)!==null&&r!==void 0?r:e==null?void 0:e.validateResponseOnClient,responses:{...e==null?void 0:e.commonResponses,...s.responses},metadata:e!=null&&e.metadata?{...e==null?void 0:e.metadata,...(o=s.metadata)!==null&&o!==void 0?o:{}}:s.metadata}]:[a,Wk(s,e)]})),Ph=Symbol("ContractPlainType"),lI=()=>({router:(t,e)=>Wk(t,e),query:t=>t,mutation:t=>t,responses:t=>t,response:()=>Ph,body:()=>Ph,type:()=>Ph,otherResponse:({contentType:t,body:e})=>({contentType:t,body:e}),noBody:()=>rI}),Ue;(function(t){t.assertEqual=n=>n;function e(n){}t.assertIs=e;function a(n){throw new Error}t.assertNever=a,t.arrayToEnum=n=>{let r={};for(let o of n)r[o]=o;return r},t.getValidEnumValues=n=>{let r=t.objectKeys(n).filter(l=>typeof n[n[l]]!="number"),o={};for(let l of r)o[l]=n[l];return t.objectValues(o)},t.objectValues=n=>t.objectKeys(n).map(function(r){return n[r]}),t.objectKeys=typeof Object.keys=="function"?n=>Object.keys(n):n=>{let r=[];for(let o in n)Object.prototype.hasOwnProperty.call(n,o)&&r.push(o);return r},t.find=(n,r)=>{for(let o of n)if(r(o))return o},t.isInteger=typeof Number.isInteger=="function"?n=>Number.isInteger(n):n=>typeof n=="number"&&isFinite(n)&&Math.floor(n)===n;function s(n,r=" | "){return n.map(o=>typeof o=="string"?`'${o}'`:o).join(r)}t.joinValues=s,t.jsonStringifyReplacer=(n,r)=>typeof r=="bigint"?r.toString():r})(Ue||(Ue={}));var Ag;(function(t){t.mergeShapes=(e,a)=>({...e,...a})})(Ag||(Ag={}));var Q=Ue.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Yn=t=>{switch(typeof t){case"undefined":return Q.undefined;case"string":return Q.string;case"number":return isNaN(t)?Q.nan:Q.number;case"boolean":return Q.boolean;case"function":return Q.function;case"bigint":return Q.bigint;case"symbol":return Q.symbol;case"object":return Array.isArray(t)?Q.array:t===null?Q.null:t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?Q.promise:typeof Map<"u"&&t instanceof Map?Q.map:typeof Set<"u"&&t instanceof Set?Q.set:typeof Date<"u"&&t instanceof Date?Q.date:Q.object;default:return Q.unknown}},P=Ue.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),dI=t=>JSON.stringify(t,null,2).replace(/"([^"]+)":/g,"$1:"),ws=class Bk extends Error{constructor(e){super(),this.issues=[],this.addIssue=s=>{this.issues=[...this.issues,s]},this.addIssues=(s=[])=>{this.issues=[...this.issues,...s]};let a=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,a):this.__proto__=a,this.name="ZodError",this.issues=e}get errors(){return this.issues}format(e){let a=e||function(r){return r.message},s={_errors:[]},n=r=>{for(let o of r.issues)if(o.code==="invalid_union")o.unionErrors.map(n);else if(o.code==="invalid_return_type")n(o.returnTypeError);else if(o.code==="invalid_arguments")n(o.argumentsError);else if(o.path.length===0)s._errors.push(a(o));else{let l=s,u=0;for(;u<o.path.length;){let c=o.path[u];u===o.path.length-1?(l[c]=l[c]||{_errors:[]},l[c]._errors.push(a(o))):l[c]=l[c]||{_errors:[]},l=l[c],u++}}};return n(this),s}static assert(e){if(!(e instanceof Bk))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,Ue.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=a=>a.message){let a={},s=[];for(let n of this.issues)n.path.length>0?(a[n.path[0]]=a[n.path[0]]||[],a[n.path[0]].push(e(n))):s.push(e(n));return{formErrors:s,fieldErrors:a}}get formErrors(){return this.flatten()}};ws.create=t=>new ws(t);var wo=(t,e)=>{let a;switch(t.code){case P.invalid_type:t.received===Q.undefined?a="Required":a=`Expected ${t.expected}, received ${t.received}`;break;case P.invalid_literal:a=`Invalid literal value, expected ${JSON.stringify(t.expected,Ue.jsonStringifyReplacer)}`;break;case P.unrecognized_keys:a=`Unrecognized key(s) in object: ${Ue.joinValues(t.keys,", ")}`;break;case P.invalid_union:a="Invalid input";break;case P.invalid_union_discriminator:a=`Invalid discriminator value. Expected ${Ue.joinValues(t.options)}`;break;case P.invalid_enum_value:a=`Invalid enum value. Expected ${Ue.joinValues(t.options)}, received '${t.received}'`;break;case P.invalid_arguments:a="Invalid function arguments";break;case P.invalid_return_type:a="Invalid function return type";break;case P.invalid_date:a="Invalid date";break;case P.invalid_string:typeof t.validation=="object"?"includes"in t.validation?(a=`Invalid input: must include "${t.validation.includes}"`,typeof t.validation.position=="number"&&(a=`${a} at one or more positions greater than or equal to ${t.validation.position}`)):"startsWith"in t.validation?a=`Invalid input: must start with "${t.validation.startsWith}"`:"endsWith"in t.validation?a=`Invalid input: must end with "${t.validation.endsWith}"`:Ue.assertNever(t.validation):t.validation!=="regex"?a=`Invalid ${t.validation}`:a="Invalid";break;case P.too_small:t.type==="array"?a=`Array must contain ${t.exact?"exactly":t.inclusive?"at least":"more than"} ${t.minimum} element(s)`:t.type==="string"?a=`String must contain ${t.exact?"exactly":t.inclusive?"at least":"over"} ${t.minimum} character(s)`:t.type==="number"?a=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="date"?a=`Date must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(t.minimum))}`:a="Invalid input";break;case P.too_big:t.type==="array"?a=`Array must contain ${t.exact?"exactly":t.inclusive?"at most":"less than"} ${t.maximum} element(s)`:t.type==="string"?a=`String must contain ${t.exact?"exactly":t.inclusive?"at most":"under"} ${t.maximum} character(s)`:t.type==="number"?a=`Number must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="bigint"?a=`BigInt must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="date"?a=`Date must be ${t.exact?"exactly":t.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(t.maximum))}`:a="Invalid input";break;case P.custom:a="Invalid input";break;case P.invalid_intersection_types:a="Intersection results could not be merged";break;case P.not_multiple_of:a=`Number must be a multiple of ${t.multipleOf}`;break;case P.not_finite:a="Number must be finite";break;default:a=e.defaultError,Ue.assertNever(t)}return{message:a}},Zk=wo;function uI(t){Zk=t}function mf(){return Zk}var hf=t=>{let{data:e,path:a,errorMaps:s,issueData:n}=t,r=[...a,...n.path||[]],o={...n,path:r};if(n.message!==void 0)return{...n,path:r,message:n.message};let l="",u=s.filter(c=>!!c).slice().reverse();for(let c of u)l=c(o,{data:e,defaultError:l}).message;return{...n,path:r,message:l}},cI=[];function j(t,e){let a=mf(),s=hf({issueData:e,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,a,a===wo?void 0:wo].filter(n=>!!n)});t.common.issues.push(s)}var Ea=class qk{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,a){let s=[];for(let n of a){if(n.status==="aborted")return xe;n.status==="dirty"&&e.dirty(),s.push(n.value)}return{status:e.value,value:s}}static async mergeObjectAsync(e,a){let s=[];for(let n of a){let r=await n.key,o=await n.value;s.push({key:r,value:o})}return qk.mergeObjectSync(e,s)}static mergeObjectSync(e,a){let s={};for(let n of a){let{key:r,value:o}=n;if(r.status==="aborted"||o.status==="aborted")return xe;r.status==="dirty"&&e.dirty(),o.status==="dirty"&&e.dirty(),r.value!=="__proto__"&&(typeof o.value<"u"||n.alwaysSet)&&(s[r.value]=o.value)}return{status:e.value,value:s}}},xe=Object.freeze({status:"aborted"}),gf=t=>({status:"dirty",value:t}),pa=t=>({status:"valid",value:t}),Mg=t=>t.status==="aborted",Lg=t=>t.status==="dirty",Td=t=>t.status==="valid",$d=t=>typeof Promise<"u"&&t instanceof Promise;function yf(t,e,a,s){if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return e.get(t)}function Fk(t,e,a,s,n){if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return e.set(t,a),a}var ie;(function(t){t.errToObj=e=>typeof e=="string"?{message:e}:e||{},t.toString=e=>typeof e=="string"?e:e==null?void 0:e.message})(ie||(ie={}));var Sl,Tl,Ys=class{constructor(e,a,s,n){this._cachedPath=[],this.parent=e,this.data=a,this._path=s,this._key=n}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}},bw=(t,e)=>{if(Td(e))return{success:!0,data:e.value};if(!t.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;let a=new ws(t.common.issues);return this._error=a,this._error}}};function Ee(t){if(!t)return{};let{errorMap:e,invalid_type_error:a,required_error:s,description:n}=t;if(e&&(a||s))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:n}:{errorMap:(r,o)=>{var l,u;let{message:c}=t;return r.code==="invalid_enum_value"?{message:c??o.defaultError}:typeof o.data>"u"?{message:(l=c??s)!==null&&l!==void 0?l:o.defaultError}:r.code!=="invalid_type"?{message:o.defaultError}:{message:(u=c??a)!==null&&u!==void 0?u:o.defaultError}},description:n}}var Ne=class{constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this)}get description(){return this._def.description}_getType(e){return Yn(e.data)}_getOrReturnCtx(e,a){return a||{common:e.parent.common,data:e.data,parsedType:Yn(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new Ea,ctx:{common:e.parent.common,data:e.data,parsedType:Yn(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){let a=this._parse(e);if($d(a))throw new Error("Synchronous parse encountered promise.");return a}_parseAsync(e){let a=this._parse(e);return Promise.resolve(a)}parse(e,a){let s=this.safeParse(e,a);if(s.success)return s.data;throw s.error}safeParse(e,a){var s;let n={common:{issues:[],async:(s=a==null?void 0:a.async)!==null&&s!==void 0?s:!1,contextualErrorMap:a==null?void 0:a.errorMap},path:(a==null?void 0:a.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Yn(e)},r=this._parseSync({data:e,path:n.path,parent:n});return bw(n,r)}async parseAsync(e,a){let s=await this.safeParseAsync(e,a);if(s.success)return s.data;throw s.error}async safeParseAsync(e,a){let s={common:{issues:[],contextualErrorMap:a==null?void 0:a.errorMap,async:!0},path:(a==null?void 0:a.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Yn(e)},n=this._parse({data:e,path:s.path,parent:s}),r=await($d(n)?n:Promise.resolve(n));return bw(s,r)}refine(e,a){let s=n=>typeof a=="string"||typeof a>"u"?{message:a}:typeof a=="function"?a(n):a;return this._refinement((n,r)=>{let o=e(n),l=()=>r.addIssue({code:P.custom,...s(n)});return typeof Promise<"u"&&o instanceof Promise?o.then(u=>u?!0:(l(),!1)):o?!0:(l(),!1)})}refinement(e,a){return this._refinement((s,n)=>e(s)?!0:(n.addIssue(typeof a=="function"?a(s,n):a),!1))}_refinement(e){return new $s({schema:this,typeName:ge.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}optional(){return Ks.create(this,this._def)}nullable(){return vi.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return gr.create(this,this._def)}promise(){return _o.create(this,this._def)}or(e){return Pd.create([this,e],this._def)}and(e){return Rd.create(this,e,this._def)}transform(e){return new $s({...Ee(this._def),schema:this,typeName:ge.ZodEffects,effect:{type:"transform",transform:e}})}default(e){let a=typeof e=="function"?e:()=>e;return new Bd({...Ee(this._def),innerType:this,defaultValue:a,typeName:ge.ZodDefault})}brand(){return new gv({typeName:ge.ZodBranded,type:this,...Ee(this._def)})}catch(e){let a=typeof e=="function"?e:()=>e;return new Zd({...Ee(this._def),innerType:this,catchValue:a,typeName:ge.ZodCatch})}describe(e){let a=this.constructor;return new a({...this._def,description:e})}pipe(e){return yv.create(this,e)}readonly(){return qd.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}},pI=/^c[^\s-]{8,}$/i,fI=/^[0-9a-z]+$/,mI=/^[0-9A-HJKMNP-TV-Z]{26}$/,hI=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,gI=/^[a-z0-9_-]{21}$/i,yI=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,vI=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,bI="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$",Rh,wI=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,kI=/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,xI=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,jk="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",_I=new RegExp(`^${jk}$`);function Hk(t){let e="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return t.precision?e=`${e}\\.\\d{${t.precision}}`:t.precision==null&&(e=`${e}(\\.\\d+)?`),e}function CI(t){return new RegExp(`^${Hk(t)}$`)}function zk(t){let e=`${jk}T${Hk(t)}`,a=[];return a.push(t.local?"Z?":"Z"),t.offset&&a.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${a.join("|")})`,new RegExp(`^${e}$`)}function SI(t,e){return!!((e==="v4"||!e)&&wI.test(t)||(e==="v6"||!e)&&kI.test(t))}var ko=class $l extends Ne{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==Q.string){let n=this._getOrReturnCtx(e);return j(n,{code:P.invalid_type,expected:Q.string,received:n.parsedType}),xe}let a=new Ea,s;for(let n of this._def.checks)if(n.kind==="min")e.data.length<n.value&&(s=this._getOrReturnCtx(e,s),j(s,{code:P.too_small,minimum:n.value,type:"string",inclusive:!0,exact:!1,message:n.message}),a.dirty());else if(n.kind==="max")e.data.length>n.value&&(s=this._getOrReturnCtx(e,s),j(s,{code:P.too_big,maximum:n.value,type:"string",inclusive:!0,exact:!1,message:n.message}),a.dirty());else if(n.kind==="length"){let r=e.data.length>n.value,o=e.data.length<n.value;(r||o)&&(s=this._getOrReturnCtx(e,s),r?j(s,{code:P.too_big,maximum:n.value,type:"string",inclusive:!0,exact:!0,message:n.message}):o&&j(s,{code:P.too_small,minimum:n.value,type:"string",inclusive:!0,exact:!0,message:n.message}),a.dirty())}else if(n.kind==="email")vI.test(e.data)||(s=this._getOrReturnCtx(e,s),j(s,{validation:"email",code:P.invalid_string,message:n.message}),a.dirty());else if(n.kind==="emoji")Rh||(Rh=new RegExp(bI,"u")),Rh.test(e.data)||(s=this._getOrReturnCtx(e,s),j(s,{validation:"emoji",code:P.invalid_string,message:n.message}),a.dirty());else if(n.kind==="uuid")hI.test(e.data)||(s=this._getOrReturnCtx(e,s),j(s,{validation:"uuid",code:P.invalid_string,message:n.message}),a.dirty());else if(n.kind==="nanoid")gI.test(e.data)||(s=this._getOrReturnCtx(e,s),j(s,{validation:"nanoid",code:P.invalid_string,message:n.message}),a.dirty());else if(n.kind==="cuid")pI.test(e.data)||(s=this._getOrReturnCtx(e,s),j(s,{validation:"cuid",code:P.invalid_string,message:n.message}),a.dirty());else if(n.kind==="cuid2")fI.test(e.data)||(s=this._getOrReturnCtx(e,s),j(s,{validation:"cuid2",code:P.invalid_string,message:n.message}),a.dirty());else if(n.kind==="ulid")mI.test(e.data)||(s=this._getOrReturnCtx(e,s),j(s,{validation:"ulid",code:P.invalid_string,message:n.message}),a.dirty());else if(n.kind==="url")try{new URL(e.data)}catch{s=this._getOrReturnCtx(e,s),j(s,{validation:"url",code:P.invalid_string,message:n.message}),a.dirty()}else n.kind==="regex"?(n.regex.lastIndex=0,n.regex.test(e.data)||(s=this._getOrReturnCtx(e,s),j(s,{validation:"regex",code:P.invalid_string,message:n.message}),a.dirty())):n.kind==="trim"?e.data=e.data.trim():n.kind==="includes"?e.data.includes(n.value,n.position)||(s=this._getOrReturnCtx(e,s),j(s,{code:P.invalid_string,validation:{includes:n.value,position:n.position},message:n.message}),a.dirty()):n.kind==="toLowerCase"?e.data=e.data.toLowerCase():n.kind==="toUpperCase"?e.data=e.data.toUpperCase():n.kind==="startsWith"?e.data.startsWith(n.value)||(s=this._getOrReturnCtx(e,s),j(s,{code:P.invalid_string,validation:{startsWith:n.value},message:n.message}),a.dirty()):n.kind==="endsWith"?e.data.endsWith(n.value)||(s=this._getOrReturnCtx(e,s),j(s,{code:P.invalid_string,validation:{endsWith:n.value},message:n.message}),a.dirty()):n.kind==="datetime"?zk(n).test(e.data)||(s=this._getOrReturnCtx(e,s),j(s,{code:P.invalid_string,validation:"datetime",message:n.message}),a.dirty()):n.kind==="date"?_I.test(e.data)||(s=this._getOrReturnCtx(e,s),j(s,{code:P.invalid_string,validation:"date",message:n.message}),a.dirty()):n.kind==="time"?CI(n).test(e.data)||(s=this._getOrReturnCtx(e,s),j(s,{code:P.invalid_string,validation:"time",message:n.message}),a.dirty()):n.kind==="duration"?yI.test(e.data)||(s=this._getOrReturnCtx(e,s),j(s,{validation:"duration",code:P.invalid_string,message:n.message}),a.dirty()):n.kind==="ip"?SI(e.data,n.version)||(s=this._getOrReturnCtx(e,s),j(s,{validation:"ip",code:P.invalid_string,message:n.message}),a.dirty()):n.kind==="base64"?xI.test(e.data)||(s=this._getOrReturnCtx(e,s),j(s,{validation:"base64",code:P.invalid_string,message:n.message}),a.dirty()):Ue.assertNever(n);return{status:a.value,value:e.data}}_regex(e,a,s){return this.refinement(n=>e.test(n),{validation:a,code:P.invalid_string,...ie.errToObj(s)})}_addCheck(e){return new $l({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...ie.errToObj(e)})}url(e){return this._addCheck({kind:"url",...ie.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...ie.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...ie.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...ie.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...ie.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...ie.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...ie.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...ie.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...ie.errToObj(e)})}datetime(e){var a,s;return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,offset:(a=e==null?void 0:e.offset)!==null&&a!==void 0?a:!1,local:(s=e==null?void 0:e.local)!==null&&s!==void 0?s:!1,...ie.errToObj(e==null?void 0:e.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,...ie.errToObj(e==null?void 0:e.message)})}duration(e){return this._addCheck({kind:"duration",...ie.errToObj(e)})}regex(e,a){return this._addCheck({kind:"regex",regex:e,...ie.errToObj(a)})}includes(e,a){return this._addCheck({kind:"includes",value:e,position:a==null?void 0:a.position,...ie.errToObj(a==null?void 0:a.message)})}startsWith(e,a){return this._addCheck({kind:"startsWith",value:e,...ie.errToObj(a)})}endsWith(e,a){return this._addCheck({kind:"endsWith",value:e,...ie.errToObj(a)})}min(e,a){return this._addCheck({kind:"min",value:e,...ie.errToObj(a)})}max(e,a){return this._addCheck({kind:"max",value:e,...ie.errToObj(a)})}length(e,a){return this._addCheck({kind:"length",value:e,...ie.errToObj(a)})}nonempty(e){return this.min(1,ie.errToObj(e))}trim(){return new $l({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new $l({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new $l({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get minLength(){let e=null;for(let a of this._def.checks)a.kind==="min"&&(e===null||a.value>e)&&(e=a.value);return e}get maxLength(){let e=null;for(let a of this._def.checks)a.kind==="max"&&(e===null||a.value<e)&&(e=a.value);return e}};ko.create=t=>{var e;return new ko({checks:[],typeName:ge.ZodString,coerce:(e=t==null?void 0:t.coerce)!==null&&e!==void 0?e:!1,...Ee(t)})};function TI(t,e){let a=(t.toString().split(".")[1]||"").length,s=(e.toString().split(".")[1]||"").length,n=a>s?a:s,r=parseInt(t.toFixed(n).replace(".","")),o=parseInt(e.toFixed(n).replace(".",""));return r%o/Math.pow(10,n)}var Ad=class Eg extends Ne{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==Q.number){let n=this._getOrReturnCtx(e);return j(n,{code:P.invalid_type,expected:Q.number,received:n.parsedType}),xe}let a,s=new Ea;for(let n of this._def.checks)n.kind==="int"?Ue.isInteger(e.data)||(a=this._getOrReturnCtx(e,a),j(a,{code:P.invalid_type,expected:"integer",received:"float",message:n.message}),s.dirty()):n.kind==="min"?(n.inclusive?e.data<n.value:e.data<=n.value)&&(a=this._getOrReturnCtx(e,a),j(a,{code:P.too_small,minimum:n.value,type:"number",inclusive:n.inclusive,exact:!1,message:n.message}),s.dirty()):n.kind==="max"?(n.inclusive?e.data>n.value:e.data>=n.value)&&(a=this._getOrReturnCtx(e,a),j(a,{code:P.too_big,maximum:n.value,type:"number",inclusive:n.inclusive,exact:!1,message:n.message}),s.dirty()):n.kind==="multipleOf"?TI(e.data,n.value)!==0&&(a=this._getOrReturnCtx(e,a),j(a,{code:P.not_multiple_of,multipleOf:n.value,message:n.message}),s.dirty()):n.kind==="finite"?Number.isFinite(e.data)||(a=this._getOrReturnCtx(e,a),j(a,{code:P.not_finite,message:n.message}),s.dirty()):Ue.assertNever(n);return{status:s.value,value:e.data}}gte(e,a){return this.setLimit("min",e,!0,ie.toString(a))}gt(e,a){return this.setLimit("min",e,!1,ie.toString(a))}lte(e,a){return this.setLimit("max",e,!0,ie.toString(a))}lt(e,a){return this.setLimit("max",e,!1,ie.toString(a))}setLimit(e,a,s,n){return new Eg({...this._def,checks:[...this._def.checks,{kind:e,value:a,inclusive:s,message:ie.toString(n)}]})}_addCheck(e){return new Eg({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:ie.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:ie.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:ie.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:ie.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:ie.toString(e)})}multipleOf(e,a){return this._addCheck({kind:"multipleOf",value:e,message:ie.toString(a)})}finite(e){return this._addCheck({kind:"finite",message:ie.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:ie.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:ie.toString(e)})}get minValue(){let e=null;for(let a of this._def.checks)a.kind==="min"&&(e===null||a.value>e)&&(e=a.value);return e}get maxValue(){let e=null;for(let a of this._def.checks)a.kind==="max"&&(e===null||a.value<e)&&(e=a.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&Ue.isInteger(e.value))}get isFinite(){let e=null,a=null;for(let s of this._def.checks){if(s.kind==="finite"||s.kind==="int"||s.kind==="multipleOf")return!0;s.kind==="min"?(a===null||s.value>a)&&(a=s.value):s.kind==="max"&&(e===null||s.value<e)&&(e=s.value)}return Number.isFinite(a)&&Number.isFinite(e)}};Ad.create=t=>new Ad({checks:[],typeName:ge.ZodNumber,coerce:(t==null?void 0:t.coerce)||!1,...Ee(t)});var Md=class Ig extends Ne{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce&&(e.data=BigInt(e.data)),this._getType(e)!==Q.bigint){let n=this._getOrReturnCtx(e);return j(n,{code:P.invalid_type,expected:Q.bigint,received:n.parsedType}),xe}let a,s=new Ea;for(let n of this._def.checks)n.kind==="min"?(n.inclusive?e.data<n.value:e.data<=n.value)&&(a=this._getOrReturnCtx(e,a),j(a,{code:P.too_small,type:"bigint",minimum:n.value,inclusive:n.inclusive,message:n.message}),s.dirty()):n.kind==="max"?(n.inclusive?e.data>n.value:e.data>=n.value)&&(a=this._getOrReturnCtx(e,a),j(a,{code:P.too_big,type:"bigint",maximum:n.value,inclusive:n.inclusive,message:n.message}),s.dirty()):n.kind==="multipleOf"?e.data%n.value!==BigInt(0)&&(a=this._getOrReturnCtx(e,a),j(a,{code:P.not_multiple_of,multipleOf:n.value,message:n.message}),s.dirty()):Ue.assertNever(n);return{status:s.value,value:e.data}}gte(e,a){return this.setLimit("min",e,!0,ie.toString(a))}gt(e,a){return this.setLimit("min",e,!1,ie.toString(a))}lte(e,a){return this.setLimit("max",e,!0,ie.toString(a))}lt(e,a){return this.setLimit("max",e,!1,ie.toString(a))}setLimit(e,a,s,n){return new Ig({...this._def,checks:[...this._def.checks,{kind:e,value:a,inclusive:s,message:ie.toString(n)}]})}_addCheck(e){return new Ig({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:ie.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:ie.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:ie.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:ie.toString(e)})}multipleOf(e,a){return this._addCheck({kind:"multipleOf",value:e,message:ie.toString(a)})}get minValue(){let e=null;for(let a of this._def.checks)a.kind==="min"&&(e===null||a.value>e)&&(e=a.value);return e}get maxValue(){let e=null;for(let a of this._def.checks)a.kind==="max"&&(e===null||a.value<e)&&(e=a.value);return e}};Md.create=t=>{var e;return new Md({checks:[],typeName:ge.ZodBigInt,coerce:(e=t==null?void 0:t.coerce)!==null&&e!==void 0?e:!1,...Ee(t)})};var Ld=class extends Ne{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==Q.boolean){let a=this._getOrReturnCtx(e);return j(a,{code:P.invalid_type,expected:Q.boolean,received:a.parsedType}),xe}return pa(e.data)}};Ld.create=t=>new Ld({typeName:ge.ZodBoolean,coerce:(t==null?void 0:t.coerce)||!1,...Ee(t)});var Ed=class Kk extends Ne{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==Q.date){let n=this._getOrReturnCtx(e);return j(n,{code:P.invalid_type,expected:Q.date,received:n.parsedType}),xe}if(isNaN(e.data.getTime())){let n=this._getOrReturnCtx(e);return j(n,{code:P.invalid_date}),xe}let a=new Ea,s;for(let n of this._def.checks)n.kind==="min"?e.data.getTime()<n.value&&(s=this._getOrReturnCtx(e,s),j(s,{code:P.too_small,message:n.message,inclusive:!0,exact:!1,minimum:n.value,type:"date"}),a.dirty()):n.kind==="max"?e.data.getTime()>n.value&&(s=this._getOrReturnCtx(e,s),j(s,{code:P.too_big,message:n.message,inclusive:!0,exact:!1,maximum:n.value,type:"date"}),a.dirty()):Ue.assertNever(n);return{status:a.value,value:new Date(e.data.getTime())}}_addCheck(e){return new Kk({...this._def,checks:[...this._def.checks,e]})}min(e,a){return this._addCheck({kind:"min",value:e.getTime(),message:ie.toString(a)})}max(e,a){return this._addCheck({kind:"max",value:e.getTime(),message:ie.toString(a)})}get minDate(){let e=null;for(let a of this._def.checks)a.kind==="min"&&(e===null||a.value>e)&&(e=a.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(let a of this._def.checks)a.kind==="max"&&(e===null||a.value<e)&&(e=a.value);return e!=null?new Date(e):null}};Ed.create=t=>new Ed({checks:[],coerce:(t==null?void 0:t.coerce)||!1,typeName:ge.ZodDate,...Ee(t)});var vf=class extends Ne{_parse(e){if(this._getType(e)!==Q.symbol){let a=this._getOrReturnCtx(e);return j(a,{code:P.invalid_type,expected:Q.symbol,received:a.parsedType}),xe}return pa(e.data)}};vf.create=t=>new vf({typeName:ge.ZodSymbol,...Ee(t)});var Id=class extends Ne{_parse(e){if(this._getType(e)!==Q.undefined){let a=this._getOrReturnCtx(e);return j(a,{code:P.invalid_type,expected:Q.undefined,received:a.parsedType}),xe}return pa(e.data)}};Id.create=t=>new Id({typeName:ge.ZodUndefined,...Ee(t)});var Od=class extends Ne{_parse(e){if(this._getType(e)!==Q.null){let a=this._getOrReturnCtx(e);return j(a,{code:P.invalid_type,expected:Q.null,received:a.parsedType}),xe}return pa(e.data)}};Od.create=t=>new Od({typeName:ge.ZodNull,...Ee(t)});var xo=class extends Ne{constructor(){super(...arguments),this._any=!0}_parse(e){return pa(e.data)}};xo.create=t=>new xo({typeName:ge.ZodAny,...Ee(t)});var Ji=class extends Ne{constructor(){super(...arguments),this._unknown=!0}_parse(e){return pa(e.data)}};Ji.create=t=>new Ji({typeName:ge.ZodUnknown,...Ee(t)});var kn=class extends Ne{_parse(e){let a=this._getOrReturnCtx(e);return j(a,{code:P.invalid_type,expected:Q.never,received:a.parsedType}),xe}};kn.create=t=>new kn({typeName:ge.ZodNever,...Ee(t)});var bf=class extends Ne{_parse(e){if(this._getType(e)!==Q.undefined){let a=this._getOrReturnCtx(e);return j(a,{code:P.invalid_type,expected:Q.void,received:a.parsedType}),xe}return pa(e.data)}};bf.create=t=>new bf({typeName:ge.ZodVoid,...Ee(t)});var gr=class Dp extends Ne{_parse(e){let{ctx:a,status:s}=this._processInputParams(e),n=this._def;if(a.parsedType!==Q.array)return j(a,{code:P.invalid_type,expected:Q.array,received:a.parsedType}),xe;if(n.exactLength!==null){let o=a.data.length>n.exactLength.value,l=a.data.length<n.exactLength.value;(o||l)&&(j(a,{code:o?P.too_big:P.too_small,minimum:l?n.exactLength.value:void 0,maximum:o?n.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:n.exactLength.message}),s.dirty())}if(n.minLength!==null&&a.data.length<n.minLength.value&&(j(a,{code:P.too_small,minimum:n.minLength.value,type:"array",inclusive:!0,exact:!1,message:n.minLength.message}),s.dirty()),n.maxLength!==null&&a.data.length>n.maxLength.value&&(j(a,{code:P.too_big,maximum:n.maxLength.value,type:"array",inclusive:!0,exact:!1,message:n.maxLength.message}),s.dirty()),a.common.async)return Promise.all([...a.data].map((o,l)=>n.type._parseAsync(new Ys(a,o,a.path,l)))).then(o=>Ea.mergeArray(s,o));let r=[...a.data].map((o,l)=>n.type._parseSync(new Ys(a,o,a.path,l)));return Ea.mergeArray(s,r)}get element(){return this._def.type}min(e,a){return new Dp({...this._def,minLength:{value:e,message:ie.toString(a)}})}max(e,a){return new Dp({...this._def,maxLength:{value:e,message:ie.toString(a)}})}length(e,a){return new Dp({...this._def,exactLength:{value:e,message:ie.toString(a)}})}nonempty(e){return this.min(1,e)}};gr.create=(t,e)=>new gr({type:t,minLength:null,maxLength:null,exactLength:null,typeName:ge.ZodArray,...Ee(e)});function Kr(t){if(t instanceof ts){let e={};for(let a in t.shape){let s=t.shape[a];e[a]=Ks.create(Kr(s))}return new ts({...t._def,shape:()=>e})}else return t instanceof gr?new gr({...t._def,type:Kr(t.element)}):t instanceof Ks?Ks.create(Kr(t.unwrap())):t instanceof vi?vi.create(Kr(t.unwrap())):t instanceof yi?yi.create(t.items.map(e=>Kr(e))):t}var ts=class cs extends Ne{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;let e=this._def.shape(),a=Ue.objectKeys(e);return this._cached={shape:e,keys:a}}_parse(e){if(this._getType(e)!==Q.object){let u=this._getOrReturnCtx(e);return j(u,{code:P.invalid_type,expected:Q.object,received:u.parsedType}),xe}let{status:a,ctx:s}=this._processInputParams(e),{shape:n,keys:r}=this._getCached(),o=[];if(!(this._def.catchall instanceof kn&&this._def.unknownKeys==="strip"))for(let u in s.data)r.includes(u)||o.push(u);let l=[];for(let u of r){let c=n[u],p=s.data[u];l.push({key:{status:"valid",value:u},value:c._parse(new Ys(s,p,s.path,u)),alwaysSet:u in s.data})}if(this._def.catchall instanceof kn){let u=this._def.unknownKeys;if(u==="passthrough")for(let c of o)l.push({key:{status:"valid",value:c},value:{status:"valid",value:s.data[c]}});else if(u==="strict")o.length>0&&(j(s,{code:P.unrecognized_keys,keys:o}),a.dirty());else if(u!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{let u=this._def.catchall;for(let c of o){let p=s.data[c];l.push({key:{status:"valid",value:c},value:u._parse(new Ys(s,p,s.path,c)),alwaysSet:c in s.data})}}return s.common.async?Promise.resolve().then(async()=>{let u=[];for(let c of l){let p=await c.key,f=await c.value;u.push({key:p,value:f,alwaysSet:c.alwaysSet})}return u}).then(u=>Ea.mergeObjectSync(a,u)):Ea.mergeObjectSync(a,l)}get shape(){return this._def.shape()}strict(e){return ie.errToObj,new cs({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(a,s)=>{var n,r,o,l;let u=(o=(r=(n=this._def).errorMap)===null||r===void 0?void 0:r.call(n,a,s).message)!==null&&o!==void 0?o:s.defaultError;return a.code==="unrecognized_keys"?{message:(l=ie.errToObj(e).message)!==null&&l!==void 0?l:u}:{message:u}}}:{}})}strip(){return new cs({...this._def,unknownKeys:"strip"})}passthrough(){return new cs({...this._def,unknownKeys:"passthrough"})}extend(e){return new cs({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new cs({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:ge.ZodObject})}setKey(e,a){return this.augment({[e]:a})}catchall(e){return new cs({...this._def,catchall:e})}pick(e){let a={};return Ue.objectKeys(e).forEach(s=>{e[s]&&this.shape[s]&&(a[s]=this.shape[s])}),new cs({...this._def,shape:()=>a})}omit(e){let a={};return Ue.objectKeys(this.shape).forEach(s=>{e[s]||(a[s]=this.shape[s])}),new cs({...this._def,shape:()=>a})}deepPartial(){return Kr(this)}partial(e){let a={};return Ue.objectKeys(this.shape).forEach(s=>{let n=this.shape[s];e&&!e[s]?a[s]=n:a[s]=n.optional()}),new cs({...this._def,shape:()=>a})}required(e){let a={};return Ue.objectKeys(this.shape).forEach(s=>{if(e&&!e[s])a[s]=this.shape[s];else{let n=this.shape[s];for(;n instanceof Ks;)n=n._def.innerType;a[s]=n}}),new cs({...this._def,shape:()=>a})}keyof(){return Jk(Ue.objectKeys(this.shape))}};ts.create=(t,e)=>new ts({shape:()=>t,unknownKeys:"strip",catchall:kn.create(),typeName:ge.ZodObject,...Ee(e)});ts.strictCreate=(t,e)=>new ts({shape:()=>t,unknownKeys:"strict",catchall:kn.create(),typeName:ge.ZodObject,...Ee(e)});ts.lazycreate=(t,e)=>new ts({shape:t,unknownKeys:"strip",catchall:kn.create(),typeName:ge.ZodObject,...Ee(e)});var Pd=class extends Ne{_parse(e){let{ctx:a}=this._processInputParams(e),s=this._def.options;function n(r){for(let l of r)if(l.result.status==="valid")return l.result;for(let l of r)if(l.result.status==="dirty")return a.common.issues.push(...l.ctx.common.issues),l.result;let o=r.map(l=>new ws(l.ctx.common.issues));return j(a,{code:P.invalid_union,unionErrors:o}),xe}if(a.common.async)return Promise.all(s.map(async r=>{let o={...a,common:{...a.common,issues:[]},parent:null};return{result:await r._parseAsync({data:a.data,path:a.path,parent:o}),ctx:o}})).then(n);{let r,o=[];for(let u of s){let c={...a,common:{...a.common,issues:[]},parent:null},p=u._parseSync({data:a.data,path:a.path,parent:c});if(p.status==="valid")return p;p.status==="dirty"&&!r&&(r={result:p,ctx:c}),c.common.issues.length&&o.push(c.common.issues)}if(r)return a.common.issues.push(...r.ctx.common.issues),r.result;let l=o.map(u=>new ws(u));return j(a,{code:P.invalid_union,unionErrors:l}),xe}}get options(){return this._def.options}};Pd.create=(t,e)=>new Pd({options:t,typeName:ge.ZodUnion,...Ee(e)});var jn=t=>t instanceof Dd?jn(t.schema):t instanceof $s?jn(t.innerType()):t instanceof Nd?[t.value]:t instanceof xc?t.options:t instanceof Wd?Ue.objectValues(t.enum):t instanceof Bd?jn(t._def.innerType):t instanceof Id?[void 0]:t instanceof Od?[null]:t instanceof Ks?[void 0,...jn(t.unwrap())]:t instanceof vi?[null,...jn(t.unwrap())]:t instanceof gv||t instanceof qd?jn(t.unwrap()):t instanceof Zd?jn(t._def.innerType):[],Vk=class Uk extends Ne{_parse(e){let{ctx:a}=this._processInputParams(e);if(a.parsedType!==Q.object)return j(a,{code:P.invalid_type,expected:Q.object,received:a.parsedType}),xe;let s=this.discriminator,n=a.data[s],r=this.optionsMap.get(n);return r?a.common.async?r._parseAsync({data:a.data,path:a.path,parent:a}):r._parseSync({data:a.data,path:a.path,parent:a}):(j(a,{code:P.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[s]}),xe)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,a,s){let n=new Map;for(let r of a){let o=jn(r.shape[e]);if(!o.length)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(let l of o){if(n.has(l))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(l)}`);n.set(l,r)}}return new Uk({typeName:ge.ZodDiscriminatedUnion,discriminator:e,options:a,optionsMap:n,...Ee(s)})}};function Og(t,e){let a=Yn(t),s=Yn(e);if(t===e)return{valid:!0,data:t};if(a===Q.object&&s===Q.object){let n=Ue.objectKeys(e),r=Ue.objectKeys(t).filter(l=>n.indexOf(l)!==-1),o={...t,...e};for(let l of r){let u=Og(t[l],e[l]);if(!u.valid)return{valid:!1};o[l]=u.data}return{valid:!0,data:o}}else if(a===Q.array&&s===Q.array){if(t.length!==e.length)return{valid:!1};let n=[];for(let r=0;r<t.length;r++){let o=t[r],l=e[r],u=Og(o,l);if(!u.valid)return{valid:!1};n.push(u.data)}return{valid:!0,data:n}}else return a===Q.date&&s===Q.date&&+t==+e?{valid:!0,data:t}:{valid:!1}}var Rd=class extends Ne{_parse(e){let{status:a,ctx:s}=this._processInputParams(e),n=(r,o)=>{if(Mg(r)||Mg(o))return xe;let l=Og(r.value,o.value);return l.valid?((Lg(r)||Lg(o))&&a.dirty(),{status:a.value,value:l.data}):(j(s,{code:P.invalid_intersection_types}),xe)};return s.common.async?Promise.all([this._def.left._parseAsync({data:s.data,path:s.path,parent:s}),this._def.right._parseAsync({data:s.data,path:s.path,parent:s})]).then(([r,o])=>n(r,o)):n(this._def.left._parseSync({data:s.data,path:s.path,parent:s}),this._def.right._parseSync({data:s.data,path:s.path,parent:s}))}};Rd.create=(t,e,a)=>new Rd({left:t,right:e,typeName:ge.ZodIntersection,...Ee(a)});var yi=class Gk extends Ne{_parse(e){let{status:a,ctx:s}=this._processInputParams(e);if(s.parsedType!==Q.array)return j(s,{code:P.invalid_type,expected:Q.array,received:s.parsedType}),xe;if(s.data.length<this._def.items.length)return j(s,{code:P.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),xe;!this._def.rest&&s.data.length>this._def.items.length&&(j(s,{code:P.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),a.dirty());let n=[...s.data].map((r,o)=>{let l=this._def.items[o]||this._def.rest;return l?l._parse(new Ys(s,r,s.path,o)):null}).filter(r=>!!r);return s.common.async?Promise.all(n).then(r=>Ea.mergeArray(a,r)):Ea.mergeArray(a,n)}get items(){return this._def.items}rest(e){return new Gk({...this._def,rest:e})}};yi.create=(t,e)=>{if(!Array.isArray(t))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new yi({items:t,typeName:ge.ZodTuple,rest:null,...Ee(e)})};var Qk=class Pg extends Ne{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:a,ctx:s}=this._processInputParams(e);if(s.parsedType!==Q.object)return j(s,{code:P.invalid_type,expected:Q.object,received:s.parsedType}),xe;let n=[],r=this._def.keyType,o=this._def.valueType;for(let l in s.data)n.push({key:r._parse(new Ys(s,l,s.path,l)),value:o._parse(new Ys(s,s.data[l],s.path,l)),alwaysSet:l in s.data});return s.common.async?Ea.mergeObjectAsync(a,n):Ea.mergeObjectSync(a,n)}get element(){return this._def.valueType}static create(e,a,s){return a instanceof Ne?new Pg({keyType:e,valueType:a,typeName:ge.ZodRecord,...Ee(s)}):new Pg({keyType:ko.create(),valueType:e,typeName:ge.ZodRecord,...Ee(a)})}},wf=class extends Ne{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:a,ctx:s}=this._processInputParams(e);if(s.parsedType!==Q.map)return j(s,{code:P.invalid_type,expected:Q.map,received:s.parsedType}),xe;let n=this._def.keyType,r=this._def.valueType,o=[...s.data.entries()].map(([l,u],c)=>({key:n._parse(new Ys(s,l,s.path,[c,"key"])),value:r._parse(new Ys(s,u,s.path,[c,"value"]))}));if(s.common.async){let l=new Map;return Promise.resolve().then(async()=>{for(let u of o){let c=await u.key,p=await u.value;if(c.status==="aborted"||p.status==="aborted")return xe;(c.status==="dirty"||p.status==="dirty")&&a.dirty(),l.set(c.value,p.value)}return{status:a.value,value:l}})}else{let l=new Map;for(let u of o){let c=u.key,p=u.value;if(c.status==="aborted"||p.status==="aborted")return xe;(c.status==="dirty"||p.status==="dirty")&&a.dirty(),l.set(c.value,p.value)}return{status:a.value,value:l}}}};wf.create=(t,e,a)=>new wf({valueType:e,keyType:t,typeName:ge.ZodMap,...Ee(a)});var kf=class Rg extends Ne{_parse(e){let{status:a,ctx:s}=this._processInputParams(e);if(s.parsedType!==Q.set)return j(s,{code:P.invalid_type,expected:Q.set,received:s.parsedType}),xe;let n=this._def;n.minSize!==null&&s.data.size<n.minSize.value&&(j(s,{code:P.too_small,minimum:n.minSize.value,type:"set",inclusive:!0,exact:!1,message:n.minSize.message}),a.dirty()),n.maxSize!==null&&s.data.size>n.maxSize.value&&(j(s,{code:P.too_big,maximum:n.maxSize.value,type:"set",inclusive:!0,exact:!1,message:n.maxSize.message}),a.dirty());let r=this._def.valueType;function o(u){let c=new Set;for(let p of u){if(p.status==="aborted")return xe;p.status==="dirty"&&a.dirty(),c.add(p.value)}return{status:a.value,value:c}}let l=[...s.data.values()].map((u,c)=>r._parse(new Ys(s,u,s.path,c)));return s.common.async?Promise.all(l).then(u=>o(u)):o(l)}min(e,a){return new Rg({...this._def,minSize:{value:e,message:ie.toString(a)}})}max(e,a){return new Rg({...this._def,maxSize:{value:e,message:ie.toString(a)}})}size(e,a){return this.min(e,a).max(e,a)}nonempty(e){return this.min(1,e)}};kf.create=(t,e)=>new kf({valueType:t,minSize:null,maxSize:null,typeName:ge.ZodSet,...Ee(e)});var Yk=class Np extends Ne{constructor(){super(...arguments),this.validate=this.implement}_parse(e){let{ctx:a}=this._processInputParams(e);if(a.parsedType!==Q.function)return j(a,{code:P.invalid_type,expected:Q.function,received:a.parsedType}),xe;function s(l,u){return hf({data:l,path:a.path,errorMaps:[a.common.contextualErrorMap,a.schemaErrorMap,mf(),wo].filter(c=>!!c),issueData:{code:P.invalid_arguments,argumentsError:u}})}function n(l,u){return hf({data:l,path:a.path,errorMaps:[a.common.contextualErrorMap,a.schemaErrorMap,mf(),wo].filter(c=>!!c),issueData:{code:P.invalid_return_type,returnTypeError:u}})}let r={errorMap:a.common.contextualErrorMap},o=a.data;if(this._def.returns instanceof _o){let l=this;return pa(async function(...u){let c=new ws([]),p=await l._def.args.parseAsync(u,r).catch(m=>{throw c.addIssue(s(u,m)),c}),f=await Reflect.apply(o,this,p);return await l._def.returns._def.type.parseAsync(f,r).catch(m=>{throw c.addIssue(n(f,m)),c})})}else{let l=this;return pa(function(...u){let c=l._def.args.safeParse(u,r);if(!c.success)throw new ws([s(u,c.error)]);let p=Reflect.apply(o,this,c.data),f=l._def.returns.safeParse(p,r);if(!f.success)throw new ws([n(p,f.error)]);return f.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new Np({...this._def,args:yi.create(e).rest(Ji.create())})}returns(e){return new Np({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,a,s){return new Np({args:e||yi.create([]).rest(Ji.create()),returns:a||Ji.create(),typeName:ge.ZodFunction,...Ee(s)})}},Dd=class extends Ne{get schema(){return this._def.getter()}_parse(e){let{ctx:a}=this._processInputParams(e);return this._def.getter()._parse({data:a.data,path:a.path,parent:a})}};Dd.create=(t,e)=>new Dd({getter:t,typeName:ge.ZodLazy,...Ee(e)});var Nd=class extends Ne{_parse(e){if(e.data!==this._def.value){let a=this._getOrReturnCtx(e);return j(a,{received:a.data,code:P.invalid_literal,expected:this._def.value}),xe}return{status:"valid",value:e.data}}get value(){return this._def.value}};Nd.create=(t,e)=>new Nd({value:t,typeName:ge.ZodLiteral,...Ee(e)});function Jk(t,e){return new xc({values:t,typeName:ge.ZodEnum,...Ee(e)})}var xc=class Dg extends Ne{constructor(){super(...arguments),Sl.set(this,void 0)}_parse(e){if(typeof e.data!="string"){let a=this._getOrReturnCtx(e),s=this._def.values;return j(a,{expected:Ue.joinValues(s),received:a.parsedType,code:P.invalid_type}),xe}if(yf(this,Sl)||Fk(this,Sl,new Set(this._def.values)),!yf(this,Sl).has(e.data)){let a=this._getOrReturnCtx(e),s=this._def.values;return j(a,{received:a.data,code:P.invalid_enum_value,options:s}),xe}return pa(e.data)}get options(){return this._def.values}get enum(){let e={};for(let a of this._def.values)e[a]=a;return e}get Values(){let e={};for(let a of this._def.values)e[a]=a;return e}get Enum(){let e={};for(let a of this._def.values)e[a]=a;return e}extract(e,a=this._def){return Dg.create(e,{...this._def,...a})}exclude(e,a=this._def){return Dg.create(this.options.filter(s=>!e.includes(s)),{...this._def,...a})}};Sl=new WeakMap;xc.create=Jk;var Wd=class extends Ne{constructor(){super(...arguments),Tl.set(this,void 0)}_parse(e){let a=Ue.getValidEnumValues(this._def.values),s=this._getOrReturnCtx(e);if(s.parsedType!==Q.string&&s.parsedType!==Q.number){let n=Ue.objectValues(a);return j(s,{expected:Ue.joinValues(n),received:s.parsedType,code:P.invalid_type}),xe}if(yf(this,Tl)||Fk(this,Tl,new Set(Ue.getValidEnumValues(this._def.values))),!yf(this,Tl).has(e.data)){let n=Ue.objectValues(a);return j(s,{received:s.data,code:P.invalid_enum_value,options:n}),xe}return pa(e.data)}get enum(){return this._def.values}};Tl=new WeakMap;Wd.create=(t,e)=>new Wd({values:t,typeName:ge.ZodNativeEnum,...Ee(e)});var _o=class extends Ne{unwrap(){return this._def.type}_parse(e){let{ctx:a}=this._processInputParams(e);if(a.parsedType!==Q.promise&&a.common.async===!1)return j(a,{code:P.invalid_type,expected:Q.promise,received:a.parsedType}),xe;let s=a.parsedType===Q.promise?a.data:Promise.resolve(a.data);return pa(s.then(n=>this._def.type.parseAsync(n,{path:a.path,errorMap:a.common.contextualErrorMap})))}};_o.create=(t,e)=>new _o({type:t,typeName:ge.ZodPromise,...Ee(e)});var $s=class extends Ne{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===ge.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){let{status:a,ctx:s}=this._processInputParams(e),n=this._def.effect||null,r={addIssue:o=>{j(s,o),o.fatal?a.abort():a.dirty()},get path(){return s.path}};if(r.addIssue=r.addIssue.bind(r),n.type==="preprocess"){let o=n.transform(s.data,r);if(s.common.async)return Promise.resolve(o).then(async l=>{if(a.value==="aborted")return xe;let u=await this._def.schema._parseAsync({data:l,path:s.path,parent:s});return u.status==="aborted"?xe:u.status==="dirty"||a.value==="dirty"?gf(u.value):u});{if(a.value==="aborted")return xe;let l=this._def.schema._parseSync({data:o,path:s.path,parent:s});return l.status==="aborted"?xe:l.status==="dirty"||a.value==="dirty"?gf(l.value):l}}if(n.type==="refinement"){let o=l=>{let u=n.refinement(l,r);if(s.common.async)return Promise.resolve(u);if(u instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return l};if(s.common.async===!1){let l=this._def.schema._parseSync({data:s.data,path:s.path,parent:s});return l.status==="aborted"?xe:(l.status==="dirty"&&a.dirty(),o(l.value),{status:a.value,value:l.value})}else return this._def.schema._parseAsync({data:s.data,path:s.path,parent:s}).then(l=>l.status==="aborted"?xe:(l.status==="dirty"&&a.dirty(),o(l.value).then(()=>({status:a.value,value:l.value}))))}if(n.type==="transform")if(s.common.async===!1){let o=this._def.schema._parseSync({data:s.data,path:s.path,parent:s});if(!Td(o))return o;let l=n.transform(o.value,r);if(l instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:a.value,value:l}}else return this._def.schema._parseAsync({data:s.data,path:s.path,parent:s}).then(o=>Td(o)?Promise.resolve(n.transform(o.value,r)).then(l=>({status:a.value,value:l})):o);Ue.assertNever(n)}};$s.create=(t,e,a)=>new $s({schema:t,typeName:ge.ZodEffects,effect:e,...Ee(a)});$s.createWithPreprocess=(t,e,a)=>new $s({schema:e,effect:{type:"preprocess",transform:t},typeName:ge.ZodEffects,...Ee(a)});var Ks=class extends Ne{_parse(e){return this._getType(e)===Q.undefined?pa(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}};Ks.create=(t,e)=>new Ks({innerType:t,typeName:ge.ZodOptional,...Ee(e)});var vi=class extends Ne{_parse(e){return this._getType(e)===Q.null?pa(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}};vi.create=(t,e)=>new vi({innerType:t,typeName:ge.ZodNullable,...Ee(e)});var Bd=class extends Ne{_parse(e){let{ctx:a}=this._processInputParams(e),s=a.data;return a.parsedType===Q.undefined&&(s=this._def.defaultValue()),this._def.innerType._parse({data:s,path:a.path,parent:a})}removeDefault(){return this._def.innerType}};Bd.create=(t,e)=>new Bd({innerType:t,typeName:ge.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...Ee(e)});var Zd=class extends Ne{_parse(e){let{ctx:a}=this._processInputParams(e),s={...a,common:{...a.common,issues:[]}},n=this._def.innerType._parse({data:s.data,path:s.path,parent:{...s}});return $d(n)?n.then(r=>({status:"valid",value:r.status==="valid"?r.value:this._def.catchValue({get error(){return new ws(s.common.issues)},input:s.data})})):{status:"valid",value:n.status==="valid"?n.value:this._def.catchValue({get error(){return new ws(s.common.issues)},input:s.data})}}removeCatch(){return this._def.innerType}};Zd.create=(t,e)=>new Zd({innerType:t,typeName:ge.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...Ee(e)});var xf=class extends Ne{_parse(e){if(this._getType(e)!==Q.nan){let a=this._getOrReturnCtx(e);return j(a,{code:P.invalid_type,expected:Q.nan,received:a.parsedType}),xe}return{status:"valid",value:e.data}}};xf.create=t=>new xf({typeName:ge.ZodNaN,...Ee(t)});var $I=Symbol("zod_brand"),gv=class extends Ne{_parse(e){let{ctx:a}=this._processInputParams(e),s=a.data;return this._def.type._parse({data:s,path:a.path,parent:a})}unwrap(){return this._def.type}},yv=class Xk extends Ne{_parse(e){let{status:a,ctx:s}=this._processInputParams(e);if(s.common.async)return(async()=>{let n=await this._def.in._parseAsync({data:s.data,path:s.path,parent:s});return n.status==="aborted"?xe:n.status==="dirty"?(a.dirty(),gf(n.value)):this._def.out._parseAsync({data:n.value,path:s.path,parent:s})})();{let n=this._def.in._parseSync({data:s.data,path:s.path,parent:s});return n.status==="aborted"?xe:n.status==="dirty"?(a.dirty(),{status:"dirty",value:n.value}):this._def.out._parseSync({data:n.value,path:s.path,parent:s})}}static create(e,a){return new Xk({in:e,out:a,typeName:ge.ZodPipeline})}},qd=class extends Ne{_parse(e){let a=this._def.innerType._parse(e),s=n=>(Td(n)&&(n.value=Object.freeze(n.value)),n);return $d(a)?a.then(n=>s(n)):s(a)}unwrap(){return this._def.innerType}};qd.create=(t,e)=>new qd({innerType:t,typeName:ge.ZodReadonly,...Ee(e)});function ex(t,e={},a){return t?xo.create().superRefine((s,n)=>{var r,o;if(!t(s)){let l=typeof e=="function"?e(s):typeof e=="string"?{message:e}:e,u=(o=(r=l.fatal)!==null&&r!==void 0?r:a)!==null&&o!==void 0?o:!0,c=typeof l=="string"?{message:l}:l;n.addIssue({code:"custom",...c,fatal:u})}}):xo.create()}var AI={object:ts.lazycreate},ge;(function(t){t.ZodString="ZodString",t.ZodNumber="ZodNumber",t.ZodNaN="ZodNaN",t.ZodBigInt="ZodBigInt",t.ZodBoolean="ZodBoolean",t.ZodDate="ZodDate",t.ZodSymbol="ZodSymbol",t.ZodUndefined="ZodUndefined",t.ZodNull="ZodNull",t.ZodAny="ZodAny",t.ZodUnknown="ZodUnknown",t.ZodNever="ZodNever",t.ZodVoid="ZodVoid",t.ZodArray="ZodArray",t.ZodObject="ZodObject",t.ZodUnion="ZodUnion",t.ZodDiscriminatedUnion="ZodDiscriminatedUnion",t.ZodIntersection="ZodIntersection",t.ZodTuple="ZodTuple",t.ZodRecord="ZodRecord",t.ZodMap="ZodMap",t.ZodSet="ZodSet",t.ZodFunction="ZodFunction",t.ZodLazy="ZodLazy",t.ZodLiteral="ZodLiteral",t.ZodEnum="ZodEnum",t.ZodEffects="ZodEffects",t.ZodNativeEnum="ZodNativeEnum",t.ZodOptional="ZodOptional",t.ZodNullable="ZodNullable",t.ZodDefault="ZodDefault",t.ZodCatch="ZodCatch",t.ZodPromise="ZodPromise",t.ZodBranded="ZodBranded",t.ZodPipeline="ZodPipeline",t.ZodReadonly="ZodReadonly"})(ge||(ge={}));var MI=(t,e={message:`Input not instance of ${t.name}`})=>ex(a=>a instanceof t,e),tx=ko.create,ax=Ad.create,LI=xf.create,EI=Md.create,sx=Ld.create,II=Ed.create,OI=vf.create,PI=Id.create,RI=Od.create,DI=xo.create,NI=Ji.create,WI=kn.create,BI=bf.create,ZI=gr.create,qI=ts.create,FI=ts.strictCreate,jI=Pd.create,HI=Vk.create,zI=Rd.create,KI=yi.create,VI=Qk.create,UI=wf.create,GI=kf.create,QI=Yk.create,YI=Dd.create,JI=Nd.create,XI=xc.create,e2=Wd.create,t2=_o.create,ww=$s.create,a2=Ks.create,s2=vi.create,n2=$s.createWithPreprocess,i2=yv.create,r2=()=>tx().optional(),o2=()=>ax().optional(),l2=()=>sx().optional(),d2={string:t=>ko.create({...t,coerce:!0}),number:t=>Ad.create({...t,coerce:!0}),boolean:t=>Ld.create({...t,coerce:!0}),bigint:t=>Md.create({...t,coerce:!0}),date:t=>Ed.create({...t,coerce:!0})},u2=xe,k=Object.freeze({__proto__:null,defaultErrorMap:wo,setErrorMap:uI,getErrorMap:mf,makeIssue:hf,EMPTY_PATH:cI,addIssueToContext:j,ParseStatus:Ea,INVALID:xe,DIRTY:gf,OK:pa,isAborted:Mg,isDirty:Lg,isValid:Td,isAsync:$d,get util(){return Ue},get objectUtil(){return Ag},ZodParsedType:Q,getParsedType:Yn,ZodType:Ne,datetimeRegex:zk,ZodString:ko,ZodNumber:Ad,ZodBigInt:Md,ZodBoolean:Ld,ZodDate:Ed,ZodSymbol:vf,ZodUndefined:Id,ZodNull:Od,ZodAny:xo,ZodUnknown:Ji,ZodNever:kn,ZodVoid:bf,ZodArray:gr,ZodObject:ts,ZodUnion:Pd,ZodDiscriminatedUnion:Vk,ZodIntersection:Rd,ZodTuple:yi,ZodRecord:Qk,ZodMap:wf,ZodSet:kf,ZodFunction:Yk,ZodLazy:Dd,ZodLiteral:Nd,ZodEnum:xc,ZodNativeEnum:Wd,ZodPromise:_o,ZodEffects:$s,ZodTransformer:$s,ZodOptional:Ks,ZodNullable:vi,ZodDefault:Bd,ZodCatch:Zd,ZodNaN:xf,BRAND:$I,ZodBranded:gv,ZodPipeline:yv,ZodReadonly:qd,custom:ex,Schema:Ne,ZodSchema:Ne,late:AI,get ZodFirstPartyTypeKind(){return ge},coerce:d2,any:DI,array:ZI,bigint:EI,boolean:sx,date:II,discriminatedUnion:HI,effect:ww,enum:XI,function:QI,instanceof:MI,intersection:zI,lazy:YI,literal:JI,map:UI,nan:LI,nativeEnum:e2,never:WI,null:RI,nullable:s2,number:ax,object:qI,oboolean:l2,onumber:o2,optional:a2,ostring:r2,pipeline:i2,preprocess:n2,promise:t2,record:VI,set:GI,strictObject:FI,string:tx,symbol:OI,transformer:ww,tuple:KI,undefined:PI,union:jI,unknown:NI,void:BI,NEVER:u2,ZodIssueCode:P,quotelessJson:dI,ZodError:ws}),Fd=k.object({message:k.string()}),c2=Fd.extend({validationErrors:k.array(k.string()).nonempty()}),Al=Fd,p2=Al.extend({errorId:k.string(),uid:k.string().optional()});function nx(t){return Fd.extend({data:t})}var f2={400:Al.describe("Generic client error"),401:Al.describe("Authentication required but not provided or invalid"),403:Al.describe("Operation not permitted"),422:c2.describe("Request validation failed"),429:Al.describe("Rate limit exceeded"),500:p2.describe("Generic server error")},Dh=k.custom(t=>typeof t=="string"?/^\d+$/.test(t):!1),_c=()=>k.string().regex(/^[a-zA-Z0-9_]+$/),vv=_c(),m2=_c().max(50),ix=k.enum(["normal","expert","master"]),pl=k.object({acc:k.number().nonnegative().max(100),consistency:k.number().nonnegative().max(100),difficulty:ix,lazyMode:k.boolean().optional(),language:k.string().max(100).regex(/[\w+]+/),punctuation:k.boolean().optional(),numbers:k.boolean().optional(),raw:k.number().nonnegative(),wpm:k.number().nonnegative(),timestamp:k.number().nonnegative()}),h2=k.object({time:k.record(Dh,k.array(pl)),words:k.record(Dh,k.array(pl)),quote:k.record(Dh,k.array(pl)),custom:k.record(k.literal("custom"),k.array(pl)),zen:k.record(k.literal("zen"),k.array(pl))}),g2=h2.keyof(),y2=k.enum(["off","slow","medium","fast"]),v2=k.enum(["off","esc","tab","enter"]),b2=k.union([k.literal(-3),k.literal(-2),k.literal(-1),k.literal(0),k.literal(1),k.literal(2),k.literal(3)]),w2=k.array(b2),kw=k.enum(["off","default","block","outline","underline","carrot","banana"]),k2=k.enum(["off","on","max"]),x2=k.enum(["off","below","replace"]),_2=k.enum(["off","bar","text","mini"]),Nh=k.enum(["off","text","mini"]),C2=k.enum(["off","on","fav","light","dark","custom"]),S2=k.enum(["black","sub","text","main"]),T2=k.enum(["0.25","0.5","0.75","1"]),$2=k.enum(["off","word","letter"]),A2=k.enum(["off","static","react","next"]),M2=k.enum(["staggered","alice","matrix","split","split_matrix","steno","steno_matrix"]),L2=k.enum(["lowercase","uppercase","blank","dynamic"]),E2=k.enum(["always","layout","never"]),I2=k.number().min(.5).max(3.5).step(.1),O2=k.enum(["manual","on"]),P2=k.enum(["off","1","2","3","4"]),R2=k.enum(["off","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15"]),D2=k.number().min(0).max(1),N2=k.enum(["off","average","pb","tagPb","last","custom","daily"]),W2=k.tuple([k.enum(["on","off"]),k.enum(["on","off"]),k.enum(["on","off"]),k.enum(["on","off"])]),B2=k.enum(["off","custom"]),Z2=k.enum(["off","letter","word","next_word","next_two_words","next_three_words"]),q2=k.enum(["off","letter","word"]),F2=k.enum(["wpm","cpm","wps","cps","wph"]),j2=k.enum(["off","result","on","sellout"]),H2=k.enum(["off","custom"]),z2=k.enum(["off","typing"]),K2=k.enum(["off","on","keymap"]),V2=k.enum(["cover","contain","max"]),U2=k.tuple([k.number(),k.number(),k.number(),k.number()]),G2=k.string().regex(/^[0-9a-zA-Z_#]+$/),Q2=k.enum(["off","1","2","3","4"]),Y2=k.enum(["off","fixed","flex"]),J2=k.enum(["off","speed","acc","both"]),Is=k.string().regex(/^#([\da-f]{3}){1,2}$/i),X2=ix,eO=k.tuple([Is,Is,Is,Is,Is,Is,Is,Is,Is,Is]),tO=k.array(_c().max(50)),aO=k.string().max(100).regex(/[\w#]+/),sO=k.number().nonnegative(),nO=k.number().nonnegative(),iO=k.number().nonnegative().max(100),rO=k.number().nonnegative(),oO=k.number().int().nonnegative(),lO=k.number().int().nonnegative(),dO=k.string().max(50).regex(/^[a-zA-Z0-9_\-+.]+$/),Wh=_c().max(50),uO=k.string().max(50).regex(/^[a-zA-Z0-9_+]+$/),cO=k.string().max(50).regex(/[\w\-_]+/),pO=_c().max(50),fO=k.number().positive(),mO=k.number().min(20).max(1e3).or(k.literal(0)),hO=k.string().regex(/(https|http):\/\/(www\.|).+\..+\/.+(\.png|\.gif|\.jpeg|\.jpg)/gi).or(k.literal("")),gO=k.object({theme:Wh,themeLight:Wh,themeDark:Wh,autoSwitchTheme:k.boolean(),customTheme:k.boolean(),customThemeColors:eO,favThemes:tO,showKeyTips:k.boolean(),smoothCaret:y2,quickRestart:v2,punctuation:k.boolean(),numbers:k.boolean(),words:lO,time:oO,mode:g2,quoteLength:w2,language:uO,fontSize:fO,freedomMode:k.boolean(),difficulty:X2,blindMode:k.boolean(),quickEnd:k.boolean(),caretStyle:kw,paceCaretStyle:kw,flipTestColors:k.boolean(),layout:pO,funbox:aO,confidenceMode:k2,indicateTypos:x2,timerStyle:_2,liveSpeedStyle:Nh,liveAccStyle:Nh,liveBurstStyle:Nh,colorfulMode:k.boolean(),randomTheme:C2,timerColor:S2,timerOpacity:T2,stopOnError:$2,showAllLines:k.boolean(),keymapMode:A2,keymapStyle:M2,keymapLegendStyle:L2,keymapLayout:cO,keymapShowTopRow:E2,keymapSize:I2,fontFamily:dO,smoothLineScroll:k.boolean(),alwaysShowDecimalPlaces:k.boolean(),alwaysShowWordsHistory:k.boolean(),singleListCommandLine:O2,capsLockWarning:k.boolean(),playSoundOnError:P2,playSoundOnClick:R2,soundVolume:D2,startGraphsAtZero:k.boolean(),showOutOfFocusWarning:k.boolean(),paceCaret:N2,paceCaretCustomSpeed:sO,repeatedPace:k.boolean(),accountChart:W2,minWpm:B2,minWpmCustomSpeed:nO,highlightMode:Z2,tapeMode:q2,typingSpeedUnit:F2,ads:j2,hideExtraLetters:k.boolean(),strictSpace:k.boolean(),minAcc:H2,minAccCustom:iO,monkey:k.boolean(),repeatQuotes:z2,oppositeShiftMode:K2,customBackground:hO,customBackgroundSize:V2,customBackgroundFilter:U2,customLayoutfluid:G2,monkeyPowerLevel:Q2,minBurst:Y2,minBurstCustomSpeed:rO,burstHeatmap:k.boolean(),britishEnglish:k.boolean(),lazyMode:k.boolean(),showAverage:J2,maxLineWidth:mO}).strict(),yO=gO.partial(),vO=k.string().regex(/^[0-9a-zA-Z_-]+$/).max(16),bv=k.object({_id:vv,name:vO,config:yO.extend({tags:k.array(m2).optional()})}),bO=nx(k.array(bv)),wO=bv.omit({_id:!0}),kO=nx(k.object({presetId:vv})),xO=k.object({presetId:vv}),xw=lI(),_O=xw.router({get:{summary:"get presets",description:"Get presets of the current user.",method:"GET",path:"/",responses:{200:bO}},add:{summary:"add preset",description:"Add a new preset for the current user.",method:"POST",path:"/",body:wO.strict(),responses:{200:kO}},save:{summary:"update preset",description:"Update an existing preset for the current user.",method:"PATCH",path:"/",body:bv.strict(),responses:{200:Fd}},delete:{method:"DELETE",path:"/:presetId",pathParams:xO,body:xw.noBody(),responses:{200:Fd},summary:"delete preset",description:"Delete preset by id."}},{pathPrefix:"/presets",strictStatusCodes:!0,metadata:{openApiTags:"presets"},commonResponses:f2}),Bh=t=>typeof(t==null?void 0:t.passthrough)=="function",CO=(t,e)=>Bh(t)?Bh(e)?t.merge(e):t:Bh(e)?e:Object.assign({},t,e),SO=Symbol("ContractNoBody"),TO=t=>"method"in t&&"path"in t,rx=(t,e)=>Object.fromEntries(Object.entries(t).map(([a,s])=>{var n,r,o;return TO(s)?[a,{...s,path:e!=null&&e.pathPrefix?e.pathPrefix+s.path:s.path,headers:CO(e==null?void 0:e.baseHeaders,s.headers),strictStatusCodes:(n=s.strictStatusCodes)!==null&&n!==void 0?n:e==null?void 0:e.strictStatusCodes,validateResponseOnClient:(r=s.validateResponseOnClient)!==null&&r!==void 0?r:e==null?void 0:e.validateResponseOnClient,responses:{...e==null?void 0:e.commonResponses,...s.responses},metadata:e!=null&&e.metadata?{...e==null?void 0:e.metadata,...(o=s.metadata)!==null&&o!==void 0?o:{}}:s.metadata}]:[a,rx(s,e)]})),Zh=Symbol("ContractPlainType"),$O=()=>({router:(t,e)=>rx(t,e),query:t=>t,mutation:t=>t,responses:t=>t,response:()=>Zh,body:()=>Zh,type:()=>Zh,otherResponse:({contentType:t,body:e})=>({contentType:t,body:e}),noBody:()=>SO}),Ge;(function(t){t.assertEqual=n=>n;function e(n){}t.assertIs=e;function a(n){throw new Error}t.assertNever=a,t.arrayToEnum=n=>{let r={};for(let o of n)r[o]=o;return r},t.getValidEnumValues=n=>{let r=t.objectKeys(n).filter(l=>typeof n[n[l]]!="number"),o={};for(let l of r)o[l]=n[l];return t.objectValues(o)},t.objectValues=n=>t.objectKeys(n).map(function(r){return n[r]}),t.objectKeys=typeof Object.keys=="function"?n=>Object.keys(n):n=>{let r=[];for(let o in n)Object.prototype.hasOwnProperty.call(n,o)&&r.push(o);return r},t.find=(n,r)=>{for(let o of n)if(r(o))return o},t.isInteger=typeof Number.isInteger=="function"?n=>Number.isInteger(n):n=>typeof n=="number"&&isFinite(n)&&Math.floor(n)===n;function s(n,r=" | "){return n.map(o=>typeof o=="string"?`'${o}'`:o).join(r)}t.joinValues=s,t.jsonStringifyReplacer=(n,r)=>typeof r=="bigint"?r.toString():r})(Ge||(Ge={}));var Ng;(function(t){t.mergeShapes=(e,a)=>({...e,...a})})(Ng||(Ng={}));var Y=Ge.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Jn=t=>{switch(typeof t){case"undefined":return Y.undefined;case"string":return Y.string;case"number":return isNaN(t)?Y.nan:Y.number;case"boolean":return Y.boolean;case"function":return Y.function;case"bigint":return Y.bigint;case"symbol":return Y.symbol;case"object":return Array.isArray(t)?Y.array:t===null?Y.null:t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?Y.promise:typeof Map<"u"&&t instanceof Map?Y.map:typeof Set<"u"&&t instanceof Set?Y.set:typeof Date<"u"&&t instanceof Date?Y.date:Y.object;default:return Y.unknown}},R=Ge.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),AO=t=>JSON.stringify(t,null,2).replace(/"([^"]+)":/g,"$1:"),ks=class ox extends Error{constructor(e){super(),this.issues=[],this.addIssue=s=>{this.issues=[...this.issues,s]},this.addIssues=(s=[])=>{this.issues=[...this.issues,...s]};let a=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,a):this.__proto__=a,this.name="ZodError",this.issues=e}get errors(){return this.issues}format(e){let a=e||function(r){return r.message},s={_errors:[]},n=r=>{for(let o of r.issues)if(o.code==="invalid_union")o.unionErrors.map(n);else if(o.code==="invalid_return_type")n(o.returnTypeError);else if(o.code==="invalid_arguments")n(o.argumentsError);else if(o.path.length===0)s._errors.push(a(o));else{let l=s,u=0;for(;u<o.path.length;){let c=o.path[u];u===o.path.length-1?(l[c]=l[c]||{_errors:[]},l[c]._errors.push(a(o))):l[c]=l[c]||{_errors:[]},l=l[c],u++}}};return n(this),s}static assert(e){if(!(e instanceof ox))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,Ge.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=a=>a.message){let a={},s=[];for(let n of this.issues)n.path.length>0?(a[n.path[0]]=a[n.path[0]]||[],a[n.path[0]].push(e(n))):s.push(e(n));return{formErrors:s,fieldErrors:a}}get formErrors(){return this.flatten()}};ks.create=t=>new ks(t);var Co=(t,e)=>{let a;switch(t.code){case R.invalid_type:t.received===Y.undefined?a="Required":a=`Expected ${t.expected}, received ${t.received}`;break;case R.invalid_literal:a=`Invalid literal value, expected ${JSON.stringify(t.expected,Ge.jsonStringifyReplacer)}`;break;case R.unrecognized_keys:a=`Unrecognized key(s) in object: ${Ge.joinValues(t.keys,", ")}`;break;case R.invalid_union:a="Invalid input";break;case R.invalid_union_discriminator:a=`Invalid discriminator value. Expected ${Ge.joinValues(t.options)}`;break;case R.invalid_enum_value:a=`Invalid enum value. Expected ${Ge.joinValues(t.options)}, received '${t.received}'`;break;case R.invalid_arguments:a="Invalid function arguments";break;case R.invalid_return_type:a="Invalid function return type";break;case R.invalid_date:a="Invalid date";break;case R.invalid_string:typeof t.validation=="object"?"includes"in t.validation?(a=`Invalid input: must include "${t.validation.includes}"`,typeof t.validation.position=="number"&&(a=`${a} at one or more positions greater than or equal to ${t.validation.position}`)):"startsWith"in t.validation?a=`Invalid input: must start with "${t.validation.startsWith}"`:"endsWith"in t.validation?a=`Invalid input: must end with "${t.validation.endsWith}"`:Ge.assertNever(t.validation):t.validation!=="regex"?a=`Invalid ${t.validation}`:a="Invalid";break;case R.too_small:t.type==="array"?a=`Array must contain ${t.exact?"exactly":t.inclusive?"at least":"more than"} ${t.minimum} element(s)`:t.type==="string"?a=`String must contain ${t.exact?"exactly":t.inclusive?"at least":"over"} ${t.minimum} character(s)`:t.type==="number"?a=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="date"?a=`Date must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(t.minimum))}`:a="Invalid input";break;case R.too_big:t.type==="array"?a=`Array must contain ${t.exact?"exactly":t.inclusive?"at most":"less than"} ${t.maximum} element(s)`:t.type==="string"?a=`String must contain ${t.exact?"exactly":t.inclusive?"at most":"under"} ${t.maximum} character(s)`:t.type==="number"?a=`Number must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="bigint"?a=`BigInt must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="date"?a=`Date must be ${t.exact?"exactly":t.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(t.maximum))}`:a="Invalid input";break;case R.custom:a="Invalid input";break;case R.invalid_intersection_types:a="Intersection results could not be merged";break;case R.not_multiple_of:a=`Number must be a multiple of ${t.multipleOf}`;break;case R.not_finite:a="Number must be finite";break;default:a=e.defaultError,Ge.assertNever(t)}return{message:a}},lx=Co;function MO(t){lx=t}function _f(){return lx}var Cf=t=>{let{data:e,path:a,errorMaps:s,issueData:n}=t,r=[...a,...n.path||[]],o={...n,path:r};if(n.message!==void 0)return{...n,path:r,message:n.message};let l="",u=s.filter(c=>!!c).slice().reverse();for(let c of u)l=c(o,{data:e,defaultError:l}).message;return{...n,path:r,message:l}},LO=[];function H(t,e){let a=_f(),s=Cf({issueData:e,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,a,a===Co?void 0:Co].filter(n=>!!n)});t.common.issues.push(s)}var Ia=class dx{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,a){let s=[];for(let n of a){if(n.status==="aborted")return _e;n.status==="dirty"&&e.dirty(),s.push(n.value)}return{status:e.value,value:s}}static async mergeObjectAsync(e,a){let s=[];for(let n of a){let r=await n.key,o=await n.value;s.push({key:r,value:o})}return dx.mergeObjectSync(e,s)}static mergeObjectSync(e,a){let s={};for(let n of a){let{key:r,value:o}=n;if(r.status==="aborted"||o.status==="aborted")return _e;r.status==="dirty"&&e.dirty(),o.status==="dirty"&&e.dirty(),r.value!=="__proto__"&&(typeof o.value<"u"||n.alwaysSet)&&(s[r.value]=o.value)}return{status:e.value,value:s}}},_e=Object.freeze({status:"aborted"}),Sf=t=>({status:"dirty",value:t}),fa=t=>({status:"valid",value:t}),Wg=t=>t.status==="aborted",Bg=t=>t.status==="dirty",jd=t=>t.status==="valid",Hd=t=>typeof Promise<"u"&&t instanceof Promise;function Tf(t,e,a,s){if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return e.get(t)}function ux(t,e,a,s,n){if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return e.set(t,a),a}var re;(function(t){t.errToObj=e=>typeof e=="string"?{message:e}:e||{},t.toString=e=>typeof e=="string"?e:e==null?void 0:e.message})(re||(re={}));var Ml,Ll,Js=class{constructor(e,a,s,n){this._cachedPath=[],this.parent=e,this.data=a,this._path=s,this._key=n}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}},_w=(t,e)=>{if(jd(e))return{success:!0,data:e.value};if(!t.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;let a=new ks(t.common.issues);return this._error=a,this._error}}};function Ie(t){if(!t)return{};let{errorMap:e,invalid_type_error:a,required_error:s,description:n}=t;if(e&&(a||s))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:n}:{errorMap:(r,o)=>{var l,u;let{message:c}=t;return r.code==="invalid_enum_value"?{message:c??o.defaultError}:typeof o.data>"u"?{message:(l=c??s)!==null&&l!==void 0?l:o.defaultError}:r.code!=="invalid_type"?{message:o.defaultError}:{message:(u=c??a)!==null&&u!==void 0?u:o.defaultError}},description:n}}var We=class{constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this)}get description(){return this._def.description}_getType(e){return Jn(e.data)}_getOrReturnCtx(e,a){return a||{common:e.parent.common,data:e.data,parsedType:Jn(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new Ia,ctx:{common:e.parent.common,data:e.data,parsedType:Jn(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){let a=this._parse(e);if(Hd(a))throw new Error("Synchronous parse encountered promise.");return a}_parseAsync(e){let a=this._parse(e);return Promise.resolve(a)}parse(e,a){let s=this.safeParse(e,a);if(s.success)return s.data;throw s.error}safeParse(e,a){var s;let n={common:{issues:[],async:(s=a==null?void 0:a.async)!==null&&s!==void 0?s:!1,contextualErrorMap:a==null?void 0:a.errorMap},path:(a==null?void 0:a.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Jn(e)},r=this._parseSync({data:e,path:n.path,parent:n});return _w(n,r)}async parseAsync(e,a){let s=await this.safeParseAsync(e,a);if(s.success)return s.data;throw s.error}async safeParseAsync(e,a){let s={common:{issues:[],contextualErrorMap:a==null?void 0:a.errorMap,async:!0},path:(a==null?void 0:a.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Jn(e)},n=this._parse({data:e,path:s.path,parent:s}),r=await(Hd(n)?n:Promise.resolve(n));return _w(s,r)}refine(e,a){let s=n=>typeof a=="string"||typeof a>"u"?{message:a}:typeof a=="function"?a(n):a;return this._refinement((n,r)=>{let o=e(n),l=()=>r.addIssue({code:R.custom,...s(n)});return typeof Promise<"u"&&o instanceof Promise?o.then(u=>u?!0:(l(),!1)):o?!0:(l(),!1)})}refinement(e,a){return this._refinement((s,n)=>e(s)?!0:(n.addIssue(typeof a=="function"?a(s,n):a),!1))}_refinement(e){return new As({schema:this,typeName:ye.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}optional(){return Vs.create(this,this._def)}nullable(){return wi.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return yr.create(this,this._def)}promise(){return $o.create(this,this._def)}or(e){return Yd.create([this,e],this._def)}and(e){return Jd.create(this,e,this._def)}transform(e){return new As({...Ie(this._def),schema:this,typeName:ye.ZodEffects,effect:{type:"transform",transform:e}})}default(e){let a=typeof e=="function"?e:()=>e;return new au({...Ie(this._def),innerType:this,defaultValue:a,typeName:ye.ZodDefault})}brand(){return new wv({typeName:ye.ZodBranded,type:this,...Ie(this._def)})}catch(e){let a=typeof e=="function"?e:()=>e;return new su({...Ie(this._def),innerType:this,catchValue:a,typeName:ye.ZodCatch})}describe(e){let a=this.constructor;return new a({...this._def,description:e})}pipe(e){return kv.create(this,e)}readonly(){return nu.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}},EO=/^c[^\s-]{8,}$/i,IO=/^[0-9a-z]+$/,OO=/^[0-9A-HJKMNP-TV-Z]{26}$/,PO=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,RO=/^[a-z0-9_-]{21}$/i,DO=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,NO=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,WO="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$",qh,BO=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,ZO=/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,qO=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,cx="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",FO=new RegExp(`^${cx}$`);function px(t){let e="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return t.precision?e=`${e}\\.\\d{${t.precision}}`:t.precision==null&&(e=`${e}(\\.\\d+)?`),e}function jO(t){return new RegExp(`^${px(t)}$`)}function fx(t){let e=`${cx}T${px(t)}`,a=[];return a.push(t.local?"Z?":"Z"),t.offset&&a.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${a.join("|")})`,new RegExp(`^${e}$`)}function HO(t,e){return!!((e==="v4"||!e)&&BO.test(t)||(e==="v6"||!e)&&ZO.test(t))}var So=class El extends We{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==Y.string){let n=this._getOrReturnCtx(e);return H(n,{code:R.invalid_type,expected:Y.string,received:n.parsedType}),_e}let a=new Ia,s;for(let n of this._def.checks)if(n.kind==="min")e.data.length<n.value&&(s=this._getOrReturnCtx(e,s),H(s,{code:R.too_small,minimum:n.value,type:"string",inclusive:!0,exact:!1,message:n.message}),a.dirty());else if(n.kind==="max")e.data.length>n.value&&(s=this._getOrReturnCtx(e,s),H(s,{code:R.too_big,maximum:n.value,type:"string",inclusive:!0,exact:!1,message:n.message}),a.dirty());else if(n.kind==="length"){let r=e.data.length>n.value,o=e.data.length<n.value;(r||o)&&(s=this._getOrReturnCtx(e,s),r?H(s,{code:R.too_big,maximum:n.value,type:"string",inclusive:!0,exact:!0,message:n.message}):o&&H(s,{code:R.too_small,minimum:n.value,type:"string",inclusive:!0,exact:!0,message:n.message}),a.dirty())}else if(n.kind==="email")NO.test(e.data)||(s=this._getOrReturnCtx(e,s),H(s,{validation:"email",code:R.invalid_string,message:n.message}),a.dirty());else if(n.kind==="emoji")qh||(qh=new RegExp(WO,"u")),qh.test(e.data)||(s=this._getOrReturnCtx(e,s),H(s,{validation:"emoji",code:R.invalid_string,message:n.message}),a.dirty());else if(n.kind==="uuid")PO.test(e.data)||(s=this._getOrReturnCtx(e,s),H(s,{validation:"uuid",code:R.invalid_string,message:n.message}),a.dirty());else if(n.kind==="nanoid")RO.test(e.data)||(s=this._getOrReturnCtx(e,s),H(s,{validation:"nanoid",code:R.invalid_string,message:n.message}),a.dirty());else if(n.kind==="cuid")EO.test(e.data)||(s=this._getOrReturnCtx(e,s),H(s,{validation:"cuid",code:R.invalid_string,message:n.message}),a.dirty());else if(n.kind==="cuid2")IO.test(e.data)||(s=this._getOrReturnCtx(e,s),H(s,{validation:"cuid2",code:R.invalid_string,message:n.message}),a.dirty());else if(n.kind==="ulid")OO.test(e.data)||(s=this._getOrReturnCtx(e,s),H(s,{validation:"ulid",code:R.invalid_string,message:n.message}),a.dirty());else if(n.kind==="url")try{new URL(e.data)}catch{s=this._getOrReturnCtx(e,s),H(s,{validation:"url",code:R.invalid_string,message:n.message}),a.dirty()}else n.kind==="regex"?(n.regex.lastIndex=0,n.regex.test(e.data)||(s=this._getOrReturnCtx(e,s),H(s,{validation:"regex",code:R.invalid_string,message:n.message}),a.dirty())):n.kind==="trim"?e.data=e.data.trim():n.kind==="includes"?e.data.includes(n.value,n.position)||(s=this._getOrReturnCtx(e,s),H(s,{code:R.invalid_string,validation:{includes:n.value,position:n.position},message:n.message}),a.dirty()):n.kind==="toLowerCase"?e.data=e.data.toLowerCase():n.kind==="toUpperCase"?e.data=e.data.toUpperCase():n.kind==="startsWith"?e.data.startsWith(n.value)||(s=this._getOrReturnCtx(e,s),H(s,{code:R.invalid_string,validation:{startsWith:n.value},message:n.message}),a.dirty()):n.kind==="endsWith"?e.data.endsWith(n.value)||(s=this._getOrReturnCtx(e,s),H(s,{code:R.invalid_string,validation:{endsWith:n.value},message:n.message}),a.dirty()):n.kind==="datetime"?fx(n).test(e.data)||(s=this._getOrReturnCtx(e,s),H(s,{code:R.invalid_string,validation:"datetime",message:n.message}),a.dirty()):n.kind==="date"?FO.test(e.data)||(s=this._getOrReturnCtx(e,s),H(s,{code:R.invalid_string,validation:"date",message:n.message}),a.dirty()):n.kind==="time"?jO(n).test(e.data)||(s=this._getOrReturnCtx(e,s),H(s,{code:R.invalid_string,validation:"time",message:n.message}),a.dirty()):n.kind==="duration"?DO.test(e.data)||(s=this._getOrReturnCtx(e,s),H(s,{validation:"duration",code:R.invalid_string,message:n.message}),a.dirty()):n.kind==="ip"?HO(e.data,n.version)||(s=this._getOrReturnCtx(e,s),H(s,{validation:"ip",code:R.invalid_string,message:n.message}),a.dirty()):n.kind==="base64"?qO.test(e.data)||(s=this._getOrReturnCtx(e,s),H(s,{validation:"base64",code:R.invalid_string,message:n.message}),a.dirty()):Ge.assertNever(n);return{status:a.value,value:e.data}}_regex(e,a,s){return this.refinement(n=>e.test(n),{validation:a,code:R.invalid_string,...re.errToObj(s)})}_addCheck(e){return new El({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...re.errToObj(e)})}url(e){return this._addCheck({kind:"url",...re.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...re.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...re.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...re.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...re.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...re.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...re.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...re.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...re.errToObj(e)})}datetime(e){var a,s;return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,offset:(a=e==null?void 0:e.offset)!==null&&a!==void 0?a:!1,local:(s=e==null?void 0:e.local)!==null&&s!==void 0?s:!1,...re.errToObj(e==null?void 0:e.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,...re.errToObj(e==null?void 0:e.message)})}duration(e){return this._addCheck({kind:"duration",...re.errToObj(e)})}regex(e,a){return this._addCheck({kind:"regex",regex:e,...re.errToObj(a)})}includes(e,a){return this._addCheck({kind:"includes",value:e,position:a==null?void 0:a.position,...re.errToObj(a==null?void 0:a.message)})}startsWith(e,a){return this._addCheck({kind:"startsWith",value:e,...re.errToObj(a)})}endsWith(e,a){return this._addCheck({kind:"endsWith",value:e,...re.errToObj(a)})}min(e,a){return this._addCheck({kind:"min",value:e,...re.errToObj(a)})}max(e,a){return this._addCheck({kind:"max",value:e,...re.errToObj(a)})}length(e,a){return this._addCheck({kind:"length",value:e,...re.errToObj(a)})}nonempty(e){return this.min(1,re.errToObj(e))}trim(){return new El({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new El({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new El({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get minLength(){let e=null;for(let a of this._def.checks)a.kind==="min"&&(e===null||a.value>e)&&(e=a.value);return e}get maxLength(){let e=null;for(let a of this._def.checks)a.kind==="max"&&(e===null||a.value<e)&&(e=a.value);return e}};So.create=t=>{var e;return new So({checks:[],typeName:ye.ZodString,coerce:(e=t==null?void 0:t.coerce)!==null&&e!==void 0?e:!1,...Ie(t)})};function zO(t,e){let a=(t.toString().split(".")[1]||"").length,s=(e.toString().split(".")[1]||"").length,n=a>s?a:s,r=parseInt(t.toFixed(n).replace(".","")),o=parseInt(e.toFixed(n).replace(".",""));return r%o/Math.pow(10,n)}var zd=class Zg extends We{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==Y.number){let n=this._getOrReturnCtx(e);return H(n,{code:R.invalid_type,expected:Y.number,received:n.parsedType}),_e}let a,s=new Ia;for(let n of this._def.checks)n.kind==="int"?Ge.isInteger(e.data)||(a=this._getOrReturnCtx(e,a),H(a,{code:R.invalid_type,expected:"integer",received:"float",message:n.message}),s.dirty()):n.kind==="min"?(n.inclusive?e.data<n.value:e.data<=n.value)&&(a=this._getOrReturnCtx(e,a),H(a,{code:R.too_small,minimum:n.value,type:"number",inclusive:n.inclusive,exact:!1,message:n.message}),s.dirty()):n.kind==="max"?(n.inclusive?e.data>n.value:e.data>=n.value)&&(a=this._getOrReturnCtx(e,a),H(a,{code:R.too_big,maximum:n.value,type:"number",inclusive:n.inclusive,exact:!1,message:n.message}),s.dirty()):n.kind==="multipleOf"?zO(e.data,n.value)!==0&&(a=this._getOrReturnCtx(e,a),H(a,{code:R.not_multiple_of,multipleOf:n.value,message:n.message}),s.dirty()):n.kind==="finite"?Number.isFinite(e.data)||(a=this._getOrReturnCtx(e,a),H(a,{code:R.not_finite,message:n.message}),s.dirty()):Ge.assertNever(n);return{status:s.value,value:e.data}}gte(e,a){return this.setLimit("min",e,!0,re.toString(a))}gt(e,a){return this.setLimit("min",e,!1,re.toString(a))}lte(e,a){return this.setLimit("max",e,!0,re.toString(a))}lt(e,a){return this.setLimit("max",e,!1,re.toString(a))}setLimit(e,a,s,n){return new Zg({...this._def,checks:[...this._def.checks,{kind:e,value:a,inclusive:s,message:re.toString(n)}]})}_addCheck(e){return new Zg({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:re.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:re.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:re.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:re.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:re.toString(e)})}multipleOf(e,a){return this._addCheck({kind:"multipleOf",value:e,message:re.toString(a)})}finite(e){return this._addCheck({kind:"finite",message:re.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:re.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:re.toString(e)})}get minValue(){let e=null;for(let a of this._def.checks)a.kind==="min"&&(e===null||a.value>e)&&(e=a.value);return e}get maxValue(){let e=null;for(let a of this._def.checks)a.kind==="max"&&(e===null||a.value<e)&&(e=a.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&Ge.isInteger(e.value))}get isFinite(){let e=null,a=null;for(let s of this._def.checks){if(s.kind==="finite"||s.kind==="int"||s.kind==="multipleOf")return!0;s.kind==="min"?(a===null||s.value>a)&&(a=s.value):s.kind==="max"&&(e===null||s.value<e)&&(e=s.value)}return Number.isFinite(a)&&Number.isFinite(e)}};zd.create=t=>new zd({checks:[],typeName:ye.ZodNumber,coerce:(t==null?void 0:t.coerce)||!1,...Ie(t)});var Kd=class qg extends We{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce&&(e.data=BigInt(e.data)),this._getType(e)!==Y.bigint){let n=this._getOrReturnCtx(e);return H(n,{code:R.invalid_type,expected:Y.bigint,received:n.parsedType}),_e}let a,s=new Ia;for(let n of this._def.checks)n.kind==="min"?(n.inclusive?e.data<n.value:e.data<=n.value)&&(a=this._getOrReturnCtx(e,a),H(a,{code:R.too_small,type:"bigint",minimum:n.value,inclusive:n.inclusive,message:n.message}),s.dirty()):n.kind==="max"?(n.inclusive?e.data>n.value:e.data>=n.value)&&(a=this._getOrReturnCtx(e,a),H(a,{code:R.too_big,type:"bigint",maximum:n.value,inclusive:n.inclusive,message:n.message}),s.dirty()):n.kind==="multipleOf"?e.data%n.value!==BigInt(0)&&(a=this._getOrReturnCtx(e,a),H(a,{code:R.not_multiple_of,multipleOf:n.value,message:n.message}),s.dirty()):Ge.assertNever(n);return{status:s.value,value:e.data}}gte(e,a){return this.setLimit("min",e,!0,re.toString(a))}gt(e,a){return this.setLimit("min",e,!1,re.toString(a))}lte(e,a){return this.setLimit("max",e,!0,re.toString(a))}lt(e,a){return this.setLimit("max",e,!1,re.toString(a))}setLimit(e,a,s,n){return new qg({...this._def,checks:[...this._def.checks,{kind:e,value:a,inclusive:s,message:re.toString(n)}]})}_addCheck(e){return new qg({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:re.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:re.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:re.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:re.toString(e)})}multipleOf(e,a){return this._addCheck({kind:"multipleOf",value:e,message:re.toString(a)})}get minValue(){let e=null;for(let a of this._def.checks)a.kind==="min"&&(e===null||a.value>e)&&(e=a.value);return e}get maxValue(){let e=null;for(let a of this._def.checks)a.kind==="max"&&(e===null||a.value<e)&&(e=a.value);return e}};Kd.create=t=>{var e;return new Kd({checks:[],typeName:ye.ZodBigInt,coerce:(e=t==null?void 0:t.coerce)!==null&&e!==void 0?e:!1,...Ie(t)})};var Vd=class extends We{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==Y.boolean){let a=this._getOrReturnCtx(e);return H(a,{code:R.invalid_type,expected:Y.boolean,received:a.parsedType}),_e}return fa(e.data)}};Vd.create=t=>new Vd({typeName:ye.ZodBoolean,coerce:(t==null?void 0:t.coerce)||!1,...Ie(t)});var Ud=class mx extends We{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==Y.date){let n=this._getOrReturnCtx(e);return H(n,{code:R.invalid_type,expected:Y.date,received:n.parsedType}),_e}if(isNaN(e.data.getTime())){let n=this._getOrReturnCtx(e);return H(n,{code:R.invalid_date}),_e}let a=new Ia,s;for(let n of this._def.checks)n.kind==="min"?e.data.getTime()<n.value&&(s=this._getOrReturnCtx(e,s),H(s,{code:R.too_small,message:n.message,inclusive:!0,exact:!1,minimum:n.value,type:"date"}),a.dirty()):n.kind==="max"?e.data.getTime()>n.value&&(s=this._getOrReturnCtx(e,s),H(s,{code:R.too_big,message:n.message,inclusive:!0,exact:!1,maximum:n.value,type:"date"}),a.dirty()):Ge.assertNever(n);return{status:a.value,value:new Date(e.data.getTime())}}_addCheck(e){return new mx({...this._def,checks:[...this._def.checks,e]})}min(e,a){return this._addCheck({kind:"min",value:e.getTime(),message:re.toString(a)})}max(e,a){return this._addCheck({kind:"max",value:e.getTime(),message:re.toString(a)})}get minDate(){let e=null;for(let a of this._def.checks)a.kind==="min"&&(e===null||a.value>e)&&(e=a.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(let a of this._def.checks)a.kind==="max"&&(e===null||a.value<e)&&(e=a.value);return e!=null?new Date(e):null}};Ud.create=t=>new Ud({checks:[],coerce:(t==null?void 0:t.coerce)||!1,typeName:ye.ZodDate,...Ie(t)});var $f=class extends We{_parse(e){if(this._getType(e)!==Y.symbol){let a=this._getOrReturnCtx(e);return H(a,{code:R.invalid_type,expected:Y.symbol,received:a.parsedType}),_e}return fa(e.data)}};$f.create=t=>new $f({typeName:ye.ZodSymbol,...Ie(t)});var Gd=class extends We{_parse(e){if(this._getType(e)!==Y.undefined){let a=this._getOrReturnCtx(e);return H(a,{code:R.invalid_type,expected:Y.undefined,received:a.parsedType}),_e}return fa(e.data)}};Gd.create=t=>new Gd({typeName:ye.ZodUndefined,...Ie(t)});var Qd=class extends We{_parse(e){if(this._getType(e)!==Y.null){let a=this._getOrReturnCtx(e);return H(a,{code:R.invalid_type,expected:Y.null,received:a.parsedType}),_e}return fa(e.data)}};Qd.create=t=>new Qd({typeName:ye.ZodNull,...Ie(t)});var To=class extends We{constructor(){super(...arguments),this._any=!0}_parse(e){return fa(e.data)}};To.create=t=>new To({typeName:ye.ZodAny,...Ie(t)});var Xi=class extends We{constructor(){super(...arguments),this._unknown=!0}_parse(e){return fa(e.data)}};Xi.create=t=>new Xi({typeName:ye.ZodUnknown,...Ie(t)});var xn=class extends We{_parse(e){let a=this._getOrReturnCtx(e);return H(a,{code:R.invalid_type,expected:Y.never,received:a.parsedType}),_e}};xn.create=t=>new xn({typeName:ye.ZodNever,...Ie(t)});var Af=class extends We{_parse(e){if(this._getType(e)!==Y.undefined){let a=this._getOrReturnCtx(e);return H(a,{code:R.invalid_type,expected:Y.void,received:a.parsedType}),_e}return fa(e.data)}};Af.create=t=>new Af({typeName:ye.ZodVoid,...Ie(t)});var yr=class Wp extends We{_parse(e){let{ctx:a,status:s}=this._processInputParams(e),n=this._def;if(a.parsedType!==Y.array)return H(a,{code:R.invalid_type,expected:Y.array,received:a.parsedType}),_e;if(n.exactLength!==null){let o=a.data.length>n.exactLength.value,l=a.data.length<n.exactLength.value;(o||l)&&(H(a,{code:o?R.too_big:R.too_small,minimum:l?n.exactLength.value:void 0,maximum:o?n.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:n.exactLength.message}),s.dirty())}if(n.minLength!==null&&a.data.length<n.minLength.value&&(H(a,{code:R.too_small,minimum:n.minLength.value,type:"array",inclusive:!0,exact:!1,message:n.minLength.message}),s.dirty()),n.maxLength!==null&&a.data.length>n.maxLength.value&&(H(a,{code:R.too_big,maximum:n.maxLength.value,type:"array",inclusive:!0,exact:!1,message:n.maxLength.message}),s.dirty()),a.common.async)return Promise.all([...a.data].map((o,l)=>n.type._parseAsync(new Js(a,o,a.path,l)))).then(o=>Ia.mergeArray(s,o));let r=[...a.data].map((o,l)=>n.type._parseSync(new Js(a,o,a.path,l)));return Ia.mergeArray(s,r)}get element(){return this._def.type}min(e,a){return new Wp({...this._def,minLength:{value:e,message:re.toString(a)}})}max(e,a){return new Wp({...this._def,maxLength:{value:e,message:re.toString(a)}})}length(e,a){return new Wp({...this._def,exactLength:{value:e,message:re.toString(a)}})}nonempty(e){return this.min(1,e)}};yr.create=(t,e)=>new yr({type:t,minLength:null,maxLength:null,exactLength:null,typeName:ye.ZodArray,...Ie(e)});function Vr(t){if(t instanceof as){let e={};for(let a in t.shape){let s=t.shape[a];e[a]=Vs.create(Vr(s))}return new as({...t._def,shape:()=>e})}else return t instanceof yr?new yr({...t._def,type:Vr(t.element)}):t instanceof Vs?Vs.create(Vr(t.unwrap())):t instanceof wi?wi.create(Vr(t.unwrap())):t instanceof bi?bi.create(t.items.map(e=>Vr(e))):t}var as=class ps extends We{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;let e=this._def.shape(),a=Ge.objectKeys(e);return this._cached={shape:e,keys:a}}_parse(e){if(this._getType(e)!==Y.object){let u=this._getOrReturnCtx(e);return H(u,{code:R.invalid_type,expected:Y.object,received:u.parsedType}),_e}let{status:a,ctx:s}=this._processInputParams(e),{shape:n,keys:r}=this._getCached(),o=[];if(!(this._def.catchall instanceof xn&&this._def.unknownKeys==="strip"))for(let u in s.data)r.includes(u)||o.push(u);let l=[];for(let u of r){let c=n[u],p=s.data[u];l.push({key:{status:"valid",value:u},value:c._parse(new Js(s,p,s.path,u)),alwaysSet:u in s.data})}if(this._def.catchall instanceof xn){let u=this._def.unknownKeys;if(u==="passthrough")for(let c of o)l.push({key:{status:"valid",value:c},value:{status:"valid",value:s.data[c]}});else if(u==="strict")o.length>0&&(H(s,{code:R.unrecognized_keys,keys:o}),a.dirty());else if(u!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{let u=this._def.catchall;for(let c of o){let p=s.data[c];l.push({key:{status:"valid",value:c},value:u._parse(new Js(s,p,s.path,c)),alwaysSet:c in s.data})}}return s.common.async?Promise.resolve().then(async()=>{let u=[];for(let c of l){let p=await c.key,f=await c.value;u.push({key:p,value:f,alwaysSet:c.alwaysSet})}return u}).then(u=>Ia.mergeObjectSync(a,u)):Ia.mergeObjectSync(a,l)}get shape(){return this._def.shape()}strict(e){return re.errToObj,new ps({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(a,s)=>{var n,r,o,l;let u=(o=(r=(n=this._def).errorMap)===null||r===void 0?void 0:r.call(n,a,s).message)!==null&&o!==void 0?o:s.defaultError;return a.code==="unrecognized_keys"?{message:(l=re.errToObj(e).message)!==null&&l!==void 0?l:u}:{message:u}}}:{}})}strip(){return new ps({...this._def,unknownKeys:"strip"})}passthrough(){return new ps({...this._def,unknownKeys:"passthrough"})}extend(e){return new ps({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new ps({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:ye.ZodObject})}setKey(e,a){return this.augment({[e]:a})}catchall(e){return new ps({...this._def,catchall:e})}pick(e){let a={};return Ge.objectKeys(e).forEach(s=>{e[s]&&this.shape[s]&&(a[s]=this.shape[s])}),new ps({...this._def,shape:()=>a})}omit(e){let a={};return Ge.objectKeys(this.shape).forEach(s=>{e[s]||(a[s]=this.shape[s])}),new ps({...this._def,shape:()=>a})}deepPartial(){return Vr(this)}partial(e){let a={};return Ge.objectKeys(this.shape).forEach(s=>{let n=this.shape[s];e&&!e[s]?a[s]=n:a[s]=n.optional()}),new ps({...this._def,shape:()=>a})}required(e){let a={};return Ge.objectKeys(this.shape).forEach(s=>{if(e&&!e[s])a[s]=this.shape[s];else{let n=this.shape[s];for(;n instanceof Vs;)n=n._def.innerType;a[s]=n}}),new ps({...this._def,shape:()=>a})}keyof(){return wx(Ge.objectKeys(this.shape))}};as.create=(t,e)=>new as({shape:()=>t,unknownKeys:"strip",catchall:xn.create(),typeName:ye.ZodObject,...Ie(e)});as.strictCreate=(t,e)=>new as({shape:()=>t,unknownKeys:"strict",catchall:xn.create(),typeName:ye.ZodObject,...Ie(e)});as.lazycreate=(t,e)=>new as({shape:t,unknownKeys:"strip",catchall:xn.create(),typeName:ye.ZodObject,...Ie(e)});var Yd=class extends We{_parse(e){let{ctx:a}=this._processInputParams(e),s=this._def.options;function n(r){for(let l of r)if(l.result.status==="valid")return l.result;for(let l of r)if(l.result.status==="dirty")return a.common.issues.push(...l.ctx.common.issues),l.result;let o=r.map(l=>new ks(l.ctx.common.issues));return H(a,{code:R.invalid_union,unionErrors:o}),_e}if(a.common.async)return Promise.all(s.map(async r=>{let o={...a,common:{...a.common,issues:[]},parent:null};return{result:await r._parseAsync({data:a.data,path:a.path,parent:o}),ctx:o}})).then(n);{let r,o=[];for(let u of s){let c={...a,common:{...a.common,issues:[]},parent:null},p=u._parseSync({data:a.data,path:a.path,parent:c});if(p.status==="valid")return p;p.status==="dirty"&&!r&&(r={result:p,ctx:c}),c.common.issues.length&&o.push(c.common.issues)}if(r)return a.common.issues.push(...r.ctx.common.issues),r.result;let l=o.map(u=>new ks(u));return H(a,{code:R.invalid_union,unionErrors:l}),_e}}get options(){return this._def.options}};Yd.create=(t,e)=>new Yd({options:t,typeName:ye.ZodUnion,...Ie(e)});var Hn=t=>t instanceof Xd?Hn(t.schema):t instanceof As?Hn(t.innerType()):t instanceof eu?[t.value]:t instanceof Cc?t.options:t instanceof tu?Ge.objectValues(t.enum):t instanceof au?Hn(t._def.innerType):t instanceof Gd?[void 0]:t instanceof Qd?[null]:t instanceof Vs?[void 0,...Hn(t.unwrap())]:t instanceof wi?[null,...Hn(t.unwrap())]:t instanceof wv||t instanceof nu?Hn(t.unwrap()):t instanceof su?Hn(t._def.innerType):[],hx=class gx extends We{_parse(e){let{ctx:a}=this._processInputParams(e);if(a.parsedType!==Y.object)return H(a,{code:R.invalid_type,expected:Y.object,received:a.parsedType}),_e;let s=this.discriminator,n=a.data[s],r=this.optionsMap.get(n);return r?a.common.async?r._parseAsync({data:a.data,path:a.path,parent:a}):r._parseSync({data:a.data,path:a.path,parent:a}):(H(a,{code:R.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[s]}),_e)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,a,s){let n=new Map;for(let r of a){let o=Hn(r.shape[e]);if(!o.length)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(let l of o){if(n.has(l))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(l)}`);n.set(l,r)}}return new gx({typeName:ye.ZodDiscriminatedUnion,discriminator:e,options:a,optionsMap:n,...Ie(s)})}};function Fg(t,e){let a=Jn(t),s=Jn(e);if(t===e)return{valid:!0,data:t};if(a===Y.object&&s===Y.object){let n=Ge.objectKeys(e),r=Ge.objectKeys(t).filter(l=>n.indexOf(l)!==-1),o={...t,...e};for(let l of r){let u=Fg(t[l],e[l]);if(!u.valid)return{valid:!1};o[l]=u.data}return{valid:!0,data:o}}else if(a===Y.array&&s===Y.array){if(t.length!==e.length)return{valid:!1};let n=[];for(let r=0;r<t.length;r++){let o=t[r],l=e[r],u=Fg(o,l);if(!u.valid)return{valid:!1};n.push(u.data)}return{valid:!0,data:n}}else return a===Y.date&&s===Y.date&&+t==+e?{valid:!0,data:t}:{valid:!1}}var Jd=class extends We{_parse(e){let{status:a,ctx:s}=this._processInputParams(e),n=(r,o)=>{if(Wg(r)||Wg(o))return _e;let l=Fg(r.value,o.value);return l.valid?((Bg(r)||Bg(o))&&a.dirty(),{status:a.value,value:l.data}):(H(s,{code:R.invalid_intersection_types}),_e)};return s.common.async?Promise.all([this._def.left._parseAsync({data:s.data,path:s.path,parent:s}),this._def.right._parseAsync({data:s.data,path:s.path,parent:s})]).then(([r,o])=>n(r,o)):n(this._def.left._parseSync({data:s.data,path:s.path,parent:s}),this._def.right._parseSync({data:s.data,path:s.path,parent:s}))}};Jd.create=(t,e,a)=>new Jd({left:t,right:e,typeName:ye.ZodIntersection,...Ie(a)});var bi=class yx extends We{_parse(e){let{status:a,ctx:s}=this._processInputParams(e);if(s.parsedType!==Y.array)return H(s,{code:R.invalid_type,expected:Y.array,received:s.parsedType}),_e;if(s.data.length<this._def.items.length)return H(s,{code:R.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),_e;!this._def.rest&&s.data.length>this._def.items.length&&(H(s,{code:R.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),a.dirty());let n=[...s.data].map((r,o)=>{let l=this._def.items[o]||this._def.rest;return l?l._parse(new Js(s,r,s.path,o)):null}).filter(r=>!!r);return s.common.async?Promise.all(n).then(r=>Ia.mergeArray(a,r)):Ia.mergeArray(a,n)}get items(){return this._def.items}rest(e){return new yx({...this._def,rest:e})}};bi.create=(t,e)=>{if(!Array.isArray(t))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new bi({items:t,typeName:ye.ZodTuple,rest:null,...Ie(e)})};var vx=class jg extends We{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:a,ctx:s}=this._processInputParams(e);if(s.parsedType!==Y.object)return H(s,{code:R.invalid_type,expected:Y.object,received:s.parsedType}),_e;let n=[],r=this._def.keyType,o=this._def.valueType;for(let l in s.data)n.push({key:r._parse(new Js(s,l,s.path,l)),value:o._parse(new Js(s,s.data[l],s.path,l)),alwaysSet:l in s.data});return s.common.async?Ia.mergeObjectAsync(a,n):Ia.mergeObjectSync(a,n)}get element(){return this._def.valueType}static create(e,a,s){return a instanceof We?new jg({keyType:e,valueType:a,typeName:ye.ZodRecord,...Ie(s)}):new jg({keyType:So.create(),valueType:e,typeName:ye.ZodRecord,...Ie(a)})}},Mf=class extends We{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:a,ctx:s}=this._processInputParams(e);if(s.parsedType!==Y.map)return H(s,{code:R.invalid_type,expected:Y.map,received:s.parsedType}),_e;let n=this._def.keyType,r=this._def.valueType,o=[...s.data.entries()].map(([l,u],c)=>({key:n._parse(new Js(s,l,s.path,[c,"key"])),value:r._parse(new Js(s,u,s.path,[c,"value"]))}));if(s.common.async){let l=new Map;return Promise.resolve().then(async()=>{for(let u of o){let c=await u.key,p=await u.value;if(c.status==="aborted"||p.status==="aborted")return _e;(c.status==="dirty"||p.status==="dirty")&&a.dirty(),l.set(c.value,p.value)}return{status:a.value,value:l}})}else{let l=new Map;for(let u of o){let c=u.key,p=u.value;if(c.status==="aborted"||p.status==="aborted")return _e;(c.status==="dirty"||p.status==="dirty")&&a.dirty(),l.set(c.value,p.value)}return{status:a.value,value:l}}}};Mf.create=(t,e,a)=>new Mf({valueType:e,keyType:t,typeName:ye.ZodMap,...Ie(a)});var Lf=class Hg extends We{_parse(e){let{status:a,ctx:s}=this._processInputParams(e);if(s.parsedType!==Y.set)return H(s,{code:R.invalid_type,expected:Y.set,received:s.parsedType}),_e;let n=this._def;n.minSize!==null&&s.data.size<n.minSize.value&&(H(s,{code:R.too_small,minimum:n.minSize.value,type:"set",inclusive:!0,exact:!1,message:n.minSize.message}),a.dirty()),n.maxSize!==null&&s.data.size>n.maxSize.value&&(H(s,{code:R.too_big,maximum:n.maxSize.value,type:"set",inclusive:!0,exact:!1,message:n.maxSize.message}),a.dirty());let r=this._def.valueType;function o(u){let c=new Set;for(let p of u){if(p.status==="aborted")return _e;p.status==="dirty"&&a.dirty(),c.add(p.value)}return{status:a.value,value:c}}let l=[...s.data.values()].map((u,c)=>r._parse(new Js(s,u,s.path,c)));return s.common.async?Promise.all(l).then(u=>o(u)):o(l)}min(e,a){return new Hg({...this._def,minSize:{value:e,message:re.toString(a)}})}max(e,a){return new Hg({...this._def,maxSize:{value:e,message:re.toString(a)}})}size(e,a){return this.min(e,a).max(e,a)}nonempty(e){return this.min(1,e)}};Lf.create=(t,e)=>new Lf({valueType:t,minSize:null,maxSize:null,typeName:ye.ZodSet,...Ie(e)});var bx=class Bp extends We{constructor(){super(...arguments),this.validate=this.implement}_parse(e){let{ctx:a}=this._processInputParams(e);if(a.parsedType!==Y.function)return H(a,{code:R.invalid_type,expected:Y.function,received:a.parsedType}),_e;function s(l,u){return Cf({data:l,path:a.path,errorMaps:[a.common.contextualErrorMap,a.schemaErrorMap,_f(),Co].filter(c=>!!c),issueData:{code:R.invalid_arguments,argumentsError:u}})}function n(l,u){return Cf({data:l,path:a.path,errorMaps:[a.common.contextualErrorMap,a.schemaErrorMap,_f(),Co].filter(c=>!!c),issueData:{code:R.invalid_return_type,returnTypeError:u}})}let r={errorMap:a.common.contextualErrorMap},o=a.data;if(this._def.returns instanceof $o){let l=this;return fa(async function(...u){let c=new ks([]),p=await l._def.args.parseAsync(u,r).catch(m=>{throw c.addIssue(s(u,m)),c}),f=await Reflect.apply(o,this,p);return await l._def.returns._def.type.parseAsync(f,r).catch(m=>{throw c.addIssue(n(f,m)),c})})}else{let l=this;return fa(function(...u){let c=l._def.args.safeParse(u,r);if(!c.success)throw new ks([s(u,c.error)]);let p=Reflect.apply(o,this,c.data),f=l._def.returns.safeParse(p,r);if(!f.success)throw new ks([n(p,f.error)]);return f.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new Bp({...this._def,args:bi.create(e).rest(Xi.create())})}returns(e){return new Bp({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,a,s){return new Bp({args:e||bi.create([]).rest(Xi.create()),returns:a||Xi.create(),typeName:ye.ZodFunction,...Ie(s)})}},Xd=class extends We{get schema(){return this._def.getter()}_parse(e){let{ctx:a}=this._processInputParams(e);return this._def.getter()._parse({data:a.data,path:a.path,parent:a})}};Xd.create=(t,e)=>new Xd({getter:t,typeName:ye.ZodLazy,...Ie(e)});var eu=class extends We{_parse(e){if(e.data!==this._def.value){let a=this._getOrReturnCtx(e);return H(a,{received:a.data,code:R.invalid_literal,expected:this._def.value}),_e}return{status:"valid",value:e.data}}get value(){return this._def.value}};eu.create=(t,e)=>new eu({value:t,typeName:ye.ZodLiteral,...Ie(e)});function wx(t,e){return new Cc({values:t,typeName:ye.ZodEnum,...Ie(e)})}var Cc=class zg extends We{constructor(){super(...arguments),Ml.set(this,void 0)}_parse(e){if(typeof e.data!="string"){let a=this._getOrReturnCtx(e),s=this._def.values;return H(a,{expected:Ge.joinValues(s),received:a.parsedType,code:R.invalid_type}),_e}if(Tf(this,Ml)||ux(this,Ml,new Set(this._def.values)),!Tf(this,Ml).has(e.data)){let a=this._getOrReturnCtx(e),s=this._def.values;return H(a,{received:a.data,code:R.invalid_enum_value,options:s}),_e}return fa(e.data)}get options(){return this._def.values}get enum(){let e={};for(let a of this._def.values)e[a]=a;return e}get Values(){let e={};for(let a of this._def.values)e[a]=a;return e}get Enum(){let e={};for(let a of this._def.values)e[a]=a;return e}extract(e,a=this._def){return zg.create(e,{...this._def,...a})}exclude(e,a=this._def){return zg.create(this.options.filter(s=>!e.includes(s)),{...this._def,...a})}};Ml=new WeakMap;Cc.create=wx;var tu=class extends We{constructor(){super(...arguments),Ll.set(this,void 0)}_parse(e){let a=Ge.getValidEnumValues(this._def.values),s=this._getOrReturnCtx(e);if(s.parsedType!==Y.string&&s.parsedType!==Y.number){let n=Ge.objectValues(a);return H(s,{expected:Ge.joinValues(n),received:s.parsedType,code:R.invalid_type}),_e}if(Tf(this,Ll)||ux(this,Ll,new Set(Ge.getValidEnumValues(this._def.values))),!Tf(this,Ll).has(e.data)){let n=Ge.objectValues(a);return H(s,{received:s.data,code:R.invalid_enum_value,options:n}),_e}return fa(e.data)}get enum(){return this._def.values}};Ll=new WeakMap;tu.create=(t,e)=>new tu({values:t,typeName:ye.ZodNativeEnum,...Ie(e)});var $o=class extends We{unwrap(){return this._def.type}_parse(e){let{ctx:a}=this._processInputParams(e);if(a.parsedType!==Y.promise&&a.common.async===!1)return H(a,{code:R.invalid_type,expected:Y.promise,received:a.parsedType}),_e;let s=a.parsedType===Y.promise?a.data:Promise.resolve(a.data);return fa(s.then(n=>this._def.type.parseAsync(n,{path:a.path,errorMap:a.common.contextualErrorMap})))}};$o.create=(t,e)=>new $o({type:t,typeName:ye.ZodPromise,...Ie(e)});var As=class extends We{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===ye.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){let{status:a,ctx:s}=this._processInputParams(e),n=this._def.effect||null,r={addIssue:o=>{H(s,o),o.fatal?a.abort():a.dirty()},get path(){return s.path}};if(r.addIssue=r.addIssue.bind(r),n.type==="preprocess"){let o=n.transform(s.data,r);if(s.common.async)return Promise.resolve(o).then(async l=>{if(a.value==="aborted")return _e;let u=await this._def.schema._parseAsync({data:l,path:s.path,parent:s});return u.status==="aborted"?_e:u.status==="dirty"||a.value==="dirty"?Sf(u.value):u});{if(a.value==="aborted")return _e;let l=this._def.schema._parseSync({data:o,path:s.path,parent:s});return l.status==="aborted"?_e:l.status==="dirty"||a.value==="dirty"?Sf(l.value):l}}if(n.type==="refinement"){let o=l=>{let u=n.refinement(l,r);if(s.common.async)return Promise.resolve(u);if(u instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return l};if(s.common.async===!1){let l=this._def.schema._parseSync({data:s.data,path:s.path,parent:s});return l.status==="aborted"?_e:(l.status==="dirty"&&a.dirty(),o(l.value),{status:a.value,value:l.value})}else return this._def.schema._parseAsync({data:s.data,path:s.path,parent:s}).then(l=>l.status==="aborted"?_e:(l.status==="dirty"&&a.dirty(),o(l.value).then(()=>({status:a.value,value:l.value}))))}if(n.type==="transform")if(s.common.async===!1){let o=this._def.schema._parseSync({data:s.data,path:s.path,parent:s});if(!jd(o))return o;let l=n.transform(o.value,r);if(l instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:a.value,value:l}}else return this._def.schema._parseAsync({data:s.data,path:s.path,parent:s}).then(o=>jd(o)?Promise.resolve(n.transform(o.value,r)).then(l=>({status:a.value,value:l})):o);Ge.assertNever(n)}};As.create=(t,e,a)=>new As({schema:t,typeName:ye.ZodEffects,effect:e,...Ie(a)});As.createWithPreprocess=(t,e,a)=>new As({schema:e,effect:{type:"preprocess",transform:t},typeName:ye.ZodEffects,...Ie(a)});var Vs=class extends We{_parse(e){return this._getType(e)===Y.undefined?fa(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}};Vs.create=(t,e)=>new Vs({innerType:t,typeName:ye.ZodOptional,...Ie(e)});var wi=class extends We{_parse(e){return this._getType(e)===Y.null?fa(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}};wi.create=(t,e)=>new wi({innerType:t,typeName:ye.ZodNullable,...Ie(e)});var au=class extends We{_parse(e){let{ctx:a}=this._processInputParams(e),s=a.data;return a.parsedType===Y.undefined&&(s=this._def.defaultValue()),this._def.innerType._parse({data:s,path:a.path,parent:a})}removeDefault(){return this._def.innerType}};au.create=(t,e)=>new au({innerType:t,typeName:ye.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...Ie(e)});var su=class extends We{_parse(e){let{ctx:a}=this._processInputParams(e),s={...a,common:{...a.common,issues:[]}},n=this._def.innerType._parse({data:s.data,path:s.path,parent:{...s}});return Hd(n)?n.then(r=>({status:"valid",value:r.status==="valid"?r.value:this._def.catchValue({get error(){return new ks(s.common.issues)},input:s.data})})):{status:"valid",value:n.status==="valid"?n.value:this._def.catchValue({get error(){return new ks(s.common.issues)},input:s.data})}}removeCatch(){return this._def.innerType}};su.create=(t,e)=>new su({innerType:t,typeName:ye.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...Ie(e)});var Ef=class extends We{_parse(e){if(this._getType(e)!==Y.nan){let a=this._getOrReturnCtx(e);return H(a,{code:R.invalid_type,expected:Y.nan,received:a.parsedType}),_e}return{status:"valid",value:e.data}}};Ef.create=t=>new Ef({typeName:ye.ZodNaN,...Ie(t)});var KO=Symbol("zod_brand"),wv=class extends We{_parse(e){let{ctx:a}=this._processInputParams(e),s=a.data;return this._def.type._parse({data:s,path:a.path,parent:a})}unwrap(){return this._def.type}},kv=class kx extends We{_parse(e){let{status:a,ctx:s}=this._processInputParams(e);if(s.common.async)return(async()=>{let n=await this._def.in._parseAsync({data:s.data,path:s.path,parent:s});return n.status==="aborted"?_e:n.status==="dirty"?(a.dirty(),Sf(n.value)):this._def.out._parseAsync({data:n.value,path:s.path,parent:s})})();{let n=this._def.in._parseSync({data:s.data,path:s.path,parent:s});return n.status==="aborted"?_e:n.status==="dirty"?(a.dirty(),{status:"dirty",value:n.value}):this._def.out._parseSync({data:n.value,path:s.path,parent:s})}}static create(e,a){return new kx({in:e,out:a,typeName:ye.ZodPipeline})}},nu=class extends We{_parse(e){let a=this._def.innerType._parse(e),s=n=>(jd(n)&&(n.value=Object.freeze(n.value)),n);return Hd(a)?a.then(n=>s(n)):s(a)}unwrap(){return this._def.innerType}};nu.create=(t,e)=>new nu({innerType:t,typeName:ye.ZodReadonly,...Ie(e)});function xx(t,e={},a){return t?To.create().superRefine((s,n)=>{var r,o;if(!t(s)){let l=typeof e=="function"?e(s):typeof e=="string"?{message:e}:e,u=(o=(r=l.fatal)!==null&&r!==void 0?r:a)!==null&&o!==void 0?o:!0,c=typeof l=="string"?{message:l}:l;n.addIssue({code:"custom",...c,fatal:u})}}):To.create()}var VO={object:as.lazycreate},ye;(function(t){t.ZodString="ZodString",t.ZodNumber="ZodNumber",t.ZodNaN="ZodNaN",t.ZodBigInt="ZodBigInt",t.ZodBoolean="ZodBoolean",t.ZodDate="ZodDate",t.ZodSymbol="ZodSymbol",t.ZodUndefined="ZodUndefined",t.ZodNull="ZodNull",t.ZodAny="ZodAny",t.ZodUnknown="ZodUnknown",t.ZodNever="ZodNever",t.ZodVoid="ZodVoid",t.ZodArray="ZodArray",t.ZodObject="ZodObject",t.ZodUnion="ZodUnion",t.ZodDiscriminatedUnion="ZodDiscriminatedUnion",t.ZodIntersection="ZodIntersection",t.ZodTuple="ZodTuple",t.ZodRecord="ZodRecord",t.ZodMap="ZodMap",t.ZodSet="ZodSet",t.ZodFunction="ZodFunction",t.ZodLazy="ZodLazy",t.ZodLiteral="ZodLiteral",t.ZodEnum="ZodEnum",t.ZodEffects="ZodEffects",t.ZodNativeEnum="ZodNativeEnum",t.ZodOptional="ZodOptional",t.ZodNullable="ZodNullable",t.ZodDefault="ZodDefault",t.ZodCatch="ZodCatch",t.ZodPromise="ZodPromise",t.ZodBranded="ZodBranded",t.ZodPipeline="ZodPipeline",t.ZodReadonly="ZodReadonly"})(ye||(ye={}));var UO=(t,e={message:`Input not instance of ${t.name}`})=>xx(a=>a instanceof t,e),_x=So.create,Cx=zd.create,GO=Ef.create,QO=Kd.create,Sx=Vd.create,YO=Ud.create,JO=$f.create,XO=Gd.create,eP=Qd.create,tP=To.create,aP=Xi.create,sP=xn.create,nP=Af.create,iP=yr.create,rP=as.create,oP=as.strictCreate,lP=Yd.create,dP=hx.create,uP=Jd.create,cP=bi.create,pP=vx.create,fP=Mf.create,mP=Lf.create,hP=bx.create,gP=Xd.create,yP=eu.create,vP=Cc.create,bP=tu.create,wP=$o.create,Cw=As.create,kP=Vs.create,xP=wi.create,_P=As.createWithPreprocess,CP=kv.create,SP=()=>_x().optional(),TP=()=>Cx().optional(),$P=()=>Sx().optional(),AP={string:t=>So.create({...t,coerce:!0}),number:t=>zd.create({...t,coerce:!0}),boolean:t=>Vd.create({...t,coerce:!0}),bigint:t=>Kd.create({...t,coerce:!0}),date:t=>Ud.create({...t,coerce:!0})},MP=_e,Wt=Object.freeze({__proto__:null,defaultErrorMap:Co,setErrorMap:MO,getErrorMap:_f,makeIssue:Cf,EMPTY_PATH:LO,addIssueToContext:H,ParseStatus:Ia,INVALID:_e,DIRTY:Sf,OK:fa,isAborted:Wg,isDirty:Bg,isValid:jd,isAsync:Hd,get util(){return Ge},get objectUtil(){return Ng},ZodParsedType:Y,getParsedType:Jn,ZodType:We,datetimeRegex:fx,ZodString:So,ZodNumber:zd,ZodBigInt:Kd,ZodBoolean:Vd,ZodDate:Ud,ZodSymbol:$f,ZodUndefined:Gd,ZodNull:Qd,ZodAny:To,ZodUnknown:Xi,ZodNever:xn,ZodVoid:Af,ZodArray:yr,ZodObject:as,ZodUnion:Yd,ZodDiscriminatedUnion:hx,ZodIntersection:Jd,ZodTuple:bi,ZodRecord:vx,ZodMap:Mf,ZodSet:Lf,ZodFunction:bx,ZodLazy:Xd,ZodLiteral:eu,ZodEnum:Cc,ZodNativeEnum:tu,ZodPromise:$o,ZodEffects:As,ZodTransformer:As,ZodOptional:Vs,ZodNullable:wi,ZodDefault:au,ZodCatch:su,ZodNaN:Ef,BRAND:KO,ZodBranded:wv,ZodPipeline:kv,ZodReadonly:nu,custom:xx,Schema:We,ZodSchema:We,late:VO,get ZodFirstPartyTypeKind(){return ye},coerce:AP,any:tP,array:iP,bigint:QO,boolean:Sx,date:YO,discriminatedUnion:dP,effect:Cw,enum:vP,function:hP,instanceof:UO,intersection:uP,lazy:gP,literal:yP,map:fP,nan:GO,nativeEnum:bP,never:sP,null:eP,nullable:xP,number:Cx,object:rP,oboolean:$P,onumber:TP,optional:kP,ostring:SP,pipeline:CP,preprocess:_P,promise:wP,record:pP,set:mP,strictObject:oP,string:_x,symbol:JO,transformer:Cw,tuple:cP,undefined:XO,union:lP,unknown:aP,void:nP,NEVER:MP,ZodIssueCode:R,quotelessJson:AO,ZodError:ks}),iu=Wt.object({message:Wt.string()}),LP=iu.extend({validationErrors:Wt.array(Wt.string()).nonempty()}),Il=iu,EP=Il.extend({errorId:Wt.string(),uid:Wt.string().optional()});function Tx(t){return iu.extend({data:t})}var IP={400:Il.describe("Generic client error"),401:Il.describe("Authentication required but not provided or invalid"),403:Il.describe("Operation not permitted"),422:LP.describe("Request validation failed"),429:Il.describe("Rate limit exceeded"),500:EP.describe("Generic server error")};Wt.custom(t=>typeof t=="string"?/^\d+$/.test(t):!1);var $x=()=>Wt.string().regex(/^[a-zA-Z0-9_]+$/),xv=$x();$x().max(50);var Ax=Wt.object({name:Wt.string().regex(/^[0-9a-zA-Z_.-]+$/).max(20),enabled:Wt.boolean()}),Mx=Ax.extend({createdOn:Wt.number().min(0),modifiedOn:Wt.number().min(0),lastUsedOn:Wt.number().min(0).or(Wt.literal(-1))}),OP=Wt.record(xv,Mx),PP=Tx(OP),Lx=Ax,RP=Tx(Wt.object({apeKeyId:xv,apeKey:Wt.string().base64(),apeKeyDetails:Mx})),DP=Lx.partial(),Sw=Wt.object({apeKeyId:xv}),Tw=$O(),NP=Tw.router({get:{summary:"get ape keys",description:"Get ape keys of the current user.",method:"GET",path:"/",responses:{200:PP}},add:{summary:"add ape key",description:"Add an ape key for the current user.",method:"POST",path:"/",body:Lx.strict(),responses:{200:RP}},save:{summary:"update ape key",description:"Update an existing ape key for the current user.",method:"PATCH",path:"/:apeKeyId",pathParams:Sw,body:DP.strict(),responses:{200:iu}},delete:{summary:"delete ape key",description:"Delete ape key by id.",method:"DELETE",path:"/:apeKeyId",pathParams:Sw,body:Tw.noBody(),responses:{200:iu}}},{pathPrefix:"/ape-keys",strictStatusCodes:!0,metadata:{openApiTags:"ape-keys"},commonResponses:IP});const WP="",Zp=Qo.backendUrl,Ex=`${Zp}${WP}`,Fi=hk(Ex,1e4),Z={users:new Bn.Users(Fi),configs:Th(nI,Zp,1e4),results:new Bn.Results(Fi),psas:new Bn.Psas(Fi),quotes:new Bn.Quotes(Fi),leaderboards:new Bn.Leaderboards(Fi),presets:Th(_O,Zp,1e4),publicStats:new Bn.Public(Fi),apeKeys:Th(NP,Zp,1e4),configuration:new Bn.Configuration(Fi),dev:new Bn.Dev(hk(Ex,24e4))};async function rp(){}class Pn{constructor(e){this.name=e.name,this.element=e.element,this.pathname=e.path,this.beforeHide=e.beforeHide??rp,this.afterHide=e.afterHide??rp,this.beforeShow=e.beforeShow??rp,this.afterShow=e.afterShow??rp}}const Fm=new Map;function za(t,e=!0){const a=document.getElementById(t)??void 0;if(a===void 0)throw new Error(`Element with id ${t} not found`);Fm.set(t,a),e&&Aa(t)}function Aa(t){const e=Fm.get(t);e?e.remove():za(t,!0)}const BP={popups:document.getElementById("popups"),main:document.querySelector("main")};function ss(t,e){const a=Fm.get(t);BP[e].append(a)}function ZP(t){return Fm.has(t)}function Rs(t,e=!1){const a=e?100:1e3;i(".pageLoading .fill, .pageAccount .preloader .fill").stop(!0,e).animate({width:t+"%"},a)}function If(t){i(".pageLoading .text, .pageAccount .preloader .text").text(t)}async function Ix(){return new Promise(t=>{cr(i(".pageLoading .preloader .icon"),i(".pageLoading .preloader .barWrapper"),125,async()=>{t()}),cr(i(".pageAccount .preloader .icon"),i(".pageAccount .preloader .barWrapper"),125,async()=>{t()})})}const qP=new Pn({name:"loading",element:i(".page.pageLoading"),path:"/",afterHide:async()=>{Aa("pageLoading")},beforeShow:async()=>{ss("pageLoading","main")}}),ns={theme:"serika_dark",themeLight:"serika",themeDark:"serika_dark",autoSwitchTheme:!1,customTheme:!1,customThemeColors:["#323437","#e2b714","#e2b714","#646669","#2c2e31","#d1d0c5","#ca4754","#7e2a33","#ca4754","#7e2a33"],favThemes:[],showKeyTips:!0,smoothCaret:"medium",quickRestart:"off",punctuation:!1,numbers:!1,words:50,time:30,mode:"time",quoteLength:[1],language:"english",fontSize:2,freedomMode:!1,difficulty:"normal",blindMode:!1,quickEnd:!1,caretStyle:"default",paceCaretStyle:"default",flipTestColors:!1,layout:"default",funbox:"none",confidenceMode:"off",indicateTypos:"off",timerStyle:"mini",liveSpeedStyle:"off",liveAccStyle:"off",liveBurstStyle:"off",colorfulMode:!1,randomTheme:"off",timerColor:"main",timerOpacity:"1",stopOnError:"off",showAllLines:!1,keymapMode:"off",keymapStyle:"staggered",keymapLegendStyle:"lowercase",keymapLayout:"overrideSync",keymapShowTopRow:"layout",keymapSize:1,fontFamily:"Roboto_Mono",smoothLineScroll:!1,alwaysShowDecimalPlaces:!1,alwaysShowWordsHistory:!1,singleListCommandLine:"on",capsLockWarning:!0,playSoundOnError:"off",playSoundOnClick:"off",soundVolume:.5,startGraphsAtZero:!0,showOutOfFocusWarning:!0,paceCaret:"off",paceCaretCustomSpeed:100,repeatedPace:!0,accountChart:["on","on","on","on"],minWpm:"off",minWpmCustomSpeed:100,highlightMode:"letter",typingSpeedUnit:"wpm",ads:"result",hideExtraLetters:!1,strictSpace:!1,minAcc:"off",minAccCustom:90,monkey:!1,repeatQuotes:"off",oppositeShiftMode:"off",customBackground:"",customBackgroundSize:"cover",customBackgroundFilter:[0,1,1,1],customLayoutfluid:"qwerty#dvorak#colemak",monkeyPowerLevel:"off",minBurst:"off",minBurstCustomSpeed:100,burstHeatmap:!1,britishEnglish:!1,lazyMode:!1,showAverage:"off",tapeMode:"off",maxLineWidth:0},$w={results:void 0,personalBests:{time:{},words:{},quote:{},zen:{},custom:{}},name:"",email:"",uid:"",isPremium:!1,config:ns,customThemes:[],presets:[],tags:[],banned:void 0,verified:void 0,lbMemory:{time:{15:{english:0},60:{english:0}}},typingStats:{timeTyping:0,startedTests:0,completedTests:0},quoteRatings:void 0,quoteMod:!1,favoriteQuotes:{},addedAt:0,filterPresets:[],xp:0,inboxUnreadSize:0,streak:0,maxStreak:0,streakHourOffset:void 0,allTimeLbs:{time:{15:{english:{count:0,rank:0}},60:{english:{count:0,rank:0}}}}},Ox=[];function FP(t){Ox.push(t)}window.addEventListener("load",()=>{window.addEventListener("online",()=>{Aw(!0)}),window.addEventListener("offline",()=>{Aw(!1)})});function Aw(t){Ox.forEach(e=>{try{e(t)}catch(a){console.error("Connection event subscriber threw an error"),console.error(a)}})}let ys=!1,vr=!1,$t=!1,wa=null,Sc=!0,Hi=!1,Kg=1;function Px(t){ys=t}function jP(t){vr=t}function _v(t){$t=t}function Rx(t){wa=t}function fz(t){Sc=t}function Dx(t){Hi=t}function Cv(t){Kg=t}let ru=navigator.onLine;function xt(){return ru}let Yl,Vg=!1;function jm(){Vg||Yl===void 0&&(Yl=od("No internet connection",0,"exclamation-triangle",!1,()=>{Vg=!0,Yl=void 0}))}const HP=uv(1e4,()=>{ru?(h("You're back online",1,{customTitle:"Connection"}),Yl!==void 0&&i(`#bannerCenter .banner[id="${Yl}"] .closeButton`).trigger("click"),Vg=!1):$t||jm()});FP(t=>{ru=t,HP()});window.addEventListener("load",()=>{ru=navigator.onLine,ru||jm()});function zP(t){const e={};for(const a of pr(ns)){const s=t[a]??ns[a];e[a]=s}return e}class qp{constructor(e,a,s=!1){const n=new wl(a),r=this.getInterval(n,s);this.startDay=r.start,this.endDay=r.end,this.data=this.buildData(e,n),this.isFullYear=s}getInterval(e,a=!1){const s=a?RA(e):new Date;let n=DA(e);return a||(n=vg(NA(s,52),1),lw(n)||(n=dw(n))),{start:n,end:s}}buildData(e,a){const s=new Array(Math.max(0,386-e.length)).fill(void 0);s.push(...e);const n=Jr(this.endDay,this.startDay)+1,r=s.length-n+Jr(this.endDay,a);return s.slice(r)}getMonths(){const e=WA({start:this.startDay,end:this.endDay}),a=[];for(let s=0;s<e.length;s++){const n=e[s];let r=s===0?this.startDay:BA(n),o=s===e.length-1?this.endDay:ZA(r);lw(r)||(r=(s===0?dw:qA)(r)),FA(o)||(o=jA(o));const l=HA(o,r,{roundingMethod:"ceil"});l>2?a.push({text:nt(n,"MMM").toLowerCase(),weeks:l}):s==0&&a.push({text:"",weeks:l})}return a}getDays(){const e=[],a=this.getBuckets(),s=o=>{if(o===void 0||o===null||o===0)return"0";for(let l=0;l<4;l++)if(o<=(a[l]??0))return(1+l).toString();return"4"};for(let o=0;o<this.startDay.getDay();o++)e.push({level:"filler"});const n=Jr(this.endDay,this.startDay);let r=this.startDay;for(let o=0;o<=n;o++){const l=this.data[o],u=nt(r,"EEEE dd MMM yyyy");e.push({level:s(l),label:l!=null?`${l} ${l==1?"test":"tests"} on ${u}`:`no activity on ${u}`}),r=vg(r,1)}for(let o=this.endDay.getDay();o<6;o++)e.push({level:"filler"});return e}getTotalTests(){const e=Jr(this.endDay,this.startDay);return this.data.slice(0,e+1).reduce((a,s)=>(a??0)+(s??0),0)??0}getBuckets(){const a=this.data.filter(o=>o!=null).sort((o,l)=>o-l),s=a.slice(Math.round(a.length*.1),a.length-Math.round(a.length*.1)),r=s.reduce((o,l)=>o+l,0)/s.length;return[Math.floor(r/2),Math.round(r),Math.round(r*1.5)]}}class KP extends qp{constructor(e,a){super(e,a),this.lastDay=new wl(a)}increment(e){const a=new wl(e),s=new wl(this.lastDay);if(zA(a,s)){const n=this.data.length-1;this.data[n]=(this.data[n]||0)+1}else{if(KA(a,s))throw new Error("cannot alter data in the past.");{const n=Jr(a,s)-1;for(let o=0;o<n;o++)this.data.push(void 0);this.data.push(1);const r=this.getInterval(a);this.startDay=r.start,this.endDay=r.end,this.lastDay=a}}this.data=this.buildData(this.data,this.lastDay)}getFullYearCalendar(){const e=new Date;return this.lastDay.getFullYear()!==new wl(e).getFullYear()?new qp([],e,!0):new qp(this.data,this.lastDay,!0)}}let V;function S(){return V}function aa(t){const e=V==null?void 0:V.banned,a=V==null?void 0:V.verified,s=V==null?void 0:V.lbOptOut;try{t==null||delete t.banned}catch{}try{t==null||delete t.verified}catch{}try{t==null||delete t.lbOptOut}catch{}V=t,V&&(V.banned=e,V.verified=a,V.lbOptOut=s)}async function VP(){var e,a,s,n,r,o,l;const t={...$w};try{if(!ce())return!1;const[u,c,p]=await Promise.all([Z.users.getData(),Z.configs.get(),Z.presets.get()]);if(u.status!==200)throw{message:`${u.message} (user)`,responseCode:u.status};if(c.status!==200)throw{message:`${c.body.message} (config)`,responseCode:c.status};if(p.status!==200)throw{message:`${p.body.message} (presets)`,responseCode:p.status};const f=u.data,m=c.body.data,g=p.body.data;if(f===null)throw{message:"Request was successful but user data is null",responseCode:200};if(m!==null&&"config"in m)throw new Error("Config data is not in the correct format. Please refresh the page or contact support.");t.name=f.name,t.personalBests=f.personalBests,t.personalBests??(t.personalBests={time:{},words:{},quote:{},zen:{},custom:{}});for(const v of["time","words","quote","zen","custom"])(e=t.personalBests)[v]??(e[v]={});t.banned=f.banned,t.lbOptOut=f.lbOptOut,t.verified=f.verified,t.discordId=f.discordId,t.discordAvatar=f.discordAvatar,t.needsToChangeName=f.needsToChangeName,t.typingStats={timeTyping:f.timeTyping??0,startedTests:f.startedTests??0,completedTests:f.completedTests??0},t.quoteMod=f.quoteMod,t.favoriteQuotes=f.favoriteQuotes??{},t.quoteRatings=f.quoteRatings,t.details=f.profileDetails,t.addedAt=f.addedAt,t.inventory=f.inventory,t.xp=f.xp??0,t.inboxUnreadSize=f.inboxUnreadSize??0,t.streak=((a=f==null?void 0:f.streak)==null?void 0:a.length)??0,t.maxStreak=((s=f==null?void 0:f.streak)==null?void 0:s.maxLength)??0,t.filterPresets=f.resultFilterPresets??[],t.isPremium=f==null?void 0:f.isPremium,t.allTimeLbs=f.allTimeLbs,f.testActivity!==void 0&&(t.testActivity=new KP(f.testActivity.testsByDays,new Date(f.testActivity.lastDay)));const y=(n=f==null?void 0:f.streak)==null?void 0:n.hourOffset;if(t.streakHourOffset=y??void 0,f.lbMemory!==void 0&&(t.lbMemory=f.lbMemory),m==null?t.config={...ns}:t.config=zP(m),t.customThemes=f.customThemes??[],t.tags=((r=f.tags)==null?void 0:r.map(v=>({...v,display:v.name.replaceAll("_"," ")})))??[],t.tags=(o=t.tags)==null?void 0:o.sort((v,A)=>v.name>A.name?1:v.name<A.name?-1:0),g!=null){const v=g.map(A=>({...A,display:A.name.replace(/_/gi," ")}));t.presets=v,t.presets=(l=t.presets)==null?void 0:l.sort((A,W)=>A.name>W.name?1:A.name<W.name?-1:0)}return V=t,V}catch(u){throw V=$w,u}}async function Sv(t){var s;if(!ce()||!V||V.results!==void 0&&(t===void 0||V.results.length>t)||!xt())return!1;V.results===void 0&&(If("Downloading results..."),Rs(90));const e=await Z.results.get(t);if(e.status!==200)return h("Error getting results: "+e.message,-1),!1;const a=e.data;if(a==null||a.sort((n,r)=>r.timestamp-n.timestamp),a.forEach(n=>{n.bailedOut===void 0&&(n.bailedOut=!1),n.blindMode===void 0&&(n.blindMode=!1),n.lazyMode===void 0&&(n.lazyMode=!1),n.difficulty===void 0&&(n.difficulty="normal"),n.funbox===void 0&&(n.funbox="none"),(n.language===void 0||n.language===null)&&(n.language="english"),n.numbers===void 0&&(n.numbers=!1),n.punctuation===void 0&&(n.punctuation=!1),n.numbers===void 0&&(n.numbers=!1),n.quoteLength===void 0&&(n.quoteLength=-1),n.restartCount===void 0&&(n.restartCount=0),n.incompleteTestSeconds===void 0&&(n.incompleteTestSeconds=0),n.afkDuration===void 0&&(n.afkDuration=0),n.tags===void 0&&(n.tags=[]),n.correctChars!==void 0&&n.incorrectChars!==void 0&&(n.charStats=[n.correctChars,n.incorrectChars,0,0])}),V.results!==void 0&&V.results.length>0){const n=(s=mi(V.results))==null?void 0:s.timestamp,r=a.filter(o=>o.timestamp<n);V.results.push(...r)}else V.results=a;return!0}async function UP(t){if(!V)return!1;if(V.customThemes===void 0&&(V.customThemes=[]),V.customThemes.length>=10)return h("Too many custom themes!",0),!1;const e=await Z.users.addCustomTheme(t);if(e.status!==200)return h("Error adding custom theme: "+e.message,-1),!1;if(e.data===null)return h("Error adding custom theme: No data returned",-1),!1;const a={...t,_id:e.data._id};return V.customThemes.push(a),!0}async function GP(t,e){var r;if(!ce()||!V)return!1;V.customThemes===void 0&&(V.customThemes=[]);const a=(r=V.customThemes)==null?void 0:r.find(o=>o._id===t);if(!a)return h("Editing failed: Custom theme with id: "+t+" does not exist",-1),!1;const s=await Z.users.editCustomTheme(t,e);if(s.status!==200)return h("Error editing custom theme: "+s.message,-1),!1;const n={...e,_id:t};return V.customThemes[V.customThemes.indexOf(a)]=n,!0}async function QP(t){var s,n;if(!ce()||!V||!((s=V.customThemes)==null?void 0:s.find(r=>r._id===t)))return!1;const a=await Z.users.deleteCustomTheme(t);return a.status!==200?(h("Error deleting custom theme: "+a.message,-1),!1):(V.customThemes=(n=V.customThemes)==null?void 0:n.filter(r=>r._id!==t),!0)}async function Nx(t,e,a,s,n,r,o){const l=S();if(!l)return[0,0];function u(){var W;const p=[];(W=l==null?void 0:l.tags)==null||W.forEach($=>{$.active===!0&&p.push($._id)});let f=0,m=0,g=0,y=0,v=0,A=0;if((l==null?void 0:l.results)!==void 0){for(const $ of l.results)if($.mode===t&&($.punctuation??!1)===a&&($.numbers??!1)===s&&$.language===n&&$.difficulty===r&&($.lazyMode===o||$.lazyMode===void 0&&!o)&&(p.length===0||p.some(se=>$.tags.includes(se)))){if(`${$.mode2}`!=`${e}`&&t!=="quote")continue;if(A<10&&(g+=$.wpm,y+=$.acc,A++),`${$.mode2}`==`${e}`&&(f+=$.wpm,m+=$.acc,v++,v>=10))break}}return v===0&&t==="quote"?[g/A,y/A]:[f/v,m/v]}return l===null||await Sv()===null?[0,0]:u()}async function YP(t,e,a,s,n,r,o){const l=S();if(!l)return 0;function u(){var m;const p=[];(m=l==null?void 0:l.tags)==null||m.forEach(g=>{g.active===!0&&p.push(g._id)});let f=0;if((l==null?void 0:l.results)!==void 0){for(const g of l.results)if(g.mode===t&&(g.punctuation??!1)===a&&(g.numbers??!1)===s&&g.language===n&&g.difficulty===r&&(g.lazyMode===o||g.lazyMode===void 0&&!o)&&(p.length===0||p.some(y=>g.tags.includes(y)))){if(g.timestamp<Date.now()-864e5||`${g.mode2}`!=`${e}`&&t!=="quote")continue;g.wpm>f&&(f=g.wpm)}}return f}return l===null||await Sv()===null?0:u()}async function JP(t,e,a,s,n,r,o){const l=S();if(!l)return 0;let u=0;for(const c of l.tags){if(!c.active)continue;const p=await Wx(c._id,t,e,a,s,n,r,o);p>u&&(u=p)}return u}async function Of(t,e,a,s,n,r,o,l){var p;if(!(await yc()).filter(f=>l==null?void 0:l.split("#").includes(f.name)).every(f=>f.canGetPb)||V===null||(V==null?void 0:V.personalBests)===null)return 0;const c=V==null?void 0:V.personalBests[t][e];return c===void 0?0:((p=c.find(f=>(f.punctuation??!1)===a&&(f.numbers??!1)===s&&f.difficulty===r&&f.language===n&&(f.lazyMode??!1)===o))==null?void 0:p.wpm)??0}async function XP(t,e,a,s,n,r,o,l,u,c,p){if(t==="quote"||!V)return;function f(){var g,y;if(!V)return;let m=!1;V.personalBests??(V.personalBests={time:{},words:{},quote:{},zen:{},custom:{}}),(g=V.personalBests)[t]??(g[t]={[e]:[]}),(y=V.personalBests[t])[e]??(y[e]=[]),V.personalBests[t][e].forEach(v=>{(v.punctuation??!1)===a&&(v.numbers??!1)===s&&v.difficulty===r&&v.language===n&&(v.lazyMode??!1)===o&&(m=!0,v.wpm=l,v.acc=u,v.raw=c,v.timestamp=Date.now(),v.consistency=p,v.lazyMode=o)}),m||V.personalBests[t][e].push({language:n,difficulty:r,lazyMode:o,punctuation:a,numbers:s,wpm:l,acc:u,raw:c,timestamp:Date.now(),consistency:p})}V!==null&&f()}async function Wx(t,e,a,s,n,r,o,l){var f,m,g,y;if(V===null)return 0;let u=0;const c=(((f=S())==null?void 0:f.tags)??[]).filter(v=>v._id===t)[0];return c===void 0||(c.personalBests??(c.personalBests={time:{},words:{},quote:{},zen:{},custom:{}}),(m=c.personalBests)[e]??(m[e]={[a]:[]}),(g=c.personalBests[e])[a]??(g[a]=[]),u=((y=(c.personalBests[e][a]??[]).find(v=>(v.punctuation??!1)===s&&(v.numbers??!1)===n&&v.difficulty===o&&v.language===r&&(v.lazyMode===l||v.lazyMode===void 0&&!l)))==null?void 0:y.wpm)??0),u}async function eR(t,e,a,s,n,r,o,l,u,c,p,f){if(!V||e==="quote")return;function m(){var y,v,A;const g=(y=V==null?void 0:V.tags)==null?void 0:y.filter(W=>W._id===t)[0];g.personalBests??(g.personalBests={time:{},words:{},quote:{},zen:{},custom:{}}),(v=g.personalBests)[e]??(v[e]={[a]:[]}),(A=g.personalBests[e])[a]??(A[a]=[]);try{let W=!1;g.personalBests[e][a].forEach($=>{($.punctuation??!1)===s&&($.numbers??!1)===n&&$.difficulty===o&&$.language===r&&($.lazyMode===l||$.lazyMode===void 0&&!l)&&(W=!0,$.wpm=u,$.acc=c,$.raw=p,$.timestamp=Date.now(),$.consistency=f,$.lazyMode=l)}),W||g.personalBests[e][a].push({language:r,difficulty:o,lazyMode:l,punctuation:s,numbers:n,wpm:u,acc:c,raw:p,timestamp:Date.now(),consistency:f})}catch{g.personalBests={time:{},words:{},quote:{},zen:{},custom:{}},g.personalBests[e][a]=[{language:r,difficulty:o,lazyMode:l,punctuation:s,numbers:n,wpm:u,acc:c,raw:p,timestamp:Date.now(),consistency:f}]}}V!==null&&m()}async function Mw(t,e,a,s,n=!1){var r,o,l;{const u=t,c=e,p=S();if(!p)return;p.lbMemory===void 0&&(p.lbMemory={time:{15:{english:0},60:{english:0}}}),p.lbMemory[u]===void 0&&(p.lbMemory[u]={15:{english:0},60:{english:0}}),p.lbMemory[u][c]===void 0&&(p.lbMemory[u][c]={});const f=(l=(o=(r=p.lbMemory)==null?void 0:r[u])==null?void 0:o[c])==null?void 0:l[a],m=p.lbMemory[u][c];m[a]=s,n&&f!==s&&await Z.users.updateLeaderboardMemory(t,e,a,s),aa(p)}}async function Bx(t){if(ce()){const e=await Z.configs.save({body:t});e.status!==200&&h("Failed to save config: "+e.body.message,-1)}}async function tR(){if(ce()){const t=await Z.configs.delete();t.status!==200&&h("Failed to reset config: "+t.body.message,-1)}}function Tv(t){const e=S();e&&((e==null?void 0:e.results)!==void 0&&(e.results.unshift(t),aa(e)),e.testActivity!==void 0&&(e.testActivity.increment(new Date(t.timestamp)),aa(e)))}function $v(t,e){const a=S();a&&(a.typingStats===void 0&&(a.typingStats={timeTyping:0,startedTests:0,completedTests:0}),a.typingStats.timeTyping+=e,a.typingStats.startedTests+=t,a.typingStats.completedTests+=1,aa(a))}function Zx(t){const e=S();e&&(e.xp===void 0&&(e.xp=0),e.xp+=t,aa(e))}function aR(t){const e=S();e&&(e.inventory===void 0&&(e.inventory={badges:[]}),e.inventory.badges.push(t),aa(e))}function sR(t){const e=S();e&&(e.streak=t,e.streak>e.maxStreak&&(e.maxStreak=e.streak),aa(e))}async function nR(t){var a;if(!ce()||V===void 0)return;if(t==="current")return V.testActivity;const e=new Date().getFullYear().toString();if(t===e)return(a=V.testActivity)==null?void 0:a.getFullYearCalendar();if(V.testActivityByYear===void 0){if(!xt())return;Je();const s=await Z.users.getTestActivity();if(s.status!==200){h("Error getting test activities: "+s.message,-1),Te();return}V.testActivityByYear={};for(const n in s.data){if(n===e)continue;const r=s.data[n]??[],o=vg(new Date(parseInt(n),0,1),r.length);V.testActivityByYear[n]=new qp(r,o,!0)}Te()}return V.testActivityByYear[t]}const qx=[];function Tc(){i("#words, #koInputVisualContainer").css("transition","none").removeClass("blurred"),i(".outOfFocusWarning").addClass("hidden"),dA(qx)}function iR(){qx.push(setTimeout(()=>{i("#words, #koInputVisualContainer").css("transition","0.25s").addClass("blurred"),i(".outOfFocusWarning").removeClass("hidden")},1e3))}function Fx(t,e,a){a===void 0?h(`Invalid value for ${t} (${e}). Please try to change this setting again.`,-1):h(`Invalid value for ${t} (${e}). ${a}`,-1),console.error(`Invalid value key ${t} value ${e} type ${typeof e}`)}function ee(t,e,a){const s=a.safeParse(e).success;return s||Fx(t,e,void 0),s}function it(t,e){return ee(t,e,VA.boolean())}async function rR(t,e,a){let s=!1,n;for(const r of a)switch(r){case"layoutfluid":{if(typeof e!="string")break;const o=e.split(/[# ]+/);if(o.length<2||o.length>5)break;try{await Wm()}catch(u){n=Re(u,"Failed to validate layoutfluid value");break}const l=await Promise.all(o.map(async u=>vc(u)));if(!l.every(u=>u!==void 0)){n=`The following inputted layouts do not exist: ${o.map((p,f)=>[p,l[f]]).filter(([p,f])=>f===void 0).map(([p])=>p).join(", ")}`;break}s=!0;break}}return s||Fx(t,e,n),s}const jx=[];function mt(t){jx.push(t)}function L(t,e,a,s,n){jx.forEach(r=>{try{r(t,e,a,s,n)}catch(o){console.error("Config event subscriber threw an error"),console.error(o)}})}let Ug;async function _n(t,e){try{QA(Ug,t,e)}catch{console.log("Analytics unavailable")}}const op=localStorage.getItem("acceptedCookies");let Pf;op!=null&&op!==""?Pf=JSON.parse(op):Pf=null;Pf!==null&&Pf.analytics&&Gg();function Gg(){try{Ug=UA(TM),GA(Ug,!0),i("body").append(`
    <script
    async
    src="https://www.googletagmanager.com/gtag/js?id=UA-165993088-1"
  ><\/script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() {
      dataLayer.push(arguments);
    }
    gtag("js", new Date());

    gtag("config", "UA-165993088-1");
  <\/script>`)}catch(t){console.error(Re(t,"Failed to activate analytics"))}}function Hx(t){return Math.floor((Math.sqrt(392*t+22801)-53)/98)}function oR(t){return 49*(t-1)+100}function lR(t){return(49*Math.pow(t,2)+53*t-102)/2}function Rf(t){const e=Hx(t);return{level:e,levelCurrentXp:t-lR(e),levelMaxXp:oR(e)}}let na={bg:"#323437",main:"#e2b714",caret:"#e2b714",sub:"#646669",subAlt:"#2c2e31",text:"#d1d0c5",error:"#ca4754",errorExtra:"#7e2a33",colorfulError:"#ca4754",colorfulErrorExtra:"#7e2a33"};async function Za(t){return na[t]||$c(),na[t]}async function Oi(){return na.bg||$c(),na}function dR(){na={bg:"",main:"",caret:"",sub:"",subAlt:"",text:"",error:"",errorExtra:"",colorfulError:"",colorfulErrorExtra:""}}function $c(){const t=getComputedStyle(document.body);na.bg=t.getPropertyValue("--bg-color").replace(" ",""),na.main=t.getPropertyValue("--main-color").replace(" ",""),na.caret=t.getPropertyValue("--caret-color").replace(" ",""),na.sub=t.getPropertyValue("--sub-color").replace(" ",""),na.subAlt=t.getPropertyValue("--sub-alt-color").replace(" ",""),na.text=t.getPropertyValue("--text-color").replace(" ",""),na.error=t.getPropertyValue("--error-color").replace(" ",""),na.errorExtra=t.getPropertyValue("--error-extra-color").replace(" ",""),na.colorfulError=t.getPropertyValue("--colorful-error-color").replace(" ",""),na.colorfulErrorExtra=t.getPropertyValue("--colorful-error-extra-color").replace(" ","")}let Df=!1;function uR(){Df||(Df=!0,console.error("Slow timer, disabling animations"))}function ou(){Df=!1}function Ct(){return Df}let Qg=!1,Ga=!1;function zx(){Ga=!0}function Ja(t){t?(i("header nav .account").css("opacity",1).css("pointer-events","none"),Qg?(i("header nav .account .loading").css("opacity",1).removeClass("hidden"),i("header nav .account .avatar").stop(!0,!0).css({opacity:1}).animate({opacity:0},100,()=>{i("header nav .account .avatar").addClass("hidden")})):(i("header nav .account .loading").stop(!0,!0).removeClass("hidden").css({opacity:0}).animate({opacity:1},100),i("header nav .account .user").stop(!0,!0).css({opacity:1}).animate({opacity:0},100,()=>{i("header nav .account .user").addClass("hidden")}))):(i("header nav .account").css("opacity",1).css("pointer-events","auto"),Qg?(i("header nav .account .loading").css("opacity",1).addClass("hidden"),i("header nav .account .avatar").stop(!0,!0).removeClass("hidden").css({opacity:0}).animate({opacity:1},100)):(i("header nav .account .loading").stop(!0,!0).css({opacity:1}).animate({opacity:0},100,()=>{i("header nav .account .loading").addClass("hidden")}),i("header nav .account .user").stop(!0,!0).removeClass("hidden").css({opacity:0}).animate({opacity:1},100)))}async function Hm(t,e,a){if(ce()){if(t!==void 0){const s=Rf(t),n=s.levelCurrentXp/s.levelMaxXp;i("header nav .level").text(s.level),i("header nav .bar").css({width:n*100+"%"})}(a??"")&&(e??"")?nv(e,a).then(s=>{s!==null&&(i("header nav .account .avatar").css("background-image",`url(${s})`),Qg=!0,i("header nav .account .user").addClass("hidden"),i("header nav .account .avatar").removeClass("hidden"))}):(i("header nav .account .avatar").addClass("hidden"),i("header nav .account .user").removeClass("hidden")),i("nav .textButton.account").removeClass("hidden").css({opacity:0}).animate({opacity:1},125)}else i("nav .textButton.account").css({opacity:1}).animate({opacity:0},125,()=>{i("nav .textButton.account").addClass("hidden")})}async function Kx(t,e,a){Ga=!1;const s=Rf(t),n=Rf(t+e),r=s.level+s.levelCurrentXp/s.levelMaxXp,o=n.level+n.levelCurrentXp/n.levelMaxXp,l=S();if(l){if(!Ga){const u=pR(r,o),c=cR(e,a);await Promise.all([u,c]),await vt(2e3)}i("nav .level").text(Hx(l.xp)),i("nav .xpBar").stop(!0,!0).css("opacity",1).animate({opacity:0},Ct()?0:250,()=>{i("nav .xpBar .xpGain").text("")})}}async function cR(t,e){if(!e){i("nav .xpBar .xpGain").text(`+${t}`);return}const a=1e3;let s=0;const n=i("nav .xpBar .xpGain"),r=i("nav .xpBar .xpBreakdown");r.empty();async function o(l){Ga&&(s=t,l=""),r.find(".next").removeClass("next").addClass("previous"),r.append(`<div class='text next' style="opacity: 0; margin-top: 1rem;">${l}</div>`);const u=r.find(".previous");u.animate({marginTop:"-1rem",opacity:0},Ct()?0:250,()=>{u.remove()}),setTimeout(()=>{n.stop(!0,!0).text(`+${s}`).css({borderSpacing:100}).animate({borderSpacing:0},{step(c){n.css("transform",`scale(${1+c/300}) translateY(-50%)`)},duration:Ct()?0:250,easing:"swing"})},125),await Hr(r.find(".next"),{opacity:"1",marginTop:"0"},Ct()?0:250,"swing")}n.text("+0"),r.append(`<div class='text next'>time typing +${e.base}</div>`),s+=e.base??0,e["100%"]?(await vt(a),await o(`perfect +${e["100%"]}`),s+=e["100%"]):e.corrected&&(await vt(a),await o(`clean +${e.corrected}`),s+=e.corrected),!Ga&&(e.quote?(await vt(a),await o(`quote +${e.quote}`),s+=e.quote):(e.punctuation&&(await vt(a),await o(`punctuation +${e.punctuation}`),s+=e.punctuation),e.numbers&&(await vt(a),await o(`numbers +${e.numbers}`),s+=e.numbers)),!Ga&&(e.funbox&&(await vt(a),await o(`funbox +${e.funbox}`),s+=e.funbox),!Ga&&(e.streak&&(await vt(a),await o(`streak +${e.streak}`),s+=e.streak),!Ga&&(e.accPenalty&&(await vt(a),await o(`accuracy penalty -${e.accPenalty}`),s-=e.accPenalty),!Ga&&(e.incomplete&&(await vt(a),await o(`incomplete tests +${e.incomplete}`),s+=e.incomplete),!Ga&&(e.configMultiplier&&(await vt(a),await o(`global multiplier x${e.configMultiplier}`),s*=e.configMultiplier),!Ga&&(e.daily&&(await vt(a),await o(`daily bonus +${e.daily}`),s+=e.daily),!Ga&&(await vt(a),await o("")))))))))}async function pR(t,e){const a=e-t;i("nav .xpBar").stop(!0,!0).css("opacity",0),await Hr(i("nav .xpBar"),{opacity:"1"},Ct()?0:250,"linear");const s=i("nav .xpBar .bar");if(s.css("width",`${t%1*100}%`),e%1===0)await Hr(s,{width:"100%"},Ct()?0:1e3,"easeOutExpo"),Fh(),s.css("width","0%");else if(Math.floor(t)===Math.floor(e))await Hr(s,{width:`${e%1*100}%`},Ct()?0:1e3,"easeOutExpo");else{const n=Math.min(1e3/a,200);let r=a,o=!1,l=n,u="linear",c=1-t%1;do r-1<1&&(l=af(r-1,0,.5,1e3,200),u="easeOutQuad"),o&&(Fh(),s.css("width","0%"),c=1),await Hr(s,{width:"100%"},Ct()?0:l,u),r-=c,o=!0;while(r>1);Fh(),s.css("width","0%"),await Hr(s,{width:`${r%1*100}%`},Ct()?0:1e3,"easeOutExpo")}}async function Fh(){const t=await Oi(),e=i("nav .level");e.text(parseInt(e.text())+1);const a=Math.random()*2-1,s=Math.random()+1;e.stop(!0,!0).css({backgroundColor:t.main,borderSpacing:100,transition:"initial"}).animate({backgroundColor:t.sub,borderSpacing:0},{step(n){e.css("transform",`scale(${1+n/200*s}) rotate(${n/10*a}deg)`)},duration:2e3,easing:"easeOutCubic",complete:()=>{e.css({backgroundColor:"",transition:""})}})}const Av=[{name:"nausea",info:"I think I'm gonna be sick.",hasCSS:!0},{name:"round_round_baby",info:"...right round, like a record baby. Right, round round round.",hasCSS:!0},{name:"simon_says",info:"Type what simon says.",properties:["changesWordsVisibility","usesLayout"],forcedConfig:{highlightMode:["letter","off"]},hasCSS:!0},{name:"mirror",info:"Everything is mirrored!",hasCSS:!0},{name:"upside_down",info:"Everything is upside down!",hasCSS:!0},{name:"tts",info:"Listen closely.",properties:["changesWordsVisibility","speaks"],forcedConfig:{highlightMode:["letter","off"]},hasCSS:!0},{name:"choo_choo",info:"All the letters are spinning!",properties:["noLigatures","conflictsWithSymmetricChars"],hasCSS:!0},{name:"arrows",info:"Play it on a pad!",properties:["ignoresLanguage","ignoresLayout","nospace","noLetters","symmetricChars"],forcedConfig:{punctuation:[!1],numbers:[!1],highlightMode:["letter","off"]}},{name:"rAnDoMcAsE",info:"I kInDa LiKe HoW iNeFfIcIeNt QwErTy Is.",properties:["changesCapitalisation"]},{name:"capitals",info:"Capitalize Every Word.",properties:["changesCapitalisation"]},{name:"layoutfluid",info:"Switch between layouts specified below proportionately to the length of the test.",properties:["changesLayout","noInfiniteDuration"]},{name:"earthquake",info:"Everybody get down! The words are shaking!",properties:["noLigatures"],hasCSS:!0},{name:"space_balls",info:"In a galaxy far far away.",hasCSS:!0},{name:"gibberish",info:"Anvbuefl dizzs eoos alsb?",properties:["ignoresLanguage","unspeakable"]},{name:"58008",alias:"numbers",info:"A special mode for accountants.",properties:["ignoresLanguage","ignoresLayout","noLetters"],forcedConfig:{numbers:[!1]}},{name:"ascii",info:"Where was the ampersand again?. Only ASCII characters.",properties:["ignoresLanguage","noLetters","unspeakable"],forcedConfig:{numbers:[!1]}},{name:"specials",info:"!@#$%^&*. Only special characters.",properties:["ignoresLanguage","noLetters","unspeakable"],forcedConfig:{punctuation:[!1],numbers:[!1]}},{name:"plus_zero",info:"React quickly! Only the current word is visible.",properties:["changesWordsVisibility","toPush:1","noInfiniteDuration"]},{name:"plus_one",info:"Only one future word is visible.",properties:["changesWordsVisibility","toPush:2","noInfiniteDuration"]},{name:"plus_two",info:"Only two future words are visible.",properties:["changesWordsVisibility","toPush:3","noInfiniteDuration"]},{name:"plus_three",info:"Only three future words are visible.",properties:["changesWordsVisibility","toPush:4","noInfiniteDuration"]},{name:"read_ahead_easy",info:"Only the current word is invisible.",properties:["changesWordsVisibility"],forcedConfig:{highlightMode:["letter","off"]},hasCSS:!0},{name:"read_ahead",info:"Current and the next word are invisible!",properties:["changesWordsVisibility"],forcedConfig:{highlightMode:["letter","off"]},hasCSS:!0},{name:"read_ahead_hard",info:"Current and the next two words are invisible!",properties:["changesWordsVisibility"],forcedConfig:{highlightMode:["letter","off"]},hasCSS:!0},{name:"memory",info:"Test your memory. Remember the words and type them blind.",properties:["changesWordsVisibility","noInfiniteDuration"],forcedConfig:{mode:["words","quote","custom"]}},{name:"nospace",info:"Whoneedsspacesanyway?",properties:["nospace"],forcedConfig:{highlightMode:["letter","off"]}},{name:"poetry",info:"Practice typing some beautiful prose.",properties:["noInfiniteDuration","ignoresLanguage"],forcedConfig:{punctuation:[!1],numbers:[!1]}},{name:"wikipedia",info:"Practice typing wikipedia sections.",properties:["noInfiniteDuration","ignoresLanguage"],forcedConfig:{punctuation:[!1],numbers:[!1]}},{name:"weakspot",info:"Focus on slow and mistyped letters.",properties:["changesWordsFrequency"]},{name:"pseudolang",info:"Nonsense words that look like the current language.",properties:["unspeakable","ignoresLanguage"]},{name:"IPv4",alias:"network",info:"For sysadmins.",properties:["ignoresLanguage","ignoresLayout","noLetters"],forcedConfig:{numbers:[!1]}},{name:"IPv6",alias:"network",info:"For sysadmins with a long beard.",properties:["ignoresLanguage","ignoresLayout","noLetters"],forcedConfig:{numbers:[!1]}},{name:"binary",alias:"numbers",info:"01000010 01100101 01100101 01110000 00100000 01100010 01101111 01101111 01110000 00101110",properties:["ignoresLanguage","ignoresLayout","noLetters"],forcedConfig:{numbers:[!1],punctuation:[!1]}},{name:"zipf",alias:"frequency",info:"Words are generated according to Zipf's law. (not all languages will produce Zipfy results, use with caution)",properties:["changesWordsFrequency"]},{name:"morse",info:"-.../././.--./ -.../---/---/.--./-.-.--/ ",properties:["ignoresLanguage","ignoresLayout","noLetters","nospace"]},{name:"crt",info:"Go back to the 1980s",properties:["noLigatures"]},{name:"backwards",info:"...sdrawkcab epyt ot yrt woN",properties:["noLigatures","conflictsWithSymmetricChars","wordOrder:reverse"]},{name:"ddoouubblleedd",info:"TTyyppee eevveerryytthhiinngg ttwwiiccee..",properties:["noLigatures"]}];function fR(){return Av}function Ae(t){const e=[];for(const a of t.split("#")){const s=Av.find(n=>n.name===a);s&&e.push(s)}return e}function ot(t,e){const a=Av.find(s=>s.name===t);if(!a)throw new Error(`Funbox ${t} not found.`);a.functions=e}function mR(t){return t.normalize("NFD").replace(/[\u0300-\u036f]/g,"")}function Vx(t){return t.replace(/([A-Z])/g," $1").trim().toLowerCase()}function Ux(t){try{return t.charAt(t.length-1)}catch{return""}}function Lw(t,e,a){return e>t.length-1?t:t.substring(0,e)+a+t.substring(e+1)}function Ac(t){return t.split(/ +/).map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" ")}function Ao(t){return t.charAt(0).toUpperCase()+t.slice(1)}function hR(t,e){const a=[];let s=[];const n=new Set(e);for(const r of t)n.has(r)?(s.length>0&&a.push(s.join("")),a.push(r),s=[]):s.push(r);return s.length>0&&a.push(s.join("")),a}function ki(t,e=!1){let a="";return e?a=Ds(t):a=t,a.replace(/_/g," ")}function Ds(t){return t.replace(/_\d*k$/g,"")}function Gx(t){const e={"":'"',"":'"',"":'"',"":"'","":"'",",":",","":"-","":"...","":"<<","":">>","":"-","":" ","":" ","":" "};return t.replace(/[,\u2007\u202F\u00A0]/g,a=>e[a]||"")}function Yg(t,e,a){var s;if(Ae(a).length===0)return{result:!0};if(t==="words"||t==="time")return e===0?(a==="nospace"&&console.log("break"),Ae(a).filter(r=>{var o;return(o=r.properties)==null?void 0:o.includes("noInfiniteDuration")}).length>0?{result:!1,forcedConfigs:[t==="words"?10:15]}:{result:!0}):{result:!0};{const n={};for(const r of Ae(a))if(r.forcedConfig)for(const o in r.forcedConfig)n[o]===void 0?n[o]=r.forcedConfig[o]:n[o]=Q0(n[o],r.forcedConfig[o],!0);if(n[t]===void 0)return{result:!0};if(((s=n[t])==null?void 0:s.length)===0)throw new Error("No intersection of forced configs");return{result:(n[t]??[]).includes(e),forcedConfigs:n[t]}}}function Lr(t,e,a,s=!1){let n=0;if(t==="mode"){let r=[];r=r.concat(Ae(a).filter(o=>{var l,u;return((l=o.forcedConfig)==null?void 0:l.mode)!==void 0&&!((u=o.forcedConfig)!=null&&u.mode.includes(e))})),e==="zen"&&(r=r.concat(Ae(a).filter(o=>{var l,u,c,p,f,m,g,y,v,A,W;return((l=o.functions)==null?void 0:l.getWord)??((u=o.functions)==null?void 0:u.pullSection)??((c=o.functions)==null?void 0:c.alterText)??((p=o.functions)==null?void 0:p.withWords)??((f=o.properties)==null?void 0:f.includes("changesCapitalisation"))??((m=o.properties)==null?void 0:m.includes("nospace"))??((g=o.properties)==null?void 0:g.find($=>$.startsWith("toPush:")))??((y=o.properties)==null?void 0:y.includes("changesWordsVisibility"))??((v=o.properties)==null?void 0:v.includes("speaks"))??((A=o.properties)==null?void 0:A.includes("changesLayout"))??((W=o.properties)==null?void 0:W.includes("changesWordsFrequency"))}))),(e==="quote"||e==="custom")&&(r=r.concat(Ae(a).filter(o=>{var l,u,c,p;return((l=o.functions)==null?void 0:l.getWord)??((u=o.functions)==null?void 0:u.pullSection)??((c=o.functions)==null?void 0:c.withWords)??((p=o.properties)==null?void 0:p.includes("changesWordsFrequency"))}))),r.length>0&&(n+=1)}if(t==="words"||t==="time"){if(!Yg(t,e,a).result)if(s)n+=1;else return h("Active funboxes do not support infinite tests",0),!1}else Yg(t,e,a).result||(n+=1);return n>0?(s||h(`You can't set ${Vx(t)} to ${e.toString()} with currently active funboxes.`,0,{duration:5}),!1):!0}function Qx(t,e){console.log("cansetfunboxwithconfig",t,e.mode);let a=e.funbox;a==="none"?a=t:a+="#"+t;const s=[];for(const[n,r]of Object.entries(e))Lr(n,r,a,!0)||s.push({key:n,value:r});if(s.length>0){const n=[];for(const r of s)n.push(`${Ao(Vx(r.key))} cannot be set to ${r.value.toString()}.`);return h(`You can't enable ${t.replace(/_/g," ")}:<br>${n.join("<br>")}`,0,{duration:5,allowHTML:!0}),!1}else return!0}function Mv(t,e){if(e==="none"||t==="none")return!0;let a=Ae(t);e!==void 0&&(a=a.concat(fR().filter(b=>b.name===e)));const s=Ae(t).filter(b=>t.split("#").find(w=>w===b.name)!==void 0).length===t.split("#").length,n=a.filter(b=>{var w,q,me;return((w=b.functions)==null?void 0:w.getWord)??((q=b.functions)==null?void 0:q.pullSection)??((me=b.functions)==null?void 0:me.withWords)}).length<=1,r=a.filter(b=>{var w;return(w=b.properties)==null?void 0:w.find(q=>q==="changesLayout")}).length===0||a.filter(b=>{var w;return(w=b.properties)==null?void 0:w.find(q=>q==="ignoresLayout"||q==="usesLayout")}).length===0,o=a.filter(b=>{var w;return(w=b.properties)==null?void 0:w.find(q=>q==="nospace"||q.startsWith("toPush"))}).length<=1,l=a.filter(b=>{var w;return(w=b.properties)==null?void 0:w.find(q=>q==="changesWordsVisibility")}).length<=1,u=a.filter(b=>{var w;return(w=b.properties)==null?void 0:w.find(q=>q==="changesWordsFrequency")}).length<=1,c=a.filter(b=>{var w;return(w=b.properties)==null?void 0:w.find(q=>q==="changesWordsFrequency")}).length===0||a.filter(b=>{var w;return(w=b.properties)==null?void 0:w.find(q=>q==="ignoresLanguage")}).length===0,p=a.filter(b=>{var w;return(w=b.properties)==null?void 0:w.find(q=>q==="noLetters")}).length===0||a.filter(b=>{var w;return(w=b.properties)==null?void 0:w.find(q=>q==="changesCapitalisation")}).length===0,f=a.filter(b=>{var w;return(w=b.properties)==null?void 0:w.find(q=>q==="conflictsWithSymmetricChars")}).length===0||a.filter(b=>{var w;return(w=b.properties)==null?void 0:w.find(q=>q==="symmetricChars")}).length===0,m=a.filter(b=>{var w;return(w=b.properties)==null?void 0:w.find(q=>q==="speaks")}).length<=1,g=a.filter(b=>{var w;return(w=b.properties)==null?void 0:w.find(q=>q==="speaks")}).length===0||a.filter(b=>{var w;return(w=b.properties)==null?void 0:w.find(q=>q==="speaks")}).length===1&&a.filter(b=>{var w;return(w=b.properties)==null?void 0:w.find(q=>q==="unspeakable")}).length===0||a.filter(b=>{var w;return(w=b.properties)==null?void 0:w.find(q=>q==="ignoresLanguage")}).length===0,y=a.filter(b=>{var w,q;return(((w=b.properties)==null?void 0:w.find(me=>me.startsWith("toPush:")))??"")||((q=b.functions)==null?void 0:q.pullSection)}).length<=1,v=a.filter(b=>b.hasCSS==!0).length<=1,A=a.filter(b=>{var w;return(w=b.functions)==null?void 0:w.punctuateWord}).length<=1,W=a.filter(b=>{var w;return(w=b.functions)==null?void 0:w.isCharCorrect}).length<=1,$=a.filter(b=>{var w;return(w=b.functions)==null?void 0:w.getWordHtml}).length<=1,se={};let te=!0;for(const b of a)if(b.forcedConfig)for(const w in b.forcedConfig)if(se[w]){if(Q0(se[w],b.forcedConfig[w],!0).length===0){te=!1;break}}else se[w]=b.forcedConfig[w];return s&&n&&r&&o&&l&&u&&c&&p&&f&&m&&g&&y&&v&&A&&W&&$&&te}var Qe;(function(t){t.assertEqual=n=>n;function e(n){}t.assertIs=e;function a(n){throw new Error}t.assertNever=a,t.arrayToEnum=n=>{let r={};for(let o of n)r[o]=o;return r},t.getValidEnumValues=n=>{let r=t.objectKeys(n).filter(l=>typeof n[n[l]]!="number"),o={};for(let l of r)o[l]=n[l];return t.objectValues(o)},t.objectValues=n=>t.objectKeys(n).map(function(r){return n[r]}),t.objectKeys=typeof Object.keys=="function"?n=>Object.keys(n):n=>{let r=[];for(let o in n)Object.prototype.hasOwnProperty.call(n,o)&&r.push(o);return r},t.find=(n,r)=>{for(let o of n)if(r(o))return o},t.isInteger=typeof Number.isInteger=="function"?n=>Number.isInteger(n):n=>typeof n=="number"&&isFinite(n)&&Math.floor(n)===n;function s(n,r=" | "){return n.map(o=>typeof o=="string"?`'${o}'`:o).join(r)}t.joinValues=s,t.jsonStringifyReplacer=(n,r)=>typeof r=="bigint"?r.toString():r})(Qe||(Qe={}));var Jg;(function(t){t.mergeShapes=(e,a)=>({...e,...a})})(Jg||(Jg={}));var J=Qe.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Xn=t=>{switch(typeof t){case"undefined":return J.undefined;case"string":return J.string;case"number":return isNaN(t)?J.nan:J.number;case"boolean":return J.boolean;case"function":return J.function;case"bigint":return J.bigint;case"symbol":return J.symbol;case"object":return Array.isArray(t)?J.array:t===null?J.null:t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?J.promise:typeof Map<"u"&&t instanceof Map?J.map:typeof Set<"u"&&t instanceof Set?J.set:typeof Date<"u"&&t instanceof Date?J.date:J.object;default:return J.unknown}},D=Qe.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),gR=t=>JSON.stringify(t,null,2).replace(/"([^"]+)":/g,"$1:"),xs=class Yx extends Error{constructor(e){super(),this.issues=[],this.addIssue=s=>{this.issues=[...this.issues,s]},this.addIssues=(s=[])=>{this.issues=[...this.issues,...s]};let a=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,a):this.__proto__=a,this.name="ZodError",this.issues=e}get errors(){return this.issues}format(e){let a=e||function(r){return r.message},s={_errors:[]},n=r=>{for(let o of r.issues)if(o.code==="invalid_union")o.unionErrors.map(n);else if(o.code==="invalid_return_type")n(o.returnTypeError);else if(o.code==="invalid_arguments")n(o.argumentsError);else if(o.path.length===0)s._errors.push(a(o));else{let l=s,u=0;for(;u<o.path.length;){let c=o.path[u];u===o.path.length-1?(l[c]=l[c]||{_errors:[]},l[c]._errors.push(a(o))):l[c]=l[c]||{_errors:[]},l=l[c],u++}}};return n(this),s}static assert(e){if(!(e instanceof Yx))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,Qe.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=a=>a.message){let a={},s=[];for(let n of this.issues)n.path.length>0?(a[n.path[0]]=a[n.path[0]]||[],a[n.path[0]].push(e(n))):s.push(e(n));return{formErrors:s,fieldErrors:a}}get formErrors(){return this.flatten()}};xs.create=t=>new xs(t);var Mo=(t,e)=>{let a;switch(t.code){case D.invalid_type:t.received===J.undefined?a="Required":a=`Expected ${t.expected}, received ${t.received}`;break;case D.invalid_literal:a=`Invalid literal value, expected ${JSON.stringify(t.expected,Qe.jsonStringifyReplacer)}`;break;case D.unrecognized_keys:a=`Unrecognized key(s) in object: ${Qe.joinValues(t.keys,", ")}`;break;case D.invalid_union:a="Invalid input";break;case D.invalid_union_discriminator:a=`Invalid discriminator value. Expected ${Qe.joinValues(t.options)}`;break;case D.invalid_enum_value:a=`Invalid enum value. Expected ${Qe.joinValues(t.options)}, received '${t.received}'`;break;case D.invalid_arguments:a="Invalid function arguments";break;case D.invalid_return_type:a="Invalid function return type";break;case D.invalid_date:a="Invalid date";break;case D.invalid_string:typeof t.validation=="object"?"includes"in t.validation?(a=`Invalid input: must include "${t.validation.includes}"`,typeof t.validation.position=="number"&&(a=`${a} at one or more positions greater than or equal to ${t.validation.position}`)):"startsWith"in t.validation?a=`Invalid input: must start with "${t.validation.startsWith}"`:"endsWith"in t.validation?a=`Invalid input: must end with "${t.validation.endsWith}"`:Qe.assertNever(t.validation):t.validation!=="regex"?a=`Invalid ${t.validation}`:a="Invalid";break;case D.too_small:t.type==="array"?a=`Array must contain ${t.exact?"exactly":t.inclusive?"at least":"more than"} ${t.minimum} element(s)`:t.type==="string"?a=`String must contain ${t.exact?"exactly":t.inclusive?"at least":"over"} ${t.minimum} character(s)`:t.type==="number"?a=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="date"?a=`Date must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(t.minimum))}`:a="Invalid input";break;case D.too_big:t.type==="array"?a=`Array must contain ${t.exact?"exactly":t.inclusive?"at most":"less than"} ${t.maximum} element(s)`:t.type==="string"?a=`String must contain ${t.exact?"exactly":t.inclusive?"at most":"under"} ${t.maximum} character(s)`:t.type==="number"?a=`Number must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="bigint"?a=`BigInt must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="date"?a=`Date must be ${t.exact?"exactly":t.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(t.maximum))}`:a="Invalid input";break;case D.custom:a="Invalid input";break;case D.invalid_intersection_types:a="Intersection results could not be merged";break;case D.not_multiple_of:a=`Number must be a multiple of ${t.multipleOf}`;break;case D.not_finite:a="Number must be finite";break;default:a=e.defaultError,Qe.assertNever(t)}return{message:a}},Jx=Mo;function yR(t){Jx=t}function Nf(){return Jx}var Wf=t=>{let{data:e,path:a,errorMaps:s,issueData:n}=t,r=[...a,...n.path||[]],o={...n,path:r};if(n.message!==void 0)return{...n,path:r,message:n.message};let l="",u=s.filter(c=>!!c).slice().reverse();for(let c of u)l=c(o,{data:e,defaultError:l}).message;return{...n,path:r,message:l}},vR=[];function z(t,e){let a=Nf(),s=Wf({issueData:e,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,a,a===Mo?void 0:Mo].filter(n=>!!n)});t.common.issues.push(s)}var Oa=class Xx{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,a){let s=[];for(let n of a){if(n.status==="aborted")return Ce;n.status==="dirty"&&e.dirty(),s.push(n.value)}return{status:e.value,value:s}}static async mergeObjectAsync(e,a){let s=[];for(let n of a){let r=await n.key,o=await n.value;s.push({key:r,value:o})}return Xx.mergeObjectSync(e,s)}static mergeObjectSync(e,a){let s={};for(let n of a){let{key:r,value:o}=n;if(r.status==="aborted"||o.status==="aborted")return Ce;r.status==="dirty"&&e.dirty(),o.status==="dirty"&&e.dirty(),r.value!=="__proto__"&&(typeof o.value<"u"||n.alwaysSet)&&(s[r.value]=o.value)}return{status:e.value,value:s}}},Ce=Object.freeze({status:"aborted"}),Bf=t=>({status:"dirty",value:t}),ma=t=>({status:"valid",value:t}),Xg=t=>t.status==="aborted",ey=t=>t.status==="dirty",lu=t=>t.status==="valid",du=t=>typeof Promise<"u"&&t instanceof Promise;function Zf(t,e,a,s){if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return e.get(t)}function e_(t,e,a,s,n){if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return e.set(t,a),a}var oe;(function(t){t.errToObj=e=>typeof e=="string"?{message:e}:e||{},t.toString=e=>typeof e=="string"?e:e==null?void 0:e.message})(oe||(oe={}));var Ol,Pl,Xs=class{constructor(e,a,s,n){this._cachedPath=[],this.parent=e,this.data=a,this._path=s,this._key=n}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}},Ew=(t,e)=>{if(lu(e))return{success:!0,data:e.value};if(!t.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;let a=new xs(t.common.issues);return this._error=a,this._error}}};function Oe(t){if(!t)return{};let{errorMap:e,invalid_type_error:a,required_error:s,description:n}=t;if(e&&(a||s))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:n}:{errorMap:(r,o)=>{var l,u;let{message:c}=t;return r.code==="invalid_enum_value"?{message:c??o.defaultError}:typeof o.data>"u"?{message:(l=c??s)!==null&&l!==void 0?l:o.defaultError}:r.code!=="invalid_type"?{message:o.defaultError}:{message:(u=c??a)!==null&&u!==void 0?u:o.defaultError}},description:n}}var Be=class{constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this)}get description(){return this._def.description}_getType(e){return Xn(e.data)}_getOrReturnCtx(e,a){return a||{common:e.parent.common,data:e.data,parsedType:Xn(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new Oa,ctx:{common:e.parent.common,data:e.data,parsedType:Xn(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){let a=this._parse(e);if(du(a))throw new Error("Synchronous parse encountered promise.");return a}_parseAsync(e){let a=this._parse(e);return Promise.resolve(a)}parse(e,a){let s=this.safeParse(e,a);if(s.success)return s.data;throw s.error}safeParse(e,a){var s;let n={common:{issues:[],async:(s=a==null?void 0:a.async)!==null&&s!==void 0?s:!1,contextualErrorMap:a==null?void 0:a.errorMap},path:(a==null?void 0:a.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Xn(e)},r=this._parseSync({data:e,path:n.path,parent:n});return Ew(n,r)}async parseAsync(e,a){let s=await this.safeParseAsync(e,a);if(s.success)return s.data;throw s.error}async safeParseAsync(e,a){let s={common:{issues:[],contextualErrorMap:a==null?void 0:a.errorMap,async:!0},path:(a==null?void 0:a.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Xn(e)},n=this._parse({data:e,path:s.path,parent:s}),r=await(du(n)?n:Promise.resolve(n));return Ew(s,r)}refine(e,a){let s=n=>typeof a=="string"||typeof a>"u"?{message:a}:typeof a=="function"?a(n):a;return this._refinement((n,r)=>{let o=e(n),l=()=>r.addIssue({code:D.custom,...s(n)});return typeof Promise<"u"&&o instanceof Promise?o.then(u=>u?!0:(l(),!1)):o?!0:(l(),!1)})}refinement(e,a){return this._refinement((s,n)=>e(s)?!0:(n.addIssue(typeof a=="function"?a(s,n):a),!1))}_refinement(e){return new Ms({schema:this,typeName:ve.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}optional(){return Us.create(this,this._def)}nullable(){return _i.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return br.create(this,this._def)}promise(){return Io.create(this,this._def)}or(e){return gu.create([this,e],this._def)}and(e){return yu.create(this,e,this._def)}transform(e){return new Ms({...Oe(this._def),schema:this,typeName:ve.ZodEffects,effect:{type:"transform",transform:e}})}default(e){let a=typeof e=="function"?e:()=>e;return new ku({...Oe(this._def),innerType:this,defaultValue:a,typeName:ve.ZodDefault})}brand(){return new Lv({typeName:ve.ZodBranded,type:this,...Oe(this._def)})}catch(e){let a=typeof e=="function"?e:()=>e;return new xu({...Oe(this._def),innerType:this,catchValue:a,typeName:ve.ZodCatch})}describe(e){let a=this.constructor;return new a({...this._def,description:e})}pipe(e){return Ev.create(this,e)}readonly(){return _u.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}},bR=/^c[^\s-]{8,}$/i,wR=/^[0-9a-z]+$/,kR=/^[0-9A-HJKMNP-TV-Z]{26}$/,xR=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,_R=/^[a-z0-9_-]{21}$/i,CR=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,SR=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,TR="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$",jh,$R=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,AR=/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,MR=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,t_="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",LR=new RegExp(`^${t_}$`);function a_(t){let e="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return t.precision?e=`${e}\\.\\d{${t.precision}}`:t.precision==null&&(e=`${e}(\\.\\d+)?`),e}function ER(t){return new RegExp(`^${a_(t)}$`)}function s_(t){let e=`${t_}T${a_(t)}`,a=[];return a.push(t.local?"Z?":"Z"),t.offset&&a.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${a.join("|")})`,new RegExp(`^${e}$`)}function IR(t,e){return!!((e==="v4"||!e)&&$R.test(t)||(e==="v6"||!e)&&AR.test(t))}var Lo=class Rl extends Be{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==J.string){let n=this._getOrReturnCtx(e);return z(n,{code:D.invalid_type,expected:J.string,received:n.parsedType}),Ce}let a=new Oa,s;for(let n of this._def.checks)if(n.kind==="min")e.data.length<n.value&&(s=this._getOrReturnCtx(e,s),z(s,{code:D.too_small,minimum:n.value,type:"string",inclusive:!0,exact:!1,message:n.message}),a.dirty());else if(n.kind==="max")e.data.length>n.value&&(s=this._getOrReturnCtx(e,s),z(s,{code:D.too_big,maximum:n.value,type:"string",inclusive:!0,exact:!1,message:n.message}),a.dirty());else if(n.kind==="length"){let r=e.data.length>n.value,o=e.data.length<n.value;(r||o)&&(s=this._getOrReturnCtx(e,s),r?z(s,{code:D.too_big,maximum:n.value,type:"string",inclusive:!0,exact:!0,message:n.message}):o&&z(s,{code:D.too_small,minimum:n.value,type:"string",inclusive:!0,exact:!0,message:n.message}),a.dirty())}else if(n.kind==="email")SR.test(e.data)||(s=this._getOrReturnCtx(e,s),z(s,{validation:"email",code:D.invalid_string,message:n.message}),a.dirty());else if(n.kind==="emoji")jh||(jh=new RegExp(TR,"u")),jh.test(e.data)||(s=this._getOrReturnCtx(e,s),z(s,{validation:"emoji",code:D.invalid_string,message:n.message}),a.dirty());else if(n.kind==="uuid")xR.test(e.data)||(s=this._getOrReturnCtx(e,s),z(s,{validation:"uuid",code:D.invalid_string,message:n.message}),a.dirty());else if(n.kind==="nanoid")_R.test(e.data)||(s=this._getOrReturnCtx(e,s),z(s,{validation:"nanoid",code:D.invalid_string,message:n.message}),a.dirty());else if(n.kind==="cuid")bR.test(e.data)||(s=this._getOrReturnCtx(e,s),z(s,{validation:"cuid",code:D.invalid_string,message:n.message}),a.dirty());else if(n.kind==="cuid2")wR.test(e.data)||(s=this._getOrReturnCtx(e,s),z(s,{validation:"cuid2",code:D.invalid_string,message:n.message}),a.dirty());else if(n.kind==="ulid")kR.test(e.data)||(s=this._getOrReturnCtx(e,s),z(s,{validation:"ulid",code:D.invalid_string,message:n.message}),a.dirty());else if(n.kind==="url")try{new URL(e.data)}catch{s=this._getOrReturnCtx(e,s),z(s,{validation:"url",code:D.invalid_string,message:n.message}),a.dirty()}else n.kind==="regex"?(n.regex.lastIndex=0,n.regex.test(e.data)||(s=this._getOrReturnCtx(e,s),z(s,{validation:"regex",code:D.invalid_string,message:n.message}),a.dirty())):n.kind==="trim"?e.data=e.data.trim():n.kind==="includes"?e.data.includes(n.value,n.position)||(s=this._getOrReturnCtx(e,s),z(s,{code:D.invalid_string,validation:{includes:n.value,position:n.position},message:n.message}),a.dirty()):n.kind==="toLowerCase"?e.data=e.data.toLowerCase():n.kind==="toUpperCase"?e.data=e.data.toUpperCase():n.kind==="startsWith"?e.data.startsWith(n.value)||(s=this._getOrReturnCtx(e,s),z(s,{code:D.invalid_string,validation:{startsWith:n.value},message:n.message}),a.dirty()):n.kind==="endsWith"?e.data.endsWith(n.value)||(s=this._getOrReturnCtx(e,s),z(s,{code:D.invalid_string,validation:{endsWith:n.value},message:n.message}),a.dirty()):n.kind==="datetime"?s_(n).test(e.data)||(s=this._getOrReturnCtx(e,s),z(s,{code:D.invalid_string,validation:"datetime",message:n.message}),a.dirty()):n.kind==="date"?LR.test(e.data)||(s=this._getOrReturnCtx(e,s),z(s,{code:D.invalid_string,validation:"date",message:n.message}),a.dirty()):n.kind==="time"?ER(n).test(e.data)||(s=this._getOrReturnCtx(e,s),z(s,{code:D.invalid_string,validation:"time",message:n.message}),a.dirty()):n.kind==="duration"?CR.test(e.data)||(s=this._getOrReturnCtx(e,s),z(s,{validation:"duration",code:D.invalid_string,message:n.message}),a.dirty()):n.kind==="ip"?IR(e.data,n.version)||(s=this._getOrReturnCtx(e,s),z(s,{validation:"ip",code:D.invalid_string,message:n.message}),a.dirty()):n.kind==="base64"?MR.test(e.data)||(s=this._getOrReturnCtx(e,s),z(s,{validation:"base64",code:D.invalid_string,message:n.message}),a.dirty()):Qe.assertNever(n);return{status:a.value,value:e.data}}_regex(e,a,s){return this.refinement(n=>e.test(n),{validation:a,code:D.invalid_string,...oe.errToObj(s)})}_addCheck(e){return new Rl({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...oe.errToObj(e)})}url(e){return this._addCheck({kind:"url",...oe.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...oe.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...oe.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...oe.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...oe.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...oe.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...oe.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...oe.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...oe.errToObj(e)})}datetime(e){var a,s;return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,offset:(a=e==null?void 0:e.offset)!==null&&a!==void 0?a:!1,local:(s=e==null?void 0:e.local)!==null&&s!==void 0?s:!1,...oe.errToObj(e==null?void 0:e.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,...oe.errToObj(e==null?void 0:e.message)})}duration(e){return this._addCheck({kind:"duration",...oe.errToObj(e)})}regex(e,a){return this._addCheck({kind:"regex",regex:e,...oe.errToObj(a)})}includes(e,a){return this._addCheck({kind:"includes",value:e,position:a==null?void 0:a.position,...oe.errToObj(a==null?void 0:a.message)})}startsWith(e,a){return this._addCheck({kind:"startsWith",value:e,...oe.errToObj(a)})}endsWith(e,a){return this._addCheck({kind:"endsWith",value:e,...oe.errToObj(a)})}min(e,a){return this._addCheck({kind:"min",value:e,...oe.errToObj(a)})}max(e,a){return this._addCheck({kind:"max",value:e,...oe.errToObj(a)})}length(e,a){return this._addCheck({kind:"length",value:e,...oe.errToObj(a)})}nonempty(e){return this.min(1,oe.errToObj(e))}trim(){return new Rl({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new Rl({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new Rl({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get minLength(){let e=null;for(let a of this._def.checks)a.kind==="min"&&(e===null||a.value>e)&&(e=a.value);return e}get maxLength(){let e=null;for(let a of this._def.checks)a.kind==="max"&&(e===null||a.value<e)&&(e=a.value);return e}};Lo.create=t=>{var e;return new Lo({checks:[],typeName:ve.ZodString,coerce:(e=t==null?void 0:t.coerce)!==null&&e!==void 0?e:!1,...Oe(t)})};function OR(t,e){let a=(t.toString().split(".")[1]||"").length,s=(e.toString().split(".")[1]||"").length,n=a>s?a:s,r=parseInt(t.toFixed(n).replace(".","")),o=parseInt(e.toFixed(n).replace(".",""));return r%o/Math.pow(10,n)}var uu=class ty extends Be{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==J.number){let n=this._getOrReturnCtx(e);return z(n,{code:D.invalid_type,expected:J.number,received:n.parsedType}),Ce}let a,s=new Oa;for(let n of this._def.checks)n.kind==="int"?Qe.isInteger(e.data)||(a=this._getOrReturnCtx(e,a),z(a,{code:D.invalid_type,expected:"integer",received:"float",message:n.message}),s.dirty()):n.kind==="min"?(n.inclusive?e.data<n.value:e.data<=n.value)&&(a=this._getOrReturnCtx(e,a),z(a,{code:D.too_small,minimum:n.value,type:"number",inclusive:n.inclusive,exact:!1,message:n.message}),s.dirty()):n.kind==="max"?(n.inclusive?e.data>n.value:e.data>=n.value)&&(a=this._getOrReturnCtx(e,a),z(a,{code:D.too_big,maximum:n.value,type:"number",inclusive:n.inclusive,exact:!1,message:n.message}),s.dirty()):n.kind==="multipleOf"?OR(e.data,n.value)!==0&&(a=this._getOrReturnCtx(e,a),z(a,{code:D.not_multiple_of,multipleOf:n.value,message:n.message}),s.dirty()):n.kind==="finite"?Number.isFinite(e.data)||(a=this._getOrReturnCtx(e,a),z(a,{code:D.not_finite,message:n.message}),s.dirty()):Qe.assertNever(n);return{status:s.value,value:e.data}}gte(e,a){return this.setLimit("min",e,!0,oe.toString(a))}gt(e,a){return this.setLimit("min",e,!1,oe.toString(a))}lte(e,a){return this.setLimit("max",e,!0,oe.toString(a))}lt(e,a){return this.setLimit("max",e,!1,oe.toString(a))}setLimit(e,a,s,n){return new ty({...this._def,checks:[...this._def.checks,{kind:e,value:a,inclusive:s,message:oe.toString(n)}]})}_addCheck(e){return new ty({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:oe.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:oe.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:oe.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:oe.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:oe.toString(e)})}multipleOf(e,a){return this._addCheck({kind:"multipleOf",value:e,message:oe.toString(a)})}finite(e){return this._addCheck({kind:"finite",message:oe.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:oe.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:oe.toString(e)})}get minValue(){let e=null;for(let a of this._def.checks)a.kind==="min"&&(e===null||a.value>e)&&(e=a.value);return e}get maxValue(){let e=null;for(let a of this._def.checks)a.kind==="max"&&(e===null||a.value<e)&&(e=a.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&Qe.isInteger(e.value))}get isFinite(){let e=null,a=null;for(let s of this._def.checks){if(s.kind==="finite"||s.kind==="int"||s.kind==="multipleOf")return!0;s.kind==="min"?(a===null||s.value>a)&&(a=s.value):s.kind==="max"&&(e===null||s.value<e)&&(e=s.value)}return Number.isFinite(a)&&Number.isFinite(e)}};uu.create=t=>new uu({checks:[],typeName:ve.ZodNumber,coerce:(t==null?void 0:t.coerce)||!1,...Oe(t)});var cu=class ay extends Be{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce&&(e.data=BigInt(e.data)),this._getType(e)!==J.bigint){let n=this._getOrReturnCtx(e);return z(n,{code:D.invalid_type,expected:J.bigint,received:n.parsedType}),Ce}let a,s=new Oa;for(let n of this._def.checks)n.kind==="min"?(n.inclusive?e.data<n.value:e.data<=n.value)&&(a=this._getOrReturnCtx(e,a),z(a,{code:D.too_small,type:"bigint",minimum:n.value,inclusive:n.inclusive,message:n.message}),s.dirty()):n.kind==="max"?(n.inclusive?e.data>n.value:e.data>=n.value)&&(a=this._getOrReturnCtx(e,a),z(a,{code:D.too_big,type:"bigint",maximum:n.value,inclusive:n.inclusive,message:n.message}),s.dirty()):n.kind==="multipleOf"?e.data%n.value!==BigInt(0)&&(a=this._getOrReturnCtx(e,a),z(a,{code:D.not_multiple_of,multipleOf:n.value,message:n.message}),s.dirty()):Qe.assertNever(n);return{status:s.value,value:e.data}}gte(e,a){return this.setLimit("min",e,!0,oe.toString(a))}gt(e,a){return this.setLimit("min",e,!1,oe.toString(a))}lte(e,a){return this.setLimit("max",e,!0,oe.toString(a))}lt(e,a){return this.setLimit("max",e,!1,oe.toString(a))}setLimit(e,a,s,n){return new ay({...this._def,checks:[...this._def.checks,{kind:e,value:a,inclusive:s,message:oe.toString(n)}]})}_addCheck(e){return new ay({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:oe.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:oe.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:oe.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:oe.toString(e)})}multipleOf(e,a){return this._addCheck({kind:"multipleOf",value:e,message:oe.toString(a)})}get minValue(){let e=null;for(let a of this._def.checks)a.kind==="min"&&(e===null||a.value>e)&&(e=a.value);return e}get maxValue(){let e=null;for(let a of this._def.checks)a.kind==="max"&&(e===null||a.value<e)&&(e=a.value);return e}};cu.create=t=>{var e;return new cu({checks:[],typeName:ve.ZodBigInt,coerce:(e=t==null?void 0:t.coerce)!==null&&e!==void 0?e:!1,...Oe(t)})};var pu=class extends Be{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==J.boolean){let a=this._getOrReturnCtx(e);return z(a,{code:D.invalid_type,expected:J.boolean,received:a.parsedType}),Ce}return ma(e.data)}};pu.create=t=>new pu({typeName:ve.ZodBoolean,coerce:(t==null?void 0:t.coerce)||!1,...Oe(t)});var fu=class n_ extends Be{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==J.date){let n=this._getOrReturnCtx(e);return z(n,{code:D.invalid_type,expected:J.date,received:n.parsedType}),Ce}if(isNaN(e.data.getTime())){let n=this._getOrReturnCtx(e);return z(n,{code:D.invalid_date}),Ce}let a=new Oa,s;for(let n of this._def.checks)n.kind==="min"?e.data.getTime()<n.value&&(s=this._getOrReturnCtx(e,s),z(s,{code:D.too_small,message:n.message,inclusive:!0,exact:!1,minimum:n.value,type:"date"}),a.dirty()):n.kind==="max"?e.data.getTime()>n.value&&(s=this._getOrReturnCtx(e,s),z(s,{code:D.too_big,message:n.message,inclusive:!0,exact:!1,maximum:n.value,type:"date"}),a.dirty()):Qe.assertNever(n);return{status:a.value,value:new Date(e.data.getTime())}}_addCheck(e){return new n_({...this._def,checks:[...this._def.checks,e]})}min(e,a){return this._addCheck({kind:"min",value:e.getTime(),message:oe.toString(a)})}max(e,a){return this._addCheck({kind:"max",value:e.getTime(),message:oe.toString(a)})}get minDate(){let e=null;for(let a of this._def.checks)a.kind==="min"&&(e===null||a.value>e)&&(e=a.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(let a of this._def.checks)a.kind==="max"&&(e===null||a.value<e)&&(e=a.value);return e!=null?new Date(e):null}};fu.create=t=>new fu({checks:[],coerce:(t==null?void 0:t.coerce)||!1,typeName:ve.ZodDate,...Oe(t)});var qf=class extends Be{_parse(e){if(this._getType(e)!==J.symbol){let a=this._getOrReturnCtx(e);return z(a,{code:D.invalid_type,expected:J.symbol,received:a.parsedType}),Ce}return ma(e.data)}};qf.create=t=>new qf({typeName:ve.ZodSymbol,...Oe(t)});var mu=class extends Be{_parse(e){if(this._getType(e)!==J.undefined){let a=this._getOrReturnCtx(e);return z(a,{code:D.invalid_type,expected:J.undefined,received:a.parsedType}),Ce}return ma(e.data)}};mu.create=t=>new mu({typeName:ve.ZodUndefined,...Oe(t)});var hu=class extends Be{_parse(e){if(this._getType(e)!==J.null){let a=this._getOrReturnCtx(e);return z(a,{code:D.invalid_type,expected:J.null,received:a.parsedType}),Ce}return ma(e.data)}};hu.create=t=>new hu({typeName:ve.ZodNull,...Oe(t)});var Eo=class extends Be{constructor(){super(...arguments),this._any=!0}_parse(e){return ma(e.data)}};Eo.create=t=>new Eo({typeName:ve.ZodAny,...Oe(t)});var er=class extends Be{constructor(){super(...arguments),this._unknown=!0}_parse(e){return ma(e.data)}};er.create=t=>new er({typeName:ve.ZodUnknown,...Oe(t)});var Cn=class extends Be{_parse(e){let a=this._getOrReturnCtx(e);return z(a,{code:D.invalid_type,expected:J.never,received:a.parsedType}),Ce}};Cn.create=t=>new Cn({typeName:ve.ZodNever,...Oe(t)});var Ff=class extends Be{_parse(e){if(this._getType(e)!==J.undefined){let a=this._getOrReturnCtx(e);return z(a,{code:D.invalid_type,expected:J.void,received:a.parsedType}),Ce}return ma(e.data)}};Ff.create=t=>new Ff({typeName:ve.ZodVoid,...Oe(t)});var br=class Fp extends Be{_parse(e){let{ctx:a,status:s}=this._processInputParams(e),n=this._def;if(a.parsedType!==J.array)return z(a,{code:D.invalid_type,expected:J.array,received:a.parsedType}),Ce;if(n.exactLength!==null){let o=a.data.length>n.exactLength.value,l=a.data.length<n.exactLength.value;(o||l)&&(z(a,{code:o?D.too_big:D.too_small,minimum:l?n.exactLength.value:void 0,maximum:o?n.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:n.exactLength.message}),s.dirty())}if(n.minLength!==null&&a.data.length<n.minLength.value&&(z(a,{code:D.too_small,minimum:n.minLength.value,type:"array",inclusive:!0,exact:!1,message:n.minLength.message}),s.dirty()),n.maxLength!==null&&a.data.length>n.maxLength.value&&(z(a,{code:D.too_big,maximum:n.maxLength.value,type:"array",inclusive:!0,exact:!1,message:n.maxLength.message}),s.dirty()),a.common.async)return Promise.all([...a.data].map((o,l)=>n.type._parseAsync(new Xs(a,o,a.path,l)))).then(o=>Oa.mergeArray(s,o));let r=[...a.data].map((o,l)=>n.type._parseSync(new Xs(a,o,a.path,l)));return Oa.mergeArray(s,r)}get element(){return this._def.type}min(e,a){return new Fp({...this._def,minLength:{value:e,message:oe.toString(a)}})}max(e,a){return new Fp({...this._def,maxLength:{value:e,message:oe.toString(a)}})}length(e,a){return new Fp({...this._def,exactLength:{value:e,message:oe.toString(a)}})}nonempty(e){return this.min(1,e)}};br.create=(t,e)=>new br({type:t,minLength:null,maxLength:null,exactLength:null,typeName:ve.ZodArray,...Oe(e)});function Ur(t){if(t instanceof is){let e={};for(let a in t.shape){let s=t.shape[a];e[a]=Us.create(Ur(s))}return new is({...t._def,shape:()=>e})}else return t instanceof br?new br({...t._def,type:Ur(t.element)}):t instanceof Us?Us.create(Ur(t.unwrap())):t instanceof _i?_i.create(Ur(t.unwrap())):t instanceof xi?xi.create(t.items.map(e=>Ur(e))):t}var is=class fs extends Be{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;let e=this._def.shape(),a=Qe.objectKeys(e);return this._cached={shape:e,keys:a}}_parse(e){if(this._getType(e)!==J.object){let u=this._getOrReturnCtx(e);return z(u,{code:D.invalid_type,expected:J.object,received:u.parsedType}),Ce}let{status:a,ctx:s}=this._processInputParams(e),{shape:n,keys:r}=this._getCached(),o=[];if(!(this._def.catchall instanceof Cn&&this._def.unknownKeys==="strip"))for(let u in s.data)r.includes(u)||o.push(u);let l=[];for(let u of r){let c=n[u],p=s.data[u];l.push({key:{status:"valid",value:u},value:c._parse(new Xs(s,p,s.path,u)),alwaysSet:u in s.data})}if(this._def.catchall instanceof Cn){let u=this._def.unknownKeys;if(u==="passthrough")for(let c of o)l.push({key:{status:"valid",value:c},value:{status:"valid",value:s.data[c]}});else if(u==="strict")o.length>0&&(z(s,{code:D.unrecognized_keys,keys:o}),a.dirty());else if(u!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{let u=this._def.catchall;for(let c of o){let p=s.data[c];l.push({key:{status:"valid",value:c},value:u._parse(new Xs(s,p,s.path,c)),alwaysSet:c in s.data})}}return s.common.async?Promise.resolve().then(async()=>{let u=[];for(let c of l){let p=await c.key,f=await c.value;u.push({key:p,value:f,alwaysSet:c.alwaysSet})}return u}).then(u=>Oa.mergeObjectSync(a,u)):Oa.mergeObjectSync(a,l)}get shape(){return this._def.shape()}strict(e){return oe.errToObj,new fs({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(a,s)=>{var n,r,o,l;let u=(o=(r=(n=this._def).errorMap)===null||r===void 0?void 0:r.call(n,a,s).message)!==null&&o!==void 0?o:s.defaultError;return a.code==="unrecognized_keys"?{message:(l=oe.errToObj(e).message)!==null&&l!==void 0?l:u}:{message:u}}}:{}})}strip(){return new fs({...this._def,unknownKeys:"strip"})}passthrough(){return new fs({...this._def,unknownKeys:"passthrough"})}extend(e){return new fs({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new fs({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:ve.ZodObject})}setKey(e,a){return this.augment({[e]:a})}catchall(e){return new fs({...this._def,catchall:e})}pick(e){let a={};return Qe.objectKeys(e).forEach(s=>{e[s]&&this.shape[s]&&(a[s]=this.shape[s])}),new fs({...this._def,shape:()=>a})}omit(e){let a={};return Qe.objectKeys(this.shape).forEach(s=>{e[s]||(a[s]=this.shape[s])}),new fs({...this._def,shape:()=>a})}deepPartial(){return Ur(this)}partial(e){let a={};return Qe.objectKeys(this.shape).forEach(s=>{let n=this.shape[s];e&&!e[s]?a[s]=n:a[s]=n.optional()}),new fs({...this._def,shape:()=>a})}required(e){let a={};return Qe.objectKeys(this.shape).forEach(s=>{if(e&&!e[s])a[s]=this.shape[s];else{let n=this.shape[s];for(;n instanceof Us;)n=n._def.innerType;a[s]=n}}),new fs({...this._def,shape:()=>a})}keyof(){return u_(Qe.objectKeys(this.shape))}};is.create=(t,e)=>new is({shape:()=>t,unknownKeys:"strip",catchall:Cn.create(),typeName:ve.ZodObject,...Oe(e)});is.strictCreate=(t,e)=>new is({shape:()=>t,unknownKeys:"strict",catchall:Cn.create(),typeName:ve.ZodObject,...Oe(e)});is.lazycreate=(t,e)=>new is({shape:t,unknownKeys:"strip",catchall:Cn.create(),typeName:ve.ZodObject,...Oe(e)});var gu=class extends Be{_parse(e){let{ctx:a}=this._processInputParams(e),s=this._def.options;function n(r){for(let l of r)if(l.result.status==="valid")return l.result;for(let l of r)if(l.result.status==="dirty")return a.common.issues.push(...l.ctx.common.issues),l.result;let o=r.map(l=>new xs(l.ctx.common.issues));return z(a,{code:D.invalid_union,unionErrors:o}),Ce}if(a.common.async)return Promise.all(s.map(async r=>{let o={...a,common:{...a.common,issues:[]},parent:null};return{result:await r._parseAsync({data:a.data,path:a.path,parent:o}),ctx:o}})).then(n);{let r,o=[];for(let u of s){let c={...a,common:{...a.common,issues:[]},parent:null},p=u._parseSync({data:a.data,path:a.path,parent:c});if(p.status==="valid")return p;p.status==="dirty"&&!r&&(r={result:p,ctx:c}),c.common.issues.length&&o.push(c.common.issues)}if(r)return a.common.issues.push(...r.ctx.common.issues),r.result;let l=o.map(u=>new xs(u));return z(a,{code:D.invalid_union,unionErrors:l}),Ce}}get options(){return this._def.options}};gu.create=(t,e)=>new gu({options:t,typeName:ve.ZodUnion,...Oe(e)});var zn=t=>t instanceof vu?zn(t.schema):t instanceof Ms?zn(t.innerType()):t instanceof bu?[t.value]:t instanceof Mc?t.options:t instanceof wu?Qe.objectValues(t.enum):t instanceof ku?zn(t._def.innerType):t instanceof mu?[void 0]:t instanceof hu?[null]:t instanceof Us?[void 0,...zn(t.unwrap())]:t instanceof _i?[null,...zn(t.unwrap())]:t instanceof Lv||t instanceof _u?zn(t.unwrap()):t instanceof xu?zn(t._def.innerType):[],i_=class r_ extends Be{_parse(e){let{ctx:a}=this._processInputParams(e);if(a.parsedType!==J.object)return z(a,{code:D.invalid_type,expected:J.object,received:a.parsedType}),Ce;let s=this.discriminator,n=a.data[s],r=this.optionsMap.get(n);return r?a.common.async?r._parseAsync({data:a.data,path:a.path,parent:a}):r._parseSync({data:a.data,path:a.path,parent:a}):(z(a,{code:D.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[s]}),Ce)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,a,s){let n=new Map;for(let r of a){let o=zn(r.shape[e]);if(!o.length)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(let l of o){if(n.has(l))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(l)}`);n.set(l,r)}}return new r_({typeName:ve.ZodDiscriminatedUnion,discriminator:e,options:a,optionsMap:n,...Oe(s)})}};function sy(t,e){let a=Xn(t),s=Xn(e);if(t===e)return{valid:!0,data:t};if(a===J.object&&s===J.object){let n=Qe.objectKeys(e),r=Qe.objectKeys(t).filter(l=>n.indexOf(l)!==-1),o={...t,...e};for(let l of r){let u=sy(t[l],e[l]);if(!u.valid)return{valid:!1};o[l]=u.data}return{valid:!0,data:o}}else if(a===J.array&&s===J.array){if(t.length!==e.length)return{valid:!1};let n=[];for(let r=0;r<t.length;r++){let o=t[r],l=e[r],u=sy(o,l);if(!u.valid)return{valid:!1};n.push(u.data)}return{valid:!0,data:n}}else return a===J.date&&s===J.date&&+t==+e?{valid:!0,data:t}:{valid:!1}}var yu=class extends Be{_parse(e){let{status:a,ctx:s}=this._processInputParams(e),n=(r,o)=>{if(Xg(r)||Xg(o))return Ce;let l=sy(r.value,o.value);return l.valid?((ey(r)||ey(o))&&a.dirty(),{status:a.value,value:l.data}):(z(s,{code:D.invalid_intersection_types}),Ce)};return s.common.async?Promise.all([this._def.left._parseAsync({data:s.data,path:s.path,parent:s}),this._def.right._parseAsync({data:s.data,path:s.path,parent:s})]).then(([r,o])=>n(r,o)):n(this._def.left._parseSync({data:s.data,path:s.path,parent:s}),this._def.right._parseSync({data:s.data,path:s.path,parent:s}))}};yu.create=(t,e,a)=>new yu({left:t,right:e,typeName:ve.ZodIntersection,...Oe(a)});var xi=class o_ extends Be{_parse(e){let{status:a,ctx:s}=this._processInputParams(e);if(s.parsedType!==J.array)return z(s,{code:D.invalid_type,expected:J.array,received:s.parsedType}),Ce;if(s.data.length<this._def.items.length)return z(s,{code:D.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),Ce;!this._def.rest&&s.data.length>this._def.items.length&&(z(s,{code:D.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),a.dirty());let n=[...s.data].map((r,o)=>{let l=this._def.items[o]||this._def.rest;return l?l._parse(new Xs(s,r,s.path,o)):null}).filter(r=>!!r);return s.common.async?Promise.all(n).then(r=>Oa.mergeArray(a,r)):Oa.mergeArray(a,n)}get items(){return this._def.items}rest(e){return new o_({...this._def,rest:e})}};xi.create=(t,e)=>{if(!Array.isArray(t))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new xi({items:t,typeName:ve.ZodTuple,rest:null,...Oe(e)})};var l_=class ny extends Be{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:a,ctx:s}=this._processInputParams(e);if(s.parsedType!==J.object)return z(s,{code:D.invalid_type,expected:J.object,received:s.parsedType}),Ce;let n=[],r=this._def.keyType,o=this._def.valueType;for(let l in s.data)n.push({key:r._parse(new Xs(s,l,s.path,l)),value:o._parse(new Xs(s,s.data[l],s.path,l)),alwaysSet:l in s.data});return s.common.async?Oa.mergeObjectAsync(a,n):Oa.mergeObjectSync(a,n)}get element(){return this._def.valueType}static create(e,a,s){return a instanceof Be?new ny({keyType:e,valueType:a,typeName:ve.ZodRecord,...Oe(s)}):new ny({keyType:Lo.create(),valueType:e,typeName:ve.ZodRecord,...Oe(a)})}},jf=class extends Be{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:a,ctx:s}=this._processInputParams(e);if(s.parsedType!==J.map)return z(s,{code:D.invalid_type,expected:J.map,received:s.parsedType}),Ce;let n=this._def.keyType,r=this._def.valueType,o=[...s.data.entries()].map(([l,u],c)=>({key:n._parse(new Xs(s,l,s.path,[c,"key"])),value:r._parse(new Xs(s,u,s.path,[c,"value"]))}));if(s.common.async){let l=new Map;return Promise.resolve().then(async()=>{for(let u of o){let c=await u.key,p=await u.value;if(c.status==="aborted"||p.status==="aborted")return Ce;(c.status==="dirty"||p.status==="dirty")&&a.dirty(),l.set(c.value,p.value)}return{status:a.value,value:l}})}else{let l=new Map;for(let u of o){let c=u.key,p=u.value;if(c.status==="aborted"||p.status==="aborted")return Ce;(c.status==="dirty"||p.status==="dirty")&&a.dirty(),l.set(c.value,p.value)}return{status:a.value,value:l}}}};jf.create=(t,e,a)=>new jf({valueType:e,keyType:t,typeName:ve.ZodMap,...Oe(a)});var Hf=class iy extends Be{_parse(e){let{status:a,ctx:s}=this._processInputParams(e);if(s.parsedType!==J.set)return z(s,{code:D.invalid_type,expected:J.set,received:s.parsedType}),Ce;let n=this._def;n.minSize!==null&&s.data.size<n.minSize.value&&(z(s,{code:D.too_small,minimum:n.minSize.value,type:"set",inclusive:!0,exact:!1,message:n.minSize.message}),a.dirty()),n.maxSize!==null&&s.data.size>n.maxSize.value&&(z(s,{code:D.too_big,maximum:n.maxSize.value,type:"set",inclusive:!0,exact:!1,message:n.maxSize.message}),a.dirty());let r=this._def.valueType;function o(u){let c=new Set;for(let p of u){if(p.status==="aborted")return Ce;p.status==="dirty"&&a.dirty(),c.add(p.value)}return{status:a.value,value:c}}let l=[...s.data.values()].map((u,c)=>r._parse(new Xs(s,u,s.path,c)));return s.common.async?Promise.all(l).then(u=>o(u)):o(l)}min(e,a){return new iy({...this._def,minSize:{value:e,message:oe.toString(a)}})}max(e,a){return new iy({...this._def,maxSize:{value:e,message:oe.toString(a)}})}size(e,a){return this.min(e,a).max(e,a)}nonempty(e){return this.min(1,e)}};Hf.create=(t,e)=>new Hf({valueType:t,minSize:null,maxSize:null,typeName:ve.ZodSet,...Oe(e)});var d_=class jp extends Be{constructor(){super(...arguments),this.validate=this.implement}_parse(e){let{ctx:a}=this._processInputParams(e);if(a.parsedType!==J.function)return z(a,{code:D.invalid_type,expected:J.function,received:a.parsedType}),Ce;function s(l,u){return Wf({data:l,path:a.path,errorMaps:[a.common.contextualErrorMap,a.schemaErrorMap,Nf(),Mo].filter(c=>!!c),issueData:{code:D.invalid_arguments,argumentsError:u}})}function n(l,u){return Wf({data:l,path:a.path,errorMaps:[a.common.contextualErrorMap,a.schemaErrorMap,Nf(),Mo].filter(c=>!!c),issueData:{code:D.invalid_return_type,returnTypeError:u}})}let r={errorMap:a.common.contextualErrorMap},o=a.data;if(this._def.returns instanceof Io){let l=this;return ma(async function(...u){let c=new xs([]),p=await l._def.args.parseAsync(u,r).catch(m=>{throw c.addIssue(s(u,m)),c}),f=await Reflect.apply(o,this,p);return await l._def.returns._def.type.parseAsync(f,r).catch(m=>{throw c.addIssue(n(f,m)),c})})}else{let l=this;return ma(function(...u){let c=l._def.args.safeParse(u,r);if(!c.success)throw new xs([s(u,c.error)]);let p=Reflect.apply(o,this,c.data),f=l._def.returns.safeParse(p,r);if(!f.success)throw new xs([n(p,f.error)]);return f.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new jp({...this._def,args:xi.create(e).rest(er.create())})}returns(e){return new jp({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,a,s){return new jp({args:e||xi.create([]).rest(er.create()),returns:a||er.create(),typeName:ve.ZodFunction,...Oe(s)})}},vu=class extends Be{get schema(){return this._def.getter()}_parse(e){let{ctx:a}=this._processInputParams(e);return this._def.getter()._parse({data:a.data,path:a.path,parent:a})}};vu.create=(t,e)=>new vu({getter:t,typeName:ve.ZodLazy,...Oe(e)});var bu=class extends Be{_parse(e){if(e.data!==this._def.value){let a=this._getOrReturnCtx(e);return z(a,{received:a.data,code:D.invalid_literal,expected:this._def.value}),Ce}return{status:"valid",value:e.data}}get value(){return this._def.value}};bu.create=(t,e)=>new bu({value:t,typeName:ve.ZodLiteral,...Oe(e)});function u_(t,e){return new Mc({values:t,typeName:ve.ZodEnum,...Oe(e)})}var Mc=class ry extends Be{constructor(){super(...arguments),Ol.set(this,void 0)}_parse(e){if(typeof e.data!="string"){let a=this._getOrReturnCtx(e),s=this._def.values;return z(a,{expected:Qe.joinValues(s),received:a.parsedType,code:D.invalid_type}),Ce}if(Zf(this,Ol)||e_(this,Ol,new Set(this._def.values)),!Zf(this,Ol).has(e.data)){let a=this._getOrReturnCtx(e),s=this._def.values;return z(a,{received:a.data,code:D.invalid_enum_value,options:s}),Ce}return ma(e.data)}get options(){return this._def.values}get enum(){let e={};for(let a of this._def.values)e[a]=a;return e}get Values(){let e={};for(let a of this._def.values)e[a]=a;return e}get Enum(){let e={};for(let a of this._def.values)e[a]=a;return e}extract(e,a=this._def){return ry.create(e,{...this._def,...a})}exclude(e,a=this._def){return ry.create(this.options.filter(s=>!e.includes(s)),{...this._def,...a})}};Ol=new WeakMap;Mc.create=u_;var wu=class extends Be{constructor(){super(...arguments),Pl.set(this,void 0)}_parse(e){let a=Qe.getValidEnumValues(this._def.values),s=this._getOrReturnCtx(e);if(s.parsedType!==J.string&&s.parsedType!==J.number){let n=Qe.objectValues(a);return z(s,{expected:Qe.joinValues(n),received:s.parsedType,code:D.invalid_type}),Ce}if(Zf(this,Pl)||e_(this,Pl,new Set(Qe.getValidEnumValues(this._def.values))),!Zf(this,Pl).has(e.data)){let n=Qe.objectValues(a);return z(s,{received:s.data,code:D.invalid_enum_value,options:n}),Ce}return ma(e.data)}get enum(){return this._def.values}};Pl=new WeakMap;wu.create=(t,e)=>new wu({values:t,typeName:ve.ZodNativeEnum,...Oe(e)});var Io=class extends Be{unwrap(){return this._def.type}_parse(e){let{ctx:a}=this._processInputParams(e);if(a.parsedType!==J.promise&&a.common.async===!1)return z(a,{code:D.invalid_type,expected:J.promise,received:a.parsedType}),Ce;let s=a.parsedType===J.promise?a.data:Promise.resolve(a.data);return ma(s.then(n=>this._def.type.parseAsync(n,{path:a.path,errorMap:a.common.contextualErrorMap})))}};Io.create=(t,e)=>new Io({type:t,typeName:ve.ZodPromise,...Oe(e)});var Ms=class extends Be{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===ve.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){let{status:a,ctx:s}=this._processInputParams(e),n=this._def.effect||null,r={addIssue:o=>{z(s,o),o.fatal?a.abort():a.dirty()},get path(){return s.path}};if(r.addIssue=r.addIssue.bind(r),n.type==="preprocess"){let o=n.transform(s.data,r);if(s.common.async)return Promise.resolve(o).then(async l=>{if(a.value==="aborted")return Ce;let u=await this._def.schema._parseAsync({data:l,path:s.path,parent:s});return u.status==="aborted"?Ce:u.status==="dirty"||a.value==="dirty"?Bf(u.value):u});{if(a.value==="aborted")return Ce;let l=this._def.schema._parseSync({data:o,path:s.path,parent:s});return l.status==="aborted"?Ce:l.status==="dirty"||a.value==="dirty"?Bf(l.value):l}}if(n.type==="refinement"){let o=l=>{let u=n.refinement(l,r);if(s.common.async)return Promise.resolve(u);if(u instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return l};if(s.common.async===!1){let l=this._def.schema._parseSync({data:s.data,path:s.path,parent:s});return l.status==="aborted"?Ce:(l.status==="dirty"&&a.dirty(),o(l.value),{status:a.value,value:l.value})}else return this._def.schema._parseAsync({data:s.data,path:s.path,parent:s}).then(l=>l.status==="aborted"?Ce:(l.status==="dirty"&&a.dirty(),o(l.value).then(()=>({status:a.value,value:l.value}))))}if(n.type==="transform")if(s.common.async===!1){let o=this._def.schema._parseSync({data:s.data,path:s.path,parent:s});if(!lu(o))return o;let l=n.transform(o.value,r);if(l instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:a.value,value:l}}else return this._def.schema._parseAsync({data:s.data,path:s.path,parent:s}).then(o=>lu(o)?Promise.resolve(n.transform(o.value,r)).then(l=>({status:a.value,value:l})):o);Qe.assertNever(n)}};Ms.create=(t,e,a)=>new Ms({schema:t,typeName:ve.ZodEffects,effect:e,...Oe(a)});Ms.createWithPreprocess=(t,e,a)=>new Ms({schema:e,effect:{type:"preprocess",transform:t},typeName:ve.ZodEffects,...Oe(a)});var Us=class extends Be{_parse(t){return this._getType(t)===J.undefined?ma(void 0):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}};Us.create=(t,e)=>new Us({innerType:t,typeName:ve.ZodOptional,...Oe(e)});var _i=class extends Be{_parse(e){return this._getType(e)===J.null?ma(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}};_i.create=(t,e)=>new _i({innerType:t,typeName:ve.ZodNullable,...Oe(e)});var ku=class extends Be{_parse(e){let{ctx:a}=this._processInputParams(e),s=a.data;return a.parsedType===J.undefined&&(s=this._def.defaultValue()),this._def.innerType._parse({data:s,path:a.path,parent:a})}removeDefault(){return this._def.innerType}};ku.create=(t,e)=>new ku({innerType:t,typeName:ve.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...Oe(e)});var xu=class extends Be{_parse(e){let{ctx:a}=this._processInputParams(e),s={...a,common:{...a.common,issues:[]}},n=this._def.innerType._parse({data:s.data,path:s.path,parent:{...s}});return du(n)?n.then(r=>({status:"valid",value:r.status==="valid"?r.value:this._def.catchValue({get error(){return new xs(s.common.issues)},input:s.data})})):{status:"valid",value:n.status==="valid"?n.value:this._def.catchValue({get error(){return new xs(s.common.issues)},input:s.data})}}removeCatch(){return this._def.innerType}};xu.create=(t,e)=>new xu({innerType:t,typeName:ve.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...Oe(e)});var zf=class extends Be{_parse(e){if(this._getType(e)!==J.nan){let a=this._getOrReturnCtx(e);return z(a,{code:D.invalid_type,expected:J.nan,received:a.parsedType}),Ce}return{status:"valid",value:e.data}}};zf.create=t=>new zf({typeName:ve.ZodNaN,...Oe(t)});var PR=Symbol("zod_brand"),Lv=class extends Be{_parse(e){let{ctx:a}=this._processInputParams(e),s=a.data;return this._def.type._parse({data:s,path:a.path,parent:a})}unwrap(){return this._def.type}},Ev=class c_ extends Be{_parse(e){let{status:a,ctx:s}=this._processInputParams(e);if(s.common.async)return(async()=>{let n=await this._def.in._parseAsync({data:s.data,path:s.path,parent:s});return n.status==="aborted"?Ce:n.status==="dirty"?(a.dirty(),Bf(n.value)):this._def.out._parseAsync({data:n.value,path:s.path,parent:s})})();{let n=this._def.in._parseSync({data:s.data,path:s.path,parent:s});return n.status==="aborted"?Ce:n.status==="dirty"?(a.dirty(),{status:"dirty",value:n.value}):this._def.out._parseSync({data:n.value,path:s.path,parent:s})}}static create(e,a){return new c_({in:e,out:a,typeName:ve.ZodPipeline})}},_u=class extends Be{_parse(e){let a=this._def.innerType._parse(e),s=n=>(lu(n)&&(n.value=Object.freeze(n.value)),n);return du(a)?a.then(n=>s(n)):s(a)}unwrap(){return this._def.innerType}};_u.create=(t,e)=>new _u({innerType:t,typeName:ve.ZodReadonly,...Oe(e)});function p_(t,e={},a){return t?Eo.create().superRefine((s,n)=>{var r,o;if(!t(s)){let l=typeof e=="function"?e(s):typeof e=="string"?{message:e}:e,u=(o=(r=l.fatal)!==null&&r!==void 0?r:a)!==null&&o!==void 0?o:!0,c=typeof l=="string"?{message:l}:l;n.addIssue({code:"custom",...c,fatal:u})}}):Eo.create()}var RR={object:is.lazycreate},ve;(function(t){t.ZodString="ZodString",t.ZodNumber="ZodNumber",t.ZodNaN="ZodNaN",t.ZodBigInt="ZodBigInt",t.ZodBoolean="ZodBoolean",t.ZodDate="ZodDate",t.ZodSymbol="ZodSymbol",t.ZodUndefined="ZodUndefined",t.ZodNull="ZodNull",t.ZodAny="ZodAny",t.ZodUnknown="ZodUnknown",t.ZodNever="ZodNever",t.ZodVoid="ZodVoid",t.ZodArray="ZodArray",t.ZodObject="ZodObject",t.ZodUnion="ZodUnion",t.ZodDiscriminatedUnion="ZodDiscriminatedUnion",t.ZodIntersection="ZodIntersection",t.ZodTuple="ZodTuple",t.ZodRecord="ZodRecord",t.ZodMap="ZodMap",t.ZodSet="ZodSet",t.ZodFunction="ZodFunction",t.ZodLazy="ZodLazy",t.ZodLiteral="ZodLiteral",t.ZodEnum="ZodEnum",t.ZodEffects="ZodEffects",t.ZodNativeEnum="ZodNativeEnum",t.ZodOptional="ZodOptional",t.ZodNullable="ZodNullable",t.ZodDefault="ZodDefault",t.ZodCatch="ZodCatch",t.ZodPromise="ZodPromise",t.ZodBranded="ZodBranded",t.ZodPipeline="ZodPipeline",t.ZodReadonly="ZodReadonly"})(ve||(ve={}));var DR=(t,e={message:`Input not instance of ${t.name}`})=>p_(a=>a instanceof t,e),f_=Lo.create,m_=uu.create,NR=zf.create,WR=cu.create,h_=pu.create,BR=fu.create,ZR=qf.create,qR=mu.create,FR=hu.create,jR=Eo.create,HR=er.create,zR=Cn.create,KR=Ff.create,VR=br.create,UR=is.create,GR=is.strictCreate,QR=gu.create,YR=i_.create,JR=yu.create,XR=xi.create,eD=l_.create,tD=jf.create,aD=Hf.create,sD=d_.create,nD=vu.create,iD=bu.create,rD=Mc.create,oD=wu.create,lD=Io.create,Iw=Ms.create,dD=Us.create,uD=_i.create,cD=Ms.createWithPreprocess,pD=Ev.create,fD=()=>f_().optional(),mD=()=>m_().optional(),hD=()=>h_().optional(),gD={string:t=>Lo.create({...t,coerce:!0}),number:t=>uu.create({...t,coerce:!0}),boolean:t=>pu.create({...t,coerce:!0}),bigint:t=>cu.create({...t,coerce:!0}),date:t=>fu.create({...t,coerce:!0})},yD=Ce,C=Object.freeze({__proto__:null,defaultErrorMap:Mo,setErrorMap:yR,getErrorMap:Nf,makeIssue:Wf,EMPTY_PATH:vR,addIssueToContext:z,ParseStatus:Oa,INVALID:Ce,DIRTY:Bf,OK:ma,isAborted:Xg,isDirty:ey,isValid:lu,isAsync:du,get util(){return Qe},get objectUtil(){return Jg},ZodParsedType:J,getParsedType:Xn,ZodType:Be,datetimeRegex:s_,ZodString:Lo,ZodNumber:uu,ZodBigInt:cu,ZodBoolean:pu,ZodDate:fu,ZodSymbol:qf,ZodUndefined:mu,ZodNull:hu,ZodAny:Eo,ZodUnknown:er,ZodNever:Cn,ZodVoid:Ff,ZodArray:br,ZodObject:is,ZodUnion:gu,ZodDiscriminatedUnion:i_,ZodIntersection:yu,ZodTuple:xi,ZodRecord:l_,ZodMap:jf,ZodSet:Hf,ZodFunction:d_,ZodLazy:vu,ZodLiteral:bu,ZodEnum:Mc,ZodNativeEnum:wu,ZodPromise:Io,ZodEffects:Ms,ZodTransformer:Ms,ZodOptional:Us,ZodNullable:_i,ZodDefault:ku,ZodCatch:xu,ZodNaN:zf,BRAND:PR,ZodBranded:Lv,ZodPipeline:Ev,ZodReadonly:_u,custom:p_,Schema:Be,ZodSchema:Be,late:RR,get ZodFirstPartyTypeKind(){return ve},coerce:gD,any:jR,array:VR,bigint:WR,boolean:h_,date:BR,discriminatedUnion:YR,effect:Iw,enum:rD,function:sD,instanceof:DR,intersection:JR,lazy:nD,literal:iD,map:tD,nan:NR,nativeEnum:oD,never:zR,null:FR,nullable:uD,number:m_,object:UR,oboolean:hD,onumber:mD,optional:dD,ostring:fD,pipeline:pD,preprocess:cD,promise:lD,record:eD,set:aD,strictObject:GR,string:f_,symbol:ZR,transformer:Iw,tuple:XR,undefined:qR,union:QR,unknown:HR,void:KR,NEVER:yD,ZodIssueCode:D,quotelessJson:gR,ZodError:xs}),Hh=C.custom(t=>typeof t=="string"?/^\d+$/.test(t):!1),Lc=()=>C.string().regex(/^[a-zA-Z0-9_]+$/);Lc();Lc().max(50);var g_=C.enum(["normal","expert","master"]),fl=C.object({acc:C.number().nonnegative().max(100),consistency:C.number().nonnegative().max(100),difficulty:g_,lazyMode:C.boolean().optional(),language:C.string().max(100).regex(/[\w+]+/),punctuation:C.boolean().optional(),numbers:C.boolean().optional(),raw:C.number().nonnegative(),wpm:C.number().nonnegative(),timestamp:C.number().nonnegative()}),vD=C.object({time:C.record(Hh,C.array(fl)),words:C.record(Hh,C.array(fl)),quote:C.record(Hh,C.array(fl)),custom:C.record(C.literal("custom"),C.array(fl)),zen:C.record(C.literal("zen"),C.array(fl))}),bD=vD.keyof(),y_=C.enum(["off","slow","medium","fast"]),v_=C.enum(["off","esc","tab","enter"]),b_=C.union([C.literal(-3),C.literal(-2),C.literal(-1),C.literal(0),C.literal(1),C.literal(2),C.literal(3)]),w_=C.array(b_),Kf=C.enum(["off","default","block","outline","underline","carrot","banana"]),k_=C.enum(["off","on","max"]),x_=C.enum(["off","below","replace"]),__=C.enum(["off","bar","text","mini"]),io=C.enum(["off","text","mini"]),C_=C.enum(["off","on","fav","light","dark","custom"]),S_=C.enum(["black","sub","text","main"]),T_=C.enum(["0.25","0.5","0.75","1"]),$_=C.enum(["off","word","letter"]),A_=C.enum(["off","static","react","next"]),M_=C.enum(["staggered","alice","matrix","split","split_matrix","steno","steno_matrix"]),L_=C.enum(["lowercase","uppercase","blank","dynamic"]),E_=C.enum(["always","layout","never"]),I_=C.number().min(.5).max(3.5).step(.1),O_=C.enum(["manual","on"]),P_=C.enum(["off","1","2","3","4"]),R_=C.enum(["off","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15"]),D_=C.number().min(0).max(1),N_=C.enum(["off","average","pb","tagPb","last","custom","daily"]),W_=C.tuple([C.enum(["on","off"]),C.enum(["on","off"]),C.enum(["on","off"]),C.enum(["on","off"])]),B_=C.enum(["off","custom"]),Z_=C.enum(["off","letter","word","next_word","next_two_words","next_three_words"]),q_=C.enum(["off","letter","word"]),F_=C.enum(["wpm","cpm","wps","cps","wph"]),j_=C.enum(["off","result","on","sellout"]),H_=C.enum(["off","custom"]),z_=C.enum(["off","typing"]),K_=C.enum(["off","on","keymap"]),V_=C.enum(["cover","contain","max"]),U_=C.tuple([C.number(),C.number(),C.number(),C.number()]),wD=C.string().regex(/^[0-9a-zA-Z_#]+$/),G_=C.enum(["off","1","2","3","4"]),Q_=C.enum(["off","fixed","flex"]),Y_=C.enum(["off","speed","acc","both"]),Os=C.string().regex(/^#([\da-f]{3}){1,2}$/i),J_=g_,X_=C.tuple([Os,Os,Os,Os,Os,Os,Os,Os,Os,Os]),eC=C.array(Lc().max(50)),Iv=C.string().max(100).regex(/[\w#]+/),tC=C.number().nonnegative(),aC=C.number().nonnegative(),sC=C.number().nonnegative().max(100),nC=C.number().nonnegative(),iC=C.number().int().nonnegative(),rC=C.number().int().nonnegative(),oC=C.string().max(50).regex(/^[a-zA-Z0-9_\-+.]+$/),tr=Lc().max(50),lC=C.string().max(50).regex(/^[a-zA-Z0-9_+]+$/),dC=C.string().max(50).regex(/[\w\-_]+/),uC=Lc().max(50),cC=C.number().positive(),pC=C.number().min(20).max(1e3).or(C.literal(0)),fC=C.string().regex(/(https|http):\/\/(www\.|).+\..+\/.+(\.png|\.gif|\.jpeg|\.jpg)/gi).or(C.literal("")),kD=C.object({theme:tr,themeLight:tr,themeDark:tr,autoSwitchTheme:C.boolean(),customTheme:C.boolean(),customThemeColors:X_,favThemes:eC,showKeyTips:C.boolean(),smoothCaret:y_,quickRestart:v_,punctuation:C.boolean(),numbers:C.boolean(),words:rC,time:iC,mode:bD,quoteLength:w_,language:lC,fontSize:cC,freedomMode:C.boolean(),difficulty:J_,blindMode:C.boolean(),quickEnd:C.boolean(),caretStyle:Kf,paceCaretStyle:Kf,flipTestColors:C.boolean(),layout:uC,funbox:Iv,confidenceMode:k_,indicateTypos:x_,timerStyle:__,liveSpeedStyle:io,liveAccStyle:io,liveBurstStyle:io,colorfulMode:C.boolean(),randomTheme:C_,timerColor:S_,timerOpacity:T_,stopOnError:$_,showAllLines:C.boolean(),keymapMode:A_,keymapStyle:M_,keymapLegendStyle:L_,keymapLayout:dC,keymapShowTopRow:E_,keymapSize:I_,fontFamily:oC,smoothLineScroll:C.boolean(),alwaysShowDecimalPlaces:C.boolean(),alwaysShowWordsHistory:C.boolean(),singleListCommandLine:O_,capsLockWarning:C.boolean(),playSoundOnError:P_,playSoundOnClick:R_,soundVolume:D_,startGraphsAtZero:C.boolean(),showOutOfFocusWarning:C.boolean(),paceCaret:N_,paceCaretCustomSpeed:tC,repeatedPace:C.boolean(),accountChart:W_,minWpm:B_,minWpmCustomSpeed:aC,highlightMode:Z_,tapeMode:q_,typingSpeedUnit:F_,ads:j_,hideExtraLetters:C.boolean(),strictSpace:C.boolean(),minAcc:H_,minAccCustom:sC,monkey:C.boolean(),repeatQuotes:z_,oppositeShiftMode:K_,customBackground:fC,customBackgroundSize:V_,customBackgroundFilter:U_,customLayoutfluid:wD,monkeyPowerLevel:G_,minBurst:Q_,minBurstCustomSpeed:nC,burstHeatmap:C.boolean(),britishEnglish:C.boolean(),lazyMode:C.boolean(),showAverage:Y_,maxLineWidth:pC}).strict();kD.partial();var Ye;(function(t){t.assertEqual=n=>n;function e(n){}t.assertIs=e;function a(n){throw new Error}t.assertNever=a,t.arrayToEnum=n=>{let r={};for(let o of n)r[o]=o;return r},t.getValidEnumValues=n=>{let r=t.objectKeys(n).filter(l=>typeof n[n[l]]!="number"),o={};for(let l of r)o[l]=n[l];return t.objectValues(o)},t.objectValues=n=>t.objectKeys(n).map(function(r){return n[r]}),t.objectKeys=typeof Object.keys=="function"?n=>Object.keys(n):n=>{let r=[];for(let o in n)Object.prototype.hasOwnProperty.call(n,o)&&r.push(o);return r},t.find=(n,r)=>{for(let o of n)if(r(o))return o},t.isInteger=typeof Number.isInteger=="function"?n=>Number.isInteger(n):n=>typeof n=="number"&&isFinite(n)&&Math.floor(n)===n;function s(n,r=" | "){return n.map(o=>typeof o=="string"?`'${o}'`:o).join(r)}t.joinValues=s,t.jsonStringifyReplacer=(n,r)=>typeof r=="bigint"?r.toString():r})(Ye||(Ye={}));var oy;(function(t){t.mergeShapes=(e,a)=>({...e,...a})})(oy||(oy={}));var X=Ye.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),ei=t=>{switch(typeof t){case"undefined":return X.undefined;case"string":return X.string;case"number":return isNaN(t)?X.nan:X.number;case"boolean":return X.boolean;case"function":return X.function;case"bigint":return X.bigint;case"symbol":return X.symbol;case"object":return Array.isArray(t)?X.array:t===null?X.null:t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?X.promise:typeof Map<"u"&&t instanceof Map?X.map:typeof Set<"u"&&t instanceof Set?X.set:typeof Date<"u"&&t instanceof Date?X.date:X.object;default:return X.unknown}},N=Ye.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),xD=t=>JSON.stringify(t,null,2).replace(/"([^"]+)":/g,"$1:"),_s=class mC extends Error{constructor(e){super(),this.issues=[],this.addIssue=s=>{this.issues=[...this.issues,s]},this.addIssues=(s=[])=>{this.issues=[...this.issues,...s]};let a=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,a):this.__proto__=a,this.name="ZodError",this.issues=e}get errors(){return this.issues}format(e){let a=e||function(r){return r.message},s={_errors:[]},n=r=>{for(let o of r.issues)if(o.code==="invalid_union")o.unionErrors.map(n);else if(o.code==="invalid_return_type")n(o.returnTypeError);else if(o.code==="invalid_arguments")n(o.argumentsError);else if(o.path.length===0)s._errors.push(a(o));else{let l=s,u=0;for(;u<o.path.length;){let c=o.path[u];u===o.path.length-1?(l[c]=l[c]||{_errors:[]},l[c]._errors.push(a(o))):l[c]=l[c]||{_errors:[]},l=l[c],u++}}};return n(this),s}static assert(e){if(!(e instanceof mC))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,Ye.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=a=>a.message){let a={},s=[];for(let n of this.issues)n.path.length>0?(a[n.path[0]]=a[n.path[0]]||[],a[n.path[0]].push(e(n))):s.push(e(n));return{formErrors:s,fieldErrors:a}}get formErrors(){return this.flatten()}};_s.create=t=>new _s(t);var Oo=(t,e)=>{let a;switch(t.code){case N.invalid_type:t.received===X.undefined?a="Required":a=`Expected ${t.expected}, received ${t.received}`;break;case N.invalid_literal:a=`Invalid literal value, expected ${JSON.stringify(t.expected,Ye.jsonStringifyReplacer)}`;break;case N.unrecognized_keys:a=`Unrecognized key(s) in object: ${Ye.joinValues(t.keys,", ")}`;break;case N.invalid_union:a="Invalid input";break;case N.invalid_union_discriminator:a=`Invalid discriminator value. Expected ${Ye.joinValues(t.options)}`;break;case N.invalid_enum_value:a=`Invalid enum value. Expected ${Ye.joinValues(t.options)}, received '${t.received}'`;break;case N.invalid_arguments:a="Invalid function arguments";break;case N.invalid_return_type:a="Invalid function return type";break;case N.invalid_date:a="Invalid date";break;case N.invalid_string:typeof t.validation=="object"?"includes"in t.validation?(a=`Invalid input: must include "${t.validation.includes}"`,typeof t.validation.position=="number"&&(a=`${a} at one or more positions greater than or equal to ${t.validation.position}`)):"startsWith"in t.validation?a=`Invalid input: must start with "${t.validation.startsWith}"`:"endsWith"in t.validation?a=`Invalid input: must end with "${t.validation.endsWith}"`:Ye.assertNever(t.validation):t.validation!=="regex"?a=`Invalid ${t.validation}`:a="Invalid";break;case N.too_small:t.type==="array"?a=`Array must contain ${t.exact?"exactly":t.inclusive?"at least":"more than"} ${t.minimum} element(s)`:t.type==="string"?a=`String must contain ${t.exact?"exactly":t.inclusive?"at least":"over"} ${t.minimum} character(s)`:t.type==="number"?a=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="date"?a=`Date must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(t.minimum))}`:a="Invalid input";break;case N.too_big:t.type==="array"?a=`Array must contain ${t.exact?"exactly":t.inclusive?"at most":"less than"} ${t.maximum} element(s)`:t.type==="string"?a=`String must contain ${t.exact?"exactly":t.inclusive?"at most":"under"} ${t.maximum} character(s)`:t.type==="number"?a=`Number must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="bigint"?a=`BigInt must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="date"?a=`Date must be ${t.exact?"exactly":t.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(t.maximum))}`:a="Invalid input";break;case N.custom:a="Invalid input";break;case N.invalid_intersection_types:a="Intersection results could not be merged";break;case N.not_multiple_of:a=`Number must be a multiple of ${t.multipleOf}`;break;case N.not_finite:a="Number must be finite";break;default:a=e.defaultError,Ye.assertNever(t)}return{message:a}},hC=Oo;function _D(t){hC=t}function Vf(){return hC}var Uf=t=>{let{data:e,path:a,errorMaps:s,issueData:n}=t,r=[...a,...n.path||[]],o={...n,path:r};if(n.message!==void 0)return{...n,path:r,message:n.message};let l="",u=s.filter(c=>!!c).slice().reverse();for(let c of u)l=c(o,{data:e,defaultError:l}).message;return{...n,path:r,message:l}},CD=[];function K(t,e){let a=Vf(),s=Uf({issueData:e,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,a,a===Oo?void 0:Oo].filter(n=>!!n)});t.common.issues.push(s)}var Pa=class gC{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,a){let s=[];for(let n of a){if(n.status==="aborted")return Se;n.status==="dirty"&&e.dirty(),s.push(n.value)}return{status:e.value,value:s}}static async mergeObjectAsync(e,a){let s=[];for(let n of a){let r=await n.key,o=await n.value;s.push({key:r,value:o})}return gC.mergeObjectSync(e,s)}static mergeObjectSync(e,a){let s={};for(let n of a){let{key:r,value:o}=n;if(r.status==="aborted"||o.status==="aborted")return Se;r.status==="dirty"&&e.dirty(),o.status==="dirty"&&e.dirty(),r.value!=="__proto__"&&(typeof o.value<"u"||n.alwaysSet)&&(s[r.value]=o.value)}return{status:e.value,value:s}}},Se=Object.freeze({status:"aborted"}),Gf=t=>({status:"dirty",value:t}),ha=t=>({status:"valid",value:t}),ly=t=>t.status==="aborted",dy=t=>t.status==="dirty",Cu=t=>t.status==="valid",Su=t=>typeof Promise<"u"&&t instanceof Promise;function Qf(t,e,a,s){if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return e.get(t)}function yC(t,e,a,s,n){if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return e.set(t,a),a}var le;(function(t){t.errToObj=e=>typeof e=="string"?{message:e}:e||{},t.toString=e=>typeof e=="string"?e:e==null?void 0:e.message})(le||(le={}));var Dl,Nl,en=class{constructor(t,e,a,s){this._cachedPath=[],this.parent=t,this.data=e,this._path=a,this._key=s}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}},Ow=(t,e)=>{if(Cu(e))return{success:!0,data:e.value};if(!t.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;let a=new _s(t.common.issues);return this._error=a,this._error}}};function Pe(t){if(!t)return{};let{errorMap:e,invalid_type_error:a,required_error:s,description:n}=t;if(e&&(a||s))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:n}:{errorMap:(r,o)=>{var l,u;let{message:c}=t;return r.code==="invalid_enum_value"?{message:c??o.defaultError}:typeof o.data>"u"?{message:(l=c??s)!==null&&l!==void 0?l:o.defaultError}:r.code!=="invalid_type"?{message:o.defaultError}:{message:(u=c??a)!==null&&u!==void 0?u:o.defaultError}},description:n}}var Ze=class{constructor(t){this.spa=this.safeParseAsync,this._def=t,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this)}get description(){return this._def.description}_getType(t){return ei(t.data)}_getOrReturnCtx(t,e){return e||{common:t.parent.common,data:t.data,parsedType:ei(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}_processInputParams(t){return{status:new Pa,ctx:{common:t.parent.common,data:t.data,parsedType:ei(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}}_parseSync(t){let e=this._parse(t);if(Su(e))throw new Error("Synchronous parse encountered promise.");return e}_parseAsync(t){let e=this._parse(t);return Promise.resolve(e)}parse(t,e){let a=this.safeParse(t,e);if(a.success)return a.data;throw a.error}safeParse(t,e){var a;let s={common:{issues:[],async:(a=e==null?void 0:e.async)!==null&&a!==void 0?a:!1,contextualErrorMap:e==null?void 0:e.errorMap},path:(e==null?void 0:e.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:ei(t)},n=this._parseSync({data:t,path:s.path,parent:s});return Ow(s,n)}async parseAsync(t,e){let a=await this.safeParseAsync(t,e);if(a.success)return a.data;throw a.error}async safeParseAsync(t,e){let a={common:{issues:[],contextualErrorMap:e==null?void 0:e.errorMap,async:!0},path:(e==null?void 0:e.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:ei(t)},s=this._parse({data:t,path:a.path,parent:a}),n=await(Su(s)?s:Promise.resolve(s));return Ow(a,n)}refine(t,e){let a=s=>typeof e=="string"||typeof e>"u"?{message:e}:typeof e=="function"?e(s):e;return this._refinement((s,n)=>{let r=t(s),o=()=>n.addIssue({code:N.custom,...a(s)});return typeof Promise<"u"&&r instanceof Promise?r.then(l=>l?!0:(o(),!1)):r?!0:(o(),!1)})}refinement(t,e){return this._refinement((a,s)=>t(a)?!0:(s.addIssue(typeof e=="function"?e(a,s):e),!1))}_refinement(t){return new Ls({schema:this,typeName:be.ZodEffects,effect:{type:"refinement",refinement:t}})}superRefine(t){return this._refinement(t)}optional(){return Gs.create(this,this._def)}nullable(){return Si.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return wr.create(this,this._def)}promise(){return Do.create(this,this._def)}or(t){return Iu.create([this,t],this._def)}and(t){return Ou.create(this,t,this._def)}transform(t){return new Ls({...Pe(this._def),schema:this,typeName:be.ZodEffects,effect:{type:"transform",transform:t}})}default(t){let e=typeof t=="function"?t:()=>t;return new Nu({...Pe(this._def),innerType:this,defaultValue:e,typeName:be.ZodDefault})}brand(){return new Ov({typeName:be.ZodBranded,type:this,...Pe(this._def)})}catch(t){let e=typeof t=="function"?t:()=>t;return new Wu({...Pe(this._def),innerType:this,catchValue:e,typeName:be.ZodCatch})}describe(t){let e=this.constructor;return new e({...this._def,description:t})}pipe(t){return Pv.create(this,t)}readonly(){return Bu.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}},SD=/^c[^\s-]{8,}$/i,TD=/^[0-9a-z]+$/,$D=/^[0-9A-HJKMNP-TV-Z]{26}$/,AD=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,MD=/^[a-z0-9_-]{21}$/i,LD=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,ED=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,ID="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$",zh,OD=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,PD=/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,RD=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,vC="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",DD=new RegExp(`^${vC}$`);function bC(t){let e="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return t.precision?e=`${e}\\.\\d{${t.precision}}`:t.precision==null&&(e=`${e}(\\.\\d+)?`),e}function ND(t){return new RegExp(`^${bC(t)}$`)}function wC(t){let e=`${vC}T${bC(t)}`,a=[];return a.push(t.local?"Z?":"Z"),t.offset&&a.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${a.join("|")})`,new RegExp(`^${e}$`)}function WD(t,e){return!!((e==="v4"||!e)&&OD.test(t)||(e==="v6"||!e)&&PD.test(t))}var Po=class Wl extends Ze{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==X.string){let n=this._getOrReturnCtx(e);return K(n,{code:N.invalid_type,expected:X.string,received:n.parsedType}),Se}let a=new Pa,s;for(let n of this._def.checks)if(n.kind==="min")e.data.length<n.value&&(s=this._getOrReturnCtx(e,s),K(s,{code:N.too_small,minimum:n.value,type:"string",inclusive:!0,exact:!1,message:n.message}),a.dirty());else if(n.kind==="max")e.data.length>n.value&&(s=this._getOrReturnCtx(e,s),K(s,{code:N.too_big,maximum:n.value,type:"string",inclusive:!0,exact:!1,message:n.message}),a.dirty());else if(n.kind==="length"){let r=e.data.length>n.value,o=e.data.length<n.value;(r||o)&&(s=this._getOrReturnCtx(e,s),r?K(s,{code:N.too_big,maximum:n.value,type:"string",inclusive:!0,exact:!0,message:n.message}):o&&K(s,{code:N.too_small,minimum:n.value,type:"string",inclusive:!0,exact:!0,message:n.message}),a.dirty())}else if(n.kind==="email")ED.test(e.data)||(s=this._getOrReturnCtx(e,s),K(s,{validation:"email",code:N.invalid_string,message:n.message}),a.dirty());else if(n.kind==="emoji")zh||(zh=new RegExp(ID,"u")),zh.test(e.data)||(s=this._getOrReturnCtx(e,s),K(s,{validation:"emoji",code:N.invalid_string,message:n.message}),a.dirty());else if(n.kind==="uuid")AD.test(e.data)||(s=this._getOrReturnCtx(e,s),K(s,{validation:"uuid",code:N.invalid_string,message:n.message}),a.dirty());else if(n.kind==="nanoid")MD.test(e.data)||(s=this._getOrReturnCtx(e,s),K(s,{validation:"nanoid",code:N.invalid_string,message:n.message}),a.dirty());else if(n.kind==="cuid")SD.test(e.data)||(s=this._getOrReturnCtx(e,s),K(s,{validation:"cuid",code:N.invalid_string,message:n.message}),a.dirty());else if(n.kind==="cuid2")TD.test(e.data)||(s=this._getOrReturnCtx(e,s),K(s,{validation:"cuid2",code:N.invalid_string,message:n.message}),a.dirty());else if(n.kind==="ulid")$D.test(e.data)||(s=this._getOrReturnCtx(e,s),K(s,{validation:"ulid",code:N.invalid_string,message:n.message}),a.dirty());else if(n.kind==="url")try{new URL(e.data)}catch{s=this._getOrReturnCtx(e,s),K(s,{validation:"url",code:N.invalid_string,message:n.message}),a.dirty()}else n.kind==="regex"?(n.regex.lastIndex=0,n.regex.test(e.data)||(s=this._getOrReturnCtx(e,s),K(s,{validation:"regex",code:N.invalid_string,message:n.message}),a.dirty())):n.kind==="trim"?e.data=e.data.trim():n.kind==="includes"?e.data.includes(n.value,n.position)||(s=this._getOrReturnCtx(e,s),K(s,{code:N.invalid_string,validation:{includes:n.value,position:n.position},message:n.message}),a.dirty()):n.kind==="toLowerCase"?e.data=e.data.toLowerCase():n.kind==="toUpperCase"?e.data=e.data.toUpperCase():n.kind==="startsWith"?e.data.startsWith(n.value)||(s=this._getOrReturnCtx(e,s),K(s,{code:N.invalid_string,validation:{startsWith:n.value},message:n.message}),a.dirty()):n.kind==="endsWith"?e.data.endsWith(n.value)||(s=this._getOrReturnCtx(e,s),K(s,{code:N.invalid_string,validation:{endsWith:n.value},message:n.message}),a.dirty()):n.kind==="datetime"?wC(n).test(e.data)||(s=this._getOrReturnCtx(e,s),K(s,{code:N.invalid_string,validation:"datetime",message:n.message}),a.dirty()):n.kind==="date"?DD.test(e.data)||(s=this._getOrReturnCtx(e,s),K(s,{code:N.invalid_string,validation:"date",message:n.message}),a.dirty()):n.kind==="time"?ND(n).test(e.data)||(s=this._getOrReturnCtx(e,s),K(s,{code:N.invalid_string,validation:"time",message:n.message}),a.dirty()):n.kind==="duration"?LD.test(e.data)||(s=this._getOrReturnCtx(e,s),K(s,{validation:"duration",code:N.invalid_string,message:n.message}),a.dirty()):n.kind==="ip"?WD(e.data,n.version)||(s=this._getOrReturnCtx(e,s),K(s,{validation:"ip",code:N.invalid_string,message:n.message}),a.dirty()):n.kind==="base64"?RD.test(e.data)||(s=this._getOrReturnCtx(e,s),K(s,{validation:"base64",code:N.invalid_string,message:n.message}),a.dirty()):Ye.assertNever(n);return{status:a.value,value:e.data}}_regex(e,a,s){return this.refinement(n=>e.test(n),{validation:a,code:N.invalid_string,...le.errToObj(s)})}_addCheck(e){return new Wl({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...le.errToObj(e)})}url(e){return this._addCheck({kind:"url",...le.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...le.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...le.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...le.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...le.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...le.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...le.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...le.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...le.errToObj(e)})}datetime(e){var a,s;return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,offset:(a=e==null?void 0:e.offset)!==null&&a!==void 0?a:!1,local:(s=e==null?void 0:e.local)!==null&&s!==void 0?s:!1,...le.errToObj(e==null?void 0:e.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,...le.errToObj(e==null?void 0:e.message)})}duration(e){return this._addCheck({kind:"duration",...le.errToObj(e)})}regex(e,a){return this._addCheck({kind:"regex",regex:e,...le.errToObj(a)})}includes(e,a){return this._addCheck({kind:"includes",value:e,position:a==null?void 0:a.position,...le.errToObj(a==null?void 0:a.message)})}startsWith(e,a){return this._addCheck({kind:"startsWith",value:e,...le.errToObj(a)})}endsWith(e,a){return this._addCheck({kind:"endsWith",value:e,...le.errToObj(a)})}min(e,a){return this._addCheck({kind:"min",value:e,...le.errToObj(a)})}max(e,a){return this._addCheck({kind:"max",value:e,...le.errToObj(a)})}length(e,a){return this._addCheck({kind:"length",value:e,...le.errToObj(a)})}nonempty(e){return this.min(1,le.errToObj(e))}trim(){return new Wl({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new Wl({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new Wl({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get minLength(){let e=null;for(let a of this._def.checks)a.kind==="min"&&(e===null||a.value>e)&&(e=a.value);return e}get maxLength(){let e=null;for(let a of this._def.checks)a.kind==="max"&&(e===null||a.value<e)&&(e=a.value);return e}};Po.create=t=>{var e;return new Po({checks:[],typeName:be.ZodString,coerce:(e=t==null?void 0:t.coerce)!==null&&e!==void 0?e:!1,...Pe(t)})};function BD(t,e){let a=(t.toString().split(".")[1]||"").length,s=(e.toString().split(".")[1]||"").length,n=a>s?a:s,r=parseInt(t.toFixed(n).replace(".","")),o=parseInt(e.toFixed(n).replace(".",""));return r%o/Math.pow(10,n)}var Tu=class uy extends Ze{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==X.number){let n=this._getOrReturnCtx(e);return K(n,{code:N.invalid_type,expected:X.number,received:n.parsedType}),Se}let a,s=new Pa;for(let n of this._def.checks)n.kind==="int"?Ye.isInteger(e.data)||(a=this._getOrReturnCtx(e,a),K(a,{code:N.invalid_type,expected:"integer",received:"float",message:n.message}),s.dirty()):n.kind==="min"?(n.inclusive?e.data<n.value:e.data<=n.value)&&(a=this._getOrReturnCtx(e,a),K(a,{code:N.too_small,minimum:n.value,type:"number",inclusive:n.inclusive,exact:!1,message:n.message}),s.dirty()):n.kind==="max"?(n.inclusive?e.data>n.value:e.data>=n.value)&&(a=this._getOrReturnCtx(e,a),K(a,{code:N.too_big,maximum:n.value,type:"number",inclusive:n.inclusive,exact:!1,message:n.message}),s.dirty()):n.kind==="multipleOf"?BD(e.data,n.value)!==0&&(a=this._getOrReturnCtx(e,a),K(a,{code:N.not_multiple_of,multipleOf:n.value,message:n.message}),s.dirty()):n.kind==="finite"?Number.isFinite(e.data)||(a=this._getOrReturnCtx(e,a),K(a,{code:N.not_finite,message:n.message}),s.dirty()):Ye.assertNever(n);return{status:s.value,value:e.data}}gte(e,a){return this.setLimit("min",e,!0,le.toString(a))}gt(e,a){return this.setLimit("min",e,!1,le.toString(a))}lte(e,a){return this.setLimit("max",e,!0,le.toString(a))}lt(e,a){return this.setLimit("max",e,!1,le.toString(a))}setLimit(e,a,s,n){return new uy({...this._def,checks:[...this._def.checks,{kind:e,value:a,inclusive:s,message:le.toString(n)}]})}_addCheck(e){return new uy({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:le.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:le.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:le.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:le.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:le.toString(e)})}multipleOf(e,a){return this._addCheck({kind:"multipleOf",value:e,message:le.toString(a)})}finite(e){return this._addCheck({kind:"finite",message:le.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:le.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:le.toString(e)})}get minValue(){let e=null;for(let a of this._def.checks)a.kind==="min"&&(e===null||a.value>e)&&(e=a.value);return e}get maxValue(){let e=null;for(let a of this._def.checks)a.kind==="max"&&(e===null||a.value<e)&&(e=a.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&Ye.isInteger(e.value))}get isFinite(){let e=null,a=null;for(let s of this._def.checks){if(s.kind==="finite"||s.kind==="int"||s.kind==="multipleOf")return!0;s.kind==="min"?(a===null||s.value>a)&&(a=s.value):s.kind==="max"&&(e===null||s.value<e)&&(e=s.value)}return Number.isFinite(a)&&Number.isFinite(e)}};Tu.create=t=>new Tu({checks:[],typeName:be.ZodNumber,coerce:(t==null?void 0:t.coerce)||!1,...Pe(t)});var $u=class cy extends Ze{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce&&(e.data=BigInt(e.data)),this._getType(e)!==X.bigint){let n=this._getOrReturnCtx(e);return K(n,{code:N.invalid_type,expected:X.bigint,received:n.parsedType}),Se}let a,s=new Pa;for(let n of this._def.checks)n.kind==="min"?(n.inclusive?e.data<n.value:e.data<=n.value)&&(a=this._getOrReturnCtx(e,a),K(a,{code:N.too_small,type:"bigint",minimum:n.value,inclusive:n.inclusive,message:n.message}),s.dirty()):n.kind==="max"?(n.inclusive?e.data>n.value:e.data>=n.value)&&(a=this._getOrReturnCtx(e,a),K(a,{code:N.too_big,type:"bigint",maximum:n.value,inclusive:n.inclusive,message:n.message}),s.dirty()):n.kind==="multipleOf"?e.data%n.value!==BigInt(0)&&(a=this._getOrReturnCtx(e,a),K(a,{code:N.not_multiple_of,multipleOf:n.value,message:n.message}),s.dirty()):Ye.assertNever(n);return{status:s.value,value:e.data}}gte(e,a){return this.setLimit("min",e,!0,le.toString(a))}gt(e,a){return this.setLimit("min",e,!1,le.toString(a))}lte(e,a){return this.setLimit("max",e,!0,le.toString(a))}lt(e,a){return this.setLimit("max",e,!1,le.toString(a))}setLimit(e,a,s,n){return new cy({...this._def,checks:[...this._def.checks,{kind:e,value:a,inclusive:s,message:le.toString(n)}]})}_addCheck(e){return new cy({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:le.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:le.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:le.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:le.toString(e)})}multipleOf(e,a){return this._addCheck({kind:"multipleOf",value:e,message:le.toString(a)})}get minValue(){let e=null;for(let a of this._def.checks)a.kind==="min"&&(e===null||a.value>e)&&(e=a.value);return e}get maxValue(){let e=null;for(let a of this._def.checks)a.kind==="max"&&(e===null||a.value<e)&&(e=a.value);return e}};$u.create=t=>{var e;return new $u({checks:[],typeName:be.ZodBigInt,coerce:(e=t==null?void 0:t.coerce)!==null&&e!==void 0?e:!1,...Pe(t)})};var Au=class extends Ze{_parse(t){if(this._def.coerce&&(t.data=!!t.data),this._getType(t)!==X.boolean){let e=this._getOrReturnCtx(t);return K(e,{code:N.invalid_type,expected:X.boolean,received:e.parsedType}),Se}return ha(t.data)}};Au.create=t=>new Au({typeName:be.ZodBoolean,coerce:(t==null?void 0:t.coerce)||!1,...Pe(t)});var Mu=class kC extends Ze{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==X.date){let n=this._getOrReturnCtx(e);return K(n,{code:N.invalid_type,expected:X.date,received:n.parsedType}),Se}if(isNaN(e.data.getTime())){let n=this._getOrReturnCtx(e);return K(n,{code:N.invalid_date}),Se}let a=new Pa,s;for(let n of this._def.checks)n.kind==="min"?e.data.getTime()<n.value&&(s=this._getOrReturnCtx(e,s),K(s,{code:N.too_small,message:n.message,inclusive:!0,exact:!1,minimum:n.value,type:"date"}),a.dirty()):n.kind==="max"?e.data.getTime()>n.value&&(s=this._getOrReturnCtx(e,s),K(s,{code:N.too_big,message:n.message,inclusive:!0,exact:!1,maximum:n.value,type:"date"}),a.dirty()):Ye.assertNever(n);return{status:a.value,value:new Date(e.data.getTime())}}_addCheck(e){return new kC({...this._def,checks:[...this._def.checks,e]})}min(e,a){return this._addCheck({kind:"min",value:e.getTime(),message:le.toString(a)})}max(e,a){return this._addCheck({kind:"max",value:e.getTime(),message:le.toString(a)})}get minDate(){let e=null;for(let a of this._def.checks)a.kind==="min"&&(e===null||a.value>e)&&(e=a.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(let a of this._def.checks)a.kind==="max"&&(e===null||a.value<e)&&(e=a.value);return e!=null?new Date(e):null}};Mu.create=t=>new Mu({checks:[],coerce:(t==null?void 0:t.coerce)||!1,typeName:be.ZodDate,...Pe(t)});var Yf=class extends Ze{_parse(t){if(this._getType(t)!==X.symbol){let e=this._getOrReturnCtx(t);return K(e,{code:N.invalid_type,expected:X.symbol,received:e.parsedType}),Se}return ha(t.data)}};Yf.create=t=>new Yf({typeName:be.ZodSymbol,...Pe(t)});var Lu=class extends Ze{_parse(t){if(this._getType(t)!==X.undefined){let e=this._getOrReturnCtx(t);return K(e,{code:N.invalid_type,expected:X.undefined,received:e.parsedType}),Se}return ha(t.data)}};Lu.create=t=>new Lu({typeName:be.ZodUndefined,...Pe(t)});var Eu=class extends Ze{_parse(t){if(this._getType(t)!==X.null){let e=this._getOrReturnCtx(t);return K(e,{code:N.invalid_type,expected:X.null,received:e.parsedType}),Se}return ha(t.data)}};Eu.create=t=>new Eu({typeName:be.ZodNull,...Pe(t)});var Ro=class extends Ze{constructor(){super(...arguments),this._any=!0}_parse(t){return ha(t.data)}};Ro.create=t=>new Ro({typeName:be.ZodAny,...Pe(t)});var ar=class extends Ze{constructor(){super(...arguments),this._unknown=!0}_parse(t){return ha(t.data)}};ar.create=t=>new ar({typeName:be.ZodUnknown,...Pe(t)});var Sn=class extends Ze{_parse(t){let e=this._getOrReturnCtx(t);return K(e,{code:N.invalid_type,expected:X.never,received:e.parsedType}),Se}};Sn.create=t=>new Sn({typeName:be.ZodNever,...Pe(t)});var Jf=class extends Ze{_parse(t){if(this._getType(t)!==X.undefined){let e=this._getOrReturnCtx(t);return K(e,{code:N.invalid_type,expected:X.void,received:e.parsedType}),Se}return ha(t.data)}};Jf.create=t=>new Jf({typeName:be.ZodVoid,...Pe(t)});var wr=class Hp extends Ze{_parse(e){let{ctx:a,status:s}=this._processInputParams(e),n=this._def;if(a.parsedType!==X.array)return K(a,{code:N.invalid_type,expected:X.array,received:a.parsedType}),Se;if(n.exactLength!==null){let o=a.data.length>n.exactLength.value,l=a.data.length<n.exactLength.value;(o||l)&&(K(a,{code:o?N.too_big:N.too_small,minimum:l?n.exactLength.value:void 0,maximum:o?n.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:n.exactLength.message}),s.dirty())}if(n.minLength!==null&&a.data.length<n.minLength.value&&(K(a,{code:N.too_small,minimum:n.minLength.value,type:"array",inclusive:!0,exact:!1,message:n.minLength.message}),s.dirty()),n.maxLength!==null&&a.data.length>n.maxLength.value&&(K(a,{code:N.too_big,maximum:n.maxLength.value,type:"array",inclusive:!0,exact:!1,message:n.maxLength.message}),s.dirty()),a.common.async)return Promise.all([...a.data].map((o,l)=>n.type._parseAsync(new en(a,o,a.path,l)))).then(o=>Pa.mergeArray(s,o));let r=[...a.data].map((o,l)=>n.type._parseSync(new en(a,o,a.path,l)));return Pa.mergeArray(s,r)}get element(){return this._def.type}min(e,a){return new Hp({...this._def,minLength:{value:e,message:le.toString(a)}})}max(e,a){return new Hp({...this._def,maxLength:{value:e,message:le.toString(a)}})}length(e,a){return new Hp({...this._def,exactLength:{value:e,message:le.toString(a)}})}nonempty(e){return this.min(1,e)}};wr.create=(t,e)=>new wr({type:t,minLength:null,maxLength:null,exactLength:null,typeName:be.ZodArray,...Pe(e)});function Gr(t){if(t instanceof rs){let e={};for(let a in t.shape){let s=t.shape[a];e[a]=Gs.create(Gr(s))}return new rs({...t._def,shape:()=>e})}else return t instanceof wr?new wr({...t._def,type:Gr(t.element)}):t instanceof Gs?Gs.create(Gr(t.unwrap())):t instanceof Si?Si.create(Gr(t.unwrap())):t instanceof Ci?Ci.create(t.items.map(e=>Gr(e))):t}var rs=class ms extends Ze{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;let e=this._def.shape(),a=Ye.objectKeys(e);return this._cached={shape:e,keys:a}}_parse(e){if(this._getType(e)!==X.object){let u=this._getOrReturnCtx(e);return K(u,{code:N.invalid_type,expected:X.object,received:u.parsedType}),Se}let{status:a,ctx:s}=this._processInputParams(e),{shape:n,keys:r}=this._getCached(),o=[];if(!(this._def.catchall instanceof Sn&&this._def.unknownKeys==="strip"))for(let u in s.data)r.includes(u)||o.push(u);let l=[];for(let u of r){let c=n[u],p=s.data[u];l.push({key:{status:"valid",value:u},value:c._parse(new en(s,p,s.path,u)),alwaysSet:u in s.data})}if(this._def.catchall instanceof Sn){let u=this._def.unknownKeys;if(u==="passthrough")for(let c of o)l.push({key:{status:"valid",value:c},value:{status:"valid",value:s.data[c]}});else if(u==="strict")o.length>0&&(K(s,{code:N.unrecognized_keys,keys:o}),a.dirty());else if(u!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{let u=this._def.catchall;for(let c of o){let p=s.data[c];l.push({key:{status:"valid",value:c},value:u._parse(new en(s,p,s.path,c)),alwaysSet:c in s.data})}}return s.common.async?Promise.resolve().then(async()=>{let u=[];for(let c of l){let p=await c.key,f=await c.value;u.push({key:p,value:f,alwaysSet:c.alwaysSet})}return u}).then(u=>Pa.mergeObjectSync(a,u)):Pa.mergeObjectSync(a,l)}get shape(){return this._def.shape()}strict(e){return le.errToObj,new ms({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(a,s)=>{var n,r,o,l;let u=(o=(r=(n=this._def).errorMap)===null||r===void 0?void 0:r.call(n,a,s).message)!==null&&o!==void 0?o:s.defaultError;return a.code==="unrecognized_keys"?{message:(l=le.errToObj(e).message)!==null&&l!==void 0?l:u}:{message:u}}}:{}})}strip(){return new ms({...this._def,unknownKeys:"strip"})}passthrough(){return new ms({...this._def,unknownKeys:"passthrough"})}extend(e){return new ms({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new ms({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:be.ZodObject})}setKey(e,a){return this.augment({[e]:a})}catchall(e){return new ms({...this._def,catchall:e})}pick(e){let a={};return Ye.objectKeys(e).forEach(s=>{e[s]&&this.shape[s]&&(a[s]=this.shape[s])}),new ms({...this._def,shape:()=>a})}omit(e){let a={};return Ye.objectKeys(this.shape).forEach(s=>{e[s]||(a[s]=this.shape[s])}),new ms({...this._def,shape:()=>a})}deepPartial(){return Gr(this)}partial(e){let a={};return Ye.objectKeys(this.shape).forEach(s=>{let n=this.shape[s];e&&!e[s]?a[s]=n:a[s]=n.optional()}),new ms({...this._def,shape:()=>a})}required(e){let a={};return Ye.objectKeys(this.shape).forEach(s=>{if(e&&!e[s])a[s]=this.shape[s];else{let n=this.shape[s];for(;n instanceof Gs;)n=n._def.innerType;a[s]=n}}),new ms({...this._def,shape:()=>a})}keyof(){return $C(Ye.objectKeys(this.shape))}};rs.create=(t,e)=>new rs({shape:()=>t,unknownKeys:"strip",catchall:Sn.create(),typeName:be.ZodObject,...Pe(e)});rs.strictCreate=(t,e)=>new rs({shape:()=>t,unknownKeys:"strict",catchall:Sn.create(),typeName:be.ZodObject,...Pe(e)});rs.lazycreate=(t,e)=>new rs({shape:t,unknownKeys:"strip",catchall:Sn.create(),typeName:be.ZodObject,...Pe(e)});var Iu=class extends Ze{_parse(t){let{ctx:e}=this._processInputParams(t),a=this._def.options;function s(n){for(let o of n)if(o.result.status==="valid")return o.result;for(let o of n)if(o.result.status==="dirty")return e.common.issues.push(...o.ctx.common.issues),o.result;let r=n.map(o=>new _s(o.ctx.common.issues));return K(e,{code:N.invalid_union,unionErrors:r}),Se}if(e.common.async)return Promise.all(a.map(async n=>{let r={...e,common:{...e.common,issues:[]},parent:null};return{result:await n._parseAsync({data:e.data,path:e.path,parent:r}),ctx:r}})).then(s);{let n,r=[];for(let l of a){let u={...e,common:{...e.common,issues:[]},parent:null},c=l._parseSync({data:e.data,path:e.path,parent:u});if(c.status==="valid")return c;c.status==="dirty"&&!n&&(n={result:c,ctx:u}),u.common.issues.length&&r.push(u.common.issues)}if(n)return e.common.issues.push(...n.ctx.common.issues),n.result;let o=r.map(l=>new _s(l));return K(e,{code:N.invalid_union,unionErrors:o}),Se}}get options(){return this._def.options}};Iu.create=(t,e)=>new Iu({options:t,typeName:be.ZodUnion,...Pe(e)});var Kn=t=>t instanceof Pu?Kn(t.schema):t instanceof Ls?Kn(t.innerType()):t instanceof Ru?[t.value]:t instanceof Ec?t.options:t instanceof Du?Ye.objectValues(t.enum):t instanceof Nu?Kn(t._def.innerType):t instanceof Lu?[void 0]:t instanceof Eu?[null]:t instanceof Gs?[void 0,...Kn(t.unwrap())]:t instanceof Si?[null,...Kn(t.unwrap())]:t instanceof Ov||t instanceof Bu?Kn(t.unwrap()):t instanceof Wu?Kn(t._def.innerType):[],xC=class _C extends Ze{_parse(e){let{ctx:a}=this._processInputParams(e);if(a.parsedType!==X.object)return K(a,{code:N.invalid_type,expected:X.object,received:a.parsedType}),Se;let s=this.discriminator,n=a.data[s],r=this.optionsMap.get(n);return r?a.common.async?r._parseAsync({data:a.data,path:a.path,parent:a}):r._parseSync({data:a.data,path:a.path,parent:a}):(K(a,{code:N.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[s]}),Se)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,a,s){let n=new Map;for(let r of a){let o=Kn(r.shape[e]);if(!o.length)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(let l of o){if(n.has(l))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(l)}`);n.set(l,r)}}return new _C({typeName:be.ZodDiscriminatedUnion,discriminator:e,options:a,optionsMap:n,...Pe(s)})}};function py(t,e){let a=ei(t),s=ei(e);if(t===e)return{valid:!0,data:t};if(a===X.object&&s===X.object){let n=Ye.objectKeys(e),r=Ye.objectKeys(t).filter(l=>n.indexOf(l)!==-1),o={...t,...e};for(let l of r){let u=py(t[l],e[l]);if(!u.valid)return{valid:!1};o[l]=u.data}return{valid:!0,data:o}}else if(a===X.array&&s===X.array){if(t.length!==e.length)return{valid:!1};let n=[];for(let r=0;r<t.length;r++){let o=t[r],l=e[r],u=py(o,l);if(!u.valid)return{valid:!1};n.push(u.data)}return{valid:!0,data:n}}else return a===X.date&&s===X.date&&+t==+e?{valid:!0,data:t}:{valid:!1}}var Ou=class extends Ze{_parse(t){let{status:e,ctx:a}=this._processInputParams(t),s=(n,r)=>{if(ly(n)||ly(r))return Se;let o=py(n.value,r.value);return o.valid?((dy(n)||dy(r))&&e.dirty(),{status:e.value,value:o.data}):(K(a,{code:N.invalid_intersection_types}),Se)};return a.common.async?Promise.all([this._def.left._parseAsync({data:a.data,path:a.path,parent:a}),this._def.right._parseAsync({data:a.data,path:a.path,parent:a})]).then(([n,r])=>s(n,r)):s(this._def.left._parseSync({data:a.data,path:a.path,parent:a}),this._def.right._parseSync({data:a.data,path:a.path,parent:a}))}};Ou.create=(t,e,a)=>new Ou({left:t,right:e,typeName:be.ZodIntersection,...Pe(a)});var Ci=class CC extends Ze{_parse(e){let{status:a,ctx:s}=this._processInputParams(e);if(s.parsedType!==X.array)return K(s,{code:N.invalid_type,expected:X.array,received:s.parsedType}),Se;if(s.data.length<this._def.items.length)return K(s,{code:N.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),Se;!this._def.rest&&s.data.length>this._def.items.length&&(K(s,{code:N.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),a.dirty());let n=[...s.data].map((r,o)=>{let l=this._def.items[o]||this._def.rest;return l?l._parse(new en(s,r,s.path,o)):null}).filter(r=>!!r);return s.common.async?Promise.all(n).then(r=>Pa.mergeArray(a,r)):Pa.mergeArray(a,n)}get items(){return this._def.items}rest(e){return new CC({...this._def,rest:e})}};Ci.create=(t,e)=>{if(!Array.isArray(t))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new Ci({items:t,typeName:be.ZodTuple,rest:null,...Pe(e)})};var SC=class fy extends Ze{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:a,ctx:s}=this._processInputParams(e);if(s.parsedType!==X.object)return K(s,{code:N.invalid_type,expected:X.object,received:s.parsedType}),Se;let n=[],r=this._def.keyType,o=this._def.valueType;for(let l in s.data)n.push({key:r._parse(new en(s,l,s.path,l)),value:o._parse(new en(s,s.data[l],s.path,l)),alwaysSet:l in s.data});return s.common.async?Pa.mergeObjectAsync(a,n):Pa.mergeObjectSync(a,n)}get element(){return this._def.valueType}static create(e,a,s){return a instanceof Ze?new fy({keyType:e,valueType:a,typeName:be.ZodRecord,...Pe(s)}):new fy({keyType:Po.create(),valueType:e,typeName:be.ZodRecord,...Pe(a)})}},Xf=class extends Ze{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){let{status:e,ctx:a}=this._processInputParams(t);if(a.parsedType!==X.map)return K(a,{code:N.invalid_type,expected:X.map,received:a.parsedType}),Se;let s=this._def.keyType,n=this._def.valueType,r=[...a.data.entries()].map(([o,l],u)=>({key:s._parse(new en(a,o,a.path,[u,"key"])),value:n._parse(new en(a,l,a.path,[u,"value"]))}));if(a.common.async){let o=new Map;return Promise.resolve().then(async()=>{for(let l of r){let u=await l.key,c=await l.value;if(u.status==="aborted"||c.status==="aborted")return Se;(u.status==="dirty"||c.status==="dirty")&&e.dirty(),o.set(u.value,c.value)}return{status:e.value,value:o}})}else{let o=new Map;for(let l of r){let u=l.key,c=l.value;if(u.status==="aborted"||c.status==="aborted")return Se;(u.status==="dirty"||c.status==="dirty")&&e.dirty(),o.set(u.value,c.value)}return{status:e.value,value:o}}}};Xf.create=(t,e,a)=>new Xf({valueType:e,keyType:t,typeName:be.ZodMap,...Pe(a)});var em=class my extends Ze{_parse(e){let{status:a,ctx:s}=this._processInputParams(e);if(s.parsedType!==X.set)return K(s,{code:N.invalid_type,expected:X.set,received:s.parsedType}),Se;let n=this._def;n.minSize!==null&&s.data.size<n.minSize.value&&(K(s,{code:N.too_small,minimum:n.minSize.value,type:"set",inclusive:!0,exact:!1,message:n.minSize.message}),a.dirty()),n.maxSize!==null&&s.data.size>n.maxSize.value&&(K(s,{code:N.too_big,maximum:n.maxSize.value,type:"set",inclusive:!0,exact:!1,message:n.maxSize.message}),a.dirty());let r=this._def.valueType;function o(u){let c=new Set;for(let p of u){if(p.status==="aborted")return Se;p.status==="dirty"&&a.dirty(),c.add(p.value)}return{status:a.value,value:c}}let l=[...s.data.values()].map((u,c)=>r._parse(new en(s,u,s.path,c)));return s.common.async?Promise.all(l).then(u=>o(u)):o(l)}min(e,a){return new my({...this._def,minSize:{value:e,message:le.toString(a)}})}max(e,a){return new my({...this._def,maxSize:{value:e,message:le.toString(a)}})}size(e,a){return this.min(e,a).max(e,a)}nonempty(e){return this.min(1,e)}};em.create=(t,e)=>new em({valueType:t,minSize:null,maxSize:null,typeName:be.ZodSet,...Pe(e)});var TC=class zp extends Ze{constructor(){super(...arguments),this.validate=this.implement}_parse(e){let{ctx:a}=this._processInputParams(e);if(a.parsedType!==X.function)return K(a,{code:N.invalid_type,expected:X.function,received:a.parsedType}),Se;function s(l,u){return Uf({data:l,path:a.path,errorMaps:[a.common.contextualErrorMap,a.schemaErrorMap,Vf(),Oo].filter(c=>!!c),issueData:{code:N.invalid_arguments,argumentsError:u}})}function n(l,u){return Uf({data:l,path:a.path,errorMaps:[a.common.contextualErrorMap,a.schemaErrorMap,Vf(),Oo].filter(c=>!!c),issueData:{code:N.invalid_return_type,returnTypeError:u}})}let r={errorMap:a.common.contextualErrorMap},o=a.data;if(this._def.returns instanceof Do){let l=this;return ha(async function(...u){let c=new _s([]),p=await l._def.args.parseAsync(u,r).catch(m=>{throw c.addIssue(s(u,m)),c}),f=await Reflect.apply(o,this,p);return await l._def.returns._def.type.parseAsync(f,r).catch(m=>{throw c.addIssue(n(f,m)),c})})}else{let l=this;return ha(function(...u){let c=l._def.args.safeParse(u,r);if(!c.success)throw new _s([s(u,c.error)]);let p=Reflect.apply(o,this,c.data),f=l._def.returns.safeParse(p,r);if(!f.success)throw new _s([n(p,f.error)]);return f.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new zp({...this._def,args:Ci.create(e).rest(ar.create())})}returns(e){return new zp({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,a,s){return new zp({args:e||Ci.create([]).rest(ar.create()),returns:a||ar.create(),typeName:be.ZodFunction,...Pe(s)})}},Pu=class extends Ze{get schema(){return this._def.getter()}_parse(t){let{ctx:e}=this._processInputParams(t);return this._def.getter()._parse({data:e.data,path:e.path,parent:e})}};Pu.create=(t,e)=>new Pu({getter:t,typeName:be.ZodLazy,...Pe(e)});var Ru=class extends Ze{_parse(t){if(t.data!==this._def.value){let e=this._getOrReturnCtx(t);return K(e,{received:e.data,code:N.invalid_literal,expected:this._def.value}),Se}return{status:"valid",value:t.data}}get value(){return this._def.value}};Ru.create=(t,e)=>new Ru({value:t,typeName:be.ZodLiteral,...Pe(e)});function $C(t,e){return new Ec({values:t,typeName:be.ZodEnum,...Pe(e)})}var Ec=class hy extends Ze{constructor(){super(...arguments),Dl.set(this,void 0)}_parse(e){if(typeof e.data!="string"){let a=this._getOrReturnCtx(e),s=this._def.values;return K(a,{expected:Ye.joinValues(s),received:a.parsedType,code:N.invalid_type}),Se}if(Qf(this,Dl)||yC(this,Dl,new Set(this._def.values)),!Qf(this,Dl).has(e.data)){let a=this._getOrReturnCtx(e),s=this._def.values;return K(a,{received:a.data,code:N.invalid_enum_value,options:s}),Se}return ha(e.data)}get options(){return this._def.values}get enum(){let e={};for(let a of this._def.values)e[a]=a;return e}get Values(){let e={};for(let a of this._def.values)e[a]=a;return e}get Enum(){let e={};for(let a of this._def.values)e[a]=a;return e}extract(e,a=this._def){return hy.create(e,{...this._def,...a})}exclude(e,a=this._def){return hy.create(this.options.filter(s=>!e.includes(s)),{...this._def,...a})}};Dl=new WeakMap;Ec.create=$C;var Du=class extends Ze{constructor(){super(...arguments),Nl.set(this,void 0)}_parse(t){let e=Ye.getValidEnumValues(this._def.values),a=this._getOrReturnCtx(t);if(a.parsedType!==X.string&&a.parsedType!==X.number){let s=Ye.objectValues(e);return K(a,{expected:Ye.joinValues(s),received:a.parsedType,code:N.invalid_type}),Se}if(Qf(this,Nl)||yC(this,Nl,new Set(Ye.getValidEnumValues(this._def.values))),!Qf(this,Nl).has(t.data)){let s=Ye.objectValues(e);return K(a,{received:a.data,code:N.invalid_enum_value,options:s}),Se}return ha(t.data)}get enum(){return this._def.values}};Nl=new WeakMap;Du.create=(t,e)=>new Du({values:t,typeName:be.ZodNativeEnum,...Pe(e)});var Do=class extends Ze{unwrap(){return this._def.type}_parse(t){let{ctx:e}=this._processInputParams(t);if(e.parsedType!==X.promise&&e.common.async===!1)return K(e,{code:N.invalid_type,expected:X.promise,received:e.parsedType}),Se;let a=e.parsedType===X.promise?e.data:Promise.resolve(e.data);return ha(a.then(s=>this._def.type.parseAsync(s,{path:e.path,errorMap:e.common.contextualErrorMap})))}};Do.create=(t,e)=>new Do({type:t,typeName:be.ZodPromise,...Pe(e)});var Ls=class extends Ze{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===be.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(t){let{status:e,ctx:a}=this._processInputParams(t),s=this._def.effect||null,n={addIssue:r=>{K(a,r),r.fatal?e.abort():e.dirty()},get path(){return a.path}};if(n.addIssue=n.addIssue.bind(n),s.type==="preprocess"){let r=s.transform(a.data,n);if(a.common.async)return Promise.resolve(r).then(async o=>{if(e.value==="aborted")return Se;let l=await this._def.schema._parseAsync({data:o,path:a.path,parent:a});return l.status==="aborted"?Se:l.status==="dirty"||e.value==="dirty"?Gf(l.value):l});{if(e.value==="aborted")return Se;let o=this._def.schema._parseSync({data:r,path:a.path,parent:a});return o.status==="aborted"?Se:o.status==="dirty"||e.value==="dirty"?Gf(o.value):o}}if(s.type==="refinement"){let r=o=>{let l=s.refinement(o,n);if(a.common.async)return Promise.resolve(l);if(l instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return o};if(a.common.async===!1){let o=this._def.schema._parseSync({data:a.data,path:a.path,parent:a});return o.status==="aborted"?Se:(o.status==="dirty"&&e.dirty(),r(o.value),{status:e.value,value:o.value})}else return this._def.schema._parseAsync({data:a.data,path:a.path,parent:a}).then(o=>o.status==="aborted"?Se:(o.status==="dirty"&&e.dirty(),r(o.value).then(()=>({status:e.value,value:o.value}))))}if(s.type==="transform")if(a.common.async===!1){let r=this._def.schema._parseSync({data:a.data,path:a.path,parent:a});if(!Cu(r))return r;let o=s.transform(r.value,n);if(o instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:e.value,value:o}}else return this._def.schema._parseAsync({data:a.data,path:a.path,parent:a}).then(r=>Cu(r)?Promise.resolve(s.transform(r.value,n)).then(o=>({status:e.value,value:o})):r);Ye.assertNever(s)}};Ls.create=(t,e,a)=>new Ls({schema:t,typeName:be.ZodEffects,effect:e,...Pe(a)});Ls.createWithPreprocess=(t,e,a)=>new Ls({schema:e,effect:{type:"preprocess",transform:t},typeName:be.ZodEffects,...Pe(a)});var Gs=class extends Ze{_parse(t){return this._getType(t)===X.undefined?ha(void 0):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}};Gs.create=(t,e)=>new Gs({innerType:t,typeName:be.ZodOptional,...Pe(e)});var Si=class extends Ze{_parse(t){return this._getType(t)===X.null?ha(null):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}};Si.create=(t,e)=>new Si({innerType:t,typeName:be.ZodNullable,...Pe(e)});var Nu=class extends Ze{_parse(t){let{ctx:e}=this._processInputParams(t),a=e.data;return e.parsedType===X.undefined&&(a=this._def.defaultValue()),this._def.innerType._parse({data:a,path:e.path,parent:e})}removeDefault(){return this._def.innerType}};Nu.create=(t,e)=>new Nu({innerType:t,typeName:be.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...Pe(e)});var Wu=class extends Ze{_parse(t){let{ctx:e}=this._processInputParams(t),a={...e,common:{...e.common,issues:[]}},s=this._def.innerType._parse({data:a.data,path:a.path,parent:{...a}});return Su(s)?s.then(n=>({status:"valid",value:n.status==="valid"?n.value:this._def.catchValue({get error(){return new _s(a.common.issues)},input:a.data})})):{status:"valid",value:s.status==="valid"?s.value:this._def.catchValue({get error(){return new _s(a.common.issues)},input:a.data})}}removeCatch(){return this._def.innerType}};Wu.create=(t,e)=>new Wu({innerType:t,typeName:be.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...Pe(e)});var tm=class extends Ze{_parse(t){if(this._getType(t)!==X.nan){let e=this._getOrReturnCtx(t);return K(e,{code:N.invalid_type,expected:X.nan,received:e.parsedType}),Se}return{status:"valid",value:t.data}}};tm.create=t=>new tm({typeName:be.ZodNaN,...Pe(t)});var ZD=Symbol("zod_brand"),Ov=class extends Ze{_parse(t){let{ctx:e}=this._processInputParams(t),a=e.data;return this._def.type._parse({data:a,path:e.path,parent:e})}unwrap(){return this._def.type}},Pv=class AC extends Ze{_parse(e){let{status:a,ctx:s}=this._processInputParams(e);if(s.common.async)return(async()=>{let n=await this._def.in._parseAsync({data:s.data,path:s.path,parent:s});return n.status==="aborted"?Se:n.status==="dirty"?(a.dirty(),Gf(n.value)):this._def.out._parseAsync({data:n.value,path:s.path,parent:s})})();{let n=this._def.in._parseSync({data:s.data,path:s.path,parent:s});return n.status==="aborted"?Se:n.status==="dirty"?(a.dirty(),{status:"dirty",value:n.value}):this._def.out._parseSync({data:n.value,path:s.path,parent:s})}}static create(e,a){return new AC({in:e,out:a,typeName:be.ZodPipeline})}},Bu=class extends Ze{_parse(t){let e=this._def.innerType._parse(t),a=s=>(Cu(s)&&(s.value=Object.freeze(s.value)),s);return Su(e)?e.then(s=>a(s)):a(e)}unwrap(){return this._def.innerType}};Bu.create=(t,e)=>new Bu({innerType:t,typeName:be.ZodReadonly,...Pe(e)});function MC(t,e={},a){return t?Ro.create().superRefine((s,n)=>{var r,o;if(!t(s)){let l=typeof e=="function"?e(s):typeof e=="string"?{message:e}:e,u=(o=(r=l.fatal)!==null&&r!==void 0?r:a)!==null&&o!==void 0?o:!0,c=typeof l=="string"?{message:l}:l;n.addIssue({code:"custom",...c,fatal:u})}}):Ro.create()}var qD={object:rs.lazycreate},be;(function(t){t.ZodString="ZodString",t.ZodNumber="ZodNumber",t.ZodNaN="ZodNaN",t.ZodBigInt="ZodBigInt",t.ZodBoolean="ZodBoolean",t.ZodDate="ZodDate",t.ZodSymbol="ZodSymbol",t.ZodUndefined="ZodUndefined",t.ZodNull="ZodNull",t.ZodAny="ZodAny",t.ZodUnknown="ZodUnknown",t.ZodNever="ZodNever",t.ZodVoid="ZodVoid",t.ZodArray="ZodArray",t.ZodObject="ZodObject",t.ZodUnion="ZodUnion",t.ZodDiscriminatedUnion="ZodDiscriminatedUnion",t.ZodIntersection="ZodIntersection",t.ZodTuple="ZodTuple",t.ZodRecord="ZodRecord",t.ZodMap="ZodMap",t.ZodSet="ZodSet",t.ZodFunction="ZodFunction",t.ZodLazy="ZodLazy",t.ZodLiteral="ZodLiteral",t.ZodEnum="ZodEnum",t.ZodEffects="ZodEffects",t.ZodNativeEnum="ZodNativeEnum",t.ZodOptional="ZodOptional",t.ZodNullable="ZodNullable",t.ZodDefault="ZodDefault",t.ZodCatch="ZodCatch",t.ZodPromise="ZodPromise",t.ZodBranded="ZodBranded",t.ZodPipeline="ZodPipeline",t.ZodReadonly="ZodReadonly"})(be||(be={}));var FD=(t,e={message:`Input not instance of ${t.name}`})=>MC(a=>a instanceof t,e),LC=Po.create,EC=Tu.create,jD=tm.create,HD=$u.create,IC=Au.create,zD=Mu.create,KD=Yf.create,VD=Lu.create,UD=Eu.create,GD=Ro.create,QD=ar.create,YD=Sn.create,JD=Jf.create,XD=wr.create,eN=rs.create,tN=rs.strictCreate,aN=Iu.create,sN=xC.create,nN=Ou.create,iN=Ci.create,rN=SC.create,oN=Xf.create,lN=em.create,dN=TC.create,uN=Pu.create,cN=Ru.create,pN=Ec.create,fN=Du.create,mN=Do.create,Pw=Ls.create,hN=Gs.create,gN=Si.create,yN=Ls.createWithPreprocess,vN=Pv.create,bN=()=>LC().optional(),wN=()=>EC().optional(),kN=()=>IC().optional(),xN={string:t=>Po.create({...t,coerce:!0}),number:t=>Tu.create({...t,coerce:!0}),boolean:t=>Au.create({...t,coerce:!0}),bigint:t=>$u.create({...t,coerce:!0}),date:t=>Mu.create({...t,coerce:!0})},_N=Se,ut=Object.freeze({__proto__:null,defaultErrorMap:Oo,setErrorMap:_D,getErrorMap:Vf,makeIssue:Uf,EMPTY_PATH:CD,addIssueToContext:K,ParseStatus:Pa,INVALID:Se,DIRTY:Gf,OK:ha,isAborted:ly,isDirty:dy,isValid:Cu,isAsync:Su,get util(){return Ye},get objectUtil(){return oy},ZodParsedType:X,getParsedType:ei,ZodType:Ze,datetimeRegex:wC,ZodString:Po,ZodNumber:Tu,ZodBigInt:$u,ZodBoolean:Au,ZodDate:Mu,ZodSymbol:Yf,ZodUndefined:Lu,ZodNull:Eu,ZodAny:Ro,ZodUnknown:ar,ZodNever:Sn,ZodVoid:Jf,ZodArray:wr,ZodObject:rs,ZodUnion:Iu,ZodDiscriminatedUnion:xC,ZodIntersection:Ou,ZodTuple:Ci,ZodRecord:SC,ZodMap:Xf,ZodSet:em,ZodFunction:TC,ZodLazy:Pu,ZodLiteral:Ru,ZodEnum:Ec,ZodNativeEnum:Du,ZodPromise:Do,ZodEffects:Ls,ZodTransformer:Ls,ZodOptional:Gs,ZodNullable:Si,ZodDefault:Nu,ZodCatch:Wu,ZodNaN:tm,BRAND:ZD,ZodBranded:Ov,ZodPipeline:Pv,ZodReadonly:Bu,custom:MC,Schema:Ze,ZodSchema:Ze,late:qD,get ZodFirstPartyTypeKind(){return be},coerce:xN,any:GD,array:XD,bigint:HD,boolean:IC,date:zD,discriminatedUnion:sN,effect:Pw,enum:pN,function:dN,instanceof:FD,intersection:nN,lazy:uN,literal:cN,map:oN,nan:jD,nativeEnum:fN,never:YD,null:UD,nullable:gN,number:EC,object:eN,oboolean:kN,onumber:wN,optional:hN,ostring:bN,pipeline:vN,preprocess:yN,promise:mN,record:rN,set:lN,strictObject:tN,string:LC,symbol:KD,transformer:Pw,tuple:iN,undefined:VD,union:aN,unknown:QD,void:JD,NEVER:_N,ZodIssueCode:N,quotelessJson:xD,ZodError:_s}),Kh=ut.custom(t=>typeof t=="string"?/^\d+$/.test(t):!1),OC=()=>ut.string().regex(/^[a-zA-Z0-9_]+$/);OC();OC().max(50);var CN=ut.enum(["normal","expert","master"]),ml=ut.object({acc:ut.number().nonnegative().max(100),consistency:ut.number().nonnegative().max(100),difficulty:CN,lazyMode:ut.boolean().optional(),language:ut.string().max(100).regex(/[\w+]+/),punctuation:ut.boolean().optional(),numbers:ut.boolean().optional(),raw:ut.number().nonnegative(),wpm:ut.number().nonnegative(),timestamp:ut.number().nonnegative()}),SN=ut.object({time:ut.record(Kh,ut.array(ml)),words:ut.record(Kh,ut.array(ml)),quote:ut.record(Kh,ut.array(ml)),custom:ut.record(ut.literal("custom"),ut.array(ml)),zen:ut.record(ut.literal("zen"),ut.array(ml))}),TN=SN.keyof();let PC,RC;const d={...ns};let Kp={};const $N=Da(1e3,()=>{Object.keys(Kp).length>0&&(Ja(!0),Bx(Kp).then(()=>{Ja(!1)})),Kp={}});function I(t,e=!1,a=!1){if(e)return;const n=JSON.stringify(d);window.localStorage.setItem("config",n),a||(Kp[t]=d[t],$N()),L("saveToLocalStorage",n)}function Yo(t=!1){console.log("saving full config to localStorage");const e=d,a=JSON.stringify(e);window.localStorage.setItem("config",a),t||(Ja(!0),Bx(e),Ja(!1)),L("saveToLocalStorage",a)}function os(t,e){return!it("numbers",t)||!Lr("numbers",t,d.funbox)?!1:(d.mode==="quote"&&(t=!1),d.numbers=t,I("numbers",e),L("numbers",d.numbers),!0)}function tn(t,e){return!it("punctuation",t)||!Lr("punctuation",t,d.funbox)?!1:(d.mode==="quote"&&(t=!1),d.punctuation=t,I("punctuation",e),L("punctuation",d.punctuation),!0)}function zt(t,e){if(!ee("mode",t,TN)||!Lr("mode",t,d.funbox))return!1;const a=d.mode;return d.mode=t,d.mode==="custom"||d.mode==="quote"?(tn(!1,!0),os(!1,!0)):d.mode==="zen"&&d.paceCaret!=="off"&&h("Pace caret will not work with zen mode.",0),I("mode",e),L("mode",d.mode,e,a),!0}function DC(t,e){return ee("play sound on error",t,P_)?(d.playSoundOnError=t,I("playSoundOnError",e),L("playSoundOnError",d.playSoundOnError),!0):!1}function NC(t,e){return ee("play sound on click",t,R_)?(d.playSoundOnClick=t,I("playSoundOnClick",e),L("playSoundOnClick",d.playSoundOnClick),!0):!1}function WC(t,e){return(t<0||t>1)&&(h("Sound volume must be between 0 and 1",0),t=.5),ee("sound volume",t,D_)?(d.soundVolume=t,I("soundVolume",e),L("soundVolume",d.soundVolume),!0):!1}function Ps(t,e){return ee("difficulty",t,J_)?(d.difficulty=t,I("difficulty",e),L("difficulty",d.difficulty,e),!0):!1}function gy(t,e){return ee("favorite themes",t,eC)?(d.favThemes=t,I("favThemes",e),L("favThemes",d.favThemes),!0):!1}function pn(t,e){if(!ee("funbox",t,Iv))return!1;for(const s of d.funbox.split("#"))if(!Qx(s,d))return!1;const a=t||"none";return d.funbox=a,I("funbox",e),L("funbox",d.funbox),!0}function Rv(t,e){if(!ee("funbox",t,Iv))return!1;let a;const s=d.funbox.split("#");if(s[0]==="none"&&s.splice(0,1),s.includes(t))a=s.indexOf(t),s.splice(a,1),s.length===0?d.funbox="none":d.funbox=s.join("#"),a=-a-1;else{if(!Qx(t,d))return!1;s.push(t),d.funbox=s.sort().join("#"),a=s.indexOf(t)}return I("funbox",e),L("funbox",d.funbox),a}function BC(t,e){return it("blind mode",t)?(d.blindMode=t,I("blindMode",e),L("blindMode",d.blindMode,e),!0):!1}function AN(t,e){return t.length!==4&&(t=["on","on","on","on"]),ee("account chart",t,W_)?(d.accountChart=t,I("accountChart",e),L("accountChart",d.accountChart),!0):!1}function MN(t,e){return it("account chart results",t)?(d.accountChart[0]=t?"on":"off",I("accountChart",e),L("accountChart",d.accountChart),!0):!1}function LN(t,e){return it("account chart accuracy",t)?(d.accountChart[1]=t?"on":"off",I("accountChart",e),L("accountChart",d.accountChart),!0):!1}function EN(t,e){return it("account chart avg 10",t)?(d.accountChart[2]=t?"on":"off",I("accountChart",e),L("accountChart",d.accountChart),!0):!1}function IN(t,e){return it("account chart avg 100",t)?(d.accountChart[3]=t?"on":"off",I("accountChart",e),L("accountChart",d.accountChart),!0):!1}function Dv(t,e){return ee("stop on error",t,$_)?(d.stopOnError=t,d.stopOnError!=="off"&&(d.confidenceMode="off",I("confidenceMode",e)),I("stopOnError",e),L("stopOnError",d.stopOnError,e),!0):!1}function ZC(t,e){return it("always show decimal places",t)?(d.alwaysShowDecimalPlaces=t,I("alwaysShowDecimalPlaces",e),L("alwaysShowDecimalPlaces",d.alwaysShowDecimalPlaces),!0):!1}function qC(t,e){return ee("typing speed unit",t,F_)?(d.typingSpeedUnit=t,I("typingSpeedUnit",e),L("typingSpeedUnit",d.typingSpeedUnit,e),!0):!1}function FC(t,e){return it("show out of focus warning",t)?(d.showOutOfFocusWarning=t,d.showOutOfFocusWarning||Tc(),I("showOutOfFocusWarning",e),L("showOutOfFocusWarning",d.showOutOfFocusWarning),!0):!1}function jC(t,e){return ee("pace caret",t,N_)?document.readyState==="complete"&&(t==="pb"||t==="tagPb")&&!ce()?(h('Pace caret "pb" and "tag pb" are unavailable without an account',0),!1):(d.paceCaret=t,I("paceCaret",e),L("paceCaret",d.paceCaret,e),!0):!1}function Nv(t,e){return ee("pace caret custom speed",t,tC)?(d.paceCaretCustomSpeed=t,I("paceCaretCustomSpeed",e),L("paceCaretCustomSpeed",d.paceCaretCustomSpeed),!0):!1}function HC(t,e){return it("repeated pace",t)?(d.repeatedPace=t,I("repeatedPace",e),L("repeatedPace",d.repeatedPace),!0):!1}function zC(t,e){return ee("min speed",t,B_)?(d.minWpm=t,I("minWpm",e),L("minWpm",d.minWpm,e),!0):!1}function Wv(t,e){return ee("min speed custom",t,aC)?(d.minWpmCustomSpeed=t,I("minWpmCustomSpeed",e),L("minWpmCustomSpeed",d.minWpmCustomSpeed),!0):!1}function KC(t,e){return ee("min acc",t,H_)?(d.minAcc=t,I("minAcc",e),L("minAcc",d.minAcc,e),!0):!1}function Bv(t,e){return t>100&&(t=100),ee("min acc custom",t,sC)?(d.minAccCustom=t,I("minAccCustom",e),L("minAccCustom",d.minAccCustom),!0):!1}function VC(t,e){return ee("min burst",t,Q_)?(d.minBurst=t,I("minBurst",e),L("minBurst",d.minBurst,e),!0):!1}function Zv(t,e){return ee("min burst custom speed",t,nC)?(d.minBurstCustomSpeed=t,I("minBurstCustomSpeed",e),L("minBurstCustomSpeed",d.minBurstCustomSpeed),!0):!1}function UC(t,e){return it("always show words history",t)?(d.alwaysShowWordsHistory=t,I("alwaysShowWordsHistory",e),L("alwaysShowWordsHistory",d.alwaysShowWordsHistory),!0):!1}function GC(t,e){return ee("single list command line",t,O_)?(d.singleListCommandLine=t,I("singleListCommandLine",e),L("singleListCommandLine",d.singleListCommandLine),!0):!1}function QC(t,e){return it("caps lock warning",t)?(d.capsLockWarning=t,I("capsLockWarning",e),L("capsLockWarning",d.capsLockWarning),!0):!1}function Zu(t,e){return it("show all lines",t)?t&&d.tapeMode!=="off"?(h("Show all lines doesn't support tape mode",0),!1):(d.showAllLines=t,I("showAllLines",e),L("showAllLines",d.showAllLines,e),!0):!1}function YC(t,e){return it("quick end",t)?(d.quickEnd=t,I("quickEnd",e),L("quickEnd",d.quickEnd),!0):!1}function JC(t,e){return ee("ads",t,j_)?(d.ads=t,I("ads",e),!e&&!uA()&&(On(3),h("Ad settings changed. Refreshing...",0)),L("ads",d.ads),!0):!1}function XC(t,e){return ee("repeat quotes",t,z_)?(d.repeatQuotes=t,I("repeatQuotes",e),L("repeatQuotes",d.repeatQuotes),!0):!1}function eS(t,e){return it("flip test colors",t)?(d.flipTestColors=t,I("flipTestColors",e),L("flipTestColors",d.flipTestColors),!0):!1}function tS(t,e){return it("colorful mode",t)?(d.colorfulMode=t,I("colorfulMode",e),L("colorfulMode",d.colorfulMode),!0):!1}function aS(t,e){return it("strict space",t)?(d.strictSpace=t,I("strictSpace",e),L("strictSpace",d.strictSpace),!0):!1}function sS(t,e){return ee("opposite shift mode",t,K_)?(d.oppositeShiftMode=t,I("oppositeShiftMode",e),L("oppositeShiftMode",d.oppositeShiftMode),!0):!1}function nS(t,e){return ee("caret style",t,Kf)?(d.caretStyle=t,i("#caret").removeClass("off"),i("#caret").removeClass("default"),i("#caret").removeClass("underline"),i("#caret").removeClass("outline"),i("#caret").removeClass("block"),i("#caret").removeClass("carrot"),i("#caret").removeClass("banana"),t==="off"?i("#caret").addClass("off"):t==="default"?i("#caret").addClass("default"):t==="block"?i("#caret").addClass("block"):t==="outline"?i("#caret").addClass("outline"):t==="underline"?i("#caret").addClass("underline"):t==="carrot"?i("#caret").addClass("carrot"):t==="banana"&&i("#caret").addClass("banana"),I("caretStyle",e),L("caretStyle",d.caretStyle),!0):!1}function iS(t,e){return ee("pace caret style",t,Kf)?(d.paceCaretStyle=t,i("#paceCaret").removeClass("off"),i("#paceCaret").removeClass("default"),i("#paceCaret").removeClass("underline"),i("#paceCaret").removeClass("outline"),i("#paceCaret").removeClass("block"),i("#paceCaret").removeClass("carrot"),i("#paceCaret").removeClass("banana"),t==="default"?i("#paceCaret").addClass("default"):t==="block"?i("#paceCaret").addClass("block"):t==="outline"?i("#paceCaret").addClass("outline"):t==="underline"?i("#paceCaret").addClass("underline"):t==="carrot"?i("#paceCaret").addClass("carrot"):t==="banana"&&i("#paceCaret").addClass("banana"),I("paceCaretStyle",e),L("paceCaretStyle",d.paceCaretStyle),!0):!1}function rS(t,e){return ee("show average",t,Y_)?(d.showAverage=t,I("showAverage",e),L("showAverage",d.showAverage,e),!0):!1}function Pi(t,e){return!ee("highlight mode",t,Z_)||!Lr("highlightMode",t,d.funbox)?!1:(d.highlightMode=t,I("highlightMode",e),L("highlightMode",d.highlightMode),!0)}function qv(t,e){return ee("tape mode",t,q_)?(t!=="off"&&d.showAllLines&&Zu(!1,!0),d.tapeMode=t,I("tapeMode",e),L("tapeMode",d.tapeMode),!0):!1}function oS(t,e){return it("hide extra letters",t)?(d.hideExtraLetters=t,I("hideExtraLetters",e),L("hideExtraLetters",d.hideExtraLetters),!0):!1}function lS(t,e){return ee("timer style",t,__)?(d.timerStyle=t,I("timerStyle",e),L("timerStyle",d.timerStyle),!0):!1}function dS(t,e){return ee("live speed style",t,io)?(d.liveSpeedStyle=t,I("liveSpeedStyle",e),L("liveSpeedStyle",d.timerStyle),!0):!1}function uS(t,e){return ee("live acc style",t,io)?(d.liveAccStyle=t,I("liveAccStyle",e),L("liveAccStyle",d.timerStyle),!0):!1}function cS(t,e){return ee("live burst style",t,io)?(d.liveBurstStyle=t,I("liveBurstStyle",e),L("liveBurstStyle",d.timerStyle),!0):!1}function pS(t,e){return ee("timer color",t,S_)?(d.timerColor=t,I("timerColor",e),L("timerColor",d.timerColor),!0):!1}function fS(t,e){return ee("timer opacity",t,T_)?(d.timerOpacity=t,I("timerOpacity",e),L("timerOpacity",d.timerOpacity),!0):!1}function mS(t,e){return it("key tips",t)?(d.showKeyTips=t,d.showKeyTips?i("footer .keyTips").removeClass("hidden"):i("footer .keyTips").addClass("hidden"),I("showKeyTips",e),L("showKeyTips",d.showKeyTips),!0):!1}function Ws(t,e){return t=isNaN(t)||t<0?ns.time:t,!ee("time",t,iC)||!Lr("words",t,d.funbox)?!1:(d.time=t,I("time",e),L("time",d.time),!0)}function mn(t,e,a){if(Array.isArray(t)){if(!ee("quote length",t,w_))return!1;t.length===1&&t[0]===-1&&(t=[1]),d.quoteLength=t}else{if(!ee("quote length",t,b_))return!1;Array.isArray(d.quoteLength)||(d.quoteLength=[]),(t===null||isNaN(t)||t<-3||t>3)&&(t=1),t=parseInt(t.toString()),t===-1?d.quoteLength=[0,1,2,3]:a&&t>=0?d.quoteLength.includes(t)?d.quoteLength.length>1&&(d.quoteLength=d.quoteLength.filter(s=>s!==t)):d.quoteLength.push(t):d.quoteLength=[t]}return I("quoteLength",e),L("quoteLength",d.quoteLength),!0}function Ti(t,e){return t=t<0||t>1e5?ns.words:t,!ee("words",t,rC)||!Lr("words",t,d.funbox)?!1:(d.words=t,I("words",e),L("words",d.words),!0)}function hS(t,e){return ee("smooth caret",t,y_)?(d.smoothCaret=t,t==="off"?i("#caret").css("animation-name","caretFlashHard"):i("#caret").css("animation-name","caretFlashSmooth"),I("smoothCaret",e),L("smoothCaret",d.smoothCaret),!0):!1}function gS(t,e){return it("start graphs at zero",t)?(d.startGraphsAtZero=t,I("startGraphsAtZero",e),L("startGraphsAtZero",d.startGraphsAtZero),!0):!1}function yS(t,e){return it("smooth line scroll",t)?(d.smoothLineScroll=t,I("smoothLineScroll",e),L("smoothLineScroll",d.smoothLineScroll),!0):!1}function vS(t,e){return ee("quick restart mode",t,v_)?(d.quickRestart=t,I("quickRestart",e),L("quickRestart",d.quickRestart),!0):!1}function bS(t,e){return ee("font family",t,oC)?(t===""&&(t="roboto_mono",h("Empty input received, reverted to the default font.",0,{customTitle:"Custom font"})),!t||!/^[0-9a-zA-Z_.\-#+()]+$/.test(t)?(h(`Invalid font name value: "${t}".`,-1,{customTitle:"Custom font",duration:3}),!1):(d.fontFamily=t,document.documentElement.style.setProperty("--font",`"${t.replace(/_/g," ")}", "Roboto Mono", "Vazirmatn", monospace`),I("fontFamily",e),L("fontFamily",d.fontFamily),!0)):!1}function wS(t,e){return it("freedom mode",t)?(t==null&&(t=!1),d.freedomMode=t,d.freedomMode&&d.confidenceMode!=="off"&&(d.confidenceMode="off"),I("freedomMode",e),L("freedomMode",d.freedomMode),!0):!1}function kS(t,e){return ee("confidence mode",t,k_)?(d.confidenceMode=t,d.confidenceMode!=="off"&&(d.freedomMode=!1,d.stopOnError="off",I("freedomMode",e),I("stopOnError",e)),I("confidenceMode",e),L("confidenceMode",d.confidenceMode,e),!0):!1}function xS(t,e){return ee("indicate typos",t,x_)?(d.indicateTypos=t,I("indicateTypos",e),L("indicateTypos",d.indicateTypos),!0):!1}function _S(t,e){return it("auto switch theme",t)?(t=t??ns.autoSwitchTheme,d.autoSwitchTheme=t,I("autoSwitchTheme",e),L("autoSwitchTheme",d.autoSwitchTheme),!0):!1}function ui(t,e){return it("custom theme",t)?(d.customTheme=t,I("customTheme",e),L("customTheme",d.customTheme),!0):!1}function CS(t,e){return ee("theme",t,tr)?(d.theme=t,d.customTheme&&ui(!1),I("theme",e),L("theme",d.theme),!0):!1}function SS(t,e){return ee("theme light",t,tr)?(d.themeLight=t,I("themeLight",e),L("themeLight",d.themeLight,e),!0):!1}function TS(t,e){return ee("theme dark",t,tr)?(d.themeDark=t,I("themeDark",e),L("themeDark",d.themeDark,e),!0):!1}function ON(t,e,a,s,n){return ee("themes",t,tr)?(a.length===9&&(e&&h("Missing sub alt color. Please edit it in the custom theme settings and save your changes.",0,{duration:7}),a.splice(4,0,"#000000")),d.customThemeColors=a,d.theme=t,d.customTheme=e,d.autoSwitchTheme=s,I("theme",n),L("setThemes",e),!0):!1}function $S(t,e){var a,s;if(!ee("random theme",t,C_))return!1;if(t==="custom"){if(!ce())return d.randomTheme=t,!1;if(!S())return!0;if(((s=(a=S())==null?void 0:a.customThemes)==null?void 0:s.length)===0)return h("You need to create a custom theme first",0),d.randomTheme="off",!1}return d.randomTheme=t,I("randomTheme",e),L("randomTheme",d.randomTheme),!0}function AS(t,e){return it("british english",t)?(t||(t=!1),d.britishEnglish=t,I("britishEnglish",e),L("britishEnglish",d.britishEnglish),!0):!1}function qu(t,e){return it("lazy mode",t)?(t||(t=!1),d.lazyMode=t,I("lazyMode",e),L("lazyMode",d.lazyMode,e),!0):!1}function Fu(t,e){return t.length===9&&(h("Missing sub alt color. Please edit it in the custom theme settings and save your changes.",0,{duration:7}),t.splice(4,0,"#000000")),ee("custom theme colors",t,X_)?(t!==void 0&&(d.customThemeColors=t),I("customThemeColors",e),L("customThemeColors",d.customThemeColors,e),!0):!1}function No(t,e){return ee("language",t,lC)?(d.language=t,_n("changedLanguage",{language:t}),I("language",e),L("language",d.language),!0):!1}function PN(t,e){return it("monkey",t)?(d.monkey=t,I("monkey",e),L("monkey",d.monkey),!0):!1}function Cs(t,e){return ee("keymap mode",t,A_)?(i(".activeKey").removeClass("activeKey"),i(".keymapKey").attr("style",""),d.keymapMode=t,I("keymapMode",e),L("keymapMode",d.keymapMode,e),!0):!1}function MS(t,e){return ee("keymap legend style",t,L_)?(["lowercase","uppercase","blank","dynamic"].forEach(s=>{i(".keymapLegendStyle").removeClass(s)}),t=t||"lowercase",i(".keymapKey > .letter").css("display",""),i(".keymapKey > .letter").css("text-transform",""),t==="uppercase"&&i(".keymapKey > .letter").css("text-transform","capitalize"),t==="blank"&&i(".keymapKey > .letter").css("display","none"),i(".keymapLegendStyle").addClass(t),d.keymapLegendStyle=t,I("keymapLegendStyle",e),L("keymapLegendStyle",d.keymapLegendStyle),!0):!1}function LS(t,e){return ee("keymap style",t,M_)?(t=t||"staggered",d.keymapStyle=t,I("keymapStyle",e),L("keymapStyle",d.keymapStyle),!0):!1}function sr(t,e){return ee("keymap layout",t,dC)?(d.keymapLayout=t,I("keymapLayout",e),L("keymapLayout",d.keymapLayout),!0):!1}function ES(t,e){return ee("keymapShowTopRow",t,E_)?(d.keymapShowTopRow=t,I("keymapShowTopRow",e),L("keymapShowTopRow",d.keymapShowTopRow),!0):!1}function Ic(t,e){return t<.5&&(t=.5),t>3.5&&(t=3.5),t=Ip(t),ee("keymap size",t,I_)?(d.keymapSize=t,i("#keymap").css("zoom",t),I("keymapSize",e),L("keymapSize",d.keymapSize,e),i(window).trigger("resize"),!0):!1}function nr(t,e){return ee("layout",t,uC)?(d.layout=t,I("layout",e),L("layout",d.layout,e),!0):!1}function zm(t,e){return t<0&&(t=1),typeof t=="string"&&["1","125","15","2","3","4"].includes(t)&&(t==="125"?t=1.25:t==="15"?t=1.5:t=parseInt(t)),ee("font size",t,cC)?(t===15&&(t=1.5),d.fontSize=t,i("#caret, #paceCaret, #liveStatsMini, #typingTest").css("fontSize",t+"rem"),I("fontSize",e),L("fontSize",d.fontSize,e),e||i(window).trigger("resize"),!0):!1}function Oc(t,e){return t<20&&t!==0&&(t=20),t>1e3&&(t=1e3),ee("max line width",t,pC)?(d.maxLineWidth=t,I("maxLineWidth",e),L("maxLineWidth",d.maxLineWidth,e),i(window).trigger("resize"),!0):!1}function Pc(t,e){return t=t.trim(),ee("custom background",t,fC)?(d.customBackground=t,I("customBackground",e),L("customBackground",d.customBackground),!0):!1}async function Fv(t,e){const a=t.trim();if(!await rR("layoutfluid",a,["layoutfluid"]))return!1;const s=a.replace(/ /g,"#");return d.customLayoutfluid=s,I("customLayoutfluid",e),L("customLayoutFluid",d.customLayoutfluid),!0}function jv(t,e){return ee("custom background size",t,V_)?(d.customBackgroundSize=t,I("customBackgroundSize",e),L("customBackgroundSize",d.customBackgroundSize),!0):!1}function Hv(t,e){return t.length===5&&(t=[t[0],t[1],t[2],t[3]]),ee("custom background filter",t,U_)?(d.customBackgroundFilter=t,I("customBackgroundFilter",e),L("customBackgroundFilter",d.customBackgroundFilter),!0):!1}function RN(t,e){return ee("monkey power level",t,G_)?(d.monkeyPowerLevel=t,I("monkeyPowerLevel",e),L("monkeyPowerLevel",d.monkeyPowerLevel),!0):!1}function IS(t,e){return it("burst heatmap",t)?(t||(t=!1),d.burstHeatmap=t,I("burstHeatmap",e),L("burstHeatmap",d.burstHeatmap),!0):!1}async function Rc(t){if(t===void 0)return;L("fullConfigChange"),t=NN(t);const e=t;Object.keys(ns).forEach(a=>{if(e[a]===void 0){const s=ns[a];e[a]=s}}),e!=null&&(JC(e.ads,!0),SS(e.themeLight,!0),TS(e.themeDark,!0),ON(e.theme,e.customTheme,e.customThemeColors,e.autoSwitchTheme,!0),await Fv(e.customLayoutfluid,!0),Pc(e.customBackground,!0),jv(e.customBackgroundSize,!0),Hv(e.customBackgroundFilter,!0),vS(e.quickRestart,!0),mS(e.showKeyTips,!0),Ws(e.time,!0),mn(e.quoteLength,!0),Ti(e.words,!0),No(e.language,!0),nr(e.layout,!0),zm(e.fontSize,!0),Oc(e.maxLineWidth,!0),wS(e.freedomMode,!0),nS(e.caretStyle,!0),iS(e.paceCaretStyle,!0),Ps(e.difficulty,!0),BC(e.blindMode,!0),YC(e.quickEnd,!0),eS(e.flipTestColors,!0),tS(e.colorfulMode,!0),kS(e.confidenceMode,!0),xS(e.indicateTypos,!0),lS(e.timerStyle,!0),dS(e.liveSpeedStyle,!0),uS(e.liveAccStyle,!0),cS(e.liveBurstStyle,!0),pS(e.timerColor,!0),fS(e.timerOpacity,!0),Cs(e.keymapMode,!0),LS(e.keymapStyle,!0),MS(e.keymapLegendStyle,!0),sr(e.keymapLayout,!0),ES(e.keymapShowTopRow,!0),Ic(e.keymapSize,!0),bS(e.fontFamily,!0),hS(e.smoothCaret,!0),yS(e.smoothLineScroll,!0),ZC(e.alwaysShowDecimalPlaces,!0),UC(e.alwaysShowWordsHistory,!0),GC(e.singleListCommandLine,!0),QC(e.capsLockWarning,!0),DC(e.playSoundOnError,!0),NC(e.playSoundOnClick,!0),WC(e.soundVolume,!0),Dv(e.stopOnError,!0),gy(e.favThemes,!0),pn(e.funbox,!0),$S(e.randomTheme,!0),Zu(e.showAllLines,!0),FC(e.showOutOfFocusWarning,!0),jC(e.paceCaret,!0),Nv(e.paceCaretCustomSpeed,!0),HC(e.repeatedPace,!0),AN(e.accountChart,!0),VC(e.minBurst,!0),Zv(e.minBurstCustomSpeed,!0),zC(e.minWpm,!0),Wv(e.minWpmCustomSpeed,!0),KC(e.minAcc,!0),Bv(e.minAccCustom,!0),Pi(e.highlightMode,!0),qC(e.typingSpeedUnit,!0),oS(e.hideExtraLetters,!0),gS(e.startGraphsAtZero,!0),aS(e.strictSpace,!0),sS(e.oppositeShiftMode,!0),zt(e.mode,!0),os(e.numbers,!0),tn(e.punctuation,!0),PN(e.monkey,!0),XC(e.repeatQuotes,!0),RN(e.monkeyPowerLevel,!0),IS(e.burstHeatmap,!0),AS(e.britishEnglish,!0),qu(e.lazyMode,!0),rS(e.showAverage,!0),qv(e.tapeMode,!0),L("configApplied",void 0,void 0,void 0,d)),L("fullConfigChangeFinished")}async function zv(){await Rc(ns),await tR(),Yo(!0)}async function DN(){console.log("loading localStorage config");const t=window.localStorage.getItem("config");let e;if(t!=null&&t!==""){try{e=JSON.parse(t)}catch{e={}}await Rc(e),PC=e,Yo(!0)}else await zv();RC()}function NN(t){const e=t;if(e.quickTab===!0&&(e.quickRestart="tab"),typeof e.smoothCaret=="boolean"&&(e.smoothCaret=e.smoothCaret?"medium":"off"),e.swapEscAndTab===!0&&(e.quickRestart="esc"),e.alwaysShowCPM===!0&&(e.typingSpeedUnit="cpm"),e.showAverage==="wpm"&&(e.showAverage="speed"),typeof e.playSoundOnError=="boolean"&&(e.playSoundOnError=e.playSoundOnError?"1":"off"),e.showTimerProgress===!1&&(e.timerStyle="off"),e.showLiveWpm===!0){let a="mini";e.timerStyle!=="bar"&&e.timerStyle!=="off"&&(a=e.timerStyle),e.liveSpeedStyle=a}if(e.showLiveBurst===!0){let a="mini";e.timerStyle!=="bar"&&e.timerStyle!=="off"&&(a=e.timerStyle),e.liveBurstStyle=a}if(e.showLiveAcc===!0){let a="mini";e.timerStyle!=="bar"&&e.timerStyle!=="off"&&(a=e.timerStyle),e.liveAccStyle=a}return typeof e.soundVolume=="string"&&(e.soundVolume=parseFloat(e.soundVolume)),e}function WN(){const t={};return Object.keys(d).filter(e=>d[e]!==ns[e]).forEach(e=>{t[e]=d[e]}),t}const OS=new Promise(t=>{RC=t});class BN{constructor(){this.list=[],this.sectionIndexList=[],this.length=0,this.currentIndex=0}get(e,a=!1){var s,n;return e===void 0?this.list:a?(n=(s=this.list[e])==null?void 0:s.replace(/[.?!":\-,]/g,""))==null?void 0:n.toLowerCase():this.list[e]}getCurrent(){return this.list[this.currentIndex]??""}getLast(){return this.list[this.list.length-1]}push(e,a){this.list.push(e),this.sectionIndexList.push(a),this.length=this.list.length}reset(){this.list=[],this.sectionIndexList=[],this.currentIndex=0,this.length=this.list.length}resetCurrentIndex(){this.currentIndex=0}decreaseCurrentIndex(){this.currentIndex--}increaseCurrentIndex(){this.currentIndex++}clean(){for(const e of this.list)if(/ +/.test(e)){const a=this.list.indexOf(e),s=e.split(" ");this.list.splice(a,1);for(let n=0;n<s.length;n++)this.list.splice(a+n,0,s[n])}}}const E=new BN;let ju=!1,am=!1,Kv=!1,ze=null;function yy(t){ze=t}function ZN(t){ju=t}function qN(t){am=t}function FN(t){Kv=t}za("commandLine");async function Jo(){try{Je();const t=await fv(()=>import("./commandline.CpPfAe7E.js"),__vite__mapDeps([0,1,2,3,4]));return Te(),t}catch(t){if(Te(),t instanceof Error&&t.message.includes("Failed to fetch dynamically imported module"))h("Failed to load commandline module: could not fetch",-1);else{const e=Re(t,"Failed to load commandline module");h(e,-1)}throw t}}za("devOptionsModal");document.addEventListener("keydown",async t=>{if(!ld()&&t.key!==void 0&&(t.key==="Escape"&&d.quickRestart!=="esc"||t.key==="Tab"&&d.quickRestart==="esc"&&!ju&&!t.shiftKey||t.key==="Tab"&&d.quickRestart==="esc"&&ju&&t.shiftKey||t.key.toLowerCase()==="p"&&(t.metaKey||t.ctrlKey)&&t.shiftKey)){t.preventDefault();const e=Bm(),a=iv(".pageAccount .miniResultChartWrapper");!e&&!a&&(await Jo()).show()}});window.onerror=function(t,e,a,s,n){_n("error",{error:(n==null?void 0:n.stack)??""})};window.onunhandledrejection=function(t){_n("error",{error:t.reason.stack??""})};const lp=125,dp=.75;class et{constructor(e){var n,r;this.open=!1,this.setupRan=!1,e.dialogId.startsWith("#")&&(e.dialogId=e.dialogId.slice(1)),this.skeletonAppendParent=e.appendTo??"popups",ZP(e.dialogId)&&ss(e.dialogId,this.skeletonAppendParent);const a=document.getElementById(e.dialogId),s=document.querySelector(`#${e.dialogId} > .modal`);if(a===null)throw new Error(`Dialog element with id ${e.dialogId} not found`);if(!(a instanceof HTMLDialogElement))throw new Error("Animated dialog must be an HTMLDialogElement");if(a===null)throw new Error(`Dialog element with id ${e.dialogId} not found`);if(s===null)throw new Error(`Div element inside #${e.dialogId} with class 'modal' not found`);this.dialogId=e.dialogId,this.wrapperEl=a,this.modalEl=s,this.customShowAnimations=(n=e.customAnimations)==null?void 0:n.show,this.customHideAnimations=(r=e.customAnimations)==null?void 0:r.hide,this.previousModalInChain=void 0,this.showOptionsWhenInChain=e.showOptionsWhenInChain,this.customEscapeHandler=e==null?void 0:e.customEscapeHandler,this.customWrapperClickHandler=e==null?void 0:e.customWrapperClickHandler,this.setup=e==null?void 0:e.setup,za(this.dialogId)}getPreviousModalInChain(){return this.previousModalInChain}async runSetup(){this.wrapperEl.addEventListener("keydown",e=>{e.key==="Escape"&&da(this.dialogId)&&(this.customEscapeHandler!==void 0?this.customEscapeHandler(e):this.hide())}),this.wrapperEl.addEventListener("mousedown",e=>{e.target===this.wrapperEl&&(this.customWrapperClickHandler!==void 0?this.customWrapperClickHandler(e):this.hide())}),this.setup!==void 0&&await this.setup(this.modalEl)}getDialogId(){return this.dialogId}getWrapper(){return this.wrapperEl}getModal(){return this.modalEl}isOpen(){return this.open}focusFirstInput(e){const s=[...this.modalEl.querySelectorAll("input")].filter(n=>!n.classList.contains("hidden"))[0];s!=null?e===!0?s.focus():e==="focusAndSelect"?(s.focus(),s.select()):this.wrapperEl.focus():this.wrapperEl.focus()}async show(e){return new Promise(async a=>{var u,c,p,f,m,g,y,v,A,W,$,se,te;if(this.open){a();return}if(ss(this.dialogId,this.skeletonAppendParent),this.setupRan||(await this.runSetup(),this.setupRan=!0),da(this.dialogId)){a();return}const s=(((c=(u=e==null?void 0:e.customAnimation)==null?void 0:u.modal)==null?void 0:c.durationMs)??(e==null?void 0:e.animationDurationMs)??((f=(p=this.customShowAnimations)==null?void 0:p.modal)==null?void 0:f.durationMs)??lp)*((e==null?void 0:e.modalChain)!==void 0?dp:1);(e==null?void 0:e.modalChain)!==void 0&&(this.previousModalInChain=e.modalChain,await this.previousModalInChain.hide({animationMode:"modalOnly",animationDurationMs:s,dontShowPreviousModalInchain:e.modalChain.previousModalInChain!==void 0})),this.open=!0,(e==null?void 0:e.mode)==="dialog"?this.wrapperEl.show():((e==null?void 0:e.mode)==="modal"||(e==null?void 0:e.mode)===void 0)&&this.wrapperEl.showModal(),await((m=e==null?void 0:e.beforeAnimation)==null?void 0:m.call(e,this.modalEl,e==null?void 0:e.modalChainData)),setTimeout(async()=>{this.focusFirstInput(e==null?void 0:e.focusFirstInput)},1);const n=((g=e==null?void 0:e.customAnimation)==null?void 0:g.modal)??((y=this.customShowAnimations)==null?void 0:y.modal),r=((v=e==null?void 0:e.customAnimation)==null?void 0:v.wrapper)??((A=this.customShowAnimations)==null?void 0:A.wrapper)??{from:{opacity:"0"},to:{opacity:"1"},easing:"swing"},o=(($=(W=e==null?void 0:e.customAnimation)==null?void 0:W.wrapper)==null?void 0:$.durationMs)??((te=(se=this.customShowAnimations)==null?void 0:se.wrapper)==null?void 0:te.durationMs)??lp,l=this.previousModalInChain!==void 0?"modalOnly":(e==null?void 0:e.animationMode)??"both";i(this.modalEl).stop(!0,!1),i(this.wrapperEl).stop(!0,!1),l==="both"||l==="none"?(n!=null&&n.from?(i(this.modalEl).css(n.from),i(this.modalEl).animate(n.to,l==="none"?0:s,n.easing??"swing")):i(this.modalEl).css("opacity","1"),i(this.wrapperEl).css(r.from),i(this.wrapperEl).removeClass("hidden").css("opacity","0").animate(r.to??{opacity:1},l==="none"?0:o,r.easing??"swing",async()=>{var b;this.focusFirstInput(e==null?void 0:e.focusFirstInput),await((b=e==null?void 0:e.afterAnimation)==null?void 0:b.call(e,this.modalEl,e==null?void 0:e.modalChainData)),a()})):l==="modalOnly"&&(i(this.wrapperEl).removeClass("hidden").css("opacity","1"),n!=null&&n.from?i(this.modalEl).css(n.from):i(this.modalEl).css("opacity","0"),i(this.modalEl).animate((n==null?void 0:n.to)??{opacity:1},s,(n==null?void 0:n.easing)??"swing",async()=>{var b;this.focusFirstInput(e==null?void 0:e.focusFirstInput),await((b=e==null?void 0:e.afterAnimation)==null?void 0:b.call(e,this.modalEl,e==null?void 0:e.modalChainData)),a()}))})}async hide(e){return new Promise(async a=>{var u,c,p,f,m,g,y,v,A,W,$,se,te;if(!da(this.dialogId)){a();return}e!=null&&e.clearModalChain&&(this.previousModalInChain=void 0),await((u=e==null?void 0:e.beforeAnimation)==null?void 0:u.call(e,this.modalEl));const s=((c=e==null?void 0:e.customAnimation)==null?void 0:c.modal)??((p=this.customHideAnimations)==null?void 0:p.modal),n=(((m=(f=e==null?void 0:e.customAnimation)==null?void 0:f.modal)==null?void 0:m.durationMs)??(e==null?void 0:e.animationDurationMs)??((y=(g=this.customHideAnimations)==null?void 0:g.modal)==null?void 0:y.durationMs)??lp)*(this.previousModalInChain!==void 0?dp:1),r=((v=e==null?void 0:e.customAnimation)==null?void 0:v.wrapper)??((A=this.customHideAnimations)==null?void 0:A.wrapper)??{from:{opacity:"1"},to:{opacity:"0"},easing:"swing"},o=(($=(W=e==null?void 0:e.customAnimation)==null?void 0:W.wrapper)==null?void 0:$.durationMs)??((te=(se=this.customHideAnimations)==null?void 0:se.wrapper)==null?void 0:te.durationMs)??lp,l=this.previousModalInChain!==void 0?"modalOnly":(e==null?void 0:e.animationMode)??"both";i(this.modalEl).stop(!0,!1),i(this.wrapperEl).stop(!0,!1),l==="both"||l==="none"?(s!=null&&s.from?(i(this.modalEl).css(s.from),i(this.modalEl).animate(s.to,l==="none"?0:n,s.easing??"swing")):i(this.modalEl).css("opacity","1"),i(this.wrapperEl).css(r.from),i(this.wrapperEl).css("opacity","1").animate((r==null?void 0:r.to)??{opacity:0},l==="none"?0:o,(r==null?void 0:r.easing)??"swing",async()=>{var b;this.wrapperEl.close(),this.wrapperEl.classList.add("hidden"),Aa(this.dialogId),this.open=!1,await((b=e==null?void 0:e.afterAnimation)==null?void 0:b.call(e,this.modalEl)),this.previousModalInChain!==void 0&&!(e!=null&&e.dontShowPreviousModalInchain)&&(await this.previousModalInChain.show({animationMode:"modalOnly",modalChainData:e==null?void 0:e.modalChainData,animationDurationMs:n*dp,...this.previousModalInChain.showOptionsWhenInChain}),this.previousModalInChain=void 0),a()})):l==="modalOnly"&&(i(this.wrapperEl).removeClass("hidden").css("opacity","1"),s!=null&&s.from?i(this.modalEl).css(s.from):i(this.modalEl).css("opacity","1"),i(this.modalEl).animate((s==null?void 0:s.to)??{opacity:0},n,(s==null?void 0:s.easing)??"swing",async()=>{var b;this.wrapperEl.close(),i(this.wrapperEl).addClass("hidden").css("opacity","0"),Aa(this.dialogId),this.open=!1,await((b=e==null?void 0:e.afterAnimation)==null?void 0:b.call(e,this.modalEl)),this.previousModalInChain!==void 0&&!(e!=null&&e.dontShowPreviousModalInchain)&&(await this.previousModalInChain.show({animationMode:"modalOnly",modalChainData:e==null?void 0:e.modalChainData,animationDurationMs:n*dp,...this.previousModalInChain.showOptionsWhenInChain}),this.previousModalInChain=void 0),a()}))})}destroy(){this.wrapperEl.close(),this.wrapperEl.classList.add("hidden"),Aa(this.dialogId),this.open=!1}}function PS(){RS.show()}const RS=new et({dialogId:"supportModal",setup:async t=>{var e;(e=t.querySelector("button.ads"))==null||e.addEventListener("click",async()=>{(await Jo()).show({subgroupOverride:"enableAds"},{modalChain:RS})})}});function DS(){jN.show()}const jN=new et({dialogId:"contactModal"});function HN(){zN.show({beforeAnimation:async()=>{i("#versionHistoryModal .modal").html(`
    <div class="preloader">
      <i class="fas fa-fw fa-spin fa-circle-notch"></i>
    </div
  `),cA().then(t=>{i("#versionHistoryModal .modal").html('<div class="releases"></div'),t.forEach(e=>{if(!e.draft&&!e.prerelease){let a=e.body;a=a.replace(/\r\n/g,"<br>"),a=a.replace(/### (.*?)<br>/g,"<h3>$1</h3>"),a=a.replace(/<\/h3><br>/gi,"</h3>"),a=a.replace(/^- /gm,""),a=a.replace(/\*\*(.*?)\*\*/g,"<b>$1</b>"),a=a.replace(/\[(.*?)\]\((.*?)\)/g,'<a href="$2" target="_blank">$1</a>'),i("#versionHistoryModal .modal .releases").append(`
        <div class="release">
          <div class="title">${e.name}</div>
          <div class="date">${nt(new Date(e.published_at),"dd MMM yyyy")}</div>
          <div class="body">${a}</div>
        </div>
      `)}})}).catch(t=>{i("#versionHistoryModal .modal").html(`<div class="releases">Failed to fetch version history:<br>${t.message}</div`)}),i("#newVersionIndicator").addClass("hidden")}})}const zN=new et({dialogId:"versionHistoryModal"});var I0;(I0=document.querySelector("footer #commandLineMobileButton"))==null||I0.addEventListener("click",async()=>{(await Jo()).show({singleListOverride:!1})});var O0;(O0=document.querySelector("footer #newVersionIndicator"))==null||O0.addEventListener("click",t=>{var e;t.stopPropagation(),(e=document.querySelector("#newVersionIndicator"))==null||e.classList.add("hidden")});var P0;(P0=document.querySelector("footer .currentVersion"))==null||P0.addEventListener("click",t=>{t.shiftKey?alert(Qo.clientVersion):HN()});var R0;(R0=document.querySelector("footer .right .current-theme"))==null||R0.addEventListener("click",async t=>{var a,s;if(t.shiftKey){if(d.customTheme){ui(!1);return}if(ce()&&(((s=(a=S())==null?void 0:a.customThemes)==null?void 0:s.length)??0)<1){h("No custom themes!",0),ui(!1);return}ui(!0)}else{const n=d.customTheme?"customThemesList":"themes";(await Jo()).show({subgroupOverride:n})}});var D0;(D0=document.querySelector("footer #supportMeButton"))==null||D0.addEventListener("click",()=>{PS()});var N0;(N0=document.querySelector("footer #contactPopupButton"))==null||N0.addEventListener("click",()=>{DS()});i("#keymap").on("click",".r5 .keySpace",async()=>{(await Jo()).show({subgroupOverride:"keymapLayouts"})});let Vv=!1;function tt(){Vv=!0}function Hu(){Vv=!1}function KN(){return Vv}const NS=["NumpadMultiply","NumpadSubtract","NumpadAdd","NumpadDecimal","NumpadEqual","NumpadDivide","Numpad0","Numpad1","Numpad2","Numpad3","Numpad4","Numpad5","Numpad6","Numpad7","Numpad8","Numpad9","Backquote","Digit1","Digit2","Digit3","Digit4","Digit5","Digit6","Digit7","Digit8","Digit9","Digit0","Minus","Equal","KeyQ","KeyW","KeyE","KeyR","KeyT","KeyY","KeyU","KeyI","KeyO","KeyP","BracketLeft","BracketRight","Backslash","KeyA","KeyS","KeyD","KeyF","KeyG","KeyH","KeyJ","KeyK","KeyL","Semicolon","Quote","IntlBackslash","KeyZ","KeyX","KeyC","KeyV","KeyB","KeyN","KeyM","Comma","Period","Slash","Space","Enter","Tab","NoCode"];class VN{constructor(){this.current="",this.history=[],this.historyLength=0,this.length=0,this.koreanStatus=!1}reset(){this.current="",this.history=[],this.length=0}resetHistory(){this.history=[],this.length=0}setCurrent(e){this.current=e,this.length=this.current.length}setKoreanStatus(e){this.koreanStatus=e}appendCurrent(e){this.current+=e,this.length=this.current.length}resetCurrent(){this.current=""}getCurrent(){return this.current}getKoreanStatus(){return this.koreanStatus}pushHistory(){this.history.push(this.current),this.historyLength=this.history.length,this.resetCurrent()}popHistory(){const e=this.history.pop()??"";return this.historyLength=this.history.length,e}getHistory(e){return e===void 0?this.history:this.history[e]}getHistoryLast(){return mi(this.history)}}class UN{constructor(){this.current="",this.history=[]}setCurrent(e){this.current=e}appendCurrent(e){this.current+=e}resetCurrent(){this.current=""}resetHistory(){this.history=[]}reset(){this.resetCurrent(),this.resetHistory()}getHistory(e){return this.history[e]}popHistory(){return this.history.pop()??""}pushHistory(){this.history.push(this.current),this.current=""}}let hn={};const T=new VN,Dt=new UN;let kr=[],sm=0,Km=0,gn={},Ya={correct:0,incorrect:0},st={spacing:{first:-1,last:-1,array:[]},duration:{array:[]}},dn={total:0,lastStartTime:-1},yn=[],Vm=[],Fa=[],Dc=[],zu={count:0,words:[]},Nc=[],nm=!0;function vy(){sm++}function WS(){nm=!1}function BS(){zu.count++}function by(t){zu.words.push(t)}function GN(t){Km=t}function Um(){kr.push(sm),sm=0}function Gm(){Nc.push(nm),nm=!0}function Qm(){Dc.push(zu),zu={count:0,words:[]}}function ZS(t){t?Ya.correct++:Ya.incorrect++}function QN(t){var r,o;const e=we(Op(st.duration.array)),a=Object.entries(hn);a.sort((l,u)=>l[1].timestamp-u[1].timestamp);for(const l of a)qS(t,l[0]);const s=(r=mi(a))==null?void 0:r[0],n=(o=hn[s])==null?void 0:o.index;s!==void 0&&n!==void 0&&(st.duration.array[n]=e)}let Ku=0;function qS(t,e){if(!NS.includes(e))return;e==="NoCode"&&(Ku--,e="NoCode"+Ku);const a=hn[e];if(a===void 0)return;const s=Math.abs(a.timestamp-t);st.duration.array[a.index]=s,console.debug("Keyup recorded",e,s),delete hn[e],FS(t)}function YN(t,e){var a;if(!NS.includes(e)){console.debug("Key not tracked",e);return}if(e==="NoCode"&&(e="NoCode"+Ku,Ku++),hn[e]!==void 0){console.debug("Key already down",e);return}if(hn[e]={timestamp:t,index:st.duration.array.length},st.duration.array.push(0),FS((a=hn[e])==null?void 0:a.timestamp),st.spacing.last!==-1){const s=Math.abs(t-st.spacing.last);st.spacing.array.push(we(s)),console.debug("Keydown recorded",e,s)}st.spacing.last=t,st.spacing.first===-1&&(st.spacing.first=t,console.debug("First keydown recorded",e,t))}function FS(t){Object.keys(hn).length>1?dn.lastStartTime===-1&&(dn.lastStartTime=t):dn.lastStartTime!==-1&&(dn.total+=t-dn.lastStartTime,dn.lastStartTime=-1)}function JN(){st={spacing:{first:-1,last:-1,array:[]},duration:{array:[]}},dn={total:0,lastStartTime:-1},hn={},Ku=0,console.debug("Keypress timings reset")}function jS(t){Object.keys(gn).includes(t)?gn[t]++:gn[t]=1}function HS(t){yn.push(t)}function zS(t){Vm.push(t)}function KS(t){Fa[E.currentIndex]===void 0?Fa.push(t):Fa[E.currentIndex]=t}function XN(){yn=[],Vm=[],Fa=[],kr=[],sm=0,Nc=[],nm=!0,Dc=[],zu={count:0,words:[]},Km=0,gn={},Ya={correct:0,incorrect:0},st={spacing:{first:-1,last:-1,array:[]},duration:{array:[]}}}let Vu=["The","quick","brown","fox","jumps","over","the","lazy","dog"],Uv="repeat";const Ri={value:9,mode:"word"};let Gv=!1;function Ym(){return Vu}function Tn(t){Vu=t,Ri.value=Vu.length}function Vp(){return Uv}function Uu(t){Uv=t,Ri.value=Vu.length}function Wz(){return Ri}function gt(){return Ri.value}function St(){return Ri.mode}function ir(t){Ri.value=t}function ci(t){Ri.mode=t}function Wc(){return Gv}function Wo(t){Gv=t}function Er(){return{text:Vu,mode:Uv,limit:Ri,pipeDelimiter:Gv}}function im(t,e=!1){if(e){const s=Xo()[t];if(s===void 0)throw new Error(`Custom text ${t} not found`);return s.text.split(/ +/)}else{const a=Jm()[t];if(a===void 0)throw new Error(`Custom text ${t} not found`);return a.split(/ +/)}}function eW(t,e,a=!1){if(a){const s=Xo();s[t]={text:"",progress:0};const n=s[t];if(n===void 0)throw new Error("Custom text not found");typeof e=="string"?n.text=e:n.text=e.join(" "),Yv(s)}else{const s=Jm();typeof e=="string"?s[t]=e:s[t]=e.join(" "),US(s)}}function VS(t,e){const a=e?Xo():Jm();delete a[t],e?Yv(a):US(a)}function Qv(t){const e=Xo()[t];if(e===void 0)throw new Error("Custom text not found");return e.progress??0}function wy(t,e){const a=Xo(),s=a[t];if(s===void 0)throw new Error("Custom text not found");s.progress=e,Yv(a)}function Jm(){return JSON.parse(window.localStorage.getItem("customText")??"{}")}function Xo(){return JSON.parse(window.localStorage.getItem("customTextLong")??"{}")}function US(t){window.localStorage.setItem("customText",JSON.stringify(t))}function Yv(t){window.localStorage.setItem("customTextLong",JSON.stringify(t))}function ky(t=!1){return Object.keys(t?Xo():Jm())}let rm=!0;const vn=document.querySelector("#caret");function GS(){rm&&(vn.style.animationName="none",vn.style.opacity="1",rm=!1)}function QS(){rm||(d.smoothCaret!=="off"&&!Ct()?vn.style.animationName="caretFlashSmooth":vn.style.animationName="caretFlashHard",rm=!0)}function Bc(){vn.classList.add("hidden")}function tW(t,e,a,s,n,r){let o=0;if(e){const l=t?0:(a==null?void 0:a.offsetWidth)??(s==null?void 0:s.offsetWidth)??0;a!==void 0?o=a.offsetLeft+l:s!==void 0&&(o=s.offsetLeft-s.offsetWidth+l)}else(d.blindMode||d.hideExtraLetters)&&r?o=n.offsetLeft+n.offsetWidth:a!==void 0?o=a.offsetLeft:s!==void 0&&(o=s.offsetLeft+s.offsetWidth);return o}async function $n(t=!1){var Ft,jt;const e=Math.round(((Ft=document.querySelector("#caret"))==null?void 0:Ft.getBoundingClientRect().width)??0),a=["block","outline","underline"].includes(d.caretStyle),s=E.getCurrent().length,n=T.current.length,r=document==null?void 0:document.querySelector("#words .active"),o=(r==null?void 0:r.children.length)===0;o&&r.insertAdjacentHTML("beforeend",'<letter style="opacity: 0;">_</letter>');const l=(jt=document==null?void 0:document.querySelector("#words .active"))==null?void 0:jt.querySelectorAll("letter");if(!l)return;const u=l[n],c=l[n-1],p=l[s-1],m=(await Ii(d.language)).rightToLeft,g=tW(a,m,u,c,p,n>s),y=(u==null?void 0:u.offsetTop)??(c==null?void 0:c.offsetTop)??(p==null?void 0:p.offsetTop),v=(u==null?void 0:u.offsetHeight)||(c==null?void 0:c.offsetHeight)||(p==null?void 0:p.offsetHeight)||d.fontSize*fr(1),A=(u==null?void 0:u.offsetWidth)||(c==null?void 0:c.offsetWidth)||(p==null?void 0:p.offsetWidth),W=v-vn.offsetHeight;let $=r.offsetTop+y+W/2;d.caretStyle==="underline"&&($=r.offsetTop+y-vn.offsetHeight/2);let se=r.offsetLeft+g-(a?0:e/2);const te=i(document.querySelector("#wordsWrapper")).width()??0;(d.tapeMode==="letter"||d.tapeMode==="word"&&n===0)&&(se=te/2-(a?0:e/2));const b=a?(A??0)+"px":"";let w=i("#words .smoothScroller").height();w===void 0&&(w=0);const q=i(vn);q.css("display","block");const me={top:$-w,left:se};b!==""?me.width=b:q.css("width","");const qt=d.smoothCaret=="off"?0:d.smoothCaret=="slow"?150:d.smoothCaret=="medium"?100:d.smoothCaret=="fast"?85:0;if(q.stop(!0,!1).animate(me,Ct()||t?0:qt),d.showAllLines){const Ut=window.innerHeight,ds=Ut/2-q.outerHeight()/2,nl=document.body.scrollHeight;if($>=ds&&nl>Ut&&$t){const Dn=$-ds/2;window.scrollTo({left:0,top:Dn,behavior:"smooth"})}}o&&(r==null||r.replaceChildren())}function YS(t=!1){vn.classList.remove("hidden"),$n(t),QS()}const ro=document.querySelector("#capsWarning"),aW=navigator.platform.startsWith("Mac");let un=!1,om=!1;function sW(){om||(ro==null||ro.classList.remove("hidden"),om=!0)}function nW(){om&&(ro==null||ro.classList.add("hidden"),om=!1)}function JS(t){var e,a,s;((e=t==null?void 0:t.originalEvent)==null?void 0:e.key)==="CapsLock"&&un!==null?un=!un:un=((s=(a=t==null?void 0:t.originalEvent)==null?void 0:a.getModifierState)==null?void 0:s.call(a,"CapsLock"))??!1;try{d.capsLockWarning&&un?sW():nW()}catch{}}i(document).on("keyup",JS);i(document).on("keydown",t=>{aW&&JS(t)});let $i=!1,Ai=!1;const Rw=[["Backquote","Digit1","Digit2","Digit3","Digit4","Digit5","Digit6","Digit7","Digit8","Digit9","Digit0","Minus","Equal"],["KeyQ","KeyW","KeyE","KeyR","KeyT","KeyY","KeyU","KeyI","KeyO","KeyP","BracketLeft","BracketRight","Backslash"],["KeyA","KeyS","KeyD","KeyF","KeyG","KeyH","KeyJ","KeyK","KeyL","Semicolon","Quote"],["KeyZ","KeyX","KeyC","KeyV","KeyB","KeyN","KeyM","Comma","Period","Slash"],["Space"]],iW=/^[^\p{L}\p{N}]{1}$/u,rW=/Mac|iPod|iPhone|iPad/.test(navigator.platform);let Dw=[!1,!1];function oW(){const t=$i||Ai,e=rW?t||un:t!==un,[a,s]=Dw;if(!(a===e&&s===t))return Dw=[e,t]}async function XS(){const t=oW();if(t===void 0)return;const e=[...document.getElementsByClassName("keymapKey")].filter(u=>{const c=u.classList.contains("keymapKey"),p=!u.classList.contains("keySpace")&&!u.classList.contains("keySplitSpace");return c&&p}),a=e.map(u=>u.dataset.key);if(a.includes(void 0))return;const s=e.map(u=>u.childNodes[1]),[n,r]=t,o=d.keymapLayout==="overrideSync"?d.layout==="default"?"qwerty":d.layout:d.keymapLayout,l=await vc(o).catch(()=>{});if(l===void 0){h("Failed to load keymap layout",-1);return}for(let u=0;u<a.length;u++){const c=a[u],p=s[u],f=c[0],m=c[1];if(p===void 0||c===void 0||f===void 0||m===void 0)continue;const g=[f,m].some(te=>iW.test(te??"")),y=e1(f,l);if(y===void 0)return;const W=xy(y)&&(g?r:n),$=Number(W),se=c[$];p.textContent=se??""}}i(document).on("keydown",t=>{t.code==="ShiftLeft"?($i=!0,Ai=!1):t.code==="ShiftRight"&&($i=!1,Ai=!0),d.keymapLegendStyle==="dynamic"&&XS()});i(document).on("keyup",t=>{(t.code==="ShiftLeft"||t.code==="ShiftRight")&&($i=!1,Ai=!1),d.keymapLegendStyle==="dynamic"&&XS()});function lW(){$i=!1,Ai=!1}const dW=["KeyQ","KeyW","KeyE","KeyR","KeyT","KeyY","KeyA","KeyS","KeyD","KeyF","KeyG","IntlBackslash","KeyZ","KeyX","KeyC","KeyV","KeyB","Backquote","Digit1","Digit2","Digit3","Digit4","Digit5","Digit6"],uW=["KeyY","KeyU","KeyI","KeyO","KeyP","KeyH","KeyJ","KeyK","KeyL","KeyB","KeyN","KeyM","Digit6","Digit7","Digit8","Digit9","Digit0","Minus","Equal","Backslash","BracketLeft","BracketRight","Semicolon","Quote","Comma","Period","Slash"];function xy(t){if(!$i&&!Ai||d.oppositeShiftMode==="off")return!0;const e=uW.includes(t),a=dW.includes(t);return!!(!e&&!a||$i&&e||Ai&&a)}function e1(t,e){var l,u;const a=Object.values(e.keys),s=a.findIndex(c=>c.find(p=>p.includes(t))),n=a[s];if(n===void 0)return;const r=n.findIndex(c=>c.includes(t));if(r===-1)return;let o=(l=Rw[s])==null?void 0:l[r];return e.type==="iso"&&(s===2&&r===11?o="Backslash":s===3&&r===0?o="IntlBackslash":s===3&&(o=(u=Rw[3])==null?void 0:u[r-1])),o}async function t1(){return await fv(()=>import("./howler.BchbbeDV.js").then(t=>t.h),__vite__mapDeps([5,1]))}let lm=null,xr=null;async function cW(){const t=(await t1()).Howl;lm===null&&(lm={1:[{sounds:[new t({src:"../sound/error1/error1_1.wav"}),new t({src:"../sound/error1/error1_1.wav"})],counter:0}],2:[{sounds:[new t({src:"../sound/error2/error2_1.wav"}),new t({src:"../sound/error2/error2_1.wav"})],counter:0}],3:[{sounds:[new t({src:"../sound/error3/error3_1.wav"}),new t({src:"../sound/error3/error3_1.wav"})],counter:0}],4:[{sounds:[new t({src:"../sound/error4/error4_1.wav"}),new t({src:"../sound/error4/error4_1.wav"})],counter:0},{sounds:[new t({src:"../sound/error4/error4_2.wav"}),new t({src:"../sound/error4/error4_2.wav"})],counter:0}]},Howler.volume(d.soundVolume))}async function Xm(){const t=(await t1()).Howl;xr===null&&(xr={1:[{sounds:[new t({src:"../sound/click1/click1_1.wav"}),new t({src:"../sound/click1/click1_1.wav"})],counter:0},{sounds:[new t({src:"../sound/click1/click1_2.wav"}),new t({src:"../sound/click1/click1_2.wav"})],counter:0},{sounds:[new t({src:"../sound/click1/click1_3.wav"}),new t({src:"../sound/click1/click1_3.wav"})],counter:0}],2:[{sounds:[new t({src:"../sound/click2/click2_1.wav"}),new t({src:"../sound/click2/click2_1.wav"})],counter:0},{sounds:[new t({src:"../sound/click2/click2_2.wav"}),new t({src:"../sound/click2/click2_2.wav"})],counter:0},{sounds:[new t({src:"../sound/click2/click2_3.wav"}),new t({src:"../sound/click2/click2_3.wav"})],counter:0}],3:[{sounds:[new t({src:"../sound/click3/click3_1.wav"}),new t({src:"../sound/click3/click3_1.wav"})],counter:0},{sounds:[new t({src:"../sound/click3/click3_2.wav"}),new t({src:"../sound/click3/click3_2.wav"})],counter:0},{sounds:[new t({src:"../sound/click3/click3_3.wav"}),new t({src:"../sound/click3/click3_3.wav"})],counter:0}],4:[{sounds:[new t({src:"../sound/click4/click4_1.wav"}),new t({src:"../sound/click4/click4_11.wav"})],counter:0},{sounds:[new t({src:"../sound/click4/click4_2.wav"}),new t({src:"../sound/click4/click4_22.wav"})],counter:0},{sounds:[new t({src:"../sound/click4/click4_3.wav"}),new t({src:"../sound/click4/click4_33.wav"})],counter:0},{sounds:[new t({src:"../sound/click4/click4_4.wav"}),new t({src:"../sound/click4/click4_44.wav"})],counter:0},{sounds:[new t({src:"../sound/click4/click4_5.wav"}),new t({src:"../sound/click4/click4_55.wav"})],counter:0},{sounds:[new t({src:"../sound/click4/click4_6.wav"}),new t({src:"../sound/click4/click4_66.wav"})],counter:0}],5:[{sounds:[new t({src:"../sound/click5/click5_1.wav"}),new t({src:"../sound/click5/click5_11.wav"})],counter:0},{sounds:[new t({src:"../sound/click5/click5_2.wav"}),new t({src:"../sound/click5/click5_22.wav"})],counter:0},{sounds:[new t({src:"../sound/click5/click5_3.wav"}),new t({src:"../sound/click5/click5_33.wav"})],counter:0},{sounds:[new t({src:"../sound/click5/click5_4.wav"}),new t({src:"../sound/click5/click5_44.wav"})],counter:0},{sounds:[new t({src:"../sound/click5/click5_5.wav"}),new t({src:"../sound/click5/click5_55.wav"})],counter:0},{sounds:[new t({src:"../sound/click5/click5_6.wav"}),new t({src:"../sound/click5/click5_66.wav"})],counter:0}],6:[{sounds:[new t({src:"../sound/click6/click6_1.wav"}),new t({src:"../sound/click6/click6_11.wav"})],counter:0},{sounds:[new t({src:"../sound/click6/click6_2.wav"}),new t({src:"../sound/click6/click6_22.wav"})],counter:0},{sounds:[new t({src:"../sound/click6/click6_3.wav"}),new t({src:"../sound/click6/click6_33.wav"})],counter:0}],7:[{sounds:[new t({src:"../sound/click7/click7_1.wav"}),new t({src:"../sound/click7/click7_11.wav"})],counter:0},{sounds:[new t({src:"../sound/click7/click7_2.wav"}),new t({src:"../sound/click7/click7_22.wav"})],counter:0},{sounds:[new t({src:"../sound/click7/click7_3.wav"}),new t({src:"../sound/click7/click7_33.wav"})],counter:0}],14:[{sounds:[new t({src:"../sound/click14/click14_1.wav"}),new t({src:"../sound/click14/click14_1.wav"})],counter:0},{sounds:[new t({src:"../sound/click14/click14_2.wav"}),new t({src:"../sound/click14/click14_2.wav"})],counter:0},{sounds:[new t({src:"../sound/click14/click14_3.wav"}),new t({src:"../sound/click14/click14_3.wav"})],counter:0},{sounds:[new t({src:"../sound/click14/click14_4.wav"}),new t({src:"../sound/click14/click14_4.wav"})],counter:0},{sounds:[new t({src:"../sound/click14/click14_5.wav"}),new t({src:"../sound/click14/click14_5.wav"})],counter:0},{sounds:[new t({src:"../sound/click14/click14_6.wav"}),new t({src:"../sound/click14/click14_6.wav"})],counter:0},{sounds:[new t({src:"../sound/click14/click14_7.wav"}),new t({src:"../sound/click14/click14_7.wav"})],counter:0},{sounds:[new t({src:"../sound/click14/click14_8.wav"}),new t({src:"../sound/click14/click14_8.wav"})],counter:0}],15:[{sounds:[new t({src:"../sound/click15/click15_1.wav"}),new t({src:"../sound/click15/click15_1.wav"})],counter:0},{sounds:[new t({src:"../sound/click15/click15_2.wav"}),new t({src:"../sound/click15/click15_2.wav"})],counter:0},{sounds:[new t({src:"../sound/click15/click15_3.wav"}),new t({src:"../sound/click15/click15_3.wav"})],counter:0},{sounds:[new t({src:"../sound/click15/click15_4.wav"}),new t({src:"../sound/click15/click15_4.wav"})],counter:0},{sounds:[new t({src:"../sound/click15/click15_5.wav"}),new t({src:"../sound/click15/click15_5.wav"})],counter:0}]},Howler.volume(d.soundVolume))}async function Bz(t){xr===null&&await Xm();const e=xr;Object.keys(e).includes(t)&&(e[t][0].sounds[0].seek(0),e[t][0].sounds[0].play())}let Bl="KeyA";i(document).on("keydown",t=>{Bl=t.code||"KeyA"});const qe={C:[16.35,32.7,65.41,130.81,261.63,523.25,1046.5,2093,4186.01],Db:[17.32,34.65,69.3,138.59,277.18,554.37,1108.73,2217.46,4434.92],D:[18.35,36.71,73.42,146.83,293.66,587.33,1174.66,2349.32,4698.64],Eb:[19.45,38.89,77.78,155.56,311.13,622.25,1244.51,2489.02,4978.03],E:[20.6,41.2,82.41,164.81,329.63,659.26,1318.51,2637.02],F:[21.83,43.65,87.31,174.61,349.23,698.46,1396.91,2793.83],Gb:[23.12,46.25,92.5,185,369.99,739.99,1479.98,2959.96],G:[24.5,49,98,196,392,783.99,1567.98,3135.96],Ab:[25.96,51.91,103.83,207.65,415.3,830.61,1661.22,3322.44],A:[27.5,55,110,220,440,880,1760,3520],Bb:[29.14,58.27,116.54,233.08,466.16,932.33,1864.66,3729.31],B:[30.87,61.74,123.47,246.94,493.88,987.77,1975.53,3951.07]};function je(t,e=0){return a=>t[a+e]??0}const up={KeyZ:je(qe.C),KeyS:je(qe.Db),KeyX:je(qe.D),KeyD:je(qe.Eb),KeyC:je(qe.E),KeyV:je(qe.F),KeyG:je(qe.Gb),KeyB:je(qe.G),KeyH:je(qe.Ab),KeyN:je(qe.A),KeyJ:je(qe.Bb),KeyM:je(qe.B),Comma:je(qe.C,1),KeyL:je(qe.Db,1),Period:je(qe.D,1),Semicolon:je(qe.Eb,1),Slash:je(qe.E,1),KeyQ:je(qe.C,1),Digit2:je(qe.Db,1),KeyW:je(qe.D,1),Digit3:je(qe.Eb,1),KeyE:je(qe.E,1),KeyR:je(qe.F,1),Digit5:je(qe.Gb,1),KeyT:je(qe.G,1),Digit6:je(qe.Ab,1),KeyY:je(qe.A,1),Digit7:je(qe.Bb,1),KeyU:je(qe.B,1),KeyI:je(qe.C,2),Digit9:je(qe.Db,2),KeyO:je(qe.D,2),Digit0:je(qe.Eb,2),KeyP:je(qe.E,2),BracketLeft:je(qe.F,2),Equal:je(qe.Gb,2),BracketRight:je(qe.G,2)},a1={8:"sine",9:"sawtooth",10:"square",11:"triangle"};let Nt;function s1(){if(Nt!==null)try{Nt=new AudioContext}catch(t){Nt=null,console.error(t),h(Re(t,"Error initializing audio context")+". Notes will not play.",-1)}}const Nw={pentatonic:["C","D","E","G","A"],wholetone:["C","D","E","Gb","Ab","Bb"]};function Ww(t){const e={position:0,octave:4,direction:1};return async()=>{xr===null&&await Xm(),n1(t,e)}}const Bw={position:0,octave:4,direction:1},Zw={12:{name:"pentatonic",preview:Ww("pentatonic"),meta:Bw},13:{name:"wholetone",preview:Ww("wholetone"),meta:Bw}};function n1(t,e){if(Nt===void 0&&s1(),!Nt)return;const a=ua(0,Nw[t].length-1);Math.random()<.5&&(e.octave+=e.direction),e.octave>=6&&(e.direction=-1),e.octave<=4&&(e.direction=1);const s=Nw[t][a],n=qe[s][e.octave],r=Nt.createOscillator(),o=Nt.createGain();r.type="sine",o.gain.value=d.soundVolume/10,r.connect(o),o.connect(Nt.destination),r.frequency.value=n,r.start(Nt.currentTime),o.gain.setTargetAtTime(0,Nt.currentTime,.3),r.stop(Nt.currentTime+2)}function pW(t,e){var l;if(Nt===void 0&&s1(),!Nt||(Bl=t??Bl,!(Bl in up)))return;const s=3+($i||Ai||un?1:0),n=(l=up[Bl])==null?void 0:l.call(up,s),r=Nt.createOscillator(),o=Nt.createGain();r.type=e??a1[d.playSoundOnClick],o.gain.value=d.soundVolume/10,r.connect(o),o.connect(Nt.destination),r.frequency.value=n,r.start(Nt.currentTime),o.gain.setTargetAtTime(0,Nt.currentTime,.15),r.stop(Nt.currentTime+.5)}async function An(t){if(d.playSoundOnClick==="off")return;if(d.playSoundOnClick in Zw){const{name:n,meta:r}=Zw[d.playSoundOnClick];n1(n,r);return}if(d.playSoundOnClick in a1){pW(t??void 0);return}xr===null&&await Xm();const e=xr[d.playSoundOnClick];if(e===void 0)throw new Error("Invalid click sound ID");const a=Hs(e),s=a.sounds[a.counter];a.counter++,a.counter===2&&(a.counter=0),s.seek(0),s.play()}async function eh(){if(d.playSoundOnError==="off")return;lm===null&&await cW();const t=lm[d.playSoundOnError];if(t===void 0)throw new Error("Invalid error sound ID");const e=Hs(t),a=e.sounds[e.counter];e.counter++,e.counter===2&&(e.counter=0),a.seek(0),a.play()}function fW(t){try{Howler.volume(t)}catch{}}mt((t,e)=>{t==="playSoundOnClick"&&e!=="off"&&Xm(),t==="soundVolume"&&fW(parseFloat(e))});let Jv=[],Bs=[],i1=0,Xv=!0,Ns=0,Qt=0,_r=0,Zc=0,dm=[],_y=[];var W0;const Kt=(W0=document.getElementById("playpauseReplayButton"))==null?void 0:W0.children[0];function r1(t){Jv=t}function eb(){const t=document.getElementById("replayWords");if(t===null)return;t.innerHTML="";let e=0;Bs.forEach(a=>{a.action==="backWord"?e--:(a.action==="submitCorrectWord"||a.action==="submitErrorWord")&&e++}),Jv.forEach((a,s)=>{if(s>e)return;const n=document.createElement("div");n.className="word";for(const r of a){const o=document.createElement("letter");o.innerHTML=r,n.appendChild(o)}t.appendChild(n)})}function qc(){var t;dm.forEach(e=>{clearTimeout(e)}),dm=[],_y.forEach(e=>{clearTimeout(e)}),_y=[],Zc=Qt,_r=Ns,Kt!==void 0&&(Kt.className="fas fa-play",(t=Kt.parentNode)==null||t.setAttribute("aria-label","Resume replay"))}function Dr(t=!1){t&&d.playSoundOnError!=="off"?eh():An()}function o1(t,e=!1){var s,n,r,o;let a=(s=document.getElementById("replayWords"))==null?void 0:s.children[Ns];if(a!==void 0){if(t.action==="correctLetter")e||Dr(),(n=a.children[Qt])==null||n.classList.add("correct"),Qt++;else if(t.action==="incorrectLetter"){e||Dr(!0);let l;Qt>=a.children.length&&(l=document.createElement("letter"),l==null||l.classList.add("extra"),l.innerHTML=((r=t.value)==null?void 0:r.toString())??"",a.appendChild(l)),l=a.children[Qt],l==null||l.classList.add("incorrect"),Qt++}else if(t.action==="setLetterIndex"&&typeof t.value=="number"){e||Dr(),Qt=t.value;for(const l of[...a.children].slice(Qt))l!=null&&l.classList.contains("extra")?l.remove():l.className=""}else if(t.action==="submitCorrectWord")e||Dr(),Ns++,Qt=0;else if(t.action==="submitErrorWord")e||Dr(!0),a==null||a.classList.add("error"),Ns++,Qt=0;else if(t.action==="backWord"){e||Dr(),Ns--;const l=document.getElementById("replayWords");for(l!==null&&(a=l.children[Ns]),Qt=a.children.length;((o=a.children[Qt-1])==null?void 0:o.className)==="";)Qt--;a==null||a.classList.remove("error")}}}function tb(){var s;let t=0;Qt=0,Ns=0,Bs.forEach((n,r)=>{(Ns<_r||Ns===_r&&Qt<Zc)&&(o1(n,!0),t=r+1)});const e=(s=Bs[t])==null?void 0:s.time;if(e===void 0)throw new Error("Failed to load old replay: datatime is undefined");const a=Math.floor(e/1e3);return d1(a),t}function l1(){var t;i("#resultReplay").stop(!0,!0).hasClass("hidden")?(eb(),tb(),i("#watchReplayButton").hasClass("loaded")?i("#resultReplay").removeClass("hidden").css("display","none").slideDown(250):(i("#words").html('<div class="preloader"><i class="fas fa-fw fa-spin fa-circle-notch"></i></div>'),i("#resultReplay").removeClass("hidden").css("display","none").slideDown(250))):(((t=Kt==null?void 0:Kt.parentNode)==null?void 0:t.getAttribute("aria-label"))!="Start replay"&&qc(),i("#resultReplay").slideUp(250,()=>{i("#resultReplay").addClass("hidden")}))}function mW(){i("#resultReplay").stop(!0,!0).hasClass("hidden")||l1(),i("#replayStats").text(""),Bs=[],i1=performance.now(),Xv=!0,Zc=0,_r=0}function ab(){Xv=!1}function rr(t,e){if(!Xv)return;const a=performance.now()-i1;Bs.push({action:t,value:e,time:a})}function d1(t){const a=`${yn[t-1]??0}wpm	${t}s`;i("#replayStats").text(a)}function hW(){var n,r;if(Qt=0,Ns=0,Kt===void 0)return;Kt.className="fas fa-pause",(n=Kt.parentNode)==null||n.setAttribute("aria-label","Pause replay"),eb();const t=tb(),e=(r=Bs[t])==null?void 0:r.time;if(e===void 0)throw new Error("Failed to play replay: lastTime is undefined");let a=Math.round(e/1e3);const s=Math.round(mi(Bs).time/1e3);for(;a<=s;){const o=a;_y.push(setTimeout(()=>{d1(o)},o*1e3-e)),a++}Bs.forEach((o,l)=>{l<t||dm.push(setTimeout(()=>{o1(o)},o.time-e))}),dm.push(setTimeout(()=>{Zc=0,_r=0,Kt.className="fas fa-play",Kt.parentNode.setAttribute("aria-label","Start replay")},mi(Bs).time-e))}function gW(){return JSON.stringify({replayData:Bs,wordsList:Jv})}i(".pageTest #playpauseReplayButton").on("click",()=>{(Kt==null?void 0:Kt.className)==="fas fa-play"?hW():(Kt==null?void 0:Kt.className)==="fas fa-pause"&&qc()});i("#replayWords").on("click","letter",t=>{qc();const e=document.querySelector("#replayWords"),a=[...(e==null?void 0:e.children)??[]];_r=a.indexOf(t.target.parentNode),Zc=[...a[_r].children].indexOf(t.target),eb(),tb()});i(".pageTest").on("click","#watchReplayButton",()=>{l1()});class hl{constructor(e,a,s,n,r){this.unit=e,this.convertFactor=a,this.fullUnitString=s,this.histogramDataBucketSize=n,this.historyStepSize=r}fromWpm(e){return e*this.convertFactor}toWpm(e){return e/this.convertFactor}}const yW={wpm:new hl("wpm",1,"Words per Minute",10,10),cpm:new hl("cpm",5,"Characters per Minute",50,100),wps:new hl("wps",1/60,"Words per Second",.5,2),cps:new hl("cps",5/60,"Characters per Second",5,5),wph:new hl("wph",60,"Words per Hour",250,1e3)};function ea(t){return yW[t]}const th={composing:!1,startPos:-1};function or(){return th.composing}function vW(){return th.startPos}function u1(t){th.composing=t}function bW(t){th.startPos=t}const ia=16,c1=12,Cy=ia/2,wW=c1/2,qw=250;let xa=[],Ht,Bo={},um=[],ah=[],Jl=[],sb=[],Xr=[],cp,Nr,p1=new Date,Gu=!1,f1=!1,Sy=!0,cm=!0,Ty=!1,pp=!1;async function kW(t,e){if(!f1||Xr!==void 0&&t===Xr[0]&&e===Xr[1]||!Gu&&!await _W()||t===void 0||e===void 0||t<0||e<0||e<t)return!1;e=Math.min(e,Ht.length-1);const a=CW(t,e,Ty);for(let s=0;s<xa.length;s++){const n=ah[s],r=n.children[0];n.classList.remove("highlight-hidden"),!Sy&&!cm?(n.classList.add("withAnimation"),r.classList.add("withAnimation")):(n.classList.remove("withAnimation"),r.classList.remove("withAnimation"));const o=a[s];o&&(n.style.right=o.highlightRight+"px",r.style.left=o.inputContainerLeft+"px",n.style.left=o.highlightLeft+"px")}return Sy=!1,cm=!1,Xr=[t,e],!0}function xW(){for(const t of ah)t.classList.add("highlight-hidden");cm=!0,Xr=[]}function nb(){if(Gu){for(const t of um)t.remove();ah=[],um=[],Bo={},xa=[],Jl=[],sb=[],Gu=!1,Sy=!0,cm=!0,Xr=[]}}function m1(t){f1=t}async function _W(){if(Gu||pp)return!1;pp=!0;const t=new Date().getTime()-p1.getTime();if(t<qw&&await new Promise(c=>setTimeout(c,qw-t)),Ty=(await Ii(d.language)).rightToLeft,cp=i("#resultWordsHistory")[0],Nr=cp.getBoundingClientRect(),Ht=i(cp).find(".words .word[input]"),Ht.length===0)return pp=!1,!1;let a=-1,s,n=0;Bo[0]=0;for(let c=1;c<Ht.length;c++){const p=Ht[c],f=Ht[c-1];p.offsetTop!=f.offsetTop&&(n++,s=Gl([Ht[a+1],f]),xa.push({firstWordIndex:a+1,lastWordIndex:c-1,rect:s}),a=c-1),Bo[c]=n}s=Gl([Ht[a+1],Ht[Ht.length-1]]),xa.push({firstWordIndex:a+1,lastWordIndex:Ht.length-1,rect:s});const r=Nr.width,o=Nr.height,l=Nr.top,u=Nr.left;return xa.forEach(c=>{const p=document.createElement("div");p.classList.add("highlightContainer"),um.push(p);const f=c.rect.top-wW,m=c.rect.left-Cy,g=f-l,y=m-u,v=c.rect.width+ia,A=c.rect.height+c1,W=c.rect.width,$=c.rect.height,se=g/o*100+"%",te=y/r*100+"%",b=v/r*100+"%",w=A/o*100+"%";p.style.width=b,p.style.top=se,p.style.left=te,p.style.height=w;const q=document.createElement("div"),me=document.createElement("div");me.style.top=c.rect.top-f+"px",me.style.left=c.rect.left-m+"px",me.style.width=W+"px",me.style.height=$+"px",q.className="highlight highlight-hidden",me.className="inputWordsContainer";for(let qt=c.firstWordIndex;qt<=c.lastWordIndex;qt+=1){const Ft=Ht[qt],jt=Ft.getAttribute("input")??"";if(!jt)continue;const Ut=document.createElement("div");let ds;Ty?ds=c.rect.left-Nr.left+ia:ds=0,Ut.style.left=Ft.offsetLeft+Cy-ds+"px",Ut.innerHTML=jt.replace(/\t/g,"_").replace(/\n/g,"_").replace(/</g,"&lt").replace(/>/g,"&gt").slice(0,Ft.childElementCount),Ut.className="inputWord",me.append(Ut),sb.push(Ut)}Jl.push(me),ah.push(q),q.append(me),p.append(q),cp.append(p)}),Gu=!0,pp=!1,!0}function CW(t,e,a=!1){const s=Bo[t],n=new Array(xa.length).fill(null).map(()=>({highlightLeft:0,highlightRight:0,inputContainerLeft:0,inputContainerRight:0})),r=SW(t,e),o=Ht[t],l=xa[s],u=n[s],c=um[s],p=Jl[s];if(o===void 0||l===void 0||u===void 0||c===void 0||p===void 0)return n;if(!a)u.highlightLeft=o.offsetLeft,u.highlightRight=l.rect.width-(u.highlightLeft+r)+ia;else{const f=c.offsetLeft;u.highlightRight=l.rect.width-(o.offsetLeft+o.offsetWidth)+f+Cy,u.highlightLeft=l.rect.width-(u.highlightRight+r)+ia}a?u.inputContainerLeft=-1*(p.getBoundingClientRect().width-r-u.highlightRight):u.inputContainerLeft=-1*u.highlightLeft;for(let f=s-1;f>=0;f--){const m=n[f],g=n[f+1],y=xa[f],v=Jl[f];m===void 0||y===void 0||g===void 0||v===void 0||(a?(m.highlightRight=g.highlightRight+y.rect.width+ia,m.highlightLeft=y.rect.width-(m.highlightRight+r)+ia,m.inputContainerLeft=-1*(v.getBoundingClientRect().width-r-m.highlightRight)):(m.highlightLeft=g.highlightLeft+y.rect.width+ia,m.highlightRight=y.rect.width-(m.highlightLeft+r)+ia,m.inputContainerLeft=-1*m.highlightLeft))}for(let f=s+1;f<xa.length;f++){const m=n[f],g=xa[f-1],y=xa[f],v=n[f-1],A=Jl[f];m===void 0||g===void 0||y===void 0||v===void 0||A===void 0||(a?(m.highlightRight=-1*(g.rect.width-v.highlightRight+ia),m.highlightLeft=y.rect.width-(m.highlightRight+r)+ia,m.inputContainerLeft=-1*(A.getBoundingClientRect().width-r-m.highlightRight)):(m.highlightLeft=-1*(g.rect.width-v.highlightLeft+ia),m.highlightRight=y.rect.width-(m.highlightLeft+r)+ia,m.inputContainerLeft=-1*m.highlightLeft))}return n}function SW(t,e){var y,v;const a=Bo[t],s=Bo[e];if(a===void 0||s===void 0)return 0;const n=Ht[t],r=Ht[e],o=sb[e],l=Ht[((y=xa[a])==null?void 0:y.lastWordIndex)??-1],u=Ht[((v=xa[s])==null?void 0:v.firstWordIndex)??-1];if(n===void 0||r===void 0||o===void 0||l===void 0||u===void 0)return 0;if(a==s){const A=Gl([n,r]),W=r.getBoundingClientRect(),$=o.getBoundingClientRect();let se=A.width+ia;return se-=W.width-$.width,se}const c=Gl([n,l]),p=Gl([u,r]);let f=c.width+p.width;for(let A=a+1;A<s;A++)f+=xa[A].rect.width;f+=2*ia*(s-a);const m=r.getBoundingClientRect(),g=o.getBoundingClientRect();return f-=m.width-g.width,f}function TW(){p1=new Date}let h1="loading";function Xe(){return h1}function $W(t){h1=t}const Vh={suffix:"",fallback:"-",showDecimalPlaces:void 0,rounding:Math.round};class AW{constructor(e){this.config=e}typingSpeed(e,a={}){const s={...Vh,...a};if(e==null)return s.fallback??"";const n=ea(this.config.typingSpeedUnit).fromWpm(e);return this.number(n,s)}percentage(e,a={}){const s={...Vh,...a};return s.suffix="%"+(s.suffix??""),this.number(e,s)}accuracy(e,a={}){return this.percentage(e,{rounding:Math.floor,...a})}decimals(e,a={}){const s={...Vh,...a};return this.number(e,s)}number(e,a){if(e==null)return a.fallback??"";const s=a.suffix??"";return(a.showDecimalPlaces!==void 0?a.showDecimalPlaces:this.config.alwaysShowDecimalPlaces)?we(e).toFixed(2)+s:(a.rounding??Math.round)(e).toString()+s}rank(e,a={}){const s={fallback:"-",...a};if(e==null)return s.fallback??"";let n="th";const r=e%10,o=e%100;return r===1&&o!==11&&(n="st"),r===2&&o!==12&&(n="nd"),r===3&&o!==13&&(n="rd"),e+n}}const ue=new AW(d),MW=[{name:"Prime Ape",description:"Paying for a monthly subscription",icon:"fa-dollar-sign",test:t=>t.isPremium===!0},{name:"Banned",description:"This account is banned",icon:"fa-gavel",color:"var(--error-color)",test:t=>t.banned===!0},{name:"LbOptOut",description:"This account has opted out of leaderboards",icon:"fa-crown",color:"var(--error-color)",test:t=>t.lbOptOut===!0}],LW={iconsOnly:!1};function EW(t){return MW.filter(a=>a.test(t))}function IW(t,e){const a=`<i class="fas ${t.icon}"></i>`;if(e.iconsOnly)return a;const s=[];return t.background!==void 0&&s.push(`background: ${t.background};`),(t==null?void 0:t.color)!==void 0&&s.push(`color: ${t.color};`),(t==null?void 0:t.customStyle)!==void 0&&s.push(t.customStyle),`<div class="flag" ${`aria-label="${t.description}" data-balloon-pos="right"`} style="${s.join("")}">${a}</div>`}function sh(t,e){const a={...LW,...e};return EW(t).map(s=>IW(s,a)).join("")}async function OW(){return(await fv(()=>import("./html2canvas.esm.CBrSDip1.js"),__vite__mapDeps([]))).default}function PW(t,e,a){let s="";for(const n of t)for(const r of n){const o=e[r].offsetLeft,l=e[r].offsetWidth,u=`[${r}]`,c=a[r];s+=`<hint data-length=1 data-chars-index=${u} style="left: ${o+l/2}px;">${c}</hint>`}return s=`<div class="hints">${s}</div>`,s}async function RW(t,e,a){const n=(await Ii(d.language)).rightToLeft;let r=0;for(const o of t){for(let l=0;l<o.length-1;l++){const u=a[r],c=a[r+1],p=n?c:u,f=n?u:c;if(p.offsetLeft+p.offsetWidth/2>f.offsetLeft-f.offsetWidth/2){u.dataset.length=(parseInt(u.dataset.length??"1")+parseInt(c.dataset.length??"1")).toString();const m=u.dataset.charsIndex??"[]",g=c.dataset.charsIndex??"[]";u.dataset.charsIndex=m.slice(0,-1)+","+g.slice(1);const y=o[l]??0,v=e[y].offsetLeft+(n?e[y].offsetWidth:0)+(c.offsetLeft-u.offsetLeft);u.style.left=v.toString()+"px",u.insertAdjacentHTML("beforeend",c.innerHTML),c.remove(),o.splice(l+1,1),r-=l===0?1:2,l-=l===0?1:2}r++}r++}}const DW=Da(250,async()=>{const t=await pA(d.language);t==="no"&&h(`${Ao(ki(d.language))} does not support Zipf funbox, because the list is not ordered by frequency. Please try another word list.`,0,{duration:7}),t==="unknown"&&h(`${Ao(ki(d.language))} may not support Zipf funbox, because we don't know if it's ordered by frequency or not. If you would like to add this label, please contact us.`,0,{duration:7})});mt((t,e,a)=>{(t==="language"||t==="funbox")&&d.funbox.split("#").includes("zipf")&&DW(),t==="fontSize"&&!a&&(Tc(),ob(!0),rb(!0)),(t==="fontSize"||t==="fontFamily")&&WW().catch(s=>{console.error(s)}),t==="theme"&&oo(),e!==void 0&&(t==="highlightMode"&&Xe()==="test"&&ih(),["highlightMode","blindMode","indicateTypos","tapeMode"].includes(t)&&b1(),t==="tapeMode"&&!a&&(e==="off"?i("#words").css("margin-left","unset"):Fc()),typeof e=="boolean"&&(t==="flipTestColors"&&qW(e),t==="colorfulMode"&&FW(e),t==="burstHeatmap"&&oo()))});let Pt=0,It=!1,Ra=!1,$y=!1,Up=0,Cr=!1;function g1(t){It=t}function ib(t){Pt=t}let fp;function Ay(t){Ra=t,t?new Promise(e=>{fp=e}):(fp&&fp(),fp=null)}function y1(t){Cr=t}function NW(){Up=0,Pt=0}function nh(){i("#wordsInput").trigger("focus")}function ih(t,e=!1){const a=document.querySelector("#words .active");t||a==null||a.classList.add("typed"),d.mode==="zen"&&t?a==null||a.remove():a!==null&&!e&&a.classList.remove("active");const s=document.querySelectorAll("#words .word")[Pt];if(s==null)throw new Error("activeWord is undefined - can't update active element");s.classList.add("active"),s.classList.remove("error"),s.classList.remove("typed"),document.querySelector("#words .active").offsetTop,!e&&ZW()&&rb(),d.tapeMode!=="off"&&Fc()}async function WW(){var r,o,l,u;if(Xe()!=="test"||It||d.indicateTypos!=="below")return;const e=(await Ii(d.language)).rightToLeft;let a,s;const n=(r=document.getElementById("words"))==null?void 0:r.querySelectorAll("div.word > div.hints > hint");for(let c=0;c<((n==null?void 0:n.length)??0);c++){const p=n==null?void 0:n[c];(!a||((o=p.parentElement)==null?void 0:o.parentElement)!==a)&&(a=(l=p.parentElement)==null?void 0:l.parentElement,s=a==null?void 0:a.querySelectorAll("letter"));const f=(u=p.dataset.charsIndex)==null?void 0:u.slice(1,-1).split(",").map(v=>parseInt(v)),m=e?parseInt(p.dataset.length??"1")-1:0;let g=(s==null?void 0:s[(f==null?void 0:f[m])??0]).offsetLeft;const y=(f==null?void 0:f.reduce((v,A)=>v+(s==null?void 0:s[A]).offsetWidth,0))??0;g+=y/2,p.style.left=g.toString()+"px"}}function v1(t){var n;let e=!1,a="<div class='word'>";const s=Ae(d.funbox).find(r=>{var o;return(o=r.functions)==null?void 0:o.getWordHtml});for(let r=0;r<t.length;r++)(n=s==null?void 0:s.functions)!=null&&n.getWordHtml?a+=s.functions.getWordHtml(t.charAt(r),!0):t.charAt(r)==="	"?a+=`<letter class='tabChar'><i class="fas fa-long-arrow-alt-right fa-fw"></i></letter>`:t.charAt(r)===`
`?(e=!0,a+=`<letter class='nlChar'><i class="fas fa-level-down-alt fa-rotate-90 fa-fw"></i></letter>`):a+="<letter>"+t.charAt(r)+"</letter>";return a+="</div>",e&&(a+="<div class='newline'></div>"),a}function b1(){var e,a,s;d.tapeMode!=="off"?(i("#words").addClass("tape"),i("#wordsWrapper").addClass("tape")):(i("#words").removeClass("tape"),i("#wordsWrapper").removeClass("tape")),d.blindMode?(i("#words").addClass("blind"),i("#wordsWrapper").addClass("blind")):(i("#words").removeClass("blind"),i("#wordsWrapper").removeClass("blind")),d.indicateTypos==="below"?(i("#words").addClass("indicateTyposBelow"),i("#wordsWrapper").addClass("indicateTyposBelow")):(i("#words").removeClass("indicateTyposBelow"),i("#wordsWrapper").removeClass("indicateTyposBelow"));const t=((s=(a=(e=i("#words"))==null?void 0:e.attr("class"))==null?void 0:a.split(/\s+/))==null?void 0:s.filter(n=>!n.startsWith("highlight-")))??[];d.highlightMode!=null&&t.push("highlight-"+d.highlightMode.replaceAll("_","-")),i("#words").attr("class",t.join(" ")),x1(),ob(!0),setTimeout(()=>{rb(!0)},250)}function BW(){i("#words").empty();let t="";if(d.mode!=="zen")for(let e=0;e<E.length;e++)t+=v1(E.get(e));else t='<div class="word">word height</div><div class="word active"></div>';i("#words").html(t),ih(void 0,!0),setTimeout(()=>{$n()},125),b1()}const w1=["japanese","chinese","korean"];function ZW(){return w1.some(e=>d.language.startsWith(e))||d.mode!=="time"&&d.showAllLines}async function rb(t=!1){if(Xe()!=="test"||d.tapeMode!=="off"&&!t)return;const a=(await Ii(d.language)).rightToLeft,s=document.querySelector("#wordsInput"),n=document.querySelector("#words .active");if(!n){s.style.top="0px",s.style.left="0px";return}const r=window.getComputedStyle(n),o=parseInt(r.marginTop)+parseInt(r.marginBottom);if(d.tapeMode!=="off"){s.style.top=n.offsetHeight+o*.25+-s.offsetHeight+"px",s.style.left=n.offsetLeft+"px";return}a?s.style.left=n.offsetLeft-s.offsetWidth+n.offsetWidth+"px":s.style.left=n.offsetLeft+"px",t&&!w1.some(l=>d.language.startsWith(l))?s.style.top=n.offsetTop+n.offsetHeight+-s.offsetHeight+(n.offsetHeight+o)+"px":s.style.top=n.offsetTop+n.offsetHeight+-s.offsetHeight+"px"}function ob(t=!1){if(Xe()!=="test"||!t&&d.mode!=="custom")return;i("#wordsWrapper").removeClass("hidden");const e=i(document.querySelector(".word")).outerHeight(!0);if(i(document.querySelector("#words")).outerHeight(!0),d.showAllLines&&d.mode!=="time"&&St()!=="time"&&gt()!==0)i("#words").css("height","auto").css("overflow","hidden").css("width","100%").css("margin-left","unset"),i("#wordsWrapper").css("height","auto").css("overflow","hidden"),i(".outOfFocusWarning").css("margin-top",e+fr(1)/2+"px");else{let a,s;if(d.tapeMode!=="off")a=e*2,s=e;else{let n=0,r=0,o=0;const l=document.querySelectorAll("#words .word");let u=0;const c=window.getComputedStyle(l[0]),p=parseInt(c.marginTop),f=parseInt(c.marginBottom);for(;n<3;){const g=l[o];if(!g)break;const y=g.offsetTop;y>r&&(n++,u+=g.offsetHeight+p+f,r=y),o++}n<3&&(u=u*(3/n)),a=u/3*4,s=u}i("#words").css("height",a+"px").css("overflow","hidden"),d.tapeMode!=="off"?(i("#words").width("200vw"),Fc()):i("#words").css({marginLeft:"unset",width:""}),i("#wordsWrapper").css("height",s+"px").css("overflow","hidden"),i(".outOfFocusWarning").css("margin-top",s/2-fr(1)/2+"px")}d.mode==="zen"&&i(document.querySelector(".word")).remove()}function Fw(t){i("#words").append(v1(t))}function qW(t){t?i("#words").addClass("flipped"):i("#words").removeClass("flipped")}function FW(t){t?i("#words").addClass("colorfulMode"):i("#words").removeClass("colorfulMode")}let jw=!1;async function jW(){var f,m;Je();let t=!1,e=!1;(iv("#cookiesModal")||document.contains(document.querySelector("#cookiesModal")))&&(e=!0);function a(){Te(),i("#ad-result-wrapper").removeClass("hidden"),i("#ad-result-small-wrapper").removeClass("hidden"),i("#testConfig").removeClass("hidden"),i(".pageTest .screenshotSpacer").remove(),i("#notificationCenter").removeClass("hidden"),i("#commandLineMobileButton").removeClass("hidden"),i(".pageTest .ssWatermark").addClass("hidden"),i(".pageTest .ssWatermark").text("monkeytype.com"),i(".pageTest .buttons").removeClass("hidden"),i("noscript").removeClass("hidden"),i("#nocss").removeClass("hidden"),i("header, footer").removeClass("invisible"),i("#result").removeClass("noBalloons"),i(".wordInputHighlight").removeClass("hidden"),i(".highlightContainer").removeClass("hidden"),e&&i("#cookiesModal").removeClass("hidden"),t&&i("#resultReplay").removeClass("hidden"),ce()||i(".pageTest .loginTip").removeClass("hidden"),document.querySelector("html").style.scrollBehavior="smooth",Ae(d.funbox).forEach(g=>{var y,v;return(v=(y=g.functions)==null?void 0:y.applyGlobalCSS)==null?void 0:v.call(y)})}i("#resultReplay").hasClass("hidden")||(t=!0,qc());const s=new Date(Date.now());i("#resultReplay").addClass("hidden"),i(".pageTest .ssWatermark").removeClass("hidden");const n=S(),r=[nt(s,"dd MMM yyyy HH:mm"),"monkeytype.com"];if((n==null?void 0:n.name)!==void 0){const g=`${n==null?void 0:n.name}${sh(n,{iconsOnly:!0})}`;r.unshift(g)}i(".pageTest .ssWatermark").html(r.map(g=>`<span>${g}</span>`).join("<span class='pipe'>|</span>")),i(".pageTest .buttons").addClass("hidden"),i("#notificationCenter").addClass("hidden"),i("#commandLineMobileButton").addClass("hidden"),i(".pageTest .loginTip").addClass("hidden"),i("noscript").addClass("hidden"),i("#nocss").addClass("hidden"),i("#ad-result-wrapper").addClass("hidden"),i("#ad-result-small-wrapper").addClass("hidden"),i("#testConfig").addClass("hidden"),i(".page.pageTest").prepend("<div class='screenshotSpacer'></div>"),i("header, footer").addClass("invisible"),i("#result").addClass("noBalloons"),i(".wordInputHighlight").addClass("hidden"),i(".highlightContainer").addClass("hidden"),e&&i("#cookiesModal").addClass("hidden"),Ae(d.funbox).forEach(g=>{var y,v;return(v=(y=g.functions)==null?void 0:y.clearGlobal)==null?void 0:v.call(y)}),document.querySelector("html").style.scrollBehavior="auto",window.scrollTo({top:0});const o=i("#result .wrapper"),l=((f=o.offset())==null?void 0:f.left)??0,u=((m=o.offset())==null?void 0:m.top)??0,c=o.outerWidth(!0),p=o.outerHeight(!0);try{const g=fr(2),y=fr(2);(await(await OW())(document.body,{backgroundColor:await Za("bg"),width:c+g*2,height:p+y*2,x:l-g,y:u-y})).toBlob(async A=>{try{if(A===null)throw new Error("Could not create image, blob is null");const W=new ClipboardItem(Object.defineProperty({},A.type,{value:A,enumerable:!0}));await navigator.clipboard.write([W]),h("Copied to clipboard",1,{duration:2})}catch(W){console.error("Error while saving image to clipboard",W),A?(navigator.userAgent.toLowerCase().includes("firefox")&&!jw&&(jw=!0,h("On Firefox you can enable the asyncClipboard.clipboardItem permission in about:config to enable copying straight to the clipboard",0,{duration:10})),h("Could not save image to clipboard. Opening in new tab instead (make sure popups are allowed)",0,{duration:5}),open(URL.createObjectURL(A))):h(Re(W,"Error saving image to clipboard"),-1)}a()})}catch(g){h(Re(g,"Error creating image"),-1),a()}setTimeout(()=>{a()},3e3)}async function Zs(t){var l,u;const e=t??T.current,a=document.querySelector("#words .word.active"),s=E.getCurrent();if(!s&&d.mode!=="zen")return;let n="";const r=[];let o=!1;if(d.mode==="zen")for(const c of T.current)c==="	"?n+=`<letter class='tabChar correct' style="opacity: 0"><i class="fas fa-long-arrow-alt-right fa-fw"></i></letter>`:c===`
`?(o=!0,n+=`<letter class='nlChar correct' style="opacity: 0"><i class="fas fa-level-down-alt fa-rotate-90 fa-fw"></i></letter>`):n+=`<letter class="correct">${c}</letter>`;else{let c=!1;const p=T.getKoreanStatus();if(p){const m=Bt.disassemble(s).join(""),g=Bt.disassemble(e).join(""),y=Un.test(e)?e.search(Un):g.length;e.search(Un)<Bt.d(m).length&&m.slice(0,y)===g.slice(0,y)&&(c=!0)}else{const m=Un.test(e)?e.search(Un):e.length;e.search(Un)<s.length&&s.slice(0,m)===e.slice(0,m)&&(c=!0)}const f=Ae(d.funbox).find(m=>{var g;return(g=m.functions)==null?void 0:g.getWordHtml});for(let m=0;m<e.length;m++){const g=s[m]===e[m];let y=s[m],v="",A="";if((l=f==null?void 0:f.functions)!=null&&l.getWordHtml){const W=f.functions.getWordHtml(y);W!==""&&(y=W)}else y==="	"?(v="tabChar",y='<i class="fas fa-long-arrow-alt-right fa-fw"></i>'):y===`
`&&(A="nlChar",y='<i class="fas fa-level-down-alt fa-rotate-90 fa-fw"></i>');if(g)n+=`<letter class="correct ${v}${A}">${y}</letter>`;else if(y!==void 0&&or()&&m>=vW()&&!(p&&!c))n+=`<letter class="dead">${d.indicateTypos==="replace"?e[m]===" "?"_":e[m]:y}</letter>`;else if(y===void 0){if(!d.hideExtraLetters){let W=e[m];(W===" "||W==="	"||W===`
`)&&(W="_"),n+=`<letter class="incorrect extra ${v}${A}">${W}</letter>`}}else if(n+=`<letter class="incorrect ${v}${A}">`+(d.indicateTypos==="replace"?e[m]===" "?"_":e[m]:y)+"</letter>",d.indicateTypos==="below")if(!(r!=null&&r.length))r.push([m]);else{const W=r[r.length-1];(W==null?void 0:W[W.length-1])===m-1?W.push(m):r.push([m])}}for(let m=e.length;m<s.length;m++)(u=f==null?void 0:f.functions)!=null&&u.getWordHtml?n+=f.functions.getWordHtml(s[m],!0):s[m]==="	"?n+=`<letter class='tabChar'><i class="fas fa-long-arrow-alt-right fa-fw"></i></letter>`:s[m]===`
`?n+=`<letter class='nlChar'><i class="fas fa-level-down-alt fa-rotate-90 fa-fw"></i></letter>`:n+="<letter>"+s[m]+"</letter>";d.highlightMode==="letter"&&d.hideExtraLetters&&(e.length>s.length&&!d.blindMode?a.classList.add("error"):e.length===s.length&&a.classList.remove("error"))}if(a.innerHTML=n,r!=null&&r.length){const c=a.querySelectorAll("letter"),p=PW(r,c,e);a.insertAdjacentHTML("beforeend",p);const f=a.getElementsByTagName("hint");await RW(r,c,f)}o&&i("#words").append("<div class='newline'></div>"),d.tapeMode!=="off"&&Fc()}function Fc(){var o;const t=document.querySelector("#wordsWrapper").offsetWidth;let e=0;const a=[];let s=0;if(Pt>0){for(let l=0;l<Pt;l++){const u=document.querySelectorAll("#words .word")[l];e+=i(u).outerWidth(!0)??0;const c=Math.floor(u.offsetLeft),p=Math.floor(u.offsetWidth);if(c<0-p){const f=i(i("#words .word")[l]);a.push(f),s+=f.outerWidth(!0)??0}}if(a.length>0){Pt-=a.length,a.forEach(u=>u.remove()),e-=s;const l=parseInt(i("#words").css("margin-left"),10);i("#words").css("margin-left",`${l+s}px`)}}let n=0;if(d.tapeMode==="letter"&&T.current.length>0){const u=(o=document.querySelectorAll("#words .word")[Pt])==null?void 0:o.querySelectorAll("letter");if(!u)return;for(let c=0;c<T.current.length;c++){const p=u[c];d.blindMode&&p.classList.contains("extra")||(n+=i(p).outerWidth(!0)??0)}}const r=t/2-(e+n);d.smoothLineScroll?i("#words").stop(!0,!1).animate({marginLeft:r},Ct()?0:125):i("#words").css("margin-left",`${r}px`)}function HW(){const t=Zm(d,ze);let e="";d.funbox!=="none"&&(e=" "+d.funbox.split("#").join(" ")),i(".pageTest #premidTestMode").text(`${d.mode} ${t} ${ki(d.language)}${e}`),i(".pageTest #premidSecondsLeft").text(d.time)}let Uh=0;function lb(t){var e;if(d.tapeMode==="off"&&Up>0||d.tapeMode!=="off"&&Up>=0){const a=t,s=[],n=i("#words .word");for(let o=0;o<Pt;o++){const l=i(n[o]);if(l.hasClass("hidden"))continue;Math.floor(l[0].offsetTop)<(d.tapeMode==="off"?a-10:a+10)&&s.push(i(i("#words .word")[o]))}const r=i(document.querySelector(".word")).outerHeight(!0);if(d.smoothLineScroll&&s.length>0){$y=!0;const o=i("#words .smoothScroller");o.length===0?i("#words").prepend(`<div class="smoothScroller" style="position: fixed;height:${r}px;width:100%"></div>`):o.css("height",`${(o.outerHeight(!0)??0)+r}px`),i("#words .smoothScroller").stop(!0,!1).animate({height:0},Ct()?0:125,()=>{i("#words .smoothScroller").remove()}),i("#paceCaret").stop(!0,!1).animate({top:((e=document.querySelector("#paceCaret"))==null?void 0:e.offsetTop)-r},Ct()?0:125);const l={marginTop:`-${r*(Uh+1)}px`};if(d.tapeMode!=="off"){const c=document.querySelector("#wordsWrapper").offsetWidth/2;l.marginLeft=`${c}px`}Uh++,i("#words").stop(!0,!1).animate(l,Ct()?0:125,()=>{Uh=0,document.querySelector("#words .active").offsetTop,Pt-=s.length,$y=!1,s.forEach(u=>u.remove()),i("#words").css("marginTop","0")})}else s.forEach(o=>o.remove()),Pt-=s.length,i("#paceCaret").css({top:document.querySelector("#paceCaret").offsetTop-r})}Up++,ob()}function zW(t){t?(i("#words").addClass("rightToLeftTest"),i("#resultWordsHistory .words").addClass("rightToLeftTest"),i("#resultReplay .words").addClass("rightToLeftTest")):(i("#words").removeClass("rightToLeftTest"),i("#resultWordsHistory .words").removeClass("rightToLeftTest"),i("#resultReplay .words").removeClass("rightToLeftTest"))}function KW(t){t?(i("#words").addClass("withLigatures"),i("#resultWordsHistory .words").addClass("withLigatures"),i("#resultReplay .words").addClass("withLigatures")):(i("#words").removeClass("withLigatures"),i("#resultWordsHistory .words").removeClass("withLigatures"),i("#resultReplay .words").removeClass("withLigatures"))}async function VW(){i("#resultWordsHistory .words").empty();let t="";for(let e=0;e<T.history.length+2;e++){const a=T.getHistory(e),s=Dt.getHistory(e),n=E.get(e),r=(a==null?void 0:a.match(/[\uac00-\ud7af]|[\u1100-\u11ff]|[\u3130-\u318f]|[\ua960-\ua97f]|[\ud7b0-\ud7ff]/g))!==null||(n==null?void 0:n.match(/[\uac00-\ud7af]|[\u1100-\u11ff]|[\u3130-\u318f]|[\ua960-\ua97f]|[\ud7b0-\ud7ff]/g))!==null;let o="";try{if(a===void 0||a==="")throw new Error("empty input word");if(s!==void 0&&s!==""){const u=r?Bt.assemble(s.split("")):s;o=`<div class='word nocursor' burst="${Fa[e]}" input="${u.replace(/"/g,"&quot;").replace(/ /g,"_")}">`}else o=`<div class='word nocursor' burst="${Fa[e]}" input="${a.replace(/"/g,"&quot;").replace(/ /g,"_")}">`;if(e===T.history.length-1){const u={correct:0,incorrect:0,missed:0},c=d.mode==="zen"?a.length:n.length;for(let p=0;p<c;p++)p<a.length?d.mode==="zen"||a[p]===n[p]?u.correct++:u.incorrect++:u.missed++;(u.incorrect!==0||d.mode!=="time")&&d.mode!=="zen"&&a!==n&&(o=`<div class='word nocursor error' burst="${Fa[e]}" input="${a.replace(/"/g,"&quot;").replace(/ /g,"_")}">`)}else d.mode!=="zen"&&a!==n&&(o=`<div class='word nocursor error' burst="${Fa[e]}" input="${a.replace(/"/g,"&quot;").replace(/ /g,"_")}">`);let l;if(d.mode==="zen"||a.length>n.length?l=a.length:l=n.length,s===void 0)throw new Error("empty corrected word");for(let u=0;u<l;u++){let c;try{c=r?Bt.assemble(s.split(""))[u]:s[u]}catch{c=void 0}let p="";const f=r?Bt.assemble(s.split("")):s;u+1===l&&f!==void 0&&f.length>a.length&&(p="extraCorrected"),d.mode==="zen"||n[u]!==void 0?d.mode==="zen"||a[u]===n[u]?c===a[u]||c===void 0?o+=`<letter class="correct ${p}">${a[u]}</letter>`:o+=`<letter class="corrected ${p}">`+a[u]+"</letter>":a[u]===T.current?o+=`<letter class='correct ${p}'>`+n[u]+"</letter>":a[u]===void 0?o+="<letter>"+n[u]+"</letter>":o+=`<letter class="incorrect ${p}">`+n[u]+"</letter>":o+='<letter class="incorrect extra">'+a[u]+"</letter>"}o+="</div>"}catch{try{o="<div class='word'>";for(const u of n)o+="<letter>"+u+"</letter>";o+="</div>"}catch{}}t+=o}return i("#resultWordsHistory .words").html(t),i("#showWordHistoryButton").addClass("loaded"),!0}function k1(t=!1){It&&(TW(),i("#resultWordsHistory").stop(!0,!0).hasClass("hidden")?i("#resultWordsHistory .words .word").length===0?(i("#words").html('<div class="preloader"><i class="fas fa-fw fa-spin fa-circle-notch"></i></div>'),VW().then(()=>{d.burstHeatmap&&oo(),i("#resultWordsHistory").removeClass("hidden").css("display","none").slideDown(t?0:250,()=>{d.burstHeatmap&&oo()})})):(d.burstHeatmap&&oo(),i("#resultWordsHistory").removeClass("hidden").css("display","none").slideDown(t?0:250)):i("#resultWordsHistory").slideUp(250,()=>{i("#resultWordsHistory").addClass("hidden")}))}async function oo(){if(d.burstHeatmap){i("#resultWordsHistory .heatmapLegend").removeClass("hidden");let t=[...Fa];t=t.filter(u=>u!==1/0),t=t.filter(u=>u<350);const e=ea(d.typingSpeedUnit);t.forEach((u,c)=>{t[c]=Math.round(e.fromWpm(u))});const a=await Oi();let s=[a.colorfulError,gs(a.colorfulError,a.text,.5),a.text,gs(a.main,a.text,.5),a.main],n=a.sub;a.main===a.text&&(s=[a.colorfulError,gs(a.colorfulError,a.text,.5),a.sub,gs(a.sub,a.text,.5),a.main],n=a.subAlt);const r=t.sort((u,c)=>u-c),o=t.length,l=[{val:0,colorId:0},{val:r[o*.15|0],colorId:1},{val:r[o*.35|0],colorId:2},{val:r[o*.65|0],colorId:3},{val:r[o*.85|0],colorId:4}];l.forEach((u,c)=>{const p=l[c+1];let f="";c===0&&p?f=`<${Math.round(p.val)}`:c===4?f=`${Math.round(u.val)}+`:p&&(u.val!=p.val?f=`${Math.round(u.val)}-${Math.round(p.val)-1}`:f=`${Math.round(u.val)}-${Math.round(u.val)}`),i("#resultWordsHistory .heatmapLegend .box"+c).html(`<div>${f}</div>`)}),i("#resultWordsHistory .words .word").each((u,c)=>{const p=i(c).attr("burst");if(p===void 0)i(c).css("color",n);else{let f=parseInt(p);f=Math.round(ea(d.typingSpeedUnit).fromWpm(f)),l.forEach(m=>{f>=m.val&&(i(c).addClass("heatmapInherit"),i(c).css("color",s[m.colorId]))})}}),i("#resultWordsHistory .heatmapLegend .boxes .box").each((u,c)=>{i(c).css("background",s[u])})}else i("#resultWordsHistory .heatmapLegend").addClass("hidden"),i("#resultWordsHistory .words .word").removeClass("heatmapInherit"),i("#resultWordsHistory .words .word").css("color",""),i("#resultWordsHistory .heatmapLegend .boxes .box").css("color","")}function UW(t){i(i("#words .word")[t]).addClass("error")}function GW(t){i(i("#words .word")[t]).find("letter").addClass("correct")}function x1(){let t={};d.tapeMode==="off"?d.maxLineWidth===0?t={"max-width":"100%"}:t={"max-width":d.maxLineWidth+"ch"}:d.maxLineWidth===0?t={"max-width":"100%"}:t={"max-width":"100%"};const e=i("#typingTest");e.css(t),d.maxLineWidth===0?e.removeClass("full-width-padding").addClass("content"):e.removeClass("content").addClass("full-width-padding")}function QW(t){i("#barTimerProgress").css("opacity",parseFloat(t)),i("#liveStatsTextTop").css("opacity",parseFloat(t)),i("#liveStatsTextBottom").css("opacity",parseFloat(t)),i("#liveStatsMini").css("opacity",parseFloat(t))}function YW(t){i("#barTimerProgress").removeClass("timerSub"),i("#barTimerProgress").removeClass("timerText"),i("#barTimerProgress").removeClass("timerMain"),i("#liveStatsTextTop").removeClass("timerSub"),i("#liveStatsTextTop").removeClass("timerText"),i("#liveStatsTextTop").removeClass("timerMain"),i("#liveStatsTextBottom").removeClass("timerSub"),i("#liveStatsTextBottom").removeClass("timerText"),i("#liveStatsTextBottom").removeClass("timerMain"),i("#liveStatsMini").removeClass("timerSub"),i("#liveStatsMini").removeClass("timerText"),i("#liveStatsMini").removeClass("timerMain"),t==="main"?(i("#barTimerProgress").addClass("timerMain"),i("#liveStatsTextTop").addClass("timerMain"),i("#liveStatsTextBottom").addClass("timerMain"),i("#liveStatsMini").addClass("timerMain")):t==="sub"?(i("#barTimerProgress").addClass("timerSub"),i("#liveStatsTextTop").addClass("timerSub"),i("#liveStatsTextBottom").addClass("timerSub"),i("#liveStatsMini").addClass("timerSub")):t==="text"&&(i("#barTimerProgress").addClass("timerText"),i("#liveStatsTextTop").addClass("timerText"),i("#liveStatsTextBottom").addClass("timerText"),i("#liveStatsMini").addClass("timerText"))}i(".pageTest").on("click","#saveScreenshotButton",()=>{jW()});i(".pageTest #copyWordsListButton").on("click",async()=>{let t;d.mode==="zen"?t=T.history.join(" "):t=E.get().slice(0,T.history.length).join(" "),await _1(t)});i(".pageTest #copyMissedWordsListButton").on("click",async()=>{let t;d.mode==="zen"?t=T.history.join(" "):t=Object.keys(gn??{}).join(" "),await _1(t)});async function _1(t){try{await navigator.clipboard.writeText(t),h("Copied to clipboard",0,{duration:2})}catch(e){h("Could not copy to clipboard: "+e,-1)}}i(".pageTest #toggleBurstHeatmap").on("click",async()=>{IS(!d.burstHeatmap),nb()});i(".pageTest #resultWordsHistory").on("mouseleave",".words .word",()=>{i(".wordInputHighlight").remove()});i(".pageTest #result #wpmChart").on("mouseleave",()=>{m1(!1),xW()});i(".pageTest #result #wpmChart").on("mouseenter",()=>{m1(!0)});i(".pageTest #resultWordsHistory").on("mouseenter",".words .word",t=>{if(It){const e=i(t.currentTarget).attr("input"),a=parseInt(i(t.currentTarget).attr("burst"));e!==void 0&&i(t.currentTarget).append(`<div class="wordInputHighlight withSpeed">
          <div class="text">
          ${e.replace(/\t/g,"_").replace(/\n/g,"_").replace(/</g,"&lt").replace(/>/g,"&gt")}
          </div>
          <div class="speed">
          ${ue.typingSpeed(a,{showDecimalPlaces:!1})}
          ${d.typingSpeedUnit}
          </div>
          </div>`)}});addEventListener("resize",()=>{nb()});i("#wordsInput").on("focus",t=>{t.target===document.activeElement&&(!It&&d.showOutOfFocusWarning&&Tc(),YS(!0))});i("#wordsInput").on("focusout",()=>{!It&&d.showOutOfFocusWarning&&iR(),Bc()});i(".pageTest").on("click","#showWordHistoryButton",()=>{k1()});i("#wordsWrapper").on("click",()=>{nh()});i(document).on("keypress",()=>{It&&zx()});mt((t,e)=>{t==="quickRestart"&&(e==="off"?i(".pageTest #restartTestButton").removeClass("hidden"):i(".pageTest #restartTestButton").addClass("hidden")),t==="maxLineWidth"&&x1(),t==="timerOpacity"&&QW(e),t==="timerColor"&&YW(e)});let C1="",S1=!1;function db(){return C1}function Mn(){return S1}function Mi(t,e){C1=t,S1=e}let ub=!1,Sr,el,My,Ly,pm,fm,Tr=!1,T1;function JW(t){T1=t}function XW(){const t={lastResult:T1,start:Sr,end:el,afkHistory:Nc,errorHistory:Dc,wpmHistory:yn,rawHistory:Vm,burstHistory:Fa,keypressCountHistory:kr,currentBurstStart:Km,lastSecondNotRound:Tr,missedWords:gn,accuracy:Ya,keypressTimings:st,keyOverlap:dn,wordsHistory:E.list.slice(0,T.history.length),inputHistory:T.history};try{t.keypressTimings.spacing.average=st.spacing.array.reduce((e,a)=>a+=e)/st.spacing.array.length,t.keypressTimings.spacing.sd=Ql(st.spacing.array)}catch{}try{t.keypressTimings.duration.average=st.duration.array.reduce((e,a)=>a+=e)/st.duration.array.length,t.keypressTimings.duration.sd=Ql(st.duration.array)}catch{}return t}function eB(){Sr=0,el=0,ub=!1,Tr=!1}let cb=0,mm=0,pb=[];function $1(){cb++}function fb(t){mm+=t}function mb(t,e){pb.push({acc:t,seconds:e})}function A1(){cb=0,mm=0,pb=[]}function mp(){ub=!0}function jc(t){return t===void 0?(el-Sr)/1e3:(t-Sr)/1e3}function hb(t){const e=jc($t?performance.now():el),a=L1(),s=we((a.correctWordChars+a.correctSpaces)*(60/e)/5),n=we((a.allCorrectChars+a.spaces+a.incorrectChars+a.extraChars)*(60/e)/5);return{wpm:t?s:Math.round(s),raw:t?n:Math.round(n)}}function Hw(t){el=t,Ly=Date.now(),fm=new Date().getTime()}function tB(t){Sr=t,My=Date.now(),pm=new Date().getTime()}function gb(t){let e=0;return t!==void 0&&(d.mode==="time"?e=Math.round(t)-kr.length:e=Math.ceil(t)-kr.length,e<0&&(e=0)),Nc.filter(s=>s).length+e}function aB(){Tr=!0}function M1(){var n,r;const t=T.getKoreanStatus(),e=(performance.now()-Km)/1e3;let a;if(a=t?sf.disassemble(T.current).length:T.current.length,a===0&&(a=t?((r=sf.disassemble(T.getHistoryLast()))==null?void 0:r.length)??0:((n=T.getHistoryLast())==null?void 0:n.length)??0),a===0)return 0;const s=we(a*(60/e)/5);return Math.round(s)}function Hc(){const t=Ya.correct/(Ya.correct+Ya.incorrect)*100;return isNaN(t)?100:t}function sB(){const t=jc();kr.splice(t),yn.splice(t),Fa.splice(t),Vm.splice(t)}function nB(){const t=T.getKoreanStatus();let e=[...T.history];return $t&&e.push(T.current),t&&(e=e.map(a=>sf.disassemble(a).join(""))),e}function iB(){const t=T.getKoreanStatus();let e=[...d.mode==="zen"?T.history:E.list];return $t&&e.push(d.mode==="zen"?T.current:E.getCurrent()),t&&(e=e.map(a=>sf.disassemble(a).join(""))),e}function L1(){let t=0,e=0,a=0,s=0,n=0,r=0,o=0;const l=nB(),u=iB();for(let c=0;c<l.length;c++){const p=l[c],f=u[c];if(p===f)t+=f.length,e+=f.length,c<l.length-1&&Ux(p)!==`
`&&o++;else if(p.length>=f.length)for(let m=0;m<p.length;m++)m<f.length?p[m]===f[m]?e++:a++:s++;else{const m={correct:0,incorrect:0,missed:0};for(let g=0;g<f.length;g++)g<p.length?p[g]===f[g]?m.correct++:m.incorrect++:m.missed++;e+=m.correct,a+=m.incorrect,c===l.length-1&&d.mode==="time"?m.incorrect===0&&(t+=m.correct):n+=m.missed}c<l.length-1&&r++}return Ae(d.funbox).find(c=>{var p;return(p=c.properties)==null?void 0:p.includes("nospace")})&&(r=0,o=0),{spaces:r,correctWordChars:t,allCorrectChars:e,incorrectChars:d.mode==="zen"?Ya.incorrect:a,extraChars:s,missedChars:n,correctSpaces:o}}function rB(){console.debug("Calculating result stats");let t=jc();console.debug("Test seconds",t," (date based) ",(Ly-My)/1e3," (performance.now based)",(fm-pm)/1e3," (new Date based)"),console.debug("Test seconds",Ip(t)," (date based) ",Ip((Ly-My)/1e3)," (performance.now based)",Ip((fm-pm)/1e3)," (new Date based)"),d.mode!=="custom"&&(t=we(t),console.debug("Mode is not custom - rounding to 2. New time: ",t));const e=L1(),{wpm:a,raw:s}=hb(!0),n=we(Hc()),r={wpm:isNaN(a)?0:a,wpmRaw:isNaN(s)?0:s,acc:n,correctChars:e.correctWordChars,incorrectChars:e.incorrectChars,missedChars:e.missedChars,extraChars:e.extraChars,allChars:e.allCorrectChars+e.spaces+e.incorrectChars+e.extraChars,time:we(t),spaces:e.spaces,correctSpaces:e.correctSpaces};return console.debug("Result stats",r),r}const ct={mode:null,punctuation:null,numbers:null,customText:null};function oB(t,e){if(d.mode==="zen")return!1;let a;t==="words"&&!e||t==="off"&&e?a=20:a=10;let s=[];t==="words"&&(Object.keys(gn).forEach(f=>{const m=gn[f];m!==void 0&&s.push([f,m])}),s.sort((f,m)=>m[1]-f[1]),s=s.slice(0,a));let n=[];if(t==="biwords"){for(let f=0;f<E.length;f++){const m=E.get(f),g=gn[m];g!==void 0&&(f===0?n.push([m,"",g]):n.push([m,E.get(f-1),g]))}n.sort((f,m)=>m[2]-f[2]),n=n.slice(0,a)}if((t==="words"&&s.length===0||t==="biwords"&&n.length===0)&&!e)return h("You haven't missed any words",0),!1;let r=[];if(e&&(r=E.get().map((f,m)=>[f,Fa[m]??0]),r.sort((f,m)=>f[1]-m[1]),r=r.slice(0,Math.min(a,Math.round(E.length*.2))),r.length===0&&h("Test too short to classify slow words.",0)),s.length===0&&n.length===0&&r.length===0)return h("Could not start a new custom test",0),!1;const o=[];s.forEach(f=>{for(let m=0;m<f[1];m++)o.push(f[0])}),n.forEach(f=>{for(let m=0;m<f[2];m++)f[1]!==""?o.push(f[1]+" "+f[0]):o.push(f[0])}),r.forEach((f,m)=>{for(let g=0;g<r.length-m;g++)o.push(f[0])});const l=ct.mode===null?d.mode:ct.mode,u=ct.punctuation===null?d.punctuation:ct.punctuation,c=ct.numbers===null?d.numbers:ct.numbers;let p=null;return d.mode==="custom"&&(p=Er()),zt("custom",!0),Wo(!0),Tn(o),ci("section"),Uu("shuffle"),ir((r.length+s.length+n.length)*5),Mi("practise",void 0),ct.mode=l,ct.punctuation=u,ct.numbers=c,ct.customText=p,!0}function E1(){ct.mode=null,ct.punctuation=null,ct.numbers=null,ct.customText=null}mt(t=>{t==="mode"&&E1()});const Qu=document.querySelector("#liveStatsTextBottom .liveSpeed"),Yu=document.querySelector("#liveStatsMini .speed");function lB(){Qu.innerHTML="0",Yu.innerHTML="0"}function dB(t,e){let a=t;d.blindMode&&(a=e);const s=ue.typingSpeed(a,{showDecimalPlaces:!1});Qu.innerHTML=s,Yu.innerHTML=s}let hm=!1;function yb(){d.liveSpeedStyle!=="off"&&$t&&(hm||(d.liveSpeedStyle==="mini"?i(Yu).stop(!0,!1).removeClass("hidden").css("opacity",0).animate({opacity:1},125):i(Qu).stop(!0,!1).removeClass("hidden").css("opacity",0).animate({opacity:1},125),hm=!0))}function rh(){hm&&(i(Qu).stop(!0,!1).animate({opacity:0},125,()=>{Qu.classList.add("hidden")}),i(Yu).stop(!0,!1).animate({opacity:0},125,()=>{Yu.classList.add("hidden")}),hm=!1)}mt((t,e)=>{t==="liveSpeedStyle"&&(e==="off"?rh():yb())});const Ju=document.querySelector("#liveStatsTextBottom .liveBurst"),Xu=document.querySelector("#liveStatsMini .burst");function uB(){Ju.innerHTML="0",Xu.innerHTML="0"}async function cB(t){const e=ue.typingSpeed(t,{showDecimalPlaces:!1});Xu.innerHTML=e,Ju.innerHTML=e}let gm=!1;function vb(){d.liveBurstStyle!=="off"&&$t&&(gm||(d.liveBurstStyle==="mini"?i(Xu).stop(!0,!1).removeClass("hidden").css("opacity",0).animate({opacity:1},125):i(Ju).stop(!0,!1).removeClass("hidden").css("opacity",0).animate({opacity:1},125),gm=!0))}function oh(){gm&&(i(Ju).stop(!0,!1).animate({opacity:0},125,()=>{i(Ju).addClass("hidden")}),i(Xu).stop(!0,!1).animate({opacity:0},125,()=>{i(Xu).addClass("hidden")}),gm=!1)}mt((t,e)=>{t==="liveBurstStyle"&&(e==="off"?oh():vb())});const ec=document.querySelector("#liveStatsTextBottom .liveAcc"),tc=document.querySelector("#liveStatsMini .acc");function pB(t){let e=Math.floor(t);d.blindMode&&(e=100),tc.innerHTML=e+"%",ec.innerHTML=e+"%"}function fB(){tc.innerHTML="100%",ec.innerHTML="100%"}let ym=!1;function bb(){d.liveAccStyle!=="off"&&$t&&(ym||(d.liveAccStyle==="mini"?i(tc).stop(!0,!1).removeClass("hidden").css("opacity",0).animate({opacity:1},125):i(ec).stop(!0,!1).removeClass("hidden").css("opacity",0).animate({opacity:1},125),ym=!0))}function lh(){ym&&(i(ec).stop(!0,!1).animate({opacity:0},125,()=>{i(ec).addClass("hidden")}),i(tc).stop(!0,!1).animate({opacity:0},125,()=>{i(tc).addClass("hidden")}),ym=!1)}mt((t,e)=>{t==="liveAccStyle"&&(e==="off"?lh():bb())});function hp(t=0){const e=t*wb,a=Date.now();return ac(a,e)}const wb=36e5,I1=864e5;function ac(t,e=0){return t-(t-e)%I1}function mB(t,e=0){const a=e*wb,s=ac(Date.now()-I1,a),n=ac(t,a);return s===n}function hB(t,e=0){const a=e*wb,s=ac(Date.now(),a),n=ac(t,a);return s===n}function Ta(t,e=!1,a=!1,s=":",n=!0,r=!1){t=Math.abs(t);let o=0,l;r?(o=Math.floor(t/86400),l=Math.floor(t%86400/3600)):l=Math.floor(t/3600);const u=Math.floor(t%3600/60),c=we(t%3600%60);let p,f,m,g;r&&(o<10&&s!=="text"?p="0"+o:p=o),l<10&&s!=="text"?f="0"+l:f=l,u<10&&s!=="text"?m="0"+u:m=u,c<10&&(u>0||l>0||e)&&s!=="text"?g="0"+c:g=c;let y="";return o>0&&r&&(y+=p,s==="text"?o===1?y+=" day ":y+=" days ":y+=s),(l>0||a)&&(y+=f,s==="text"?l===1?y+=" hour ":y+=" hours ":y+=s),(u>0||l>0||e)&&(y+=m,s==="text"?u===1?y+=" minute ":y+=" minutes ":n&&(y+=s)),n&&(y+=g,s==="text"&&(c===1?y+=" second":y+=" seconds")),l===0&&u===0&&!n&&s==="text"&&(y="less than 1 minute"),y.trim()}let kb=0;function sc(){return kb}function gB(t){kb=t}function yB(){kb++}const Ey=i("#barTimerProgress .bar"),O1=i("#barTimerProgress .opacityWrapper"),dh=i("#liveStatsTextTop .timerProgress"),nc=i("#liveStatsMini .time");function xb(){d.mode!=="zen"&&d.timerStyle==="bar"?O1.stop(!0,!0).removeClass("hidden").css("opacity",0).animate({opacity:1},125):d.timerStyle==="text"?dh.stop(!0,!0).removeClass("hidden").css("opacity",0).animate({opacity:1},125):(d.mode==="zen"||d.timerStyle==="mini")&&nc.stop(!0,!0).removeClass("hidden").css("opacity",0).animate({opacity:1},125)}function vB(){let t="0vw";(d.mode==="time"||d.mode==="custom"&&St()==="time")&&(t="100vw"),Ey.stop(!0,!0).animate({width:t},0),nc.text("0"),dh.text("0")}function uh(){O1.stop(!0,!0).animate({opacity:0},125),nc.stop(!0,!0).animate({opacity:0},125,()=>{nc.addClass("hidden")}),dh.stop(!0,!0).animate({opacity:0},125)}const Zn=dh[0],qn=nc[0];function zw(){return d.mode==="custom"&&St()==="section"?E.sectionIndexList[E.currentIndex]-1:T.history.length}function zc(){const t=sc();if(d.mode==="time"||d.mode==="custom"&&St()==="time"){let e=d.time;if(d.mode==="custom"&&St()==="time"&&(e=gt()),d.timerStyle==="bar"){const a=100-(t+1)/e*100;Ey.stop(!0,!0).animate({width:a+"vw"},Ct()?0:1e3,"linear")}else if(d.timerStyle==="text"){let a=Ta(e-t);e===0&&(a=Ta(t)),Zn!==null&&(Zn.innerHTML="<div>"+a+"</div>")}else if(d.timerStyle==="mini"){let a=Ta(e-t);e===0&&(a=Ta(t)),qn!==null&&(qn.innerHTML=a)}}else if(d.mode==="words"||d.mode==="custom"||d.mode==="quote"){let e=E.length;if(d.mode==="words"&&(e=d.words),d.mode==="custom"&&(e=gt()),d.mode==="quote"&&(e=(ze==null?void 0:ze.textSplit.length)??1),d.timerStyle==="bar"){const a=Math.floor((E.currentIndex+1)/e*100);Ey.stop(!0,!0).animate({width:a+"vw"},Ct()?0:250)}else d.timerStyle==="text"?e===0?Zn!==null&&(Zn.innerHTML=`<div>${T.history.length}</div>`):Zn!==null&&(Zn.innerHTML=`<div>${zw()}/${e}</div>`):d.timerStyle==="mini"&&(e===0?qn!==null&&(qn.innerHTML=`${T.history.length}`):qn!==null&&(qn.innerHTML=`${zw()}/${e}`))}else d.mode==="zen"&&(d.timerStyle==="text"?Zn!==null&&(Zn.innerHTML=`<div>${T.history.length}</div>`):qn!==null&&(qn.innerHTML=`${T.history.length}`))}function bB(){$t&&(uh(),zc(),d.timerStyle!=="off"&&setTimeout(()=>{xb()},125))}mt((t,e)=>{t==="timerStyle"&&bB()});const Kw=3;let eo=!1;function Di(t,e=!1){t&&!eo?(eo=!0,GS(),i("header").addClass("focus"),i("footer").addClass("focus"),e||i("body").css("cursor","none"),i("main").addClass("focus"),i("#bannerCenter").addClass("focus"),i("#notificationCenter").addClass("focus"),i("#capsWarning").addClass("focus"),i("#ad-vertical-right-wrapper").addClass("focus"),i("#ad-vertical-left-wrapper").addClass("focus"),i("#ad-footer-wrapper").addClass("focus"),i("#ad-footer-small-wrapper").addClass("focus"),yb(),vb(),bb(),xb()):!t&&eo&&(eo=!1,QS(),i("header").removeClass("focus"),i("footer").removeClass("focus"),i("body").css("cursor","default"),i("main").removeClass("focus"),i("#bannerCenter").removeClass("focus"),i("#notificationCenter").removeClass("focus"),i("#capsWarning").removeClass("focus"),i("#app").removeClass("focus"),i("#ad-vertical-right-wrapper").removeClass("focus"),i("#ad-vertical-left-wrapper").removeClass("focus"),i("#ad-footer-wrapper").removeClass("focus"),i("#ad-footer-small-wrapper").removeClass("focus"),rh(),oh(),lh(),uh())}i(document).on("mousemove",function(t){eo&&Xe()!=="loading"&&(Xe()==="account"&&eo||t.originalEvent&&(t.originalEvent.movementX>Kw||t.originalEvent.movementY>Kw)&&Di(!1))});function wB(){return Math.floor(Math.random()*256).toString(2).padStart(8,"0")}function kB(t){const e={a:".-",b:"-...",c:"-.-.",d:"-..",e:".",f:"..-.",g:"--.",h:"....",i:"..",j:".---",k:"-.-",l:".-..",m:"--",n:"-.",o:"---",p:".--.",q:"--.-",r:".-.",s:"...",t:"-",u:"..-",v:"...-",w:".--",x:"-..-",y:"-.--",z:"--..",0:"-----",1:".----",2:"..---",3:"...--",4:"....-",5:".....",6:"-....",7:"--...",8:"---..",9:"----.",".":".-.-.-",",":"--..--","?":"..--..","'":".----.","/":"-..-.","(":"-.--.",")":"-.--.-","&":".-...",":":"---...",";":"-.-.-.","=":"-...-","+":".-.-.","-":"-....-",_:"..--.-",'"':".-..-.",$:"...-..-","!":"-.-.--","@":".--.-."};let a="";const s=mR(t);for(let n=0;n<s.length;n++){const r=e[s.toLowerCase()[n]];a+=r!==void 0?r+"/":""}return a}function xB(){const t=ua(1,7);let e="";for(let a=0;a<t;a++)e+=String.fromCharCode(97+ua(0,25));return e}function _B(){const t=ua(1,10);let e="";for(let a=0;a<t;a++){const s=33+ua(0,93);e+=String.fromCharCode(s)}return e}function CB(){const t=ua(1,7);let e="";const a=["`","~","!","@","#","$","%","^","&","*","(",")","-","_","=","+","{","}","[","]","'",'"',"/","\\","|","?",";",":",">","<"];for(let s=0;s<t;s++)e+=Hs(a);return e}function P1(t){const e=ua(1,t);let a="";for(let s=0;s<e;s++){let n;s===0?n=ua(1,9):n=ua(0,9),a+=n.toString()}return a}let Vn=null,Gp=null;function SB(){i("#typingTest #memoryTimer").stop(!0,!0).animate({opacity:1},125)}function R1(){i("#typingTest #memoryTimer").stop(!0,!0).animate({opacity:0},125)}function Zo(){Gp!==null&&(clearInterval(Gp),Gp=null),Vn=null,R1()}function TB(){Zo(),Vn=Math.round(Math.pow(E.length,1.2)),Vw(Vn),SB(),Gp=setInterval(()=>{Vn!==null&&(Vn-=1,Vn===0?R1():Vw(Vn),Vn<=0&&(Zo(),i("#wordsWrapper").addClass("hidden")))},1e3)}function Vw(t){i("#typingTest #memoryTimer").text(`Timer left to memorise all words: ${t}s`)}let lo={};function ta(t,e,a){lo[t]??(lo[t]={value:e,setFunction:a})}function D1(){Object.keys(lo).forEach(t=>{const e=lo[t];e.setFunction(e.value,!0)}),lo={}}const N1=[];function $B(t){N1.push(t)}async function AB(t){N1.forEach(e=>{try{e(t)}catch(a){console.error("TTS event subscriber threw an error"),console.error(a)}})}const _b=[];function MB(t){_b.push(t)}async function W1(t,e){_b.forEach(a=>{try{a("flash",t,e)}catch(s){console.error("Keymap flash event subscriber threw an error"),console.error(s)}})}async function ai(t){_b.forEach(e=>{try{e("highlight",t)}catch(a){console.error("Keymap highlight event subscriber threw an error"),console.error(a)}})}const LB=50,EB=20,IB=5e3,Xl={};class OB{constructor(){this.average=0,this.count=0}update(e){this.count<LB&&this.count++;const a=1/this.count;this.average=e*a+this.average*(1-a)}}function PB(t,e){var n;const a=st.spacing.array;if(a.length===0||typeof a=="string")return;let s=a[a.length-1];e||(s+=IB),t in Xl||(Xl[t]=new OB),(n=Xl[t])==null||n.update(s)}function RB(t){let e=0,a=0;for(const s of t)s in Xl&&(e+=Xl[s].average,a++);return a===0?0:e/a}function DB(t){let e,a="";for(let s=0;s<EB;s++){const n=t.randomWord("normal"),r=RB(n);(s===0||e===void 0||r>e)&&(a=n,e=r)}return a}const NB=["","_"," "],WB=100,BB="https://poetrydb.org/random";class ZB extends Y0{constructor(e,a,s){super(e,a,s),this.title=e,this.author=a,this.words=s,this.cleanUpText()}cleanUpText(){let e=0;const a=[];for(const s of this.words){let n="";for(const r of s)NB.includes(r)||(n+=r);if(n!==""&&(a.push(n),e++,e===WB))break}this.words=a}}async function qB(){console.log("Getting poem");try{const e=(await ik.get(BB)).data[0],a=[];return e.lines.forEach(s=>{s.split(/ +/).forEach(n=>{a.push(n)})}),new ZB(e.title,e.author,a)}catch(t){return console.log(t),!1}}async function FB(t){switch(t.name){case"english":return"en";case"spanish":return"es";case"french":return"fr";case"german":return"de";case"portuguese":return"pt";case"arabic":return"ar";case"italian":return"it";case"latin":return"la";case"afrikaans":return"af";case"korean":return"ko";case"russian":return"ru";case"polish":return"pl";case"czech":return"cs";case"slovak":return"sk";case"ukrainian":return"uk";case"lithuanian":return"lt";case"indonesian":return"id";case"greek":return"el";case"turkish":return"tr";case"thai":return"th";case"tamil":return"ta";case"slovenian":return"sl";case"croatian":return"hr";case"dutch":return"nl";case"danish":return"da";case"hungarian":return"hu";case"norwegian_bokmal":return"no";case"norwegian_nynorsk":return"nn";case"hebrew":return"he";case"malay":return"ms";case"romanian":return"ro";case"finnish":return"fi";case"estonian":return"et";case"welsh":return"cy";case"persian":return"fa";case"kazakh":return"kk";case"vietnamese":return"vi";case"swedish":return"sv";case"serbian":return"sr";case"georgian":return"ka";case"catalan":return"ca";case"bulgarian":return"bg";case"esperanto":return"eo";case"bangla":return"bn";case"urdu":return"ur";case"armenian":return"hy";case"myanmar":return"my";case"hindi":return"hi";case"macedonian":return"mk";case"uzbek":return"uz";case"belarusian":return"be";case"azerbaijani":return"az";case"latvian":return"lv";case"euskera":return"eu";default:return"en"}}async function jB(t){Je();let e="en",a;try{a=await fA(t)}catch(l){console.error(Re(l,"Failed to find current language group"))}a!==void 0&&(e=await FB(a));const s=`https://${e}.wikipedia.org/api/rest_v1/page/random/summary`,n={title:"",author:""},r=await fetch(s);let o=0;if(r.status===200){const l=await r.json();n.title=l.title,n.author=l.author,o=l.pageid}return new Promise((l,u)=>{r.status!==200&&(Te(),u(r.status));const c=`https://${e}.wikipedia.org/w/api.php?action=query&format=json&pageids=${o}&prop=extracts&exintro=true&origin=*`,p=new XMLHttpRequest;p.onload=()=>{if(p.readyState===4)if(p.status===200){let f=JSON.parse(p.responseText).query.pages[o.toString()].extract;f=f.replace(/<\/p><p>+/g," "),f=mA(f),f=f.replace(/\[\d+\]/gi,""),f=f.replace(/[\u200B-\u200D\uFEFF]/g,""),f=Gx(f),e==="en"&&(f=f.replace(/[^\x20-\x7E]+/g,"")),f=f.replace(/\s+/g," "),f=f.trim();const m=f.split(" "),g=new Y0(n.title,n.author,m);Te(),l(g)}else Te(),u(p.status)},p.open("GET",c),p.send()})}function B1(t,e,a,s,n){const r=[],o=Math.round(t/e);for(let l=0;l<e;l++){let c=ua(0,2**o-1).toString(a);if(s){const p=Math.ceil(o/Math.ceil(Math.log2(a)));c="0".repeat(Math.max(0,p-c.length))+c}r.push(c)}return r.join(n)}function Uw(t,e,a,s,n,r){const o=n.split(s).map(c=>parseInt(c,a)),l=Math.round(t/e);let u=r;for(let c=0;c<e;c++)u-=l,u<0&&(-u<=l?o[c]&=2**l-1^2**-u-1:o[c]=0);return o.map(c=>c.toString(a)).join(s)+"/"+r.toString()}function HB(){return B1(32,4,10,!1,".")}function zB(){return B1(128,8,16,!0,":")}function Z1(t){return t.includes(":")?Uw(128,8,16,":",t,ua(16,32)*4):Uw(32,4,10,".",t,ua(8,32))}function KB(t){const e=t.split("/");let a=e[0].split(":"),s="";a=a.map(p=>p.replace(/^0+/gm,""));let n=0,r=-1,o=-1,l=0,u=-1,c=-1;for(let p=0;p<a.length;p++)a[p]===""?(u===-1&&(u=p),l++):(c=p-1,n<l&&(n=l,r=u,o=c),l=0,u=-1,c=-1);return n<l&&(n=l,r=u,o=a.length-1),a=a.map((p,f)=>p===""?f>=r&&f<=o&&r!==o?":":"0":p),s=a.join(":"),s=s.replace(/:{3,}/gm,"::"),e.length>1&&(s+="/"+e[1]),s}let gl=null;class Cb{constructor(e){this.words=e,this.length=this.words.length,this.shuffledIndexes=[],this.orderedIndex=0}resetIndexes(){this.orderedIndex=0,this.shuffledIndexes=[]}randomWord(e){return e==="zipf"?this.words[hA(this.words.length)]:Hs(this.words)}shuffledWord(){return this.shuffledIndexes.length===0&&this.generateShuffledIndexes(),this.words[this.shuffledIndexes.pop()]}generateShuffledIndexes(){this.shuffledIndexes=[];for(let e=0;e<this.length;e++)this.shuffledIndexes.push(e);rd(this.shuffledIndexes)}nextWord(){return this.orderedIndex>=this.length&&(this.orderedIndex=0),this.words[this.orderedIndex++]}}async function VB(t){var a;const e=Ae(d.funbox).find(s=>{var n;return(n=s.functions)==null?void 0:n.withWords});return(a=e==null?void 0:e.functions)!=null&&a.withWords?e.functions.withWords(t):((gl===null||t!==gl.words)&&(gl=new Cb(t)),gl.resetIndexes(),gl)}function q1(){i("#typingTest #layoutfluidTimer").stop(!0,!0).animate({opacity:1},125)}function ed(){i("#typingTest #layoutfluidTimer").stop(!0,!0).animate({opacity:0},125)}function Gh(t,e){i("#typingTest #layoutfluidTimer").text(`${Ao(e)} in: ${t}s`)}function UB(t,e){const a=Ao(e.replace(/_/g," "));let s=`${a} in: ${t} words`;t===1&&(s=`${a} starting next word`),i("#typingTest #layoutfluidTimer").text(s)}let yl=!1,gp=0,Qh=0,Gw=0,Qw=3,Wr=0,Br=0;function GB(t){Qh--;let e=Math.round(Math.random()),a=Math.round(Math.random()*5-.5);return t?(yl=!!Math.round(Math.random()),yl?a=3:a=0):(yl?(Gw===e?Wr++:Wr=0,(Wr>1||Br>0&&Wr>0)&&(e=1-e,Wr=0),Gw=e,a=e*(gp+1)):(Qw===e?Br++:Br=0,(Br>1||Br>0&&Wr>0)&&(e=1-e,Br=0),Qw=e,a=3-e*(gp+1)),yl=!yl,Qh<0&&e===0&&(gp=1-gp,Qh=Math.floor(Math.random()*3)+3)),a}function QB(t){const e=["","","",""];let a="";for(let s=0;s<4;s++)a+=e[GB(s===0&&t)];return a}const Yw=2;class YB{constructor(){this.chars={},this.count=0}addChar(e){this.count++,e in this.chars?this.chars[e]++:this.chars[e]=1}randomChar(){const e=ua(0,this.count-1);let a=0;for(const[s,n]of Object.entries(this.chars))if(a+=n,a>e)return s;return Object.keys(this.chars)[0]}}class JB extends Cb{constructor(e){super(e),this.ngrams={},this.length=1/0;for(let a of e){a+=" ";let s="";for(const n of a)s in this.ngrams||(this.ngrams[s]=new YB),this.ngrams[s].addChar(n),s=(s+n).slice(-Yw)}}randomWord(){let e="";for(;;){const a=e.slice(-Yw),s=this.ngrams[a];if(!s){e="";continue}const n=s.randomChar();if(n===" ")break;e+=n}return e}}ot("simon_says",{applyConfig(){Cs("next",!0)},rememberSettings(){ta("keymapMode",d.keymapMode,Cs)}});ot("tts",{applyConfig(){Cs("off",!0)},rememberSettings(){ta("keymapMode",d.keymapMode,Cs)},toggleScript(t){if(window.speechSynthesis===void 0){h("Failed to load text-to-speech script",-1);return}t[0]!==void 0&&AB(t[0])}});ot("arrows",{getWord(t,e){return QB(e===0)},rememberSettings(){ta("highlightMode",d.highlightMode,Pi)},handleChar(t){return t==="a"||t==="ArrowLeft"||t==="j"?"":t==="s"||t==="ArrowDown"||t==="k"?"":t==="w"||t==="ArrowUp"||t==="i"?"":t==="d"||t==="ArrowRight"||t==="l"?"":t},isCharCorrect(t,e){return(t==="a"||t==="ArrowLeft"||t==="j")&&e===""||(t==="s"||t==="ArrowDown"||t==="k")&&e===""||(t==="w"||t==="ArrowUp"||t==="i")&&e===""||(t==="d"||t==="ArrowRight"||t==="l")&&e===""},async preventDefaultEvent(t){return["ArrowLeft","ArrowUp","ArrowRight","ArrowDown"].includes(t.key)},getWordHtml(t,e){let a="";return t===""&&(e&&(a+="<letter>"),a+='<i class="fas fa-arrow-up"></i>',e&&(a+="</letter>")),t===""&&(e&&(a+="<letter>"),a+='<i class="fas fa-arrow-down"></i>',e&&(a+="</letter>")),t===""&&(e&&(a+="<letter>"),a+='<i class="fas fa-arrow-left"></i>',e&&(a+="</letter>")),t===""&&(e&&(a+="<letter>"),a+='<i class="fas fa-arrow-right"></i>',e&&(a+="</letter>")),a}});ot("rAnDoMcAsE",{alterText(t){let e=t[0];for(let a=1;a<t.length;a++)e[a-1]===e[a-1].toUpperCase()?e+=t[a].toLowerCase():e+=t[a].toUpperCase();return e}});ot("backwards",{alterText(t){return t.split("").reverse().join("")}});ot("capitals",{alterText(t){return Ac(t)}});ot("layoutfluid",{applyConfig(){const t=d.customLayoutfluid.split("#")[0]??"qwerty";nr(t,!0),sr(t,!0)},rememberSettings(){ta("keymapMode",d.keymapMode,Cs),ta("layout",d.layout,nr),ta("keymapLayout",d.keymapLayout,sr)},handleSpace(){if(d.mode!=="time"){const t=d.customLayoutfluid?d.customLayoutfluid.split("#"):["qwerty","dvorak","colemak"],e=E.length,a=Math.floor(e/t.length),s=Math.floor((T.history.length+1)/a),n=a-(E.currentIndex+1)%a;t[s]?(n<=3&&t[s+1]?(q1(),UB(n,t[s+1])):ed(),n===a&&(nr(t[s]),sr(t[s]),n>3&&ed())):ed(),setTimeout(()=>{ai(E.getCurrent().charAt(T.current.length).toString())},1)}},getResultContent(){return d.customLayoutfluid.replace(/#/g," ")},restart(){this.applyConfig&&this.applyConfig(),setTimeout(()=>{ai(E.getCurrent().substring(T.current.length,T.current.length+1).toString())},1)}});ot("gibberish",{getWord(){return xB()}});ot("58008",{getWord(){let t=P1(7);return d.language.startsWith("kurdish")?t=J0(t):d.language.startsWith("nepali")&&(t=X0(t)),t},punctuateWord(t){if(t.length>3&&(Math.random()<.5&&(t=Lw(t,ua(1,t.length-2),".")),Math.random()<.75)){const e=ua(1,t.length-2);if(t[e-1]!=="."&&t[e+1]!=="."&&t[e+1]!=="0"){const a=Hs(["/","*","-","+"]);t=Lw(t,e,a)}}return t},rememberSettings(){ta("numbers",d.numbers,os)},handleChar(t){return t===`
`?" ":t}});ot("ascii",{getWord(){return _B()},punctuateWord(t){return t}});ot("specials",{getWord(){return CB()}});ot("read_ahead_easy",{rememberSettings(){ta("highlightMode",d.highlightMode,Pi)}});ot("read_ahead",{rememberSettings(){ta("highlightMode",d.highlightMode,Pi)}});ot("read_ahead_hard",{rememberSettings(){ta("highlightMode",d.highlightMode,Pi)}});ot("memory",{applyConfig(){i("#wordsWrapper").addClass("hidden"),Zu(!0,!0),d.keymapMode==="next"&&Cs("react",!0)},rememberSettings(){ta("mode",d.mode,zt),ta("showAllLines",d.showAllLines,Zu),d.keymapMode==="next"&&ta("keymapMode",d.keymapMode,Cs)},start(){Zo(),i("#words").addClass("hidden")},restart(){TB(),i("#words").removeClass("hidden"),d.keymapMode==="next"&&Cs("react")}});ot("nospace",{rememberSettings(){ta("highlightMode",d.highlightMode,Pi)}});ot("poetry",{async pullSection(){return qB()}});ot("wikipedia",{async pullSection(t){return jB((t??"")||"english")}});ot("weakspot",{getWord(t){return t!==void 0?DB(t):""}});ot("pseudolang",{async withWords(t){return t!==void 0?new JB(t):new Cb([])}});ot("IPv4",{getWord(){return HB()},punctuateWord(t){let e=t;return Math.random()<.25&&(e=Z1(t)),e},rememberSettings(){ta("numbers",d.numbers,os)}});ot("IPv6",{getWord(){return zB()},punctuateWord(t){let e=t;return Math.random()<.25&&(e=Z1(t)),e.includes(":")&&(e=KB(e)),e},rememberSettings(){ta("numbers",d.numbers,os)}});ot("binary",{getWord(){return wB()}});ot("zipf",{getWordsFrequencyMode(){return"zipf"}});ot("ddoouubblleedd",{alterText(t){return t.replace(/./gu,"$&$&")}});function vm(...t){Ae(d.funbox).forEach(e=>{var a;(a=e.functions)!=null&&a.toggleScript&&e.functions.toggleScript(t)})}function XB(t){return Ae(d.funbox).forEach(e=>{var a,s;return(s=(a=e.functions)==null?void 0:a.clearGlobal)==null?void 0:s.call(a)}),D1(),pn(t,!1),!0}function F1(t){if(t==="none"&&XB("none"),!Mv(d.funbox,t)&&!d.funbox.split("#").includes(t))return h(`${Ao(t.replace(/_/g," "))} funbox is not compatible with the current funbox selection`,0),!0;D1();const e=Rv(t,!1);return d.funbox.includes(t)?Ae(t).forEach(a=>{var s,n;return(n=(s=a.functions)==null?void 0:s.applyGlobalCSS)==null?void 0:n.call(s)}):Ae(t).forEach(a=>{var s,n;return(n=(s=a.functions)==null?void 0:s.clearGlobal)==null?void 0:n.call(s)}),!(e===!1||e===!0)}async function to(){var t,e,a,s;return i("body").attr("class",((s=(a=(e=(t=i("body"))==null?void 0:t.attr("class"))==null?void 0:e.split(/\s+/))==null?void 0:a.filter(n=>!n.startsWith("fb-")))==null?void 0:s.join(" "))??""),i("#funBoxTheme").removeAttr("href"),i("#wordsWrapper").removeClass("hidden"),Zo(),tt(),!0}async function Sb(t){if(t==null?t=d.funbox:d.funbox!==t&&(d.funbox=t),!Mv(d.funbox))return h(Re(void 0,`Failed to activate funbox: funboxes ${d.funbox.replace(/_/g," ")} are not compatible`),-1),pn("none",!0),await to(),!1;Zo(),await tZ(),await aZ(),i("#wordsWrapper").removeClass("hidden");let e;try{e=await Ii(d.language)}catch(s){return h(Re(s,"Failed to activate funbox"),-1),pn("none",!0),await to(),!1}if(e.ligatures&&Ae(d.funbox).find(s=>{var n;return(n=s.properties)==null?void 0:n.includes("noLigatures")})){h("Current language does not support this funbox mode",0),pn("none",!0),await to();return}let a=!0;for(const[s,n]of Object.entries(d)){const r=Yg(s,n,d.funbox);if(!r.result&&!r.result)if(r.forcedConfigs&&r.forcedConfigs.length>0)s==="mode"&&zt(r.forcedConfigs[0]),s==="words"&&Ti(r.forcedConfigs[0]),s==="time"&&Ws(r.forcedConfigs[0]),s==="punctuation"&&tn(r.forcedConfigs[0]),s==="numbers"&&os(r.forcedConfigs[0]),s==="highlightMode"&&Pi(r.forcedConfigs[0]);else{a=!1;break}}if(!a){d.funbox.includes("#")?h(`Failed to activate funboxes ${d.funbox}: no intersecting forced configs. Disabling funbox`,-1):h(`Failed to activate funbox ${d.funbox}: no forced configs. Disabling funbox`,-1),pn("none",!0),await to();return}return tt(),Ae(d.funbox).forEach(async s=>{var n,r;(r=(n=s.functions)==null?void 0:n.applyConfig)==null||r.call(n)}),!0}async function eZ(){Ae(d.funbox).forEach(async t=>{var e;(e=t.functions)!=null&&e.rememberSettings&&t.functions.rememberSettings()})}ot("morse",{alterText(t){return kB(t)}});ot("crt",{applyGlobalCSS(){if(/^((?!chrome|android).)*safari/i.test(navigator.userAgent)){const e=navigator.userAgent.match(/.*Version\/([0-9]*)\.([0-9]*).*/),a=e!==null?parseInt(e[1]??"0"):0,s=e!==null?parseInt(e[2]??"0"):0;if(a<=16&&s<=5){h("CRT is not available on Safari 16.5 or earlier.",0,{duration:5}),F1("crt");return}}i("body").append('<div id="scanline" />'),i("body").addClass("crtmode"),i("#globalFunBoxTheme").attr("href","funbox/crt.css")},clearGlobal(){i("#scanline").remove(),i("body").removeClass("crtmode"),i("#globalFunBoxTheme").attr("href","")}});async function tZ(){var s,n;const t=i("body"),e=Ae(d.funbox).map(r=>"fb-"+r.name.replaceAll("_","-")),a=((n=(s=t==null?void 0:t.attr("class"))==null?void 0:s.split(/\s+/))==null?void 0:n.filter(r=>!r.startsWith("fb-")))??[];return t.attr("class",[...a,...e].join(" ")),!0}async function aZ(){const t=i("#funBoxTheme"),e=Ae(d.funbox).find(n=>n.hasCSS==!0),a=e!=null?"funbox/"+e.name+".css":"",s=(t.attr("href")??"")||null;return a!=s&&t.attr("href",a),!0}const sZ={keymapShowTopRow:!0,type:"matrix",keys:{row1:[],row2:["sS","tT","pP","hH","**","fF","pP","lL","tT","dD"],row3:["sS","kK","wW","rR","**","rR","bB","gG","sS","zZ"],row4:["aA","oO","eE","uU"],row5:[]}};function nZ(t){if(d.mode!=="zen"){t===""&&(t=" ");try{i(".activeKey").removeClass("activeKey");let e;d.language.startsWith("korean")&&(t=Bt.disassemble(t)[0]??t),t===" "?e="#keymap .keySpace, #keymap .keySplitSpace":t==='"'?e=`#keymap .keymapKey[data-key*='${t}']`:e=`#keymap .keymapKey[data-key*="${t}"]`,i(e).addClass("activeKey")}catch(e){e instanceof Error&&console.log("could not update highlighted keymap key: "+e.message)}}}async function iZ(t,e){if(t===void 0)return;t===" "?t="#keymap .keySpace, #keymap .keySplitSpace":t==='"'?t=`#keymap .keymapKey[data-key*='${t}']`:t=`#keymap .keymapKey[data-key*="${t}"]`;const a=await Oi();try{let s={color:a.bg,backgroundColor:a.sub,borderColor:a.sub};e||d.blindMode?s={color:a.bg,backgroundColor:a.main,borderColor:a.main}:s={color:a.bg,backgroundColor:a.error,borderColor:a.error},i(t).stop(!0,!0).css(s).animate({color:a.sub,backgroundColor:a.subAlt,borderColor:a.sub},Ct()?0:500,"easeOutExpo")}catch{}}function rZ(){i("#keymap").addClass("hidden")}function oZ(){i("#keymap").removeClass("hidden")}async function bm(t=d.layout){if(d.keymapMode!=="off"&&Xe()==="test"&&t)try{let e;try{e=await Wm()}catch(p){h(Re(p,"Failed to refresh keymap"),-1);return}let a=e[t],s=t;d.keymapLayout==="overrideSync"?d.layout==="default"?(a=e.qwerty,s="default"):(a=e[d.layout],s=d.layout):(a=e[d.keymapLayout],s=d.keymapLayout);const n=Kv&&d.keymapMode==="next"||d.keymapShowTopRow==="always"||a.keymapShowTopRow&&d.keymapShowTopRow!=="never",r=d.keymapStyle==="matrix"||d.keymapStyle==="split_matrix",o=d.keymapStyle==="steno"||d.keymapStyle==="steno_matrix";if(o&&(a=sZ),a===void 0)throw new Error("Failed to refresh keymap: layout not found");const l=a.type==="iso";let u="";const c=Object.keys(a.keys);for(let p=0;p<c.length;p++){const f=c[p];let m=a.keys[f];f==="row1"&&(r||d.keymapStyle==="staggered")&&(m=m.slice(1));let g="";if(!(f==="row1"&&(!n||o))){if((f==="row2"||f==="row3"||f==="row4")&&!r&&!o&&(g+="<div></div>"),f==="row4"&&!l&&!r&&!o&&(g+="<div></div>"),r&&(f!=="row5"&&a.matrixShowRightColumn?g+='<div class="keymapKey"></div>':g+="<div></div>"),f==="row5"){if(o)continue;const y=s.replace(/_/g," ");let v="";d.keymapLegendStyle==="blank"&&(v='style="display: none;"'),g+="<div></div>",g+=`<div class="keymapKey keySpace">
          <div class="letter" ${v}>${y}</div>
        </div>`,g+='<div class="keymapSplitSpacer"></div>',g+=`<div class="keymapKey keySplitSpace">
          <div class="letter"></div>
        </div>`}else for(let y=0;y<m.length;y++){if(f==="row2"&&y===12||f==="row4"&&r&&l&&y===0)continue;let v=10;if(a.matrixShowRightColumn&&(v=11),f==="row4"&&r&&l&&(v+=1),(d.keymapStyle==="matrix"||d.keymapStyle==="split_matrix")&&y>=v)continue;const A=m[y],W=f==="row3"&&(y===3||y===6);let $=A[0],se="";d.keymapLegendStyle==="blank"?se='style="display: none;"':d.keymapLegendStyle==="uppercase"&&($=$.toUpperCase());let te="";f==="row1"&&y===0&&!r&&d.keymapStyle!=="staggered"&&(te=" invisible");const b=`<div class="keymapKey${te}" data-key="${A.replace('"',"&quot;")}">
              <span class="letter" ${se}>${$}</span>
              ${W?"<div class='bump'></div>":""}
          </div>`;let w="";(d.keymapStyle==="split"||d.keymapStyle==="split_matrix"||d.keymapStyle==="alice"||o)&&(f==="row4"&&o&&(y===0||y===2||y===4)?w+='<div class="keymapSplitSpacer"></div>':f==="row4"&&(d.keymapStyle==="split"||d.keymapStyle==="alice")&&l?y===6&&(w+='<div class="keymapSplitSpacer"></div>'):f==="row1"&&(d.keymapStyle==="split"||d.keymapStyle==="alice")?y===7&&(w+='<div class="keymapSplitSpacer"></div>'):f==="row4"&&r&&l?y===6&&(w+='<div class="keymapSplitSpacer"></div>'):y===5&&(w+='<div class="keymapSplitSpacer"></div>')),d.keymapStyle==="alice"&&f==="row4"&&(l&&y===6||!l&&y===5)&&(w+='<div class="extraKey"><span class="letter"></span></div>'),g+=w+b}u+=`<div class="row r${p+1}">${g}</div>`}}i("#keymap").html(u),i("#keymap").removeClass("staggered"),i("#keymap").removeClass("matrix"),i("#keymap").removeClass("split"),i("#keymap").removeClass("split_matrix"),i("#keymap").removeClass("alice"),i("#keymap").removeClass("steno"),i("#keymap").removeClass("steno_matrix"),i("#keymap").addClass(d.keymapStyle)}catch(e){e instanceof Error&&console.log("something went wrong when changing layout, resettings: "+e.message)}}mt((t,e)=>{t==="layout"&&d.keymapLayout==="overrideSync"&&bm(d.keymapLayout),(t==="keymapLayout"||t==="keymapStyle"||t==="keymapShowTopRow"||t==="keymapMode")&&bm(),t==="keymapMode"&&(e==="off"?rZ():oZ())});MB((t,e,a)=>{t==="highlight"&&nZ(e),t==="flash"&&iZ(e,a)});Xa.register(YA,JA,XA,eM,tM,aM,sM,nM,iM,rM,oM,lM,dM,uM);Xa.defaults.animation.duration=0;Xa.defaults.elements.line.tension=.3;Xa.defaults.elements.line.fill="origin";class tl extends Xa{constructor(e,a){super(e,a)}async updateColors(){await dZ(this)}getDataset(e){var a;return(a=this.data.datasets)==null?void 0:a.find(s=>s.yAxisID===e)}getScale(e){return this.options.scales[e]}}let Jw;const yt=new tl(document.querySelector("#wpmChart"),{type:"line",data:{labels:[],datasets:[{clip:!1,label:"wpm",data:[],borderColor:"rgba(125, 125, 125, 1)",borderWidth:3,yAxisID:"wpm",order:2,pointRadius:1},{clip:!1,label:"raw",data:[],borderColor:"rgba(125, 125, 125, 1)",borderWidth:3,yAxisID:"raw",order:3,pointRadius:1},{clip:!1,label:"errors",data:[],borderColor:"rgba(255, 125, 125, 1)",pointBackgroundColor:"rgba(255, 125, 125, 1)",borderWidth:2,order:1,yAxisID:"error",type:"scatter",pointStyle:"crossRot",pointRadius:function(t){const e=t.dataIndex;return(t.dataset.data[e]??0)<=0?0:3},pointHoverRadius:function(t){const e=t.dataIndex;return(t.dataset.data[e]??0)<=0?0:5}}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{x:{axis:"x",ticks:{autoSkip:!0,autoSkipPadding:20},display:!0,title:{display:!1,text:"Seconds"}},wpm:{axis:"y",display:!0,title:{display:!0,text:"Words per Minute"},beginAtZero:!0,min:0,ticks:{autoSkip:!0,autoSkipPadding:20},grid:{display:!0}},raw:{axis:"y",display:!1,title:{display:!0,text:"Raw Words per Minute"},beginAtZero:!0,min:0,ticks:{autoSkip:!0,autoSkipPadding:20},grid:{display:!1}},error:{axis:"y",display:!0,position:"right",title:{display:!0,text:"Errors"},beginAtZero:!0,ticks:{precision:0,autoSkip:!0,autoSkipPadding:20},grid:{display:!1}}},plugins:{annotation:{annotations:[]},tooltip:{animation:{duration:250},mode:"index",intersect:!1,callbacks:{afterLabel:function(t){var e;if(Jw===t)return"";Jw=t;try{const a=Math.round(parseFloat(t.label))-1,s=(e=Dc[a])==null?void 0:e.words,n=[...new Set(s)],r=n[0],o=mi(n);if(r===void 0||o===void 0)return"";kW(r,o)}catch{}return""}}}}}});let j1;const de=new tl(document.querySelector(".pageAccount #accountHistoryChart"),{type:"line",data:{datasets:[{yAxisID:"wpm",data:[],fill:!1,borderWidth:0,order:3},{yAxisID:"pb",data:[],fill:!1,stepped:!0,pointRadius:0,pointHoverRadius:0,order:4},{yAxisID:"acc",fill:!1,data:[],pointStyle:"triangle",borderWidth:0,pointRadius:3.5,order:3},{yAxisID:"wpmAvgTen",data:[],fill:!1,pointRadius:0,pointHoverRadius:0,order:2},{yAxisID:"accAvgTen",data:[],fill:!1,pointRadius:0,pointHoverRadius:0,order:2},{yAxisID:"wpmAvgHundred",data:[],fill:!1,pointRadius:0,pointHoverRadius:0,order:1},{yAxisID:"accAvgHundred",label:"accAvgHundred",data:[],fill:!1,pointRadius:0,pointHoverRadius:0,order:1}]},options:{maintainAspectRatio:!1,hover:{mode:"nearest",intersect:!1},scales:{x:{axis:"x",type:"linear",reverse:!0,min:0,ticks:{stepSize:10},display:!1,grid:{display:!1}},wpm:{axis:"y",type:"linear",beginAtZero:!0,min:0,ticks:{stepSize:10},display:!0,title:{display:!0,text:"Words per Minute"},position:"right"},pb:{axis:"y",beginAtZero:!0,min:0,ticks:{stepSize:10},display:!1},acc:{axis:"y",beginAtZero:!0,min:0,max:100,reverse:!0,ticks:{stepSize:10},display:!0,title:{display:!0,text:"Accuracy"},grid:{display:!1},position:"left"},wpmAvgTen:{axis:"y",beginAtZero:!0,min:0,ticks:{stepSize:10},display:!1,grid:{display:!1}},accAvgTen:{axis:"y",beginAtZero:!0,min:0,max:100,reverse:!0,ticks:{stepSize:10},display:!1,grid:{display:!1}},wpmAvgHundred:{axis:"y",beginAtZero:!0,min:0,ticks:{stepSize:10},display:!1,grid:{display:!1}},accAvgHundred:{axis:"y",beginAtZero:!0,min:0,max:100,reverse:!0,ticks:{stepSize:10},display:!1,grid:{display:!1}}},plugins:{annotation:{annotations:[]},tooltip:{animation:{duration:250},enabled:!0,intersect:!1,external:function(t){t!==void 0&&(t.tooltip.options.displayColors=!1)},filter:function(t){return t.datasetIndex!==1&&t.datasetIndex!==3&&t.datasetIndex!==4&&t.datasetIndex!==5&&t.datasetIndex!==6},callbacks:{title:function(){return""},beforeLabel:function(t){if(t.datasetIndex!==0){const n=t.dataset.data[t.dataIndex];return`error rate: ${we(n.errorRate)}%
acc: ${we(100-n.errorRate)}%`}const e=t.dataset.data[t.dataIndex];let a=`${d.typingSpeedUnit}: ${e.wpm}
raw: ${e.raw}
acc: ${e.acc}

mode: ${e.mode} `;(e.mode==="time"||e.mode==="words")&&(a+=e.mode2);let s=e.difficulty;return s===void 0&&(s="normal"),a+=`
difficulty: ${s}`,a+=`
punctuation: ${e.punctuation}
language: ${e.language}${e.isPb?`

new personal best`:""}

date: ${nt(new Date(e.timestamp),"dd MMM yyyy HH:mm")}`,a},label:function(){return""},afterLabel:function(t){return j1=t.dataIndex,""}}}}}}),si=new tl(document.querySelector(".pageAccount #accountActivityChart"),{type:"bar",data:{labels:[],datasets:[{yAxisID:"count",label:"Seconds",data:[],trendlineLinear:{style:"rgba(255,105,180, .8)",lineStyle:"dotted",width:2},order:3},{yAxisID:"avgWpm",label:"Average Wpm",data:[],type:"line",order:2,tension:0,fill:!1}]},options:{responsive:!0,maintainAspectRatio:!1,hover:{mode:"nearest",intersect:!1},scales:{x:{axis:"x",ticks:{autoSkip:!0,autoSkipPadding:20},type:"time",time:{unit:"day",displayFormats:{day:"d MMM"}},bounds:"ticks",display:!0,title:{display:!1,text:"Date"},offset:!0},count:{axis:"y",beginAtZero:!0,min:0,ticks:{autoSkip:!0,autoSkipPadding:20,stepSize:1},display:!0,title:{display:!0,text:"Time typing (minutes)"}},avgWpm:{axis:"y",beginAtZero:!0,min:0,ticks:{autoSkip:!0,autoSkipPadding:20,stepSize:10},display:!0,position:"right",title:{display:!0,text:"Average Wpm"},grid:{display:!1}}},plugins:{annotation:{annotations:[]},tooltip:{animation:{duration:250},intersect:!1,mode:"index",callbacks:{title:function(t){const e=t[0],a=e.dataset.data[e.dataIndex];return nt(new Date(a.x),"dd MMM yyyy")},beforeLabel:function(t){const e=t.dataset.data[t.dataIndex];switch(t.datasetIndex){case 0:return`Time Typing: ${Ta(Math.round(e.y*60),!0,!0)}
Tests Completed: ${e.amount}`;case 1:return`Average ${d.typingSpeedUnit}: ${we(e.y)}`;default:return""}},label:function(){return""}}}}}}),uo=new tl(document.querySelector(".pageAccount #accountHistogramChart"),{type:"bar",data:{labels:[],datasets:[{yAxisID:"count",label:"Tests",data:[]}]},options:{responsive:!0,maintainAspectRatio:!1,hover:{mode:"nearest",intersect:!1},scales:{x:{axis:"x",bounds:"ticks",display:!0,title:{display:!1,text:"Bucket"},offset:!0},count:{axis:"y",beginAtZero:!0,min:0,ticks:{autoSkip:!0,autoSkipPadding:20,stepSize:10},display:!0,title:{display:!0,text:"Tests"}}},plugins:{annotation:{annotations:[]},tooltip:{animation:{duration:250},intersect:!1,mode:"index"}}}}),co=new tl(document.querySelector(".pageAbout #publicStatsHistogramChart"),{type:"bar",data:{labels:[],datasets:[{yAxisID:"count",label:"Users",data:[]}]},options:{responsive:!0,maintainAspectRatio:!1,hover:{mode:"nearest",intersect:!1},scales:{x:{axis:"x",bounds:"ticks",display:!0,title:{display:!1,text:"Bucket"},offset:!0},count:{axis:"y",beginAtZero:!0,min:0,ticks:{autoSkip:!0,autoSkipPadding:20,stepSize:10},display:!0,title:{display:!0,text:"Users"}}},plugins:{annotation:{annotations:[]},tooltip:{animation:{duration:250},intersect:!1,mode:"index"}}}}),Va=new tl(document.querySelector(".pageAccount #miniResultChart"),{type:"line",data:{labels:[],datasets:[{label:"wpm",data:[],borderColor:"rgba(125, 125, 125, 1)",borderWidth:2,yAxisID:"wpm",order:2,pointRadius:2},{label:"raw",data:[],borderColor:"rgba(125, 125, 125, 1)",borderWidth:2,yAxisID:"raw",order:3,pointRadius:2},{label:"errors",data:[],borderColor:"rgba(255, 125, 125, 1)",pointBackgroundColor:"rgba(255, 125, 125, 1)",borderWidth:2,order:1,yAxisID:"error",type:"scatter",pointStyle:"crossRot",pointRadius:function(t){const e=t.dataIndex;return(t.dataset.data[e]??0)<=0?0:3},pointHoverRadius:function(t){const e=t.dataIndex;return(t.dataset.data[e]??0)<=0?0:5}}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{x:{axis:"x",ticks:{autoSkip:!0,autoSkipPadding:20},display:!0,title:{display:!1,text:"Seconds"}},wpm:{axis:"y",display:!0,title:{display:!0,text:"Words per Minute"},beginAtZero:!0,min:0,ticks:{autoSkip:!0,autoSkipPadding:20},grid:{display:!0}},raw:{axis:"y",display:!1,title:{display:!0,text:"Raw Words per Minute"},beginAtZero:!0,min:0,ticks:{autoSkip:!0,autoSkipPadding:20},grid:{display:!1}},error:{display:!0,position:"right",title:{display:!0,text:"Errors"},beginAtZero:!0,ticks:{precision:0,autoSkip:!0,autoSkipPadding:20},grid:{display:!1}}},plugins:{annotation:{annotations:[]},tooltip:{animation:{duration:250},mode:"index",intersect:!1}}}});function lZ(){H1(!1),z1(!1),K1(!1),V1(!1)}function ch(t,e){t?i(`.pageAccount ${e}`).addClass("active"):i(`.pageAccount ${e}`).removeClass("active")}function H1(t=!0){const e=d.accountChart[0]==="on";ch(e,".toggleResultsOnChart"),de.getDataset("wpm").hidden=!e,de.getDataset("pb").hidden=!e,de.getDataset("wpmAvgTen").hidden=!e,de.getDataset("wpmAvgHundred").hidden=!e,de.getScale("wpm").display=e,t&&de.updateColors()}function z1(t=!0){const e=d.accountChart[0]==="on",a=d.accountChart[1]==="on";if(ch(a,".toggleAccuracyOnChart"),de.getDataset("acc").hidden=!a,de.getDataset("accAvgTen").hidden=!a,de.getDataset("accAvgHundred").hidden=!a,de.getScale("acc").display=a,e)de.getScale("acc").min=0,de.getScale("accAvgTen").min=0,de.getScale("accAvgHundred").min=0;else{const s=Math.floor(Math.min(...de.getDataset("acc").data.map(n=>n.y))/10)*10;de.getScale("acc").min=s,de.getScale("accAvgTen").min=s,de.getScale("accAvgHundred").min=s}t&&de.updateColors()}function K1(t=!0){const e=d.accountChart[0]==="on",a=d.accountChart[1]==="on",s=d.accountChart[2]==="on";ch(s,".toggleAverage10OnChart"),a&&(de.getDataset("accAvgTen").hidden=!s),e&&(de.getDataset("wpmAvgTen").hidden=!s),t&&de.updateColors()}function V1(t=!0){const e=d.accountChart[0]==="on",a=d.accountChart[1]==="on",s=d.accountChart[3]==="on";ch(s,".toggleAverage100OnChart"),a&&(de.getDataset("accAvgHundred").hidden=!s),e&&(de.getDataset("wpmAvgHundred").hidden=!s),t&&de.updateColors()}async function dZ(t){var m,g;const e=await Za("bg"),a=await Za("sub"),s=await Za("subAlt"),n=await Za("main"),r=await Za("error"),o=await Za("text"),l=gs(e,s,.75);t.data.datasets[0].borderColor=y=>{var W;return((W=y.raw)==null?void 0:W.isPb)?o:n},t.data.datasets[1]&&(t.data.datasets[1].borderColor=a),t.data.datasets[2]&&(t.data.datasets[2].borderColor=r);const u=t.data.datasets[0];((g=(m=t==null?void 0:t.data)==null?void 0:m.datasets[0])==null?void 0:g.type)===void 0?t.config.type==="line"?u.pointBackgroundColor=y=>{var W;return((W=y.raw)==null?void 0:W.isPb)?o:n}:t.config.type==="bar"&&(u.backgroundColor=n):t.data.datasets[0].type==="bar"?t.data.datasets[0].backgroundColor=n:t.data.datasets[0].type==="line"&&(u.pointBackgroundColor=n);const c=t.data.datasets[1];c!==void 0&&(c.type===void 0?t.config.type==="line"?c.pointBackgroundColor=a:t.config.type==="bar"&&(c.backgroundColor=a):(c==null?void 0:c.type)==="bar"?c.backgroundColor=a:c.type==="line"&&(c.pointBackgroundColor=a)),t.data.datasets.length===2&&(c.borderColor=()=>a);const p=t.data.datasets[2];if(t.data.datasets.length===7){p.borderColor=()=>a;const y=d.accountChart[2]==="on",v=d.accountChart[3]==="on",A=gs(e,o,.2),W=gs(e,n,.2),$=gs(e,n,.4),se=gs(e,a,.2),te=gs(e,a,.4),[b,w,q,me,qt,Ft,jt]=t.data.datasets;if(b===void 0||w===void 0||q===void 0||me===void 0||qt===void 0||Ft===void 0||jt===void 0)return;y&&v?(b.pointBackgroundColor=W,w.borderColor=A,q.pointBackgroundColor=se,me.borderColor=$,qt.borderColor=te,Ft.borderColor=n,jt.borderColor=a):y&&!v||!y&&v?(w.borderColor=A,b.pointBackgroundColor=$,q.pointBackgroundColor=te,me.borderColor=n,Ft.borderColor=n,qt.borderColor=a,jt.borderColor=a):(w.borderColor=A,b.pointBackgroundColor=n,q.pointBackgroundColor=a)}const f=t.options;Object.keys(f.scales).forEach(y=>{const v=f.scales[y];v.ticks.color=a,v.title.color=a,v.grid.color=l,v.grid.tickColor=l,v.grid.borderColor=l});try{u.trendlineLinear.style=a}catch{}t.options.plugins.annotation.annotations.forEach(y=>{y.id!=="funbox-label"&&(y.borderColor=a),y.label.backgroundColor=a,y.label.color=e}),t.update("none")}function uZ(t){Xa.defaults.font.family=t.replace(/_/g," ")}function U1(){$c(),de.updateColors(),uo.updateColors(),co.updateColors(),yt.updateColors(),si.updateColors(),Va.updateColors()}mt((t,e)=>{t==="accountChart"&&Xe()==="account"&&(H1(),z1(),K1(),V1()),t==="fontFamily"&&uZ(e)});const pt={blur:{value:0,default:0},brightness:{value:1,default:1},saturate:{value:1,default:1},opacity:{value:1,default:1}};function cZ(){let t="";return Object.keys(pt).forEach(e=>{const a=e;pt[a].value!==pt[a].default&&(t+=`${e}(${pt[a].value}${e==="blur"?"rem":""}) `)}),t}function al(){const e={filter:cZ(),width:`calc(100% + ${pt.blur.value*4}rem)`,height:`calc(100% + ${pt.blur.value*4}rem)`,left:`-${pt.blur.value*2}rem`,top:`-${pt.blur.value*2}rem`,position:"absolute"};i(".customBackground img").css(e)}function pZ(){i(".section[data-config-name='customBackgroundFilter'] .blur input").val(pt.blur.value),i(".section[data-config-name='customBackgroundFilter'] .brightness input").val(pt.brightness.value),i(".section[data-config-name='customBackgroundFilter'] .saturate input").val(pt.saturate.value),i(".section[data-config-name='customBackgroundFilter'] .opacity input").val(pt.opacity.value)}function Kc(){i(".section[data-config-name='customBackgroundFilter'] .blur .value").html(pt.blur.value.toFixed(1)),i(".section[data-config-name='customBackgroundFilter'] .brightness .value").html(pt.brightness.value.toFixed(1)),i(".section[data-config-name='customBackgroundFilter'] .saturate .value").html(pt.saturate.value.toFixed(1)),i(".section[data-config-name='customBackgroundFilter'] .opacity .value").html(pt.opacity.value.toFixed(1))}function G1(){pZ(),Kc()}function fZ(t){pt.blur.value=t[0],pt.brightness.value=t[1],pt.saturate.value=t[2],pt.opacity.value=t[3],G1()}i(".section[data-config-name='customBackgroundFilter'] .blur input").on("input",()=>{pt.blur.value=parseFloat(i(".section[data-config-name='customBackgroundFilter'] .blur input").val()),Kc(),al()});i(".section[data-config-name='customBackgroundFilter'] .brightness input").on("input",()=>{pt.brightness.value=parseFloat(i(".section[data-config-name='customBackgroundFilter'] .brightness input").val()),Kc(),al()});i(".section[data-config-name='customBackgroundFilter'] .saturate input").on("input",()=>{pt.saturate.value=parseFloat(i(".section[data-config-name='customBackgroundFilter'] .saturate input").val()),Kc(),al()});i(".section[data-config-name='customBackgroundFilter'] .opacity input").on("input",()=>{pt.opacity.value=parseFloat(i(".section[data-config-name='customBackgroundFilter'] .opacity input").val()),Kc(),al()});i(".section[data-config-name='customBackgroundFilter'] input").on("input",()=>{mZ()});const mZ=Da(2e3,async()=>{const t=Object.keys(pt).map(e=>pt[e].value);Hv(t,!1)});mt((t,e)=>{t==="customBackgroundFilter"&&e&&(fZ(e),al())});let Xt=null,Iy=!1,Qr=0;const Ln=["--bg-color","--main-color","--caret-color","--sub-color","--sub-alt-color","--text-color","--error-color","--error-extra-color","--colorful-error-color","--colorful-error-extra-color"];async function hZ(){setTimeout(async()=>{let t,e;e=await Za("bg"),t=await Za("main"),e===t&&(e="#111",t="#eee");const a=`
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 64">
  <style>
    #bg{fill:${e};}
    path{fill:${t};}
  </style>
  <g>
    <path id="bg" d="M0 16Q0 0 16 0h32q16 0 16 16v32q0 16-16 16H16Q0 64 0 48"/>
    <path d="M9.09 24.1v21.2h5.12V33.1q.256-4.61 4.48-4.61 3.46.384 3.46 3.84v12.9h5.12v-11.5q-.128-5.25 4.48-5.25 3.46.384 3.46 3.84v12.9h5.12v-12.2q0-9.47-7.04-9.47-4.22 0-7.04 3.46-2.18-3.46-6.02-3.46-3.46 0-6.02 2.43v-2.05M47 18.9v5.12h-4.61v5.12H47v16.1h5.12v-16.1h4.61v-5.12h-4.61V18.9"/>
  </g>
</svg>`;i("#favicon").attr("href","data:image/svg+xml;base64,"+btoa(a))},125)}function gZ(){console.debug("Theme controller clearing custom theme");for(const t of Ln)document.documentElement.style.setProperty(t,"")}let vl=[];async function Q1(t){return new Promise(e=>{function a(){console.debug("Theme controller swapping elements");const r=i("#currentTheme"),o=i("#nextTheme");if(o.length===0){console.debug("Theme controller failed to swap elements, next is missing");return}r.remove(),o.attr("id","currentTheme")}console.debug("Theme controller loading style",t),vl.push(setTimeout(()=>{Je()},100)),i("#nextTheme").remove();const s=document.querySelector("#currentTheme"),n=document.createElement("link");n.type="text/css",n.rel="stylesheet",n.id="nextTheme",n.onload=()=>{console.debug("Theme controller loaded style",t),Te(),a(),vl.map(r=>clearTimeout(r)),vl=[],i("#keymap .keymapKey").stop(!0,!0).removeAttr("style"),e()},n.onerror=r=>{console.debug("Theme controller failed to load style",t,r),console.error(`Failed to load theme ${t}`,r),Te(),h("Failed to load theme",0),a(),vl.map(o=>clearTimeout(o)),vl=[],i("#keymap .keymapKey").stop(!0,!0).removeAttr("style"),e()},t==="custom"?n.href="/themes/serika_dark.css":n.href=`/themes/${t}.css`,s===null?(console.debug("Theme controller appending link to the head",n),document.head.appendChild(n)):(console.debug("Theme controller inserting link after current theme",n),s.after(n))})}async function pi(t,e,a=!1){console.debug("Theme controller applying theme",t,e,a),gZ();const s=e?"custom":t;if(dR(),i(".keymapKey").attr("style",""),await Q1(s),$c(),d.customTheme&&!a||e){const r=e??d.customThemeColors;for(let o=0;o<Ln.length;o++){const l=Ln[o];document.documentElement.style.setProperty(l,r[o])}}_n("changedTheme",{theme:s});const n=await Oi();i(".keymapKey").attr("style",""),U1(),hZ(),i("#metaThemeColor").attr("content",n.bg),yZ(a?t:void 0),ek(await Za("bg"))?i("body").addClass("darkMode"):i("body").removeClass("darkMode")}function yZ(t){let e=d.theme;Xt!==null&&(e=Xt),d.customTheme&&(e="custom"),t!==void 0&&t!==""&&(e=t),e=e.replace(/_/g," "),i(".current-theme .text").text(e)}function vZ(t,e){bZ(t,e)}const bZ=Da(250,(t,e)=>{Iy=!0,pi(t,e,!0)});async function sa(t,e=!1){console.debug("Theme controller setting theme",t,e),await pi(t,void 0,e),!e&&d.autoSwitchTheme&&(_S(!1),h("Auto switch theme disabled",0))}async function Xw(t=!0){Iy&&(Iy=!1,t&&(Xt!==null?await pi(Xt):d.customTheme?await pi("custom"):await pi(d.theme)))}let Qa=[];async function Y1(){var e,a;let t;try{t=await tk()}catch(s){console.error(Re(s,"Failed to update random theme list"));return}d.randomTheme==="fav"&&d.favThemes.length>0?Qa=d.favThemes:d.randomTheme==="light"?Qa=t.filter(s=>gA(s.bgColor)).map(s=>s.name):d.randomTheme==="dark"?Qa=t.filter(s=>ek(s.bgColor)).map(s=>s.name):d.randomTheme==="on"?Qa=t.map(s=>s.name):d.randomTheme==="custom"&&S()&&(Qa=((a=(e=S())==null?void 0:e.customThemes)==null?void 0:a.map(s=>s._id))??[]),rd(Qa),Qr=0}async function wZ(){var e,a,s,n,r;if(Qa.length===0&&(await Y1(),Qa.length===0))return;Xt=Qa[Qr],Qr++,Qr>=Qa.length&&(rd(Qa),Qr=0);let t;if(d.randomTheme==="custom"){const o=(a=(e=S())==null?void 0:e.customThemes)==null?void 0:a.find(l=>l._id===Xt);t=o==null?void 0:o.colors,Xt="custom"}if(await pi(Xt,t),Qr>=Qa.length){let o=Xt.replace(/_/g," ");d.randomTheme==="custom"&&(o=(((r=(n=(s=S())==null?void 0:s.customThemes)==null?void 0:n.find(l=>l._id===Xt))==null?void 0:r.name)??"custom").replace(/_/g," ")),h(o,0)}}async function Yh(){Xt!==null&&(Xt=null,d.customTheme?await pi("custom"):await pi(d.theme))}function J1(){d.customBackgroundSize==="max"?i(".customBackground img").css({objectFit:""}):i(".customBackground img").css({objectFit:d.customBackgroundSize})}function kZ(){d.customBackground===""?(i("#words").removeClass("noErrorBorder"),i("#resultWordsHistory").removeClass("noErrorBorder"),i(".customBackground img").remove()):(i("#words").addClass("noErrorBorder"),i("#resultWordsHistory").addClass("noErrorBorder"),i(".customBackground").html(`<img src="${d.customBackground}" alt="" onerror="javascript:window.dispatchEvent(new Event('customBackgroundFailed'))" />`),al(),J1())}var B0,Ep,Z0;(Z0=(Ep=(B0=window.matchMedia)==null?void 0:B0.call(window,"(prefers-color-scheme: dark)"))==null?void 0:Ep.addEventListener)==null||Z0.call(Ep,"change",t=>{!d.autoSwitchTheme||d.customTheme||(t.matches?sa(d.themeDark,!0):sa(d.themeLight,!0))});mt(async(t,e,a)=>{var s,n,r;t==="randomTheme"&&Y1(),t==="customTheme"&&(e?await sa("custom"):await sa(d.theme)),t==="customThemeColors"&&(a?vZ("custom"):await sa("custom")),t==="theme"&&(await Yh(),await Xw(!1),await sa(e)),t==="setThemes"&&(await Yh(),await Xw(!1),d.autoSwitchTheme?(s=window.matchMedia)!=null&&s.call(window,"(prefers-color-scheme: dark)").matches?await sa(d.themeDark,!0):await sa(d.themeLight,!0):e?await sa("custom"):await sa(d.theme)),t==="randomTheme"&&e==="off"&&await Yh(),t==="customBackground"&&kZ(),t==="customBackgroundSize"&&J1(),t==="autoSwitchTheme"&&(e?(n=window.matchMedia)!=null&&n.call(window,"(prefers-color-scheme: dark)").matches?await sa(d.themeDark,!0):await sa(d.themeLight,!0):await sa(d.theme)),t==="themeLight"&&d.autoSwitchTheme&&!((r=window.matchMedia)!=null&&r.call(window,"(prefers-color-scheme: dark)").matches)&&!a&&await sa(d.themeLight,!0),t==="themeDark"&&d.autoSwitchTheme&&window.matchMedia!==void 0&&window.matchMedia("(prefers-color-scheme: dark)").matches&&!a&&await sa(d.themeDark,!0)});window.addEventListener("customBackgroundFailed",()=>{h("Custom background link is either temporairly unavailable or expired. Please make sure the URL is correct or change it",0,{duration:5})});let pe=null,Oy=0;function xZ(t){(!vr||vr&&t>Oy)&&(Oy=t)}async function _Z(){var r;if(d.paceCaret==="off"&&!vr||(i("#paceCaret").hasClass("hidden")||i("#paceCaret").addClass("hidden"),d.mode==="zen"))return;const t=i("#paceCaret"),e=(r=document==null?void 0:document.querySelector("#words .word"))==null?void 0:r.querySelector("letter"),a=i(e).height();if(e===void 0||a===void 0)return;const n=(await Ii(d.language)).rightToLeft;t.stop(!0,!0).animate({top:e.offsetTop-a/4,left:e.offsetLeft+(n?e.offsetWidth:0)},0,"linear")}async function X1(){i("#paceCaret").addClass("hidden");const t=Zm(d,ze);let e;if(d.paceCaret==="pb"?e=await Of(d.mode,t,d.punctuation,d.numbers,d.language,d.difficulty,d.lazyMode,d.funbox):d.paceCaret==="tagPb"?e=await JP(d.mode,t,d.punctuation,d.numbers,d.language,d.difficulty,d.lazyMode):d.paceCaret==="average"?([e]=await Nx(d.mode,t,d.punctuation,d.numbers,d.language,d.difficulty,d.lazyMode),e=Math.round(e)):d.paceCaret==="daily"?(e=await YP(d.mode,t,d.punctuation,d.numbers,d.language,d.difficulty,d.lazyMode),e=Math.round(e)):d.paceCaret==="custom"?e=d.paceCaretCustomSpeed:(d.paceCaret==="last"||vr)&&(e=Oy),e===void 0||e<1||Number.isNaN(e)){pe=null;return}const a=e*5,s=a/60,n=60/a;pe={wpm:e,cps:s,spc:n,correction:0,currentWordIndex:0,currentLetterIndex:-1,wordsStatus:{},timeout:null},await _Z()}async function eT(t){if(!(pe===null||!$t||It)){try{if(pe.currentLetterIndex++,pe.currentLetterIndex>=E.get(pe.currentWordIndex).length&&(pe.currentLetterIndex=-1,pe.currentWordIndex++),!d.blindMode){if(pe.correction<0)for(;pe.correction<0;)pe.currentLetterIndex--,pe.currentLetterIndex<=-2&&(pe.currentLetterIndex=E.get(pe.currentWordIndex-1).length-1,pe.currentWordIndex--),pe.correction++;else if(pe.correction>0)for(;pe.correction>0;)pe.currentLetterIndex++,pe.currentLetterIndex>=E.get(pe.currentWordIndex).length&&(pe.currentLetterIndex=-1,pe.currentWordIndex++),pe.correction--}}catch{pe=null,i("#paceCaret").addClass("hidden");return}try{const e=i("#paceCaret");let a,s,n;try{const o=pe.currentWordIndex-(E.currentIndex-Pt),l=document.querySelectorAll("#words .word")[o];pe.currentLetterIndex===-1?a=l.querySelectorAll("letter")[0]:a=l.querySelectorAll("letter")[pe.currentLetterIndex];const u=i(a).height(),c=i(a).width(),p=e.width();if(u===void 0||c===void 0||p===void 0)throw new Error("Undefined current letter height, width or caret width.");const m=(await Ii(d.language)).rightToLeft;s=l.offsetTop+a.offsetTop-d.fontSize*fr(1)*.1,pe.currentLetterIndex===-1?n=l.offsetLeft+a.offsetLeft-p/2+(m?c:0):n=l.offsetLeft+a.offsetLeft-p/2+(m?0:c),e.removeClass("hidden")}catch{e.addClass("hidden")}const r=t-performance.now();if(s!==void 0){let o=i("#words .smoothScroller").height();o===void 0&&(o=0),i("#paceCaret").css({top:s-o}),d.smoothCaret!=="off"?e.stop(!0,!0).animate({left:n},Ct()?0:r,"linear"):e.stop(!0,!0).animate({left:n},0,"linear")}pe.timeout=setTimeout(()=>{eT(t+((pe==null?void 0:pe.spc)??0)*1e3).catch(()=>{pe=null})},r)}catch(e){console.error(e),i("#paceCaret").addClass("hidden")}}}function CZ(){(pe==null?void 0:pe.timeout)!=null&&clearTimeout(pe.timeout),pe=null}function e0(t,e){t?pe!==null&&pe.wordsStatus[E.currentIndex]===!0&&!d.blindMode&&(pe.wordsStatus[E.currentIndex]=void 0,pe.correction-=e.length+1):pe!==null&&pe.wordsStatus[E.currentIndex]===void 0&&!d.blindMode&&(pe.wordsStatus[E.currentIndex]=!0,pe.correction+=e.length+1)}function SZ(){eT(performance.now()+((pe==null?void 0:pe.spc)??0)*1e3)}mt(t=>{t==="paceCaret"&&X1()});mt(t=>{t==="monkey"&&$t&&(d.monkey?i("#monkey").removeClass("hidden"):i("#monkey").addClass("hidden"))});let ic=!1,rc=!1;const Jh={"00":document.querySelector("#monkey .up"),"01":document.querySelector("#monkey .right"),10:document.querySelector("#monkey .left"),11:document.querySelector("#monkey .both")},Xh={"00":document.querySelector("#monkey .fast .up"),"01":document.querySelector("#monkey .fast .right"),10:document.querySelector("#monkey .fast .left"),11:document.querySelector("#monkey .fast .both")};let eg="right";function t0(t){return t?"1":"0"}function tT(){var t,e,a;if(d.monkey&&!((t=document.querySelector("#monkey"))!=null&&t.classList.contains("hidden"))){Object.keys(Jh).forEach(n=>{var r;(r=Jh[n])==null||r.classList.add("hidden")}),Object.keys(Xh).forEach(n=>{var r;(r=Xh[n])==null||r.classList.add("hidden")});const s=`${t0(ic)}${t0(rc)}`;(e=Jh[s])==null||e.classList.remove("hidden"),(a=Xh[s])==null||a.classList.remove("hidden")}}function TZ(t){if(!d.monkey)return;const e=af(t,130,180,0,1);i("#monkey .fast").animate({opacity:e},1e3);let a=af(t,130,180,.25,.01);a===.25&&(a=0),i("#monkey").css({animationDuration:a+"s"})}function $Z(){d.monkey&&(!ic&&eg==="right"?(ic=!0,eg="left"):rc||(rc=!0,eg="right"),tT())}function AZ(){d.monkey&&(ic?ic=!1:rc&&(rc=!1),tT())}function MZ(){d.monkey&&i("#monkey").css("opacity",0).removeClass("hidden").animate({opacity:1},125)}function aT(){i("#monkey").css("opacity",1).animate({opacity:1},125,()=>{i("#monkey").addClass("hidden"),i("#monkey .fast").stop(!0,!0).css("opacity",0),i("#monkey").stop(!0,!0).css({animationDuration:"0s"})})}const sT=[];function LZ(t){sT.push(t)}function oc(t,e,a){sT.forEach(s=>{try{s(t,e,a)}catch(n){console.error("Timer event subscriber threw an error"),console.error(n)}})}let Ui=0,vs=null;const yp=1e3;let vp=0,kt=!1;function EZ(){kt=!0}function Tb(){gB(0),vs!==null&&clearTimeout(vs)}function IZ(){kt&&console.time("premid");const t=document.querySelector("#premidSecondsLeft");t!==null&&(t.innerHTML=(d.time-sc()).toString()),kt&&console.timeEnd("premid")}function OZ(){kt&&console.time("timer progress update"),(d.mode==="time"||d.mode==="custom"&&St()==="time")&&zc(),kt&&console.timeEnd("timer progress update")}function PZ(){kt&&console.time("calculate wpm and raw");const t=hb();return kt&&console.timeEnd("calculate wpm and raw"),kt&&console.time("update live wpm"),dB(t.wpm,t.raw),kt&&console.timeEnd("update live wpm"),kt&&console.time("push to history"),HS(t.wpm),zS(t.raw),kt&&console.timeEnd("push to history"),t}function RZ(t){kt&&console.time("update monkey");const e=d.blindMode?t.raw:t.wpm;TZ(e),kt&&console.timeEnd("update monkey")}function DZ(){kt&&console.time("calculate acc");const t=we(Hc());return kt&&console.timeEnd("calculate acc"),t}function NZ(){if(kt&&console.time("layoutfluid"),d.funbox.split("#").includes("layoutfluid")&&d.mode==="time"){const t=d.customLayoutfluid?d.customLayoutfluid.split("#"):["qwerty","dvorak","colemak"],e=d.time/t.length,a=sc(),s=Math.floor(a/e),n=t[s],r=[];for(let o=1;o<t.length;o++)r.push(Math.floor(e*o));r.includes(a+3)?(q1(),Gh(3,t[s+1])):r.includes(a+2)?Gh(2,t[s+1]):r.includes(a+1)&&Gh(1,t[s+1]),d.layout!==n&&n!==void 0&&(ed(),nr(n,!0),sr(n,!0))}kt&&console.timeEnd("layoutfluid")}function WZ(t,e){if(kt&&console.time("fail conditions"),Um(),Qm(),Gm(),d.minWpm==="custom"&&t.wpm<d.minWpmCustomSpeed&&E.currentIndex>3){vs!==null&&clearTimeout(vs),ou(),Ui=0,oc("fail","min speed");return}if(d.minAcc==="custom"&&e<d.minAccCustom){vs!==null&&clearTimeout(vs),ou(),Ui=0,oc("fail","min accuracy");return}kt&&console.timeEnd("fail conditions")}function BZ(){if(kt&&console.time("times up check"),(d.mode==="time"||d.mode==="custom"&&St()==="time")&&(sc()>=d.time&&d.time!==0&&d.mode==="time"||sc()>=gt()&&gt()!==0&&d.mode==="custom")){vs!==null&&clearTimeout(vs),Bc(),T.pushHistory(),Dt.pushHistory(),ou(),Ui=0,oc("finish");return}kt&&console.timeEnd("times up check")}let Py=[];function ZZ(){return Py}async function qZ(){kt&&console.time("timer step -----------------------------"),yB(),IZ(),OZ();const t=PZ(),e=DZ();RZ(t),NZ(),WZ(t,e),BZ(),kt&&console.timeEnd("timer step -----------------------------")}async function FZ(){ou(),Ui=0,Py=[],vp=Sr+yp,function t(){const e=vp-performance.now();Py.push({dateNow:Date.now(),now:performance.now(),expected:vp,nextDelay:e}),(d.mode==="time"&&d.time<130&&d.time>0||d.mode==="words"&&d.words<250&&d.words>0)&&(e<yp/2&&uR(),e<yp/10&&(Ui++,Ui>5&&(h('This could be caused by "efficiency mode" on Microsoft Edge.'),h("Stopping the test due to bad performance. This would cause test calculations to be incorrect. If this happens a lot, please report this.",-1),oc("fail","slow timer")))),vs=setTimeout(function(){if(!$t){vs!==null&&clearTimeout(vs),ou(),Ui=0;return}qZ(),vp+=yp,t()},e)}()}let lc=0,$b=!1,nT;function jZ(t){if($b&&new Date().getDate()>nT){lc=t;return}lc+=t}function HZ(){return Ta(Math.round(lc),!0,!0)+($b?" today":" session")}function zZ(){const t=new Date;t.setSeconds(0),t.setMinutes(0),t.setHours(0),t.setMilliseconds(0),nT=t.getDate();const e=t.getTime();lc=0;const a=S();if(!a)return;const s=a.results;s==null||s.forEach(n=>{const r=new Date(n.timestamp);r.setSeconds(0),r.setMinutes(0),r.setHours(0),r.setMilliseconds(0),r.getTime()>=e&&(lc+=n.testDuration+n.incompleteTestSeconds-n.afkDuration)}),$b=!0}let Ry=!1;function iT(){wa&&!Ry&&!Ra&&(h("Challenge cleared",0),Rx(null))}function KZ(t){var e,a,s;try{if(wa){const n=t.afkDuration/t.testDuration*100;if(n>10)return h("Challenge failed: AFK time is greater than 10%",0),null;if(wa.requirements===void 0)return h(`${wa.display} challenge passed!`,1),wa.name;{let r=!0;const o=[];for(const l in wa.requirements){if(!r)return null;const u=wa.requirements[l];if(u===void 0)throw new Error("Requirement value is undefined");if(l==="wpm"){const c=Object.keys(u)[0];c==="exact"?Math.round(t.wpm)!==u.exact&&(r=!1,o.push(`WPM not ${u.exact}`)):c==="min"&&t.wpm<Number(u.min)&&(r=!1,o.push(`WPM below ${u.min}`))}else if(l==="acc"){const c=Object.keys(u)[0];c==="exact"?t.acc!==u.exact&&(r=!1,o.push(`Accuracy not ${u.exact}`)):c==="min"&&t.acc<Number(u.min)&&(r=!1,o.push(`Accuracy below ${u.min}`))}else if(l==="afk")Object.keys(u)[0]==="max"&&Math.round(n)>Number(u.max)&&(r=!1,o.push(`AFK percentage above ${u.max}`));else if(l==="time")Object.keys(u)[0]==="min"&&Math.round(t.testDuration)<Number(u.min)&&(r=!1,o.push(`Test time below ${u.min}`));else if(l==="funbox"){const c=(e=u.exact)==null?void 0:e.toString().split("#").sort().join("#");if(c===void 0)throw new Error("Funbox mode is undefined");if(c!==t.funbox){r=!1;for(const f of c.split("#"))((a=t.funbox)==null?void 0:a.split("#").find(m=>m===f))===void 0&&o.push(`${f} funbox not active`);const p=(s=t.funbox)==null?void 0:s.split("#");if(p!==void 0&&p.length>0)for(const f of p)c.split("#").find(m=>m===f)===void 0&&o.push(`${f} funbox active`)}}else if(l==="raw")Object.keys(u)[0]==="exact"&&Math.round(t.rawWpm)!==u.exact&&(r=!1,o.push(`Raw WPM not ${u.exact}`));else if(l==="con")Object.keys(u)[0]==="exact"&&Math.round(t.consistency)!==u.exact&&(r=!1,o.push(`Consistency not ${u.exact}`));else if(l==="config")for(const c in u){const p=u[c];d[c]!==p&&(r=!1,o.push(`${c} not set to ${p}`))}}return r?(wa.autoRole&&h("You will receive a role shortly. Please don't post a screenshot in challenge submissions.",1,{duration:5}),h(`${wa.display} challenge passed!`,1),wa.name):(h(`${wa.display} challenge failed: ${o.join(", ")}`,0),null)}}else return null}catch(n){return console.error(n),h(`Something went wrong when verifying challenge: ${n.message}`,0),null}}async function VZ(t){Ry=!0,pn("none");let e;try{e=await yA()}catch(n){const r=Re(n,"Failed to setup challenge");return h(r,-1),tt(),setTimeout(()=>{i("header .config").removeClass("hidden"),i(".page.pageTest").removeClass("hidden")},250),!1}const a=e.filter(n=>n.name.toLowerCase()===t.toLowerCase())[0];let s;try{if(a===void 0)return h("Challenge not found",0),tt(),setTimeout(()=>{i("header .config").removeClass("hidden"),i(".page.pageTest").removeClass("hidden")},250),!1;if(a.type==="customTime")Ws(a.parameters[0],!0),zt("time",!0),Ps("normal",!0),a.name==="englishMaster"&&(No("english_10k",!0),os(!0,!0),tn(!0,!0));else if(a.type==="customWords")Ti(a.parameters[0],!0),zt("words",!0),Ps("normal",!0);else if(a.type==="customText")Tn(a.parameters[0].split(" ")),Uu(a.parameters[1]),ir(a.parameters[2]),ci(a.parameters[3]),Wo(a.parameters[4]),zt("custom",!0),Ps("normal",!0);else if(a.type==="script"){Je();const n=await fetch("/challenges/"+a.parameters[0]);if(Te(),n.status!==200)throw new Error(`${n.status} ${n.statusText}`);let o=(await n.text()).trim();o=o.replace(/[\n\r\t ]/gm," "),o=o.replace(/ +/gm," "),Tn(o.split(" ")),Uu("repeat"),ci("word"),Wo(!1),zt("custom",!0),Ps("normal",!0),a.parameters[1]!==null&&CS(a.parameters[1]),a.parameters[2]!==null&&Sb(a.parameters[2])}else a.type==="accuracy"?(Ws(0,!0),zt("time",!0),Ps("master",!0)):a.type==="funbox"?(pn(a.parameters[0],!0),Ps("normal",!0),a.parameters[1]==="words"?Ti(a.parameters[2],!0):a.parameters[1]==="time"&&Ws(a.parameters[2],!0),zt(a.parameters[1],!0),a.parameters[3]!==void 0&&Ps(a.parameters[3],!0)):a.type==="special"&&a.name==="semimak"&&(zt("time",!0),Ws(120,!0),No("english_10k",!0),tn(!0,!0),Dv("word",!0),nr("semimak",!0),sr("overrideSync",!0),Cs("static",!0));return tt(),s=a.message,i("header .config").removeClass("hidden"),i(".page.pageTest").removeClass("hidden"),s===void 0?h(`Challenge '${a.display}' loaded.`,0):h("Challenge loaded. "+s,0),Rx(a),Ry=!1,!0}catch(n){return h(Re(n,"Failed to load challenge"),-1),!1}}mt(t=>{["difficulty","numbers","punctuation","mode","funbox","paceCaret","showAllLines","showLiveWpm","highlightMode","time","words","keymapMode","keymapLayout","layout"].includes(t)&&iT()});let hs=0,Ke=null,ht=null;function UZ(){Ke=null}function GZ(){i("#quoteRateModal .quote .text").text("-"),i("#quoteRateModal .quote .source .val").text("-"),i("#quoteRateModal .quote .id .val").text("-"),i("#quoteRateModal .quote .length .val").text("-"),i("#quoteRateModal .ratingCount .val").text("-"),i("#quoteRateModal .ratingAverage .val").text("-")}function rT(t){return!t.totalRating||!t.ratings?0:Math.round(t.totalRating/t.ratings*10)/10}async function oT(t){if(!t)return;ht=t;const e=await Z.quotes.getRating(ht);if(Te(),e.status!==200){h("Failed to get quote ratings: "+e.message,-1);return}return e.data===null?{}:(Ke=e.data,Ke!==void 0&&!Ke.average&&(Ke.average=rT(Ke)),Ke)}function Qp(t){const e=t||hs;i("#quoteRateModal .star").removeClass("active");for(let a=1;a<=e;a++)i(`#quoteRateModal .star[data-rating=${a}]`).addClass("active")}async function QZ(){var t;Ke||await oT(),i("#quoteRateModal .ratingCount .val").text((Ke==null?void 0:Ke.ratings)??"0"),i("#quoteRateModal .ratingAverage .val").text(((t=Ke==null?void 0:Ke.average)==null?void 0:t.toFixed(1))??"-")}function YZ(){if(!ht)return;let t;ht.group===0?t="short":ht.group===1?t="medium":ht.group===2?t="long":ht.group===3&&(t="thicc"),i("#quoteRateModal .quote .text").text(ht.text),i("#quoteRateModal .quote .source .val").text(ht.source),i("#quoteRateModal .quote .id .val").text(ht.id),i("#quoteRateModal .quote .length .val").text(t),QZ()}function JZ(t,e){lT.show({...e,beforeAnimation:async()=>{var n,r;GZ(),ht=t,hs=0;const a=S(),s=(r=(n=a==null?void 0:a.quoteRatings)==null?void 0:n[ht.language])==null?void 0:r[ht.id];s&&(hs=s),Qp(),YZ()}})}function XZ(t=!1){lT.hide({clearModalChain:t})}async function eq(){var n,r;if(hs===0){h("Please select a rating");return}if(!ht)return;XZ(!0);const t=await Z.quotes.addRating(ht,hs);if(Te(),t.status!==200){h("Failed to submit quote rating: "+t.message,-1);return}const e=S();if(!e)return;const a=e.quoteRatings??{},s=(a==null?void 0:a[ht.language])??{};if(s!=null&&s[ht.id]){const o=(n=a[ht.language])==null?void 0:n[ht.id],l=hs-o;s[ht.id]=hs,Ke={ratings:Ke==null?void 0:Ke.ratings,totalRating:isNaN(Ke==null?void 0:Ke.totalRating)?0:(Ke==null?void 0:Ke.totalRating)+l,quoteId:ht.id,language:ht.language},h("Rating updated",1)}else s[ht.id]=hs,Ke!=null&&Ke.ratings&&Ke.totalRating?(Ke.ratings++,Ke.totalRating+=hs):Ke={ratings:1,totalRating:hs,quoteId:ht.id,language:ht.language},h("Rating submitted",1);e.quoteRatings=a,aa(e),Ke.average=rT(Ke),i(".pageTest #result #rateQuoteButton .rating").text((r=Ke.average)==null?void 0:r.toFixed(1)),i(".pageTest #result #rateQuoteButton .icon").removeClass("far"),i(".pageTest #result #rateQuoteButton .icon").addClass("fas")}async function tq(t){var a;(a=t.querySelector(".submitButton"))==null||a.addEventListener("click",()=>{eq()});const e=t.querySelectorAll(".stars button.star");for(const s of e)s.addEventListener("click",n=>{hs=parseInt(n.currentTarget.getAttribute("data-rating")),Qp()}),s.addEventListener("mouseenter",n=>{const r=parseInt(n.currentTarget.getAttribute("data-rating"));Qp(r)}),s.addEventListener("mouseleave",()=>{Qp()})}const lT=new et({dialogId:"quoteRateModal",setup:tq}),aq=[{type:"leaderboard_atf",selectorId:"ad-result-wrapper"},{type:"med_rect_btf",selectorId:"ad-result-small-wrapper"}],sq=[{type:"leaderboard_atf",selectorId:"ad-result-wrapper"},{type:"med_rect_btf",selectorId:"ad-result-small-wrapper"},{type:"sky_btf",selectorId:"ad-vertical-right-wrapper"},{type:"sky_btf",selectorId:"ad-vertical-left-wrapper"}],nq=[{type:"leaderboard_atf",selectorId:"ad-result-wrapper"},{type:"med_rect_btf",selectorId:"ad-result-small-wrapper"},{type:"sky_btf",selectorId:"ad-vertical-right-wrapper"},{type:"sky_btf",selectorId:"ad-vertical-left-wrapper"},{type:"leaderboard_btf",selectorId:"ad-footer-wrapper"},{type:"med_rect_btf",selectorId:"ad-footer-small-wrapper"},{type:"leaderboard_btf",selectorId:"ad-about-1-wrapper"},{type:"med_rect_btf",selectorId:"ad-about-1-small-wrapper"},{type:"leaderboard_btf",selectorId:"ad-about-2-wrapper"},{type:"med_rect_btf",selectorId:"ad-about-2-small-wrapper"},{type:"leaderboard_btf",selectorId:"ad-settings-1-wrapper"},{type:"med_rect_btf",selectorId:"ad-settings-1-small-wrapper"},{type:"leaderboard_btf",selectorId:"ad-settings-2-wrapper"},{type:"med_rect_btf",selectorId:"ad-settings-2-small-wrapper"},{type:"leaderboard_btf",selectorId:"ad-settings-3-wrapper"},{type:"med_rect_btf",selectorId:"ad-settings-3-small-wrapper"},{type:"leaderboard_btf",selectorId:"ad-account-1-wrapper"},{type:"med_rect_btf",selectorId:"ad-account-1-small-wrapper"},{type:"leaderboard_btf",selectorId:"ad-account-2-wrapper"},{type:"med_rect_btf",selectorId:"ad-account-2-small-wrapper"}];let ph=!1;function iq(){const t="1024888",e="74058";window.ramp={que:[],passiveMode:!0,forcePath:"320x50-test",onReady:()=>{ph=!0,fh()}};const a=document.getElementsByTagName("head")[0],s=document.createElement("script");s.setAttribute("async",!0),s.src=`//cdn.intergient.com/${t}/${e}/ramp.js`,a.appendChild(s),window._pwGA4PageviewId="".concat(Date.now()),window.dataLayer=window.dataLayer||[],window.gtag=window.gtag||function(){dataLayer.push(arguments)},gtag("js",new Date),gtag("config","G-KETCPNHRJF",{send_page_view:!1}),gtag("event","ramp_js",{send_to:"G-KETCPNHRJF",pageview_id:window._pwGA4PageviewId})}function dT(){let t;d.ads==="result"?t=aq:d.ads==="on"?t=sq:d.ads==="sellout"&&(t=nq);const e=[];for(const a of t){const s=document.querySelector(`#${a.selectorId}`);s&&window.getComputedStyle(s).display!=="none"&&s.offsetParent!==null&&e.push(a)}return e}async function fh(){if(ph){if(Xe()==="test"&&!It){ramp.destroyUnits("all");return}await ramp.destroyUnits("all"),await ramp.addUnits(dT()),await ramp.displayUnits()}}async function rq(){}function oq(){ph&&ramp.destroyUnits("all")}async function lq(){if(!ph)return;const t=dT();await ramp.addUnits(t),await ramp.displayUnits()}const dq=900;let bp=!0;const uq=1330;let wp=!0,Vc=!1,mh,dc;function uT(){iq(),setInterval(()=>{$t||rq()},6e4),Vc=!0}function cq(){Dy(),cT(),pq()}function Dy(){i("#ad-footer-wrapper").remove(),i("#ad-footer-small-wrapper").remove(),i("#ad-about-1-wrapper").remove(),i("#ad-about-1-small-wrapper").remove(),i("#ad-about-2-wrapper").remove(),i("#ad-about-2-small-wrapper").remove(),i("#ad-settings-1-wrapper").remove(),i("#ad-settings-1-small-wrapper").remove(),i("#ad-settings-2-wrapper").remove(),i("#ad-settings-2-small-wrapper").remove(),i("#ad-settings-3-wrapper").remove(),i("#ad-settings-3-small-wrapper").remove(),i("#ad-account-1-wrapper").remove(),i("#ad-account-1-small-wrapper").remove(),i("#ad-account-2-wrapper").remove(),i("#ad-account-2-small-wrapper").remove()}function cT(){i("#ad-vertical-right-wrapper").remove(),i("#ad-vertical-left-wrapper").remove()}function pq(){i("#ad-result-wrapper").remove(),i("#ad-result-small-wrapper").remove()}function fq(){}function pT(t=!1){const e=bp;window.innerWidth>dq?bp=!0:bp=!1,!t&&(d.ads==="off"||!Vc||e!==bp&&fh())}function fT(t=!1){const e=wp;window.innerWidth>uq?wp=!0:wp=!1,!t&&(d.ads==="off"||!Vc||e!==wp&&fh())}async function Ab(){return new Promise(t=>{window.ramp===void 0&&(mh=!0),t()})}async function Mb(){return new Promise(t=>{if(dc===void 0){dc=!1,t();return}t()})}async function mq(){return d.ads==="off"?!1:Vc?(await Ab(),await Mb(),mh||dc?!1:fh()):(uT(),!0)}async function hq(){if(d.ads!=="off"){if(Vc||uT(),await Ab(),await Mb(),mh){i("#ad-result-wrapper .iconAndText .text").html(`
    Using an ad blocker? No worries
    <div class="smalltext">
      We understand ads can be annoying
      <br />
      You can
      <i>disable all ads</i>
      in the settings
    </div>
    `);return}if(dc){i("#ad-result-wrapper .iconAndText .text").html(`
    Ads not working? Ooops
    <div class="smalltext">
      You may have a cookie popup blocker enabled - ads will not show without your consent
      <br />
      You can also 
      <i>disable all ads</i>
      in the settings if you wish
    </div>
    `);return}lq()}}function wm(t){t?(i("#ad-vertical-left-wrapper").removeClass("testPage"),i("#ad-vertical-right-wrapper").removeClass("testPage"),i("#ad-footer-wrapper").removeClass("testPage"),i("#ad-footer-small-wrapper").removeClass("testPage")):(i("#ad-vertical-left-wrapper").addClass("testPage"),i("#ad-vertical-right-wrapper").addClass("testPage"),i("#ad-footer-wrapper").addClass("testPage"),i("#ad-footer-small-wrapper").addClass("testPage"))}function gq(){ramp.showCmpModal()}function yq(){oq()}const vq=Da(500,fq),bq=Da(500,pT),wq=Da(500,fT);i(window).on("resize",()=>{vq(),bq(),wq()});mt((t,e)=>{t==="ads"&&(e==="off"?cq():e==="result"?(Dy(),cT()):e==="on"&&Dy())});$M(()=>{});i(document).ready(()=>{pT(!0),fT()});window.onerror=function(t){};const tg={quotes:[],length:0,language:null,groups:[]};class kq{constructor(){this.quoteCollection=tg,this.quoteQueue=[],this.queueIndex=0}async getQuotes(e,a){var n;const s=Ds(e);if(this.quoteCollection.language!==s){let r;try{r=await ak(`quotes/${s}.json`)}catch(o){if(o instanceof Error&&((n=o==null?void 0:o.message)!=null&&n.includes("404")))return tg;throw o}if(r.quotes===void 0||r.quotes.length===0)return tg;this.quoteCollection={quotes:[],length:r.quotes.length,groups:[],language:r.language},r.quotes.forEach(o=>{const l={text:o.text,britishText:o.britishText,source:o.source,length:o.length,id:o.id,language:r.language,group:0};this.quoteCollection.quotes.push(l)}),r.groups.forEach((o,l)=>{const u=o[0],c=o[1];this.quoteCollection.groups[l]=this.quoteCollection.quotes.filter(p=>p.length>=u&&p.length<=c?(p.group=l,!0):!1)}),a!==void 0&&this.updateQuoteQueue(a)}return this.quoteCollection}getQuoteById(e){return this.quoteCollection.quotes.find(s=>s.id===e)}updateQuoteQueue(e){this.quoteQueue=[],e.forEach(a=>{var s;a<0||(s=this.quoteCollection.groups[a])==null||s.forEach(n=>{this.quoteQueue.push(n)})}),rd(this.quoteQueue),this.queueIndex=0}getRandomQuote(){if(this.quoteQueue.length===0)return null;this.queueIndex>=this.quoteQueue.length&&(this.queueIndex=0,rd(this.quoteQueue));const e=this.quoteQueue[this.queueIndex];return this.queueIndex+=1,e}getRandomFavoriteQuote(e){const a=S();if(!a)return null;const s=Ds(e),n=[],{favoriteQuotes:r}=a;if(r===void 0||(Object.keys(r).forEach(u=>{Ds(u)===s&&n.push(...r[u]??[])}),n.length===0))return null;const o=Hs(n);return this.getQuoteById(parseInt(o,10))??null}isQuoteFavorite({language:e,id:a}){const s=S();if(!s)return!1;const{favoriteQuotes:n}=s;if(n===void 0)return!1;const r=Ds(e);return Object.keys(n).find(l=>r!==Ds(l)?!1:(n[l]??[]).includes(a.toString()))!==void 0}async setQuoteFavorite(e,a){var n,r,o,l,u;const s=S();if(!s)throw new Error("Snapshot is not available");if(a){const c=await Z.users.addQuoteToFavorites(e.language,`${e.id}`);if(c.status===200)s.favoriteQuotes===void 0&&(s.favoriteQuotes={}),s.favoriteQuotes[e.language]||(s.favoriteQuotes[e.language]=[]),(u=s.favoriteQuotes[e.language])==null||u.push(`${e.id}`);else throw new Error(c.message)}else{const c=await Z.users.removeQuoteFromFavorites(e.language,`${e.id}`);if(c.status===200){const p=(r=(n=s.favoriteQuotes)==null?void 0:n[e.language])==null?void 0:r.indexOf(`${e.id}`);(l=(o=s.favoriteQuotes)==null?void 0:o[e.language])==null||l.splice(p,1)}else throw new Error(c.message)}}}const ja=new kq;mt((t,e)=>{t==="quoteLength"&&ja.updateQuoteQueue(e)});let mT=!1;function a0(){return mT}function xq(){mT=!0,console.log("Glarses Mode On - test result will be hidden. You can check the stats in the console (here)"),console.log("To disable Glarses Mode refresh the page.")}function _q(){Ny=!1,i("#result .stats .wpm .crown").css("opacity",0).addClass("hidden")}let Ny=!1,hT="normal";function Cq(){return hT}function gT(){if(Ny)return;Ny=!0,i("#result .stats .wpm .crown").removeClass("hidden").css("opacity","0").animate({opacity:1},250,"easeOutCubic")}function yT(t){hT=t;const e=i("#result .stats .wpm .crown");e.removeClass("ineligible"),e.removeClass("pending"),e.removeClass("error"),e.removeClass("warning"),e.addClass(t)}function Sq(){i("#testConfig").removeClass("invisible"),i("#mobileTestConfigButton").removeClass("invisible")}function Tq(){i("#testConfig").addClass("invisible"),i("#mobileTestConfigButton").addClass("invisible")}async function $q(){i("#testConfig .mode .textButton").removeClass("active"),i("#testConfig .mode .textButton[mode='"+d.mode+"']").addClass("active"),i("#testConfig .puncAndNum").addClass("hidden"),i("#testConfig .spacer").addClass("scrolled"),i("#testConfig .time").addClass("hidden"),i("#testConfig .wordCount").addClass("hidden"),i("#testConfig .customText").addClass("hidden"),i("#testConfig .quoteLength").addClass("hidden"),i("#testConfig .zen").addClass("hidden"),d.mode==="time"?(i("#testConfig .puncAndNum").removeClass("hidden"),i("#testConfig .leftSpacer").removeClass("scrolled"),i("#testConfig .rightSpacer").removeClass("scrolled"),i("#testConfig .time").removeClass("hidden"),zi("time",d.time)):d.mode==="words"?(i("#testConfig .puncAndNum").removeClass("hidden"),i("#testConfig .leftSpacer").removeClass("scrolled"),i("#testConfig .rightSpacer").removeClass("scrolled"),i("#testConfig .wordCount").removeClass("hidden"),zi("words",d.words)):d.mode==="quote"?(i("#testConfig .rightSpacer").removeClass("scrolled"),i("#testConfig .quoteLength").removeClass("hidden"),zi("quoteLength",d.quoteLength)):d.mode==="custom"&&(i("#testConfig .puncAndNum").removeClass("hidden"),i("#testConfig .leftSpacer").removeClass("scrolled"),i("#testConfig .rightSpacer").removeClass("scrolled"),i("#testConfig .customText").removeClass("hidden")),zi("numbers",d.numbers),zi("punctuation",d.punctuation)}async function Aq(t,e){var g,y,v;if(t===e)return;i("#testConfig .mode .textButton").removeClass("active"),i("#testConfig .mode .textButton[mode='"+e+"']").addClass("active");const a={time:"time",words:"wordCount",custom:"customText",quote:"quoteLength",zen:"zen"},s=250,n={both:"easeInOutSine",in:"easeInSine",out:"easeOutSine"},r={time:!0,words:!0,custom:!0,quote:!1,zen:!1},o=i("#testConfig .puncAndNum");if(r[e]!==r[t]){r[e]?i("#testConfig .leftSpacer").removeClass("scrolled"):i("#testConfig .leftSpacer").addClass("scrolled"),o.css({width:"unset",opacity:1}).removeClass("hidden");const A=Math.round(((g=o[0])==null?void 0:g.getBoundingClientRect().width)??0);o.css({width:r[t]?A:0,opacity:r[t]?1:0}).animate({width:r[e]?A:0,opacity:r[e]?1:0},s,n.both,()=>{r[e]?o.css("width","unset"):o.addClass("hidden")})}e==="zen"?i("#testConfig .rightSpacer").addClass("scrolled"):i("#testConfig .rightSpacer").removeClass("scrolled");const l=i(`#testConfig .${a[e]}`),u=i(`#testConfig .${a[t]}`),c=Math.round(((y=u[0])==null?void 0:y.getBoundingClientRect().width)??0);u.addClass("hidden"),l.removeClass("hidden");const p=Math.round(((v=l[0])==null?void 0:v.getBoundingClientRect().width)??0);u.removeClass("hidden"),l.addClass("hidden");const m=(p-c)/2;u.css({opacity:1,width:c}).animate({width:c+m,opacity:0},s/2,n.in,()=>{u.css({opacity:1,width:"unset"}).addClass("hidden"),l.css({opacity:0,width:c+m}).removeClass("hidden").animate({opacity:1,width:p},s/2,n.out,()=>{l.css("width","unset")})})}function zi(t,e){if(t==="time"){i("#testConfig .time .textButton").removeClass("active");const a=[15,30,60,120].includes(e)?e:"custom";i("#testConfig .time .textButton[timeConfig='"+a+"']").addClass("active")}else if(t==="words"){i("#testConfig .wordCount .textButton").removeClass("active");const a=[10,25,50,100,200].includes(e)?e:"custom";i("#testConfig .wordCount .textButton[wordCount='"+a+"']").addClass("active")}else t==="quoteLength"?(i("#testConfig .quoteLength .textButton").removeClass("active"),e.forEach(a=>{i("#testConfig .quoteLength .textButton[quoteLength='"+a+"']").addClass("active")})):t==="numbers"?e===!1?i("#testConfig .numbersMode.textButton").removeClass("active"):i("#testConfig .numbersMode.textButton").addClass("active"):t==="punctuation"&&(e===!1?i("#testConfig .punctuationMode.textButton").removeClass("active"):i("#testConfig .punctuationMode.textButton").addClass("active"))}function Mq(){i("#testConfig .quoteLength .favorite").removeClass("hidden")}function Lq(){i("#testConfig .quoteLength .favorite").addClass("hidden")}mt((t,e,a,s)=>{if(Xe()==="test")if(t==="mode"){Aq(s,e);let n;d.mode==="time"?n=d.time:d.mode==="words"?n=d.words:d.mode==="quote"&&(n=d.quoteLength),n!==void 0&&zi(d.mode,n)}else["time","quoteLength","words","numbers","punctuation"].includes(t)&&e!==void 0&&zi(t,e)});let B,ti,Yp=!1,on="",Yr="";function Eq(){Yp=!Yp,h(Yp?"on":"off",1)}let $r=[];async function vT(){var o;const t=ea(d.typingSpeedUnit),e=[];for(let l=1;l<=yn.length;l++)Tr&&l===yn.length?e.push(we(B.testDuration).toString()):e.push(l.toString());yt.getScale("wpm").title.text=t.fullUnitString;const a=[...yn.map(l=>we(t.fromWpm(l)))];if(B.chartData==="toolong")return;const s=[...B.chartData.raw.map(l=>we(t.fromWpm(l)))];d.mode!=="time"&&Tr&&B.testDuration%1<.5&&(e.pop(),a.pop(),s.pop());let n=s;if(Yp||(n=sk(n,1),n=n.map(l=>Math.round(l))),yt.data.labels=e,yt.getDataset("wpm").data=a,yt.getDataset("wpm").label=d.typingSpeedUnit,yt.getDataset("raw").data=n,ti=Math.max(Math.max(...n),Math.max(...a)),d.startGraphsAtZero)yt.getScale("wpm").min=0,yt.getScale("raw").min=0;else{const l=Math.min(Math.min(...n),Math.min(...a));yt.getScale("wpm").min=l,yt.getScale("raw").min=l}yt.getDataset("error").data=B.chartData.err;const r=await Za("sub");if(d.funbox!=="none"){let l="";for(const u of Ae(d.funbox))l+=u.name,(o=u.functions)!=null&&o.getResultContent&&(l+="("+u.functions.getResultContent()+")"),l+=" ";l=l.trimEnd(),$r.push({display:!0,id:"funbox-label",type:"line",scaleID:"wpm",value:yt.getScale("wpm").min,borderColor:"transparent",borderWidth:1,borderDash:[2,2],label:{backgroundColor:"transparent",font:{family:d.fontFamily.replace(/_/g," "),size:11,style:"normal",weight:Xa.defaults.font.weight,lineHeight:Xa.defaults.font.lineHeight},color:r,padding:3,borderRadius:3,position:"start",enabled:!0,content:`${l}`}})}yt.getScale("wpm").max=ti,yt.getScale("raw").max=ti,yt.getScale("error").max=Math.max(...B.chartData.err)}async function bT(){const t=await Oi(),e=await Of(B.mode,B.mode2,B.punctuation??!1,B.numbers??!1,B.language,B.difficulty,B.lazyMode??!1,B.funbox??"none");if(e===0)return;const a=ea(d.typingSpeedUnit),s=we(a.fromWpm(e)).toFixed(2);$r.push({display:!0,type:"line",id:"lpb",scaleID:"wpm",value:s,borderColor:t.sub,borderWidth:1,borderDash:[2,2],label:{backgroundColor:t.sub,font:{family:d.fontFamily.replace(/_/g," "),size:11,style:"normal",weight:Xa.defaults.font.weight,lineHeight:Xa.defaults.font.lineHeight},color:t.bg,padding:3,borderRadius:3,position:"center",enabled:!0,content:`PB: ${s}`}});const n=a.fromWpm(20);ti>=parseFloat(s)-n&&ti<=parseFloat(s)+n&&(ti=Math.round(parseFloat(s)+n)),yt.getScale("wpm").max=ti,yt.getScale("raw").max=ti}function wT(){let t=!1;if(B.wpm>=1e3&&(t=!0),i("#result .stats .wpm .top .text").text(d.typingSpeedUnit),t?i("#result .stats .wpm .bottom").text("Infinite"):i("#result .stats .wpm .bottom").text(ue.typingSpeed(B.wpm)),i("#result .stats .raw .bottom").text(ue.typingSpeed(B.rawWpm)),i("#result .stats .acc .bottom").text(B.acc===100?"100%":ue.accuracy(B.acc)),d.alwaysShowDecimalPlaces){d.typingSpeedUnit!="wpm"?(i("#result .stats .wpm .bottom").attr("aria-label",B.wpm.toFixed(2)+" wpm"),i("#result .stats .raw .bottom").attr("aria-label",B.rawWpm.toFixed(2)+" wpm")):(i("#result .stats .wpm .bottom").removeAttr("aria-label"),i("#result .stats .raw .bottom").removeAttr("aria-label"));let e=we(B.testDuration).toFixed(2)+"s";B.testDuration>61&&(e=Ta(we(B.testDuration))),i("#result .stats .time .bottom .text").text(e),i("#result .stats .acc .bottom").attr("aria-label",`${Ya.correct} correct / ${Ya.incorrect} incorrect`)}else{const e={showDecimalPlaces:!0,suffix:` ${d.typingSpeedUnit}`};let a=ue.typingSpeed(B.wpm,e),s=ue.typingSpeed(B.rawWpm,e);d.typingSpeedUnit!="wpm"&&(a+=" ("+B.wpm.toFixed(2)+" wpm)",s+=" ("+B.rawWpm.toFixed(2)+" wpm)"),i("#result .stats .wpm .bottom").attr("aria-label",a),i("#result .stats .raw .bottom").attr("aria-label",s),i("#result .stats .acc .bottom").attr("aria-label",`${B.acc===100?"100":ue.percentage(B.acc,{showDecimalPlaces:!0})} (${Ya.correct} correct / ${Ya.incorrect} incorrect)`)}}function Iq(){i("#result .stats .consistency .bottom").text(ue.percentage(B.consistency)),d.alwaysShowDecimalPlaces?i("#result .stats .consistency .bottom").attr("aria-label",ue.percentage(B.keyConsistency,{showDecimalPlaces:!0,suffix:" key"})):i("#result .stats .consistency .bottom").attr("aria-label",`${B.consistency}% (${B.keyConsistency}% key)`)}function Oq(){const t=we(B.afkDuration/B.testDuration*100);if(i("#result .stats .time .bottom .afk").text(""),t>0&&i("#result .stats .time .bottom .afk").text(t+"% afk"),i("#result .stats .time .bottom").attr("aria-label",`${B.afkDuration}s afk ${t}%`),d.alwaysShowDecimalPlaces){let e=we(B.testDuration).toFixed(2)+"s";B.testDuration>61&&(e=Ta(we(B.testDuration))),i("#result .stats .time .bottom .text").text(e)}else{let e=Math.round(B.testDuration)+"s";B.testDuration>61&&(e=Ta(Math.round(B.testDuration))),i("#result .stats .time .bottom .text").text(e),i("#result .stats .time .bottom").attr("aria-label",`${we(B.testDuration)}s (${B.afkDuration}s afk ${t}%)`)}}function Pq(){i("#result .stats .time .bottom .timeToday").text(HZ())}function Rq(){i("#result .stats .key .bottom").text(B.charStats[0]+"/"+B.charStats[1]+"/"+B.charStats[2]+"/"+B.charStats[3])}function Jp(t){gT(),yT(t)}async function Dq(t){if(d.mode==="quote"||t){Wy();return}let e=0;const a=await kT();if(a.value){const s=await Of(d.mode,B.mode2,d.punctuation,d.numbers,d.language,d.difficulty,d.lazyMode,d.funbox);e=B.wpm-s,e<=0?Wy():(Jp("pending"),i("#result .stats .wpm .crown").attr("aria-label","+"+ue.typingSpeed(e,{showDecimalPlaces:!0})))}else{const s=await Of(d.mode,B.mode2,d.punctuation,d.numbers,d.language,d.difficulty,d.lazyMode,"none");e=B.wpm-s,e<=0?(Jp("warning"),i("#result .stats .wpm .crown").attr("aria-label",`This result is not eligible for a new PB (${a.reason})`)):(Jp("ineligible"),i("#result .stats .wpm .crown").attr("aria-label",`You could've gotten a new PB (+${ue.typingSpeed(e,{showDecimalPlaces:!0})}), but your config does not allow it (${a.reason})`))}}function Wy(){_q(),i("#result .stats .wpm .crown").attr("aria-label","")}function Nq(){Cq()==="pending"&&(gT(),yT("error"),i("#result .stats .wpm .crown").attr("aria-label","Local PB data is out of sync with the server - please refresh (pb mismatch)"))}async function kT(){var r;const t=((r=B.funbox)==null?void 0:r.split("#"))??[],a=(await Promise.all(t.map(async o=>vA(o)))).every(o=>o==null?void 0:o.canGetPb),s=B.funbox==="none"||t.length===0||a,n=d.stopOnError!=="letter";return s&&n?{value:!0}:s?n?{value:!1,reason:"unknown"}:{value:!1,reason:"stop on letter"}:{value:!1,reason:"funbox"}}function Wq(){if(Ct())return;const t=getComputedStyle(document.body),e=[t.getPropertyValue("--main-color"),t.getPropertyValue("--text-color"),t.getPropertyValue("--sub-color")],a=Date.now()+125;(function s(){uw({particleCount:5,angle:60,spread:75,origin:{x:0},colors:e}),uw({particleCount:5,angle:120,spread:75,origin:{x:1},colors:e}),Date.now()<a&&requestAnimationFrame(s)})()}async function Bq(t){var r,o,l,u;const e=[],a=((o=(r=S())==null?void 0:r.tags)==null?void 0:o.length)??0;try{(u=(l=S())==null?void 0:l.tags)==null||u.forEach(c=>{c.active===!0&&e.push(c)})}catch{}a===0?i("#result .stats .tags").addClass("hidden"):i("#result .stats .tags").removeClass("hidden"),e.length===0?i("#result .stats .tags .bottom").html("<div class='noTags'>no tags</div>"):i("#result .stats .tags .bottom").text(""),i("#result .stats .tags .editTagsButton").attr("data-result-id",""),i("#result .stats .tags .editTagsButton").attr("data-active-tag-ids",e.map(c=>c._id).join(",")),i("#result .stats .tags .editTagsButton").addClass("invisible");let s="start",n=15;e.forEach(async c=>{const p=await Wx(c._id,d.mode,B.mode2,d.punctuation,d.numbers,d.language,d.difficulty,d.lazyMode);i("#result .stats .tags .bottom").append(`
      <div tagid="${c._id}" aria-label="PB: ${p}" data-balloon-pos="up">${c.display}<i class="fas fa-crown hidden"></i></div>
    `);const f=ea(d.typingSpeedUnit);if(d.mode!=="quote"&&!t&&(await kT()).value)if(p<B.wpm)await eR(c._id,d.mode,B.mode2,d.punctuation,d.numbers,d.language,d.difficulty,d.lazyMode,B.wpm,B.acc,B.rawWpm,B.consistency),i(`#result .stats .tags .bottom div[tagid="${c._id}"] .fas`).removeClass("hidden"),i(`#result .stats .tags .bottom div[tagid="${c._id}"]`).attr("aria-label","+"+we(B.wpm-p));else{const m=await Oi();$r.push({display:!0,type:"line",id:"tpb",scaleID:"wpm",value:f.fromWpm(p),borderColor:m.sub,borderWidth:1,borderDash:[2,2],label:{backgroundColor:m.sub,font:{family:d.fontFamily.replace(/_/g," "),size:11,style:"normal",weight:Xa.defaults.font.weight,lineHeight:Xa.defaults.font.lineHeight},color:m.bg,padding:3,borderRadius:3,position:s,xAdjust:n,enabled:!0,content:`${c.display} PB: ${we(f.fromWpm(p)).toFixed(2)}`}}),s==="start"?(s="end",n=-15):(s="start",n=15)}})}function Zq(t){let e="";e+=d.mode,d.mode==="time"?e+=" "+d.time:d.mode==="words"?e+=" "+d.words:d.mode==="quote"&&(t==null?void 0:t.group)!==void 0&&(e+=" "+["short","medium","long","thicc"][t.group]);const a=Ae(d.funbox).find(s=>{var n;return(n=s.properties)==null?void 0:n.includes("ignoresLanguage")})!==void 0;d.mode!=="custom"&&!a&&(e+="<br>"+ki(B.language)),d.punctuation&&(e+="<br>punctuation"),d.numbers&&(e+="<br>numbers"),d.blindMode&&(e+="<br>blind"),d.lazyMode&&(e+="<br>lazy"),d.funbox!=="none"&&(e+="<br>"+d.funbox.replace(/_/g," ").replace(/#/g,", ")),d.difficulty==="expert"?e+="<br>expert":d.difficulty==="master"&&(e+="<br>master"),d.stopOnError!=="off"&&(e+=`<br>stop on ${d.stopOnError}`),i("#result .stats .testType .bottom").html(e)}function qq(t,e,a,s,n){let r="";if(t&&(r+=`<br>failed (${e})`),a&&(r+="<br>afk detected"),ub){r+="<br>invalid";const o=[];(B.wpm<0||B.wpm>350&&B.mode!=="words"&&B.mode2!=="10"||B.wpm>420&&B.mode==="words"&&B.mode2==="10")&&o.push("wpm"),(B.rawWpm<0||B.rawWpm>350&&B.mode!=="words"&&B.mode2!=="10"||B.rawWpm>420&&B.mode==="words"&&B.mode2==="10")&&o.push("raw"),(B.acc<75||B.acc>100)&&o.push("accuracy"),o.length>0&&(r+=` (${o.join(",")})`)}s&&(r+="<br>repeated"),B.bailedOut&&(r+="<br>bailed out"),n&&(r+="<br>too short"),r===""?i("#result .stats .info").addClass("hidden"):(i("#result .stats .info").removeClass("hidden"),r=r.substring(4),i("#result .stats .info .bottom").html(r))}function Fq(t){var e,a,s;if(d.mode==="quote"){if(t===null){console.error("Failed to update quote rating button: randomQuote is null");return}((s=(a=(e=S())==null?void 0:e.quoteRatings)==null?void 0:a[t.language])==null?void 0:s[t.id])&&i(".pageTest #result #rateQuoteButton .icon").removeClass("far").addClass("fas"),oT(t).then(r=>{var o;i(".pageTest #result #rateQuoteButton .rating").text(((o=r==null?void 0:r.average)==null?void 0:o.toFixed(1))??"")}).catch(r=>{i(".pageTest #result #rateQuoteButton .rating").text("?")}),i(".pageTest #result #rateQuoteButton").css({opacity:0}).removeClass("hidden").css({opacity:1})}}function jq(t){const e=i(".pageTest #result #favoriteQuoteButton .icon");if(d.mode!=="quote"||!ce()){e.parent().addClass("hidden");return}if(t===null){console.error("Failed to update quote favorite button: randomQuote is null");return}on=d.mode==="quote"?t.language:"",Yr=d.mode==="quote"?t.id.toString():"";const a=ja.isQuoteFavorite(t);e.removeClass(a?"far":"fas").addClass(a?"fas":"far"),e.parent().removeClass("hidden")}function Hq(t){d.mode==="quote"?(i("#result .stats .source").removeClass("hidden"),i("#result .stats .source .bottom").html((t==null?void 0:t.source)??"Error: Source unknown")):i("#result .stats .source").addClass("hidden")}async function zq(t,e,a,s,n,r,o,l){$r=[],B=Object.assign({},t),Wy(),i("#resultWordsHistory .words").empty(),i("#result #resultWordsHistory").addClass("hidden"),i("#retrySavingResultButton").addClass("hidden"),i(".pageTest #result #rateQuoteButton .icon").removeClass("fas").addClass("far"),i(".pageTest #result #rateQuoteButton .rating").text(""),i(".pageTest #result #rateQuoteButton").addClass("hidden"),i("#words").removeClass("blurred"),i("#wordsInput").trigger("blur"),i("#result .stats .time .bottom .afk").text(""),ce()?i("#result .loginTip").addClass("hidden"):i("#result .loginTip").removeClass("hidden"),d.ads==="off"||d.ads==="result"?i("#result #watchVideoAdButton").addClass("hidden"):i("#result #watchVideoAdButton").removeClass("hidden"),wT(),Iq(),Oq(),Rq(),Zq(o),Hq(o),jq(o),await Dq(l),await vT(),await bT(),await Bq(l),qq(e,a,s,n,r),yt.options.plugins.annotation.annotations=$r,yt.updateColors(),yt.resize(),i("#result .stats .tags").hasClass("hidden")&&i("#result .stats .info").hasClass("hidden")?i("#result .stats .infoAndTags").addClass("hidden"):i("#result .stats .infoAndTags").removeClass("hidden"),a0()?(i("main #result .noStressMessage").remove(),i("main #result").prepend(`

      <div class='noStressMessage' style="
        text-align: center;
        grid-column: 1/3;
        font-size: 2rem;
        padding-bottom: 2rem;
      ">
      <i class="fas fa-check"></i>
      </div>

    `),i("main #result .stats").addClass("hidden"),i("main #result .chart").addClass("hidden"),i("main #result #resultWordsHistory").addClass("hidden"),i("main #result #resultReplay").addClass("hidden"),i("main #result .loginTip").addClass("hidden"),i("main #result #showWordHistoryButton").addClass("hidden"),i("main #result #watchReplayButton").addClass("hidden"),i("main #result #saveScreenshotButton").addClass("hidden"),console.log(`Test Completed: ${B.wpm} wpm ${B.acc}% acc ${B.rawWpm} raw ${B.consistency}% consistency`)):(i("main #result .stats").removeClass("hidden"),i("main #result .chart").removeClass("hidden"),ce()||i("main #result .loginTip").removeClass("hidden"),i("main #result #showWordHistoryButton").removeClass("hidden"),i("main #result #watchReplayButton").removeClass("hidden"),i("main #result #saveScreenshotButton").removeClass("hidden")),window.scrollY>0&&i([document.documentElement,document.body]).stop().animate({scrollTop:0},250),Tq(),cr(i("#typingTest"),i("#result"),250,async()=>{i("#result").trigger("focus"),hq(),y1(!1),i("#words").empty(),yt.resize(),window.scrollTo({top:0})},async()=>{Di(!1),i("#resultExtraButtons").removeClass("hidden").css("opacity",0).animate({opacity:1},125);const u=qm(d.mode,d.words,d.time,Er(),Mn()??!1);d.alwaysShowWordsHistory&&u&&!a0()&&k1(!0),wm(!0),to()})}function Kq(t,e){var s,n;const a=[];if(t.length>0)for(const r of t)(n=(s=S())==null?void 0:s.tags)==null||n.forEach(o=>{r===o._id&&a.push(o.display)});if(t.length===0)i(".pageTest #result .tags .bottom").html("<div class='noTags'>no tags</div>");else{i(".pageTest #result .tags .bottom div.noTags").remove();const r=i(".pageTest #result .tags .bottom div[tagid]"),o=[];r.each((u,c)=>{const p=i(c).attr("tagid");t.includes(p)?o.push(p):i(c).remove()});let l="";t.forEach((u,c)=>{o.includes(u)||(e.includes(u)?l+=`<div tagid="${u}" data-balloon-pos="up">${a[c]}<i class="fas fa-crown"></i></div>`:l+=`<div tagid="${u}">${a[c]}</div>`)}),i(".pageTest #result .tags .bottom").append(l),i(".pageTest #result .tags .top .editTagsButton").attr("active-tag-ids",t.join(","))}}i(".pageTest #favoriteQuoteButton").on("click",async()=>{var a,s,n,r,o;if(on===""||Yr===""){h("Could not get quote stats!",-1);return}const t=i(".pageTest #favoriteQuoteButton .icon"),e=S();if(e)if(t.hasClass("fas")){Je();const l=await Z.users.removeQuoteFromFavorites(on,Yr);if(Te(),h(l.message,l.status===200?1:-1),l.status===200){t.removeClass("fas").addClass("far");const u=(s=(a=e.favoriteQuotes)==null?void 0:a[on])==null?void 0:s.indexOf(Yr);(r=(n=e.favoriteQuotes)==null?void 0:n[on])==null||r.splice(u,1)}}else{Je();const l=await Z.users.addQuoteToFavorites(on,Yr);Te(),h(l.message,l.status===200?1:-1),l.status===200&&(t.removeClass("far").addClass("fas"),e.favoriteQuotes===void 0&&(e.favoriteQuotes={}),e.favoriteQuotes[on]||(e.favoriteQuotes[on]=[]),(o=e.favoriteQuotes[on])==null||o.push(Yr))}});mt(async t=>{["typingSpeedUnit","startGraphsAtZero"].includes(t)&&It&&($r=[],wT(),await vT(),await bT(),oo(),yt.options.plugins.annotation.annotations=$r,yt.updateColors(),yt.resize())});const fe={particles:[],rendering:!1},Vq=1e3,Uq=.05,Gq=4,Qq=.6,kp=1500,Zr=.3,s0=[6,3],xp=10;function Yq(){const t=document.createElement("canvas");return t.style.cssText="position:fixed;top:0;left:0;pointer-events:none;z-index:999999",t.height=window.innerHeight,t.width=window.innerWidth,window.addEventListener("resize",()=>{t.height=window.innerHeight,t.width=window.innerWidth}),document.body.appendChild(t),t}function Jq(t,e,a){return{x:t,y:e,color:a,alpha:1,prev:{x:t,y:e},vel:{x:kp-Math.random()*kp*2,y:kp-Math.random()*kp*2}}}function Xq(t){!fe.canvas||!fe.deltaTime||(t.prev.x=t.x,t.prev.y=t.y,t.x+=t.vel.x*fe.deltaTime,t.y+=t.vel.y*fe.deltaTime,t.x>fe.canvas.width?(t.vel.x*=-Zr,t.x=fe.canvas.width-(t.x-fe.canvas.width)*Zr):t.x<0&&(t.vel.x*=-Zr,t.x*=-Zr),t.y>fe.canvas.height?(t.vel.y*=-Zr,t.y=fe.canvas.height-(t.y-fe.canvas.height)*Zr):t.y<0&&(t.vel.y*=-1,t.y*=-1),t.vel.y+=Vq*fe.deltaTime,t.vel.x*=1-Uq*fe.deltaTime,t.alpha*=1-Qq*fe.deltaTime)}function eF(){fe.caret=i("#caret"),fe.canvas=Yq(),fe.context2d=fe.canvas.getContext("2d")}function xT(){if(!fe.lastFrame||!fe.context2d||!fe.canvas)return;fe.rendering=!0;const t=Date.now();fe.deltaTime=(t-fe.lastFrame)/1e3,fe.lastFrame=t,fe.context2d.clearRect(0,0,fe.canvas.width,fe.canvas.height);const e=[];for(const a of fe.particles)a.alpha<.1||(Xq(a),fe.context2d.globalAlpha=a.alpha,fe.context2d.strokeStyle=a.color,fe.context2d.lineWidth=Gq,fe.context2d.beginPath(),fe.context2d.moveTo(Math.round(a.prev.x),Math.round(a.prev.y)),fe.context2d.lineTo(Math.round(a.x),Math.round(a.y)),fe.context2d.stroke(),e.push(a));fe.particles=e,fe.particles.length&&!Ct()?requestAnimationFrame(xT):(fe.context2d.clearRect(0,0,fe.canvas.width,fe.canvas.height),fe.rendering=!1)}function _T(t=!1){if(!fe.resetTimeOut)return;delete fe.resetTimeOut,clearTimeout(fe.resetTimeOut);const e=i(document.body);e.css("transition","all .25s, transform 0.8s"),e.css("transform","translate(0,0)"),setTimeout(()=>{e.css("transition","all .25s, transform .05s"),i("html").css("overflow","inherit"),i("html").css("overflow-y","scroll")},t?0:1e3)}function tF(){fe.rendering||(fe.lastFrame=Date.now(),xT())}function aF(){const t=Math.floor(Math.random()*256).toString(16),e=Math.floor(Math.random()*256).toString(16),a=Math.floor(Math.random()*256).toString(16);return`#${t}${e}${a}`}async function CT(t=!0,e=!1){var n,r;if(d.monkeyPowerLevel==="off"||Ct())return;if(d.blindMode&&(t=!0),["3","4"].includes(d.monkeyPowerLevel)){i("html").css("overflow","hidden");const o=[Math.round(xp-Math.random()*xp),Math.round(xp-Math.random()*xp)];i(document.body).css("transform",`translate(${o[0]}px, ${o[1]}px)`),fe.resetTimeOut&&clearTimeout(fe.resetTimeOut),fe.resetTimeOut=setTimeout(_T,2e3)}const a=(n=fe.caret)==null?void 0:n.offset(),s=[(a==null?void 0:a.left)??0,((a==null?void 0:a.top)??0)+(((r=fe.caret)==null?void 0:r.height())??0)];for(let o=Math.round((s0[0]+Math.random()*s0[1])*(e?2:1));o>0;o--){const l=["2","4"].includes(d.monkeyPowerLevel)?aF():t?await Za("caret"):await Za("error");fe.particles.push(Jq(...s,l))}tF()}let ag=[];async function sF(){return ag.length===0&&(ag=await ak("languages/britishenglish.json")),ag}async function ST(t,e){var s;const a=await sF();if(t.includes("-"))return(await Promise.all(t.split("-").map(async n=>ST(n,e)))).join("-");{const n=a.find(r=>t.match(RegExp(`^([\\W]*${r[0]}[\\W]*)$`,"gi")));return!n||d.mode==="quote"&&((s=n[2])!=null&&s.includes(e))?t:t.replace(RegExp(`^(?:([\\W]*)(${n[0]})([\\W]*))$`,"gi"),(r,o,l,u)=>o+(l.charAt(0)===l.charAt(0).toUpperCase()?l===l.toUpperCase()?n[1].toUpperCase():Ac(n[1]):n[1])+u)}}const nF=[["","a"],["","e"],["","i"],["","o"],["","u"],["","n"],["","c"],["","r"],["","d"],["","t"],["","m"],["","ae"],["","oe"],["","w"],["g","g"],["","h"],["","j"],["","n"],["","s"],["","ss"],["","z"],["","y"],["","l"],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["","th"]],iF=new Map(nF.flatMap(t=>[...t[0]].map(e=>[e,t[1]])));function rF(t,e){const a=t.toLowerCase(),s=e==null?void 0:e.find(n=>n[0].includes(a));return s!==void 0?s[1]:iF.get(a)}function oF(t,e){if(!t)return t;const a=t.toUpperCase(),s=[...t].map((r,o)=>r==a[o]),n=[];for(let r=0;r<t.length;r++){const o=t[r],l=s[r],u=rF(o,e);u!==void 0?l?(n.push(u.substring(0,1).toUpperCase()),n.push(u.substring(1))):n.push(u):n.push(l?o.toUpperCase():o)}return n.join("")}const TT=[["are",["aren't"]],["can",["can't"]],["could",["couldn't"]],["did",["didn't"]],["does",["doesn't"]],["do",["don't"]],["had",["hadn't"]],["has",["hasn't"]],["have",["haven't"]],["is",["isn't"]],["it",["it's","it'll"]],["i",["i'm","i'll","i've","i'd"]],["you",["you'll","you're","you've","you'd"]],["that",["that's","that'll","that'd"]],["must",["mustn't","must've"]],["there",["there's","there'll","there'd"]],["he",["he's","he'll","he'd"]],["she",["she's","she'll","she'd"]],["we",["we're","we'll","we'd"]],["they",["they're","they'll","they'd"]],["should",["shouldn't","should've"]],["was",["wasn't"]],["were",["weren't"]],["will",["won't"]],["would",["wouldn't","would've"]],["going",["goin'"]]];async function lF(t){return TT.find(e=>t.match(RegExp(`^([\\W]*${e[0]}[\\W]*)$`,"gi")))!==void 0}async function dF(t){const e=TT.find(s=>t.match(RegExp(`^([\\W]*${s[0]}[\\W]*)$`,"gi")));if(e===void 0)return t;const a=Hs(e[1]);return t.replace(RegExp(`^(?:([\\W]*)(${e[0]})([\\W]*))$`,"gi"),(s,n,r,o)=>n+(r.charAt(0)===r.charAt(0).toUpperCase()?uF(r)?a.toUpperCase():Ac(a):a)+o)}function uF(t){return t==="I"?!1:t===t.toUpperCase()}function cF(t){return/[?!.]/.test(t)}let qr="";async function pF(t,e,a,s){var u;let n=e;const r=d.language.split("_")[0],o=Ux(t),l=Ae(d.funbox).find(c=>{var p;return(p=c.functions)==null?void 0:p.punctuateWord});if((u=l==null?void 0:l.functions)!=null&&u.punctuateWord)return l.functions.punctuateWord(n);if(r!=="code"&&r!=="georgian"&&(a===0||cF(o))){if(n=Ac(n),r==="turkish"&&(n=n.replace(/I/g,"")),r==="spanish"||r==="catalan"){const c=Math.random();c>.9?(n=""+n,qr="?"):c>.8&&(n=""+n,qr="!")}}else if(Math.random()<.1&&o!=="."&&o!==","&&a!==s-2||a===s-1)if(r==="spanish"||r==="catalan")(qr==="?"||qr==="!")&&(n+=qr,qr="");else{const c=Math.random();c<=.8?r==="kurdish"?n+=".":r==="nepali"||r==="bangla"||r==="hindi"?n+="":r==="japanese"||r==="chinese"?n+="":n+=".":c>.8&&c<.9?r==="french"?n="?":r==="arabic"||r==="persian"||r==="urdu"||r==="kurdish"?n+="":r==="greek"?n+=";":r==="japanese"||r==="chinese"?n+="":n+="?":r==="french"?n="!":r==="japanese"||r==="chinese"?n+="":n+="!"}else if(Math.random()<.01&&o!==","&&o!=="."&&r!=="russian")n=`"${n}"`;else if(Math.random()<.011&&o!==","&&o!=="."&&r!=="russian"&&r!=="ukrainian"&&r!=="slovak")n=`'${n}'`;else if(Math.random()<.012&&o!==","&&o!==".")if(r==="code"){const c=Math.random(),p=["()","{}","[]","<>"];d.language.startsWith("code_javascript")&&p.push("``");const f=Math.floor(c*p.length),m=p[f];n=`${m[0]}${n}${m[1]}`}else r==="japanese"||r==="chinese"?n=`${n}`:n=`(${n})`;else if(Math.random()<.013&&o!==","&&o!=="."&&o!==";"&&o!==""&&o!==":"&&o!==""&&o!=="")r==="french"?n=":":r==="greek"?n="":r==="chinese"?n+="":n+=":";else if(Math.random()<.014&&o!==","&&o!=="."&&t!=="-")n="-";else if(Math.random()<.015&&o!==","&&o!=="."&&o!==";"&&o!==""&&o!==""&&o!=="")r==="french"?n=";":r==="greek"?n="":r==="arabic"||r==="kurdish"?n+="":r==="chinese"?n+="":n+=";";else if(Math.random()<.2&&o!==",")r==="arabic"||r==="urdu"||r==="persian"||r==="kurdish"?n+="":r==="japanese"?n+="":r==="chinese"?n+="":n+=",";else if(Math.random()<.25&&r==="code"){const c=["{","}","[","]","(",")",";","=","+","%","/"],p=["{","}","[","]","(",")",";","=","+","%","/","/*","*/","//","!=","==","<=",">=","||","&&","<<",">>","%=","&=","*=","++","+=","--","-=","/=","^=","|="];d.language.startsWith("code_c")&&!d.language.startsWith("code_css")||d.language.startsWith("code_arduino")?n=Hs(p):d.language.startsWith("code_javascript")?n=Hs([...c,"`"]):n=Hs(c)}else Math.random()<.5&&r==="english"&&await lF(n)&&(n=await fF(n));return n.includes("	")&&(n=n.replace(/\t/g,""),n+="	"),n.includes(`
`)&&(n=n.replace(/\n/g,""),n+=`
`),n}async function fF(t){return dF(t)}function mF(){var e;const t=Ae(d.funbox).find(a=>{var s;return(s=a.functions)==null?void 0:s.getWordsFrequencyMode});if((e=t==null?void 0:t.functions)!=null&&e.getWordsFrequencyMode)return t.functions.getWordsFrequencyMode()}async function hF(){var a;const t=[],e=Ae(d.funbox).find(s=>{var n;return(n=s.functions)==null?void 0:n.pullSection});if((a=e==null?void 0:e.functions)!=null&&a.pullSection){const s=await e.functions.pullSection(d.language);if(s===!1||s===void 0)throw Rv(e.name),new Error("Failed to pull section");for(const n of s.words){if(t.length>=d.words&&d.mode==="words")break;t.push(n)}}return t}function gF(t,e,a){var n;const s=Ae(d.funbox).find(r=>{var o;return(o=r.functions)==null?void 0:o.getWord});return(n=s==null?void 0:s.functions)!=null&&n.getWord&&(t=s.functions.getWord(a,e)),t}function yF(t){var e;for(const a of Ae(d.funbox))(e=a.functions)!=null&&e.alterText&&(t=a.functions.alterText(t));return t}async function vF(t,e){return!d.britishEnglish||!d.language.includes("english")||d.mode==="quote"&&(ze==null?void 0:ze.britishText)!==void 0&&(ze==null?void 0:ze.britishText)!==""?t:await ST(t,e)}function sg(t,e){const a=!e.noLazyMode||d.mode==="custom";return d.lazyMode&&a&&(t=oF(t,e.additionalAccents)),t}function bF(){var e,a;const t=((a=(e=Ae(d.funbox).find(s=>{var n;return(n=s.properties)==null?void 0:n.find(r=>r.startsWith("wordOrder"))}))==null?void 0:e.properties)==null?void 0:a.find(s=>s.startsWith("wordOrder")))??"";return t?t.split(":")[1]:"normal"}function wF(){var s,n;if(d.mode==="zen")return 0;let t=100;const e=ze;if(d.mode==="quote"&&e===null)throw new Jt("Random quote is null");const a=((n=(s=Ae(d.funbox).find(r=>{var o;return(o=r.properties)==null?void 0:o.find(l=>l.startsWith("toPush"))}))==null?void 0:s.properties)==null?void 0:n.find(r=>r.startsWith("toPush:")))??"";return d.showAllLines&&(d.mode==="custom"&&(t=gt()),d.mode==="words"&&(t=d.words),d.mode==="quote"&&(t=e.textSplit.length)),d.mode==="words"&&d.words===0&&(t=100),d.mode==="custom"&&(gt()===0||St()==="time"?t=100:t=gt()>100?100:gt()),a&&(t=+a.split(":")[1]),d.mode==="words"&&d.words!==0&&d.words<t&&(t=d.words),d.mode==="quote"&&e.textSplit.length<t&&(t=e.textSplit.length),d.mode==="custom"&&St()==="word"&&gt()<t&&gt()!==0&&(t=gt()),t}class Jt extends Error{constructor(e){super(e),this.name="WordGenError"}}async function kF(t,e){if(ys){if(Rt===null)throw new Jt("Current wordset is null");return yy($T),e==="reverse"?Rt.words.reverse():Rt.words}const a=t.name.startsWith("swiss_german")?"german":t.name;if((await ja.getQuotes(a,d.quoteLength)).length===0)throw zt("words"),new Jt(`No ${d.language.replace(/_\d*k$/g,"").replace(/_/g," ")} quotes found`);let n;if(d.quoteLength.includes(-2)&&d.quoteLength.length===1){const r=ja.getQuoteById(Kg);if(r===void 0)throw mn(-1),new Jt(`Quote ${Kg} does not exist`);n=r}else if(d.quoteLength.includes(-3)){const r=ja.getRandomFavoriteQuote(d.language);if(r===null)throw mn(-1),new Jt("No favorite quotes found");n=r}else{const r=ja.getRandomQuote();if(r===null)throw mn(-1),new Jt("No quotes found for selected quote length");n=r}if(n.language=Ds(d.language),n.text=n.text.replace(/ +/gm," "),n.text=n.text.replace(/( *(\r\n|\r|\n) *)/g,`
 `),n.text=n.text.replace(//g,"..."),n.text=n.text.trim(),n.britishText!==void 0&&n.britishText!==""&&d.britishEnglish?n.textSplit=n.britishText.split(" "):n.textSplit=n.text.split(" "),yy(n),ze===null)throw new Jt("Random quote is null");if(ze.textSplit===void 0)throw new Jt("Random quote textSplit is undefined");return ze.textSplit}let Rt=null,ji=null,Xp=!1,$T=null;async function xF(t){var c;ys||(By=[]),$T=ze,yy(null),Gi=[],po=0,td=[],ji=t;const e={words:[],sectionIndexes:[],hasTab:!1,hasNewline:!1},a=Ae(d.funbox).find(p=>{var f;return(f=p.functions)==null?void 0:f.pullSection});Xp=((c=a==null?void 0:a.functions)==null?void 0:c.pullSection)!==void 0;const s=bF();console.debug("Word order",s);let n=t.words;d.mode==="custom"?n=Ym():d.mode==="quote"?n=await kF(t,s):d.mode==="zen"&&(n=[]);const r=wF();if(console.debug("Words limit",r),s==="reverse"&&(n=n.reverse()),Rt=await VB(n),console.debug("Wordset",Rt),r===0)return e;let o=!1,l=0;for(;!o;){const p=await AT(l,r,ho(e.words,-1)??"",ho(e.words,-2)??"");e.words.push(p.word),e.sectionIndexes.push(p.sectionIndex),d.mode==="custom"&&Wc()?Gi.length===0&&po>=gt()&&(o=!0):e.words.length>=r&&(o=!0),l++}const u=ze;if(d.mode==="quote"&&u===null)throw new Jt("Random quote is null");return e.hasTab=e.words.some(p=>p.includes("	"))||Rt.words.some(p=>p.includes("	"))||d.mode==="quote"&&u.textSplit.some(p=>p.includes("	")),e.hasNewline=e.words.some(p=>p.includes(`
`))||Rt.words.some(p=>p.includes(`
`))||d.mode==="quote"&&u.textSplit.some(p=>p.includes(`
`)),td=[],e}let po=0,Gi=[],td=[],By=[];async function AT(t,e,a,s){if(console.debug("Getting next word",{isRepeated:ys,currentWordset:Rt,wordIndex:t,language:ji,wordsBound:e,previousWord:a,previousWord2:s}),Rt===null)throw new Jt("Current wordset is null");if(ji===null)throw new Jt("Current language is null");if(ys&&d.mode!=="quote"){const c=By[t];if(c===void 0){let p=!1;if((d.mode==="time"||d.mode==="custom"&&St()==="time"||d.mode==="custom"&&St()==="word"&&t<gt()||d.mode==="words"&&t<d.words)&&(p=!0),p)console.debug("Repeated word is undefined but random generation is allowed - getting random word");else throw new Jt("Repeated word is undefined")}else return console.debug("Repeated word: ",c),po++,c}const n=mF()??"normal";let r=Rt.randomWord(n);const o=a.replace(/[.?!":\-,]/g,"").toLowerCase(),l=s==null?void 0:s.replace(/[.?!":\-,']/g,"").toLowerCase();if(Gi.length===0){const c=await hF();if(d.mode==="quote")r=Rt.nextWord();else if(d.mode==="custom"&&Vp()==="repeat")r=Rt.nextWord();else if(d.mode==="custom"&&Vp()==="random"&&(Rt.length<4||ct.mode!==null))r=Rt.randomWord(n);else if(d.mode==="custom"&&Vp()==="shuffle")r=Rt.shuffledWord();else if(d.mode==="custom"&&St()==="section"){r=Rt.randomWord(n);const p=ho(td,-1),f=ho(td,-2);let m=0;for(;m<100&&(p===r||f===r);)m++,r=Rt.randomWord(n)}else if(Xp)r=c.join(" ");else{let p=0,f=r.split(" ")[0].toLowerCase(),m=sg(f,ji);for(;p<100&&(o===m||l===m||d.mode!=="custom"&&!d.punctuation&&r==="I"||d.mode!=="custom"&&!d.punctuation&&!d.language.startsWith("code")&&/[-=_+[\]{};'\\:"|,./<>?]/i.test(r)||d.mode!=="custom"&&!d.numbers&&/[0-9]/i.test(r));)p++,r=Rt.randomWord(n),f=r.split(" ")[0],m=sg(f,ji)}r=r.replace(/ +/g," "),r=r.replace(/(^ )|( $)/g,""),r=gF(r,t,Rt),Gi=[...r.split(" ")],td.push(r),r=Gi.shift(),po++}else r=Gi.shift();if(r===void 0)throw new Jt("Random word is undefined");if(r==="")throw new Jt("Random word is empty");if(/ /g.test(r))throw new Jt("Random word contains spaces");d.mode!=="custom"&&d.mode!=="quote"&&/[A-Z]/.test(r)&&!d.punctuation&&!d.language.startsWith("german")&&!d.language.startsWith("swiss_german")&&!d.language.startsWith("code")&&!d.language.startsWith("klingon")&&!Xp&&(r=r.toLowerCase()),r=r.replace(/ +/gm," "),r=r.replace(/(^ )|( $)/gm,""),r=sg(r,ji),r=await vF(r,o),d.language.startsWith("swiss_german")&&(r=r.replace(//g,"ss")),d.punctuation&&!ji.originalPunctuation&&!Xp&&(r=await pF(a,r,t,e)),d.numbers&&Math.random()<.1&&(r=P1(4),d.language.startsWith("kurdish")?r=J0(r):d.language.startsWith("nepali")?r=X0(r):d.language.startsWith("bangla")?r=bA(r):d.language.startsWith("hindi")&&(r=wA(r))),r=yF(r),console.debug("Word:",r);const u={word:r,sectionIndex:po};return By.push(u),u}let MT=0,LT=0;async function _F(){const t=Zm(d,ze),[e,a]=(await Nx(d.mode,t,d.punctuation,d.numbers,d.language,d.difficulty,d.lazyMode)).map(we);MT=d.alwaysShowDecimalPlaces?e:Math.round(e),LT=d.alwaysShowDecimalPlaces?a:Math.floor(a)}function CF(){return MT}function SF(){return LT}mt(t=>{["difficulty","blindMode","stopOnError","paceCaret","minWpm","minAcc","minBurst","confidenceMode","layout","showAverage","typingSpeedUnit","quickRestart"].includes(t)&&Li()});async function Li(){var s,n;i(".pageTest #testModesNotice").empty(),ys&&d.mode!=="quote"&&i(".pageTest #testModesNotice").append('<div class="textButton noInteraction" style="color:var(--error-color);"><i class="fas fa-sync-alt"></i>repeated</div>'),Sc||i(".pageTest #testModesNotice").append('<div class="textButton" commands="resultSaving" style="color:var(--error-color);"><i class="fas fa-save"></i>saving disabled</div>'),ju&&(d.quickRestart==="esc"&&(i(".pageTest #testModesNotice").append('<div class="textButton noInteraction"><i class="fas fa-long-arrow-alt-right"></i>shift + tab to open commandline</div>'),i(".pageTest #testModesNotice").append('<div class="textButton noInteraction"><i class="fas fa-level-down-alt fa-rotate-90"></i>shift + esc to restart</div>')),d.quickRestart==="tab"&&i(".pageTest #testModesNotice").append('<div class="textButton noInteraction"><i class="fas fa-level-down-alt fa-rotate-90"></i>shift + tab to restart</div>')),(am||d.funbox.includes("58008"))&&d.quickRestart==="enter"&&i(".pageTest #testModesNotice").append('<div class="textButton noInteraction"><i class="fas fa-level-down-alt fa-rotate-90"></i>shift + enter to restart</div>');const t=db(),e=Mn();if(d.mode==="custom"&&t!==""&&e&&i(".pageTest #testModesNotice").append(`<div class="textButton noInteraction"><i class="fas fa-book"></i>${t} (shift + enter to save progress)</div>`),wa&&i(".pageTest #testModesNotice").append(`<div class="textButton noInteraction"><i class="fas fa-award"></i>${wa.display}</div>`),d.mode==="zen"&&i(".pageTest #testModesNotice").append('<div class="textButton noInteraction"><i class="fas fa-poll"></i>shift + enter to finish zen </div>'),d.mode!=="zen"&&i(".pageTest #testModesNotice").append(`<button class="textButton" commands="languages"><i class="fas fa-globe-americas"></i>${ki(d.language,d.mode==="quote")}</button>`),d.difficulty==="expert"?i(".pageTest #testModesNotice").append('<button class="textButton" commands="difficulty"><i class="fas fa-star-half-alt"></i>expert</button>'):d.difficulty==="master"&&i(".pageTest #testModesNotice").append('<button class="textButton" commands="difficulty"><i class="fas fa-star"></i>master</button>'),d.blindMode&&i(".pageTest #testModesNotice").append('<button class="textButton" commands="blindMode"><i class="fas fa-eye-slash"></i>blind</button>'),d.lazyMode&&i(".pageTest #testModesNotice").append('<button class="textButton" commands="lazyMode"><i class="fas fa-couch"></i>lazy</button>'),d.paceCaret!=="off"||d.repeatedPace&&vr){const r=ue.typingSpeed((pe==null?void 0:pe.wpm)??0,{showDecimalPlaces:!1,suffix:` ${d.typingSpeedUnit}`});i(".pageTest #testModesNotice").append(`<button class="textButton" commands="paceCaretMode"><i class="fas fa-tachometer-alt"></i>${d.paceCaret==="average"?"average":d.paceCaret==="pb"?"pb":d.paceCaret==="tagPb"?"tag pb":d.paceCaret==="last"?"last":d.paceCaret==="daily"?"daily":"custom"} pace ${r}</button>`)}if(d.showAverage!=="off"){const r=CF(),o=SF();if(ce()&&r>0){const l=["speed","both"].includes(d.showAverage)?ue.typingSpeed(r,{suffix:` ${d.typingSpeedUnit}`,showDecimalPlaces:!1}):"",u=["acc","both"].includes(d.showAverage)?ue.accuracy(o,{suffix:" acc",showDecimalPlaces:!1}):"",c=`${l} ${u}`.trim();i(".pageTest #testModesNotice").append(`<button class="textButton" commands="showAverage"><i class="fas fa-chart-bar"></i>avg: ${c}</button>`)}}d.minWpm!=="off"&&i(".pageTest #testModesNotice").append(`<button class="textButton" commands="minWpm"><i class="fas fa-bomb"></i>min ${ue.typingSpeed(d.minWpmCustomSpeed,{showDecimalPlaces:!1,suffix:` ${d.typingSpeedUnit}`})}</button>`),d.minAcc!=="off"&&i(".pageTest #testModesNotice").append(`<button class="textButton" commands="minAcc"><i class="fas fa-bomb"></i>min ${d.minAccCustom}% acc</button>`),d.minBurst!=="off"&&i(".pageTest #testModesNotice").append(`<button class="textButton" commands="minBurst"><i class="fas fa-bomb"></i>min ${ue.typingSpeed(d.minBurstCustomSpeed,{showDecimalPlaces:!1})} ${d.typingSpeedUnit} burst ${d.minBurst==="flex"?"(flex)":""}</button>`),d.funbox!=="none"&&i(".pageTest #testModesNotice").append(`<button class="textButton" commands="funbox"><i class="fas fa-gamepad"></i>${d.funbox.replace(/_/g," ").replace(/#/g,", ")}</button>`),d.confidenceMode==="on"&&i(".pageTest #testModesNotice").append('<button class="textButton" commands="confidenceMode"><i class="fas fa-backspace"></i>confidence</button>'),d.confidenceMode==="max"&&i(".pageTest #testModesNotice").append('<button class="textButton" commands="confidenceMode"><i class="fas fa-backspace"></i>max confidence</button>'),d.stopOnError!=="off"&&i(".pageTest #testModesNotice").append(`<button class="textButton" commands="stopOnError"><i class="fas fa-hand-paper"></i>stop on ${d.stopOnError}</button>`),d.layout!=="default"&&i(".pageTest #testModesNotice").append(`<button class="textButton" commands="layouts"><i class="fas fa-keyboard"></i>emulating ${d.layout.replace(/_/g," ")}</button>`),d.oppositeShiftMode!=="off"&&i(".pageTest #testModesNotice").append(`<button class="textButton" commands="oppositeShiftMode"><i class="fas fa-exchange-alt"></i>opposite shift${d.oppositeShiftMode==="keymap"?" (keymap)":""}</button>`);let a="";try{(n=(s=S())==null?void 0:s.tags)==null||n.forEach(r=>{r.active===!0&&(a+=r.display+", ")}),a!==""&&i(".pageTest #testModesNotice").append(`<button class="textButton" commands="tags"><i class="fas fa-tag"></i>${a.substring(0,a.length-2)}</button>`)}catch{}}function TF(){return(localStorage.getItem("prefersArabicLazyMode")??"true")==="true"}function $F(t){localStorage.setItem("prefersArabicLazyMode",t?"true":"false")}let uc="";const AF=document.getElementById("koInputVisual");let oa=null;function MF(){oa=null}function Lb(t){oa!==null&&(oa.uid=t,delete oa.hash,oa.hash=ok(oa))}function LF(t){var e;if(ld())return!1;ce()?_n("testStarted"):_n("testStartedNoLogin"),_v(!0),mW(),r1(E.list),JN(),xb(),yb(),bb(),vb(),zc(),Tb(),MZ();for(const a of Ae(d.funbox))(e=a.functions)!=null&&e.start&&a.functions.start();try{(d.paceCaret!=="off"||d.repeatedPace&&vr)&&SZ()}catch{}return tB(t),FZ(),!0}function He(t={}){if(t={...{withSameWordset:!1,practiseMissed:!1,noAnim:!1,nosave:!1},...t},Ra||Cr){event==null||event.preventDefault();return}if(Xe()==="test"&&!KN()&&(d.mode!=="zen"&&(event==null||event.preventDefault()),!qm(d.mode,d.words,d.time,Er(),Mn()??!1))){let s="Use your mouse to confirm.";d.quickRestart==="tab"?s="Press shift + tab or use your mouse to confirm.":d.quickRestart==="esc"?s="Press shift + escape or use your mouse to confirm.":d.quickRestart==="enter"&&(s="Press shift + enter or use your mouse to confirm."),h(`Quick restart disabled in long tests. ${s}`,0,{duration:4,important:!0});return}if($t&&(ys&&(t.withSameWordset=!0),Sc)){Um(),Qm(),Gm();const s=jc(performance.now()),n=gb(s);let r=we(s-n);r<0&&(r=0),fb(r),$1();const o=we(Hc());mb(o,r)}d.mode==="quote"&&ze!==null&&d.language.startsWith(ze.language)&&d.repeatQuotes==="typing"&&($t||uc!=="")&&(t.withSameWordset=!0),ct.mode!==null&&!t.withSameWordset&&!t.practiseMissed&&(h("Reverting to previous settings.",0),ct.punctuation!==null&&tn(ct.punctuation),ct.numbers!==null&&os(ct.numbers),ct.customText&&(Tn(ct.customText.text),ci(ct.customText.limit.mode),ir(ct.customText.limit.value),Wo(ct.customText.pipeDelimiter)),zt(ct.mode),E1()),Hu(),Tb(),eB(),XN(),Dt.reset(),lW(),Bc(),_v(!1),ab(),rh(),lh(),oh(),uh(),qc(),Dx(!1),CZ(),aT(),T.setKoreanStatus(!1),ed(),Zo(),UZ(),NW(),It&&(d.randomTheme!=="off"&&wZ(),zx()),xt()||jm();let a=null;It?a=i("#result"):a=i("#typingTest"),g1(!1),mr(!0),Ay(!0),a.stop(!0,!0).animate({opacity:0},t.noAnim?0:125,async()=>{var r;i("#result").addClass("hidden"),i("#typingTest").css("opacity",0).removeClass("hidden"),i("#wordsInput").val(" "),d.language.startsWith("korean")?(AF.innerText=" ",d.mode!=="zen"?i("#koInputVisualContainer").show():i("#koInputVisualContainer").hide()):i("#koInputVisualContainer").hide(),Di(!1),Xe()==="test"&&wm(!1),Sq(),yq(),await eZ(),Zy=0,uc="";let s=!1;d.repeatedPace&&t.withSameWordset&&(s=!0),Px(t.withSameWordset??!1),jP(s),await qy(),await X1();for(const o of Ae(d.funbox))(r=o.functions)!=null&&r.restart&&o.functions.restart();d.showAverage!=="off"?_F().then(()=>{Li()}):Li(),i("#wordsInput").is(":focus")&&Tc(),nh(),i("#typingTest").css("opacity",0).removeClass("hidden").stop(!0,!0).animate({opacity:1},t.noAnim?0:125,()=>{vB(),lB(),fB(),uB(),Ay(!1),HW(),Hu(),mr(!1)})}),nb()}let ef,Zy=0;async function qy(){if(console.debug("Initializing test"),Zy++,Zy>=4){Ay(!1),h("Too many test reinitialization attempts. Something is going very wrong. Please contact support.",-1,{important:!0});return}_T(),ab(),E.reset(),ib(0),T.resetHistory(),T.resetCurrent();let t;try{t=await rv(d.language)}catch(u){h(Re(u,"Failed to load language"),-1)}if(!t||t.name!==d.language){No("english"),await qy();return}Xe()==="test"&&await Sb(),d.mode==="quote"&&d.quoteLength.includes(-3)&&!ce()&&mn(-1),d.tapeMode!=="off"&&t.rightToLeft&&(h("This language does not support tape mode.",0,{important:!0}),qv("off"));const e=!t.noLazyMode||d.mode==="custom";d.lazyMode&&!e?(ef=!0,h("This language does not support lazy mode.",0,{important:!0}),qu(!1,!0)):ef&&!t.noLazyMode&&qu(!0,!0),!d.lazyMode&&!t.noLazyMode&&(ef=!1),d.mode==="custom"&&console.debug("Custom text",Er());let a,s,n=!1,r=!1;try{const u=await xF(t);a=u.words,s=u.sectionIndexes,n=u.hasTab,r=u.hasNewline}catch(u){console.error(u),u instanceof Jt?h(u.message,0,{important:!0}):h(Re(u,"Failed to generate words"),-1,{important:!0}),await qy();return}const o=!!Kv;let l=!1;for(const u of a)/\d/g.test(u)&&!l&&(l=!0);FN(l),ZN(n),qN(r),o!==l&&bm();for(let u=0;u<a.length;u++)E.push(a[u],s[u]);d.keymapMode==="next"&&d.mode!=="zen"&&ai(ho([...E.getCurrent()],0)),vm(E.getCurrent()),zW(t.rightToLeft),KW(t.ligatures??!1),BW(),console.debug("Test initialized with words",a),console.debug("Test initialized with section indexes",s)}function Eb(){var t;return d.mode==="words"&&E.length>=d.words&&d.words>0||d.mode==="custom"&&St()==="word"&&E.length>=gt()&&gt()!==0||d.mode==="quote"&&E.length>=(((t=ze==null?void 0:ze.textSplit)==null?void 0:t.length)??0)||d.mode==="custom"&&St()==="section"&&po>=gt()&&Gi.length===0&&gt()!==0}async function EF(){var n,r,o;let t=100;const e=(r=(n=Ae(d.funbox).find(l=>{var u;return(u=l.properties)==null?void 0:u.find(c=>c.startsWith("toPush"))}))==null?void 0:n.properties)==null?void 0:r.find(l=>l.startsWith("toPush:")),a=e==null?void 0:e.split(":")[1];if(a!==void 0&&(t=+a-1),E.length-T.history.length>t||Eb())return;const s=Ae(d.funbox).find(l=>{var u;return(u=l.functions)==null?void 0:u.pullSection});if((o=s==null?void 0:s.functions)!=null&&o.pullSection&&E.length-E.currentIndex<20){const l=await s.functions.pullSection(d.language);if(l===!1){h("Error while getting section. Please try again later",-1),Rv(s.name),He();return}if(l===void 0)return;let u=0;for(let c=0;c<l.words.length;c++){const p=l.words[c];if(u>=d.words&&d.mode==="words")break;u++,E.push(p,c),Fw(p)}}try{const l=await AT(E.length,t,E.get(E.length-1),E.get(E.length-2));E.push(l.word,l.sectionIndex),Fw(l.word)}catch(l){oc("fail","word generation error"),h(Re(l,"Error while getting next word. Please try again later"),-1)}}const Qi={completedEvent:null,canRetry:!1};async function IF(){const{completedEvent:t}=Qi;if(t===null){h("Could not retry saving the result as the result no longer exists.",0,{duration:5,important:!0});return}Qi.canRetry&&(Qi.canRetry=!1,i("#retrySavingResultButton").addClass("hidden"),Ja(!0),h("Retrying to save..."),await ET(t,!0))}function OF(t){var q;let e=we(st.spacing.first-Sr);(e<0||d.mode==="zen")&&(e=0);let a=we(el-st.spacing.last);(a<0||d.mode==="zen")&&(a=0);const s=rB();if(s.time%1!==0&&d.mode!=="time"&&aB(),xZ(s.wpm),Tr&&!t){const me=hb();HS(me.wpm),zS(me.raw),Um(),Qm(),Gm()}const n=kr.map(me=>Math.round(me/5*60));if(d.mode!=="time"&&Tr&&s.time%1>=.5){const me=1/(s.time%1);n[n.length-1]=Math.round(n[n.length-1]*me)}const r=Ql(n),o=Op(n);let l=we(Ch(r/o)),u=st.spacing.array.slice();u.length>0&&(u=u.slice(0,u.length-1));let c=we(Ch(Ql(u)/Op(u)));(!l||isNaN(l))&&(l=0),(!c||isNaN(c))&&(c=0);const p=[];for(const me of Dc)p.push(me.count??0);const f={wpm:yn,raw:n,err:p},m=Ql(f.wpm??[]),g=Op(f.wpm??[]),y=we(Ch(m/g)),v=isNaN(y)?0:y;let A=null;if(d.mode==="custom"){const me=Er();A={textLen:me.text.length,mode:me.mode,pipeDelimiter:me.pipeDelimiter,limit:me.limit}}const W=[];for(const me of((q=S())==null?void 0:q.tags)??[])me.active===!0&&W.push(me._id);const $=parseFloat(s.time.toString()),se=gb($);let te=d.language;d.mode==="quote"&&(te=Ds(d.language));const b=(ze==null?void 0:ze.group)??-1,w={wpm:s.wpm,rawWpm:s.wpmRaw,charStats:[s.correctChars+s.correctSpaces,s.incorrectChars,s.extraChars,s.missedChars],charTotal:s.allChars,acc:s.acc,mode:d.mode,mode2:Zm(d,ze),quoteLength:b,punctuation:d.punctuation,numbers:d.numbers,lazyMode:d.lazyMode,timestamp:Date.now(),language:te,restartCount:cb,incompleteTests:pb,incompleteTestSeconds:mm<0?0:we(mm),difficulty:d.difficulty,blindMode:d.blindMode,tags:W,keySpacing:st.spacing.array,keyDuration:st.duration.array,keyOverlap:we(dn.total),lastKeyToEnd:a,startToFirstKey:e,consistency:l,wpmConsistency:v,keyConsistency:c,funbox:d.funbox,bailedOut:Hi,chartData:f,customText:A,testDuration:$,afkDuration:se,stopOnLetter:d.stopOnError==="letter"};return w.mode!=="custom"&&delete w.customText,w.mode!=="quote"&&delete w.quoteLength,w}async function qo(t=!1){var y,v,A,W,$,se;if(!$t)return;y1(!0);const e=performance.now();Hw(e),ys&&d.mode==="quote"&&Px(!1),await vt(1),T.current.length!==0&&(T.pushHistory(),Dt.pushHistory(),r1(T.history)),QN(e);const a=(e-st.spacing.last)/1e3;if((d.mode==="zen"||Hi)&&a<7&&Hw(st.spacing.last),g1(!0),_v(!1),ab(),Bc(),rh(),lh(),oh(),uh(),Tc(),Tb(),aT(),Li(),Fa.length!==((y=T.getHistory())==null?void 0:y.length)){const te=M1();KS(te)}(d.mode==="zen"||Hi)&&sB();const s=OF(t);console.debug("Completed event object",s);function n(te){return typeof te=="number"?isNaN(te)?1:0:typeof te>"u"?1:typeof te=="object"&&te!==null?Object.values(te).reduce((b,w)=>b+n(w),0):0}let r=!1;n(s)>0&&(console.log(s),h("Failed to build result object: One of the fields is undefined or NaN",-1),r=!0);const o=JSON.parse(JSON.stringify(s));let u=Nc.slice(-5).every(te=>te);Hi&&(u=!1);const c=parseInt(o.mode2);let p=!1;const f=(fm-pm)/1e3;if(d.mode!=="zen"&&!Hi&&(s.testDuration<f-.25||s.testDuration>f+.25)?(h("Test invalid - inconsistent test duration",0),console.error("Test duration inconsistent",s.testDuration,f),mp(),r=!0):t?(h(`Test failed - ${uc}`,0,{duration:1}),r=!0):u?(h("Test invalid - AFK detected",0),r=!0):ys?(h("Test invalid - repeated",0),r=!0):d.mode==="time"&&c<15&&c>0||d.mode==="time"&&c===0&&o.testDuration<15||d.mode==="words"&&c<10&&c>0||d.mode==="words"&&c===0&&o.testDuration<15||d.mode==="custom"&&(St()==="word"||St()==="section")&&gt()<10||d.mode==="custom"&&St()==="time"&&gt()<15||d.mode==="zen"&&o.testDuration<15?(h("Test invalid - too short",0),p=!0,r=!0):o.wpm<0||o.wpm>350&&o.mode!=="words"&&o.mode2!=="10"||o.wpm>420&&o.mode==="words"&&o.mode2==="10"?(h("Test invalid - wpm",0),mp(),r=!0):o.rawWpm<0||o.rawWpm>350&&o.mode!=="words"&&o.mode2!=="10"||o.rawWpm>420&&o.mode==="words"&&o.mode2==="10"?(h("Test invalid - raw",0),mp(),r=!0):(!((v=S())!=null&&v.lbOptOut)&&(o.acc<75||o.acc>100)||((A=S())==null?void 0:A.lbOptOut)===!0&&(o.acc<50||o.acc>100))&&(h("Test invalid - accuracy",0),mp(),r=!0),ys){const te=o.testDuration,b=o.afkDuration;let w=we(te-b);w<0&&(w=0);const q=o.acc;fb(w),mb(q,w)}const m=db(),g=Mn();if(d.mode==="custom"&&m!==""&&g)if(Hi||T.history.length<E.length){const te=(W=T.getHistory())==null?void 0:W.length,b=Qv(m)+te;wy(m,b),h("Long custom text progress saved",1,{duration:5,important:!0});let w=im(m,!0);w=w.slice(b),Tn(w)}else{wy(m,0);const te=im(m,!0);Tn(te),h("Long custom text completed",1,{duration:5,important:!0})}if(jZ(o.testDuration-o.afkDuration),Pq(),ce()?i(".pageTest #result #reportQuoteButton").removeClass("hidden"):(i(".pageTest #result #rateQuoteButton").addClass("hidden"),i(".pageTest #result #reportQuoteButton").addClass("hidden"),_n("testCompletedNoLogin"),r||(oa=o),r=!0),i("#result .stats .dailyLeaderboard").addClass("hidden"),JW(JSON.parse(JSON.stringify(o))),xt()||jm(),await zq(o,t,uc,u,ys,p,ze,r),o.chartData!=="toolong"&&delete o.chartData.unsmoothedRaw,o.testDuration>122&&(o.chartData="toolong",o.keySpacing="toolong",o.keyDuration="toolong"),r){_n("testCompletedInvalid");return}A1(),o.uid=(se=($=Tt)==null?void 0:$.currentUser)==null?void 0:se.uid,Fq(ze),Ja(!0),o.bailedOut||(o.challenge=KZ(o)),o.challenge===null&&(o==null||delete o.challenge),o.hash=ok(o),await ET(o,!1)}async function ET(t,e){var s,n,r,o,l,u,c,p,f,m,g;if(!Sc){h("Result not saved: disabled by user",-1,{duration:3,customTitle:"Notice",important:!0}),Ja(!1);return}if(!xt()){h("Result not saved: offline",-1,{duration:2,customTitle:"Notice",important:!0}),Ja(!1),Qi.canRetry=!0,i("#retrySavingResultButton").removeClass("hidden"),e||(Qi.completedEvent=t);return}const a=await Z.results.save(t);if(Ja(!1),a.status!==200){[460,461,463,464,465].includes(a.status)||(Qi.canRetry=!0,i("#retrySavingResultButton").removeClass("hidden"),e||(Qi.completedEvent=t)),console.log("Error saving result",t),a.message==="Old key data format"&&(a.message="Old key data format. Please refresh the page to download the new update. If the problem persists, please contact support."),/"result\..+" is (not allowed|required)/gi.test(a.message)&&(a.message="Looks like your result data is using an incorrect schema. Please refresh the page to download the new update. If the problem persists, please contact support."),h("Failed to save result: "+a.message,-1);return}if(i("#result .stats .tags .editTagsButton").attr("data-result-id",(s=a.data)==null?void 0:s.insertedId),i("#result .stats .tags .editTagsButton").removeClass("invisible"),((n=a==null?void 0:a.data)==null?void 0:n.xp)!==void 0){const y=((r=S())==null?void 0:r.xp)??0;Kx(y,a.data.xp,a.data.xpBreakdown),Zx(a.data.xp)}((o=a==null?void 0:a.data)==null?void 0:o.streak)!==void 0&&sR(a.data.streak),((l=a==null?void 0:a.data)==null?void 0:l.insertedId)!==void 0&&(t._id=a.data.insertedId,((u=a==null?void 0:a.data)==null?void 0:u.isPb)!==void 0&&a.data.isPb&&(t.isPb=!0),Tv(t),$v(t.incompleteTests.length+1,t.testDuration+t.incompleteTestSeconds-t.afkDuration)),_n("testCompleted"),((c=a==null?void 0:a.data)==null?void 0:c.isPb)!==void 0&&a.data.isPb?((m=(f=(p=S())==null?void 0:p.personalBests)==null?void 0:f[d.mode])!=null&&m[t.mode2]&&Wq(),Jp("normal"),await XP(d.mode,t.mode2,d.punctuation,d.numbers,d.language,d.difficulty,d.lazyMode,t.wpm,t.acc,t.rawWpm,t.consistency)):Nq(),((g=a==null?void 0:a.data)==null?void 0:g.dailyLeaderboardRank)===void 0?i("#result .stats .dailyLeaderboard").addClass("hidden"):(i("#result .stats .dailyLeaderboard").css({maxWidth:"13rem",opacity:0}).removeClass("hidden").animate({opacity:1},500),i("#result .stats .dailyLeaderboard .bottom").html(ue.rank(a.data.dailyLeaderboardRank,{fallback:""}))),i("#retrySavingResultButton").addClass("hidden"),e&&h("Result saved",1,{important:!0})}function ad(t){if(uc=t,Um(),Qm(),Gm(),qo(!0),!Sc)return;const e=jc(performance.now()),a=gb(e);let s=we(e-a);s<0&&(s=0),fb(s),$1();const n=we(Hc());mb(n,s)}i(".pageTest").on("click","#testModesNotice .textButton.restart",()=>{He()});i(".pageTest").on("click","#restartTestButton",()=>{tt(),!Cr&&($t&&d.repeatQuotes==="typing"&&d.mode==="quote"?He({withSameWordset:!0}):He())});i(".pageTest").on("click","#retrySavingResultButton",IF);i(".pageTest").on("click","#nextTestButton",()=>{tt(),He()});i(".pageTest").on("click","#restartTestButtonWithSameWordset",()=>{if(d.mode==="zen"){h("Repeat test disabled in zen mode");return}tt(),He({withSameWordset:!0})});i(".pageTest").on("click","#testConfig .mode .textButton",t=>{if(Ra||i(t.currentTarget).hasClass("active"))return;const e=i(t.currentTarget).attr("mode")??"time";e!==void 0&&(zt(e),tt(),He())});i(".pageTest").on("click","#testConfig .wordCount .textButton",t=>{if(Ra)return;const e=i(t.currentTarget).attr("wordCount")??"15";e!=="custom"&&(Ti(parseInt(e)),tt(),He())});i(".pageTest").on("click","#testConfig .time .textButton",t=>{if(Ra)return;const e=i(t.currentTarget).attr("timeConfig")??"10";e!=="custom"&&(Ws(parseInt(e)),tt(),He())});i(".pageTest").on("click","#testConfig .quoteLength .textButton",t=>{if(Ra)return;let e=parseInt(i(t.currentTarget).attr("quoteLength")??"1");e!==-2&&(e===-1&&(e=[0,1,2,3]),mn(e,!1,t.shiftKey),tt(),He())});i(".pageTest").on("click","#testConfig .punctuationMode.textButton",()=>{Ra||(tn(!d.punctuation),tt(),He())});i(".pageTest").on("click","#testConfig .numbersMode.textButton",()=>{Ra||(os(!d.numbers),tt(),He())});i("header").on("click","nav #startTestButton, #logo",()=>{Xe()==="test"&&He()});mt((t,e,a)=>{Xe()==="test"&&(t==="language"&&(e!=null&&e.startsWith("arabic")&&TF()&&qu(!0,!0),He()),t==="difficulty"&&!a&&He(),t==="showAllLines"&&!a&&He(),t==="customLayoutFluid"&&d.funbox.includes("layoutfluid")&&He(),t==="keymapMode"&&e==="next"&&d.mode!=="zen"&&setTimeout(()=>{ai(ho([...E.getCurrent()],0))},0)),t==="lazyMode"&&!a&&(d.language.startsWith("arabic")&&$F(e),e===!1&&(ef=!1))});LZ((t,e)=>{t==="fail"&&e!==void 0&&ad(e),t==="finish"&&qo()});function IT(t){Ib.show({...t,focusFirstInput:"focusAndSelect",beforeAnimation:async e=>{e.querySelector("input").value=`${d.words}`}})}function PF(t=!1){Ib.hide({clearModalChain:t})}function RF(){var e;const t=parseInt((e=Ib.getModal().querySelector("input"))==null?void 0:e.value,10);t!==null&&!isNaN(t)&&t>=0&&isFinite(t)?Ti(t)&&(tt(),He(),t>2e3?h("Stay safe and take breaks!",0):t===0&&h("Infinite words! Make sure to use Bail Out from the command line to save your result.",0,{duration:7})):h("Custom word amount must be at least 1",0),PF(!0)}const Ib=new et({dialogId:"customWordAmountModal",setup:async t=>{t.addEventListener("submit",e=>{e.preventDefault(),RF()})}}),DF=["language","funbox","tags"],sd={},Wa={_id:"default-result-filters-id",name:"default result filters",pb:{no:!0,yes:!0},difficulty:{normal:!0,expert:!0,master:!0},mode:{words:!0,time:!0,quote:!0,zen:!0,custom:!0},words:{10:!0,25:!0,50:!0,100:!0,custom:!0},time:{15:!0,30:!0,60:!0,120:!0,custom:!0},quoteLength:{short:!0,medium:!0,long:!0,thicc:!0},punctuation:{on:!0,off:!0},numbers:{on:!0,off:!0},date:{last_day:!1,last_week:!1,last_month:!1,last_3months:!1,all:!0},tags:{none:!0},language:{},funbox:{none:!0}};let Me=Wa;function En(){window.localStorage.setItem("resultFilters",JSON.stringify(Me))}async function NF(){try{const t=window.localStorage.getItem("resultFilters")??"";if(!t)Me=Wa;else{const a=JSON.parse(t);let s=!1;for(const n of Object.keys(Wa)){if(s)break;if(a[n]===void 0){s=!0;break}if(typeof Wa[n]=="object"){for(const r of Object.keys(Wa[n]))if(a[n][r]===void 0){s=!0;break}}}s?Me=Wa:Me=a}const e={none:!1};Object.keys(Wa.tags).forEach(a=>{Me.tags[a]!==void 0?e[a]=Me.tags[a]:e[a]=!0}),Me.tags=e,En()}catch{console.log("error in loading result filters"),Me=Wa,En()}}async function Ob(){var s;const t=document.querySelector(".pageAccount .presetFilterButtons"),e=document.querySelector(".pageAccount .presetFilterButtons .filterBtns");if(!t||!e)return;e.innerHTML="";const a=((s=S())==null?void 0:s.filterPresets.map(n=>(n.name=n.name.replace(/_/g," "),n)))??[];if(a.length>0){let n="";for(const r of a)n+=`<div class="filterPresets">
      <div class="select-filter-preset button" data-id="${r._id}">${r.name} </div>
      <div class="button delete-filter-preset" data-id="${r._id}">
        <i class="fas fa-fw fa-trash"></i>
      </div>
    </div>`;e.innerHTML=n,t.classList.remove("hidden")}else t.classList.add("hidden")}async function WF(t){var a;const e=(a=S())==null?void 0:a.filterPresets.find(s=>s._id===t);e&&(Me=UF(e),En(),Rn()),i(".pageAccount .group.presetFilterButtons .filterBtns .filterPresets .select-filter-preset").removeClass("active"),i(`.pageAccount .group.presetFilterButtons .filterBtns .filterPresets .select-filter-preset[data-id=${t}]`).addClass("active")}function OT(t){return JSON.parse(JSON.stringify(t))}function BF(t){const e=S();e&&aa({...e,filterPresets:[...e.filterPresets,OT(t)]})}async function ZF(t){t=t.replace(/ /g,"_"),Je();const e=await Z.users.addResultFilterPreset({...Me,name:t});Te(),e.status===200?(BF({...Me,name:t,_id:e.data}),Ob(),h("Filter preset created",1)):(h("Error creating filter preset: "+e.message,-1),console.log("error creating filter preset: "+e.message))}function qF(t){const e=S();if(!e)return;const a=[...e.filterPresets],s=a.findIndex(n=>n._id===t);s>-1&&a.splice(s,1),aa({...e,filterPresets:a})}async function FF(t){Je();const e=await Z.users.removeResultFilterPreset(t);Te(),e.status===200?(qF(t),Ob(),Rb(),h("Filter preset deleted",1)):(h("Error deleting filter preset: "+e.message,-1),console.log("error deleting filter preset",e.message))}function Pb(){i(".pageAccount .group.presetFilterButtons .filterBtns .filterPresets .select-filter-preset").removeClass("active")}function Fo(){return Me}function Fy(t){return Me[t]}function Et(t,e){return Me[t][e]}function jF(t,e,a){Me[t][e]=a}function qs(t,e){Object.keys(Fy(t)).forEach(a=>{Me[t][a]=e})}function HF(t){t.forEach(e=>{Wa.tags[e._id]=!0})}function Rb(){Me=Wa,En()}function Rn(){var s,n,r,o,l;const t={};for(const u of pr(Fo()))if(!(u==="_id"||u==="name")){t[u]={all:!0,array:[]};for(const c of pr(Fy(u))){const p=t[u];if(p===void 0)continue;const f=Et(u,c);if(f===!0?(s=p.array)==null||s.push(c):p.all!==void 0&&(p.all=!1),DF.includes(u)){const m=i(`.pageAccount .group.filterButtons .filterGroup[group="${u}"] option[value="${c}"]`);f===!0?m.prop("selected",!0):m.prop("selected",!1)}else{let m;u==="date"?m=i(`.pageAccount .group.topFilters .filterGroup[group="${u}"] button[filter="${c}"]`):m=i(`.pageAccount .group.filterButtons .filterGroup[group="${u}"] button[filter="${c}"]`),f===!0?m.addClass("active"):m.removeClass("active")}}}for(const[u,c]of Object.entries(sd)){const p=c,f=Fy(u),m=Object.values(f).every(v=>v===!0),g=p.store.getData(),y=i(`.pageAccount .group.filterButtons .filterGroup[group="${u}"] option[value="all"]`);if(m){y.prop("selected",!0);for(const v of g)"value"in v&&(v.value==="all"?v.selected=!0:v.selected=!1);p.store.setData(g),p.render.renderValues()}else y.prop("selected",!1);for(const v of g)"value"in v&&(f[v.value]===!0?v.selected=!0:(!m||v.value!=="all")&&(v.selected=!1));setTimeout(()=>{p.store.setData(g),m||p.render.renderValues(),p.render.renderOptions(g)},0)}function e(u){var p,f,m,g,y;let c="";return c+="<div class='group'>",u==="difficulty"?c+='<span aria-label="Difficulty" data-balloon-pos="up"><i class="fas fa-fw fa-star"></i>':u==="mode"?c+='<span aria-label="Mode" data-balloon-pos="up"><i class="fas fa-fw fa-bars"></i>':u==="punctuation"?c+='<span aria-label="Punctuation" data-balloon-pos="up"><i class="fas fa-fw fa-at"></i>':u==="numbers"?c+='<span aria-label="Numbers" data-balloon-pos="up"><i class="fas fa-fw fa-hashtag"></i>':u==="words"?c+='<span aria-label="Words" data-balloon-pos="up"><i class="fas fa-fw fa-font"></i>':u==="time"?c+='<span aria-label="Time" data-balloon-pos="up"><i class="fas fa-fw fa-clock"></i>':u==="date"?c+='<span aria-label="Date" data-balloon-pos="up"><i class="fas fa-fw fa-calendar"></i>':u==="tags"?c+='<span aria-label="Tags" data-balloon-pos="up"><i class="fas fa-fw fa-tags"></i>':u==="language"?c+='<span aria-label="Language" data-balloon-pos="up"><i class="fas fa-fw fa-globe-americas"></i>':u==="funbox"&&(c+='<span aria-label="Funbox" data-balloon-pos="up"><i class="fas fa-fw fa-gamepad"></i>'),(p=t[u])!=null&&p.all?c+="all":u==="tags"?c+=(m=(f=t.tags)==null?void 0:f.array)==null?void 0:m.map(v=>{var $,se,te;if(v==="none")return v;const A=S();if(A===void 0)return v;const W=($=A.tags)==null?void 0:$.filter(b=>b._id===v)[0];return W!==void 0?(te=(se=A.tags)==null?void 0:se.filter(b=>b._id===v)[0])==null?void 0:te.display:W}).join(", "):c+=(y=(g=t[u])==null?void 0:g.array)==null?void 0:y.join(", ").replace(/_/g," "),c+="</span></div>",c}let a="";a+=e("date"),a+='<div class="spacer"></div>',a+=e("mode"),a+='<div class="spacer"></div>',(r=(n=t.mode)==null?void 0:n.array)!=null&&r.includes("time")&&(a+=e("time"),a+='<div class="spacer"></div>'),(l=(o=t.mode)==null?void 0:o.array)!=null&&l.includes("words")&&(a+=e("words"),a+='<div class="spacer"></div>'),a+=e("difficulty"),a+='<div class="spacer"></div>',a+=e("punctuation"),a+='<div class="spacer"></div>',a+=e("numbers"),a+='<div class="spacer"></div>',a+=e("language"),a+='<div class="spacer"></div>',a+=e("funbox"),a+='<div class="spacer"></div>',a+=e("tags"),setTimeout(()=>{i(".pageAccount .group.chart .above").html(a)},0)}function zF(t,e){Pb();try{t==="date"&&qs("date",!1);const s=!Me[t][e];Me[t][e]=s,En()}catch(a){h("Something went wrong toggling filter. Reverting to defaults.",0),console.log("toggling filter error"),console.error(a),Rb(),Rn()}}i(".pageAccount .filterButtons .buttonsAndTitle .buttons, .pageAccount .group.topFilters .buttonsAndTitle.testDate .buttons").on("click","button",t=>{const e=i(t.target).parents(".buttons").attr("group"),a=i(t.target).attr("filter");i(t.target).hasClass("allFilters")?(pr(Fo()).forEach(s=>{s==="_id"||s==="name"||qs(s,!0)}),qs("date",!1),Me.date.all=!0):i(t.target).hasClass("noFilters")?pr(Fo()).forEach(s=>{s==="_id"||s==="name"||s!=="date"&&qs(s,!1)}):i(t.target).is("button")&&(t.shiftKey?(qs(e,!1),Me[e][a]=!0):zF(e,a)),Rn(),En()});i(".pageAccount .topFilters button.allFilters").on("click",()=>{Pb(),console.log(Fo()),pr(Fo()).forEach(t=>{t==="_id"||t==="name"||qs(t,!0)}),qs("date",!1),Me.date.all=!0,Rn(),En()});i(".pageAccount .topFilters button.currentConfigFilter").on("click",()=>{var t,e;if(Pb(),pr(Fo()).forEach(a=>{a==="_id"||a==="name"||qs(a,!1)}),Me.pb.no=!0,Me.pb.yes=!0,Me.difficulty[d.difficulty]=!0,Me.mode[d.mode]=!0,d.mode==="time")if([15,30,60,120].includes(d.time)){const a=d.time;Me.time[a]=!0}else Me.time.custom=!0;else if(d.mode==="words")if([10,25,50,100,200].includes(d.words)){const a=d.words;Me.words[a]=!0}else Me.words.custom=!0;else d.mode==="quote"&&["short","medium","long","thicc"].forEach((s,n)=>{d.quoteLength.includes(n)?Me.quoteLength[s]=!0:Me.quoteLength[s]=!1});if(d.punctuation?Me.punctuation.on=!0:Me.punctuation.off=!0,d.numbers?Me.numbers.on=!0:Me.numbers.off=!0,d.mode==="quote"&&/english.*/.test(d.language)?Me.language.english=!0:Me.language[d.language]=!0,d.funbox==="none")Me.funbox.none=!0;else for(const a of d.funbox.split("#"))Me.funbox[a]=!0;Me.tags.none=!0,(e=(t=S())==null?void 0:t.tags)==null||e.forEach(a=>{a.active===!0&&(Me.tags.none=!1,Me.tags[a._id]=!0)}),Me.date.all=!0,Rn(),En()});i(".pageAccount .topFilters button.toggleAdvancedFilters").on("click",()=>{i(".pageAccount .filterButtons").slideToggle(250),i(".pageAccount .topFilters button.toggleAdvancedFilters").toggleClass("active")});function ng(t,e=0){const a=sd[t];if(a===void 0)return;const s=a.render.content.list,n=s.children.item(e);s.scrollTop=n.offsetTop-s.offsetTop}function ig(t,e,a){const s=e.some(r=>r.value==="all"),n=a.some(r=>r.value==="all");s?n?e.length<a.length&&(e=e.filter(r=>r.value!=="all")):e=e.filter(r=>r.value==="all"):n&&(e=[]),qs(t,!1);for(const r of e){if(r.value==="all"){qs(t,!0);break}jF(t,r.value,!0)}return Rn(),En(),PT(),!1}let PT=()=>{};async function KF(t){var n;PT=t;let e;try{e=await ov()}catch(r){console.error(Re(r,"Failed to append language buttons"))}if(e){let r="";r+="<select class='languageSelect' group='language' placeholder='select a language' multiple>",r+="<option value='all'>all</option>";for(const l of e)r+=`<option value="${l}" filter="${l}">${ki(l)}</option>`;r+="</select>";const o=document.querySelector(".pageAccount .content .filterButtons .buttonsAndTitle.languages .select");o&&(o.innerHTML=r,sd.language=new Vt({select:o.querySelector(".languageSelect"),settings:{showSearch:!0,placeholderText:"select a language",allowDeselect:!0,closeOnSelect:!1},events:{beforeChange:(l,u)=>ig("language",l,u),beforeOpen:()=>{ng("language")}}}))}let a;try{a=await yc()}catch(r){console.error(Re(r,"Failed to append funbox buttons"))}if(a){let r="";r+="<select class='funboxSelect' group='funbox' placeholder='select a funbox' multiple>",r+="<option value='all'>all</option>",r+="<option value='none'>no funbox</option>";for(const l of a)r+=`<option value="${l.name}" filter="${l.name}">${l.name.replace(/_/g," ")}</option>`;r+="</select>";const o=document.querySelector(".pageAccount .content .filterButtons .buttonsAndTitle.funbox .select");o&&(o.innerHTML=r,sd.funbox=new Vt({select:o.querySelector(".funboxSelect"),settings:{showSearch:!0,placeholderText:"select a funbox",allowDeselect:!0,closeOnSelect:!1},events:{beforeChange:(l,u)=>ig("funbox",l,u),beforeOpen:()=>{ng("funbox")}}}))}const s=S();if(s!==void 0&&(((n=s.tags)==null?void 0:n.length)??0)>0){i(".pageAccount .content .filterButtons .buttonsAndTitle.tags").removeClass("hidden");let r="";r+="<select class='tagsSelect' group='tags' placeholder='select a tag' multiple>",r+="<option value='all'>all</option>",r+="<option value='none'>no tag</option>";for(const l of s.tags)r+=`<option value="${l._id}" filter="${l.name}">${l.display}</option>`;r+="</select>";const o=document.querySelector(".pageAccount .content .filterButtons .buttonsAndTitle.tags .select");o&&(o.innerHTML=r,sd.tags=new Vt({select:o.querySelector(".tagsSelect"),settings:{showSearch:!0,placeholderText:"select a tag",allowDeselect:!0,closeOnSelect:!1},events:{beforeChange:(l,u)=>ig("tags",l,u),beforeOpen:()=>{ng("tags")}}}))}else i(".pageAccount .content .filterButtons .buttonsAndTitle.tags").addClass("hidden");Ob()}function VF(){i(".pageAccount .content .filterButtons .buttonsAndTitle.languages .buttons").empty(),i(".pageAccount .content .filterButtons .buttonsAndTitle.funbox .buttons").empty(),i(".pageAccount .content .filterButtons .buttonsAndTitle.tags .buttons").empty()}i(".group.presetFilterButtons .filterBtns").on("click",".filterPresets .delete-filter-preset",t=>{FF(i(t.currentTarget).data("id"))});function UF(t){const e=OT(t);return Object.entries(Wa).forEach(a=>{const s=a[0],n=a[1];e[s]===void 0&&(e[s]=n)}),e}function GF(t,e){i(".pageAccount .miniResultChartWrapper").css({top:e,left:t})}function QF(){i(".pageAccount .miniResultChartWrapper").stop(!0,!0).fadeIn(125),i(".pageAccount .miniResultChartBg").stop(!0,!0).fadeIn(125)}function RT(){i(".pageAccount .miniResultChartWrapper").stop(!0,!0).fadeOut(125),i(".pageAccount .miniResultChartBg").stop(!0,!0).fadeOut(125)}function YF(t){let e=[];for(let r=1;r<=t.wpm.length;r++)e.push(r.toString());t.wpm=t.wpm.slice(0,t.raw.length),t.err=t.err.slice(0,t.raw.length),e=e.slice(0,t.raw.length);const a=sk(t.raw,1);Va.data.labels=e,Va.getDataset("wpm").data=t.wpm,Va.getDataset("raw").data=a,Va.getDataset("error").data=t.err;const s=Math.max(Math.max(...t.wpm),Math.max(...t.raw)),n=Math.min(Math.min(...t.wpm),Math.min(...t.raw));Va.getScale("wpm").max=Math.round(s),Va.getScale("raw").max=Math.round(s),d.startGraphsAtZero?(Va.getScale("wpm").min=0,Va.getScale("raw").min=0):(Va.getScale("wpm").min=Math.round(n),Va.getScale("raw").min=Math.round(n)),Va.updateColors()}i(document).on("keydown",t=>{t.key==="Escape"&&iv(".pageAccount .miniResultChartWrapper")&&(RT(),t.preventDefault())});i(".pageAccount").on("click",".miniResultChartBg",()=>{RT()});function JF(t){const e=t?"Profile":"Account",s=t?"":`<div class="buttonGroup"><button
  class="showAllButton"
  data-balloon-pos="left"
  aria-label="Show all personal bests"
>
  <i class="fas fa-ellipsis-v"></i>
</button></div>`;i(`.page${e} .profile .pbsWords`).html(`
      <div class="group">
      <div class="quick">
        <div class="test">10 words</div>
        <div class="wpm">-</div>
        <div class="acc">-</div>
      </div>
    </div>
    <div class="group">
      <div class="quick">
        <div class="test">25 words</div>
        <div class="wpm">-</div>
        <div class="acc">-</div>
      </div>
    </div>
    <div class="group">
      <div class="quick">
        <div class="test">50 words</div>
        <div class="wpm">-</div>
        <div class="acc">-</div>
      </div>
    </div>
    <div class="group">
      <div class="quick">
        <div class="test">100 words</div>
        <div class="wpm">-</div>
        <div class="acc">-</div>
      </div>
    </div>
    ${s}
  `),i(`.page${e} .profile .pbsTime`).html(`
      <div class="group">
      <div class="quick">
        <div class="test">15 seconds</div>
        <div class="wpm">-</div>
        <div class="acc">-</div>
      </div>
    </div>
    <div class="group">
      <div class="quick">
        <div class="test">30 seconds</div>
        <div class="wpm">-</div>
        <div class="acc">-</div>
      </div>
    </div>
    <div class="group">
      <div class="quick">
        <div class="test">60 seconds</div>
        <div class="wpm">-</div>
        <div class="acc">-</div>
      </div>
    </div>
    <div class="group">
      <div class="quick">
        <div class="test">120 seconds</div>
        <div class="wpm">-</div>
        <div class="acc">-</div>
      </div>
    </div>
    ${s}
  `)}function jy(t,e=!1){if(JF(e),t===void 0)return;let a="";const s=e?"Profile":"Account";i(`.page${s} .profile .pbsTime`).html(""),i(`.page${s} .profile .pbsWords`).html("");const n=["15","30","60","120"],r=["10","25","50","100"];n.forEach(l=>{a+=n0(t,"time",l)});const o=e?"":`<div class="buttonGroup"><button
      class="showAllButton"
      data-balloon-pos="left"
      aria-label="Show all personal bests"
    >
      <i class="fas fa-ellipsis-v"></i>
    </button></div>`;i(`.page${s} .profile .pbsTime`).append(a+o),a="",r.forEach(l=>{a+=n0(t,"words",l)}),i(`.page${s} .profile .pbsWords`).append(a+o)}function n0(t,e,a){let s="",n="";const r=`${a} ${e==="time"?"seconds":"words"}`,o=d.typingSpeedUnit;try{const l=(t[e][a]??[]).sort((c,p)=>p.wpm-c.wpm)[0];if(l===void 0)throw new Error("No PB data found");const u=new Date(l.timestamp);l.timestamp!==void 0&&l.timestamp>0&&(n=nt(u,"dd MMM yyyy")),s=`<div class="quick">
      <div class="test">${r}</div>
      <div class="wpm">${ue.typingSpeed(l.wpm,{showDecimalPlaces:!1})}</div>
      <div class="acc">${ue.accuracy(l.acc,{showDecimalPlaces:!1})}</div>
    </div>
    <div class="fullTest">
      <div>${r}</div>
      <div>${ue.typingSpeed(l.wpm,{suffix:` ${o}`})}</div>
      <div>${ue.typingSpeed(l.raw,{suffix:" raw"})}</div>
      <div>${ue.accuracy(l.acc,{suffix:" acc"})}</div>
      <div>${ue.percentage(l.consistency,{suffix:" con"})}</div>
      <div>${n}</div>
    </div>`}catch{s=`<div class="quick">
    <div class="test">${r}</div>
    <div class="wpm">-</div>
    <div class="acc">-</div>
  </div>`}return`
  <div class="group">
  ${s}
  </div>
  `}const DT={1:{id:1,name:"Developer",description:"I made this",icon:"fa-laptop",color:"white",customStyle:"animation: rgb-bg 10s linear infinite;"},2:{id:2,name:"Collaborator",description:"I helped make this",icon:"fa-code",color:"white",customStyle:"animation: rgb-bg 10s linear infinite;"},3:{id:3,name:"Server Mod",description:"Discord server moderator",icon:"fa-hammer",color:"white",customStyle:"animation: rgb-bg 10s linear infinite;"},4:{id:4,name:"OG Account",description:"First 1000 users on the site",icon:"fa-baby",color:"var(--bg-color)",background:"var(--main-color)"},5:{id:5,name:"OG Discordian",description:"First 1000 Discord server members",icon:"fa-baby",color:"var(--bg-color)",background:"var(--main-color)"},6:{id:6,name:"Supporter",description:"Donated money",icon:"fa-heart",color:"var(--text-color)",background:"var(--sub-color)"},7:{id:7,name:"Sugar Daddy",description:"Donated a lot of money",icon:"fa-gem",color:"var(--bg-color)",background:"var(--main-color)"},8:{id:8,name:"Monkey Supporter",description:"Donated more money",icon:"fa-heart",color:"var(--bg-color)",background:"var(--main-color)"},9:{id:9,name:"White Hat",description:"Reported critical vulnerabilities on the site",icon:"fa-user-secret",color:"var(--bg-color)",background:"var(--main-color)"},10:{id:10,name:"Bug Hunter",description:"Reported or helped track down bugs on the site",icon:"fa-bug",color:"var(--text-color)",background:"var(--sub-color)"},11:{id:11,name:"Content Creator",description:"Verified content creator",icon:"fa-video",color:"var(--text-color)",background:"var(--sub-color)"},12:{id:12,name:"Contributor",description:"Contributed to the site",icon:"fa-hands-helping",color:"var(--text-color)",background:"var(--sub-color)"},13:{id:13,name:"Mythical",description:"Yes, I'm actually this fast",icon:"fa-rocket",color:"white",customStyle:"animation: rgb-bg 10s linear infinite;"},14:{id:14,name:"All Year Long",description:"Reached a streak of 365 days",icon:"fa-fire",color:"var(--bg-color)",background:"var(--main-color)"}};function km(t,e=!1,a=!1,s=!1){const n=DT[t];if(!n&&!s)return"";let r="";(n==null?void 0:n.background)!==void 0&&(r+=`background: ${n.background};`),(n==null?void 0:n.color)!==void 0&&(r+=`color: ${n.color};`),(n==null?void 0:n.customStyle)!==void 0&&(r+=n.customStyle);const o=(n==null?void 0:n.name)??"Badge Name Missing",l=(n==null?void 0:n.description)??"Badge Description Missing",u=(e?o+": ":"")+l;let c="";a||(c=`aria-label="${u}" data-balloon-pos="right"`);let p="";(n==null?void 0:n.icon)!==void 0?p=`<i class="fas ${e?"fa-fw":""} ${n.icon}"></i>`:p='<i class="fas fa-question"></i>';const f=`<div class="text">${o}</div>`;return`<div class="badge" ${c} style="${r}">${p}${e?"":f}</div>`}function XF(t){return DT[t]}async function xm(t,e){var $,se,te,b,w,q,me,qt,Ft,jt,Ut,ds,nl,Dn,il,rl,ol,Xc,ll,Bi;const a=t.charAt(0).toUpperCase()+t.slice(1),s=i(`.page${a} .profile`),n=i(`.page${a} .profile .details`);s.attr("uid",e.uid??""),s.attr("name",e.name??"");const r=e.banned===!0;if(n===void 0||e===void 0||e.name===void 0||e.addedAt===void 0)return;if(n.find(".placeholderAvatar").removeClass("hidden"),e.discordAvatar!==void 0&&e.discordId!==void 0&&!r?nv(e.discordId,e.discordAvatar,256).then(at=>{at!==null&&(n.find(".placeholderAvatar").addClass("hidden"),n.find(".avatar").css("background-image",`url(${at})`))}):n.find(".avatar").removeAttr("style"),($=e.inventory)!=null&&$.badges&&!r){let at="",At="";for(const Mt of e.inventory.badges)Mt.selected===!0?at=km(Mt.id):At+=km(Mt.id,!0);n.find(".badges").empty().append(at),n.find(".allBadges").empty().append(At)}n.find(".name").text(e.name),n.find(".userFlags").html(sh(e)),e.lbOptOut===!0&&(t==="profile"?s.find(".lbOptOutReminder").removeClass("hidden").text("Note: This account has opted out of the leaderboards, meaning their results aren't verified by the anticheat system and may not be legitimate."):s.find(".lbOptOutReminder").addClass("hidden")),setTimeout(()=>{Db(t)},10);const o="Joined "+nt(e.addedAt??0,"dd MMM yyyy"),l=new Date(e.addedAt),u=Jr(new Date,l),c=`${u} day${u!==1?"s":""} ago`;n.find(".joined").text(o).attr("aria-label",c);let p="";if(e.streak&&(e==null?void 0:e.streak)>1?(n.find(".streak").text(`Current streak: ${e.streak} ${e.streak===1?"day":"days"}`),p=`Longest streak: ${e.maxStreak} ${e.maxStreak===1?"day":"days"}`):(n.find(".streak").text(""),p=""),t==="account"){const at=(se=S())==null?void 0:se.results,At=at==null?void 0:at[0],Mt=e.streakHourOffset,ga=1e3*60*60*24;let Nn=hp(Mt)+ga;Nn<Date.now()&&(Nn+=ga);const nn=lk(Nn);if(console.debug("Streak hour offset"),console.debug("date.now()",Date.now(),new Date(Date.now())),console.debug("dayInMilis",ga),console.debug("difTarget",new Date(hp(Mt)+ga)),console.debug("timeDif",nn),console.debug("DateTime.getCurrentDayTimestamp()",hp(),new Date(hp())),console.debug("profile.streakHourOffset",Mt),At){const x=hB(At.timestamp,Mt),_t=mB(At.timestamp,Mt);console.debug("lastResult.timestamp",At.timestamp,new Date(At.timestamp)),console.debug("isToday",x),console.debug("isYesterday",_t);const Lt=Mt?`(${Mt>0?"+":""}${Mt} offset)`:"";x?(p+=`
Claimed today: yes`,p+=`
Come back in: ${nn} ${Lt}`):_t?(p+=`
Claimed today: no`,p+=`
Streak lost in: ${nn} ${Lt}`):(p+=`
Streak lost ${nn} ${Lt} ago`,p+=`
It will be removed from your profile on the next result save`),console.debug(p),Mt===void 0&&(p+=`

If the streak reset time doesn't line up with your timezone, you can change it in Settings > Danger zone > Update streak hour offset.`)}}n.find(".streak").attr("aria-label",p).attr("data-balloon-break","");let f="",m="";e.typingStats.completedTests!==void 0&&e.typingStats.startedTests!==void 0&&(f=Math.floor(e.typingStats.completedTests/e.typingStats.startedTests*100).toString(),m=((e.typingStats.startedTests-e.typingStats.completedTests)/e.typingStats.completedTests).toFixed(1));const g=n.find(".typingStats");g.find(".started .value").text(((te=e.typingStats)==null?void 0:te.startedTests)??0),g.find(".completed .value").text(((b=e.typingStats)==null?void 0:b.completedTests)??0).attr("data-balloon-pos","up").attr("aria-label",`${f}% (${m} restarts per completed test)`),g.find(".timeTyping .value").text(Ta(Math.round(((w=e.typingStats)==null?void 0:w.timeTyping)??0),!0,!0));let y=!1,v=!1,A=!1;if(!r&&(y=!!(((q=e.details)==null?void 0:q.bio)??""),n.find(".bio .value").text(((me=e.details)==null?void 0:me.bio)??""),v=!!(((qt=e.details)==null?void 0:qt.keyboard)??""),n.find(".keyboard .value").text(((Ft=e.details)==null?void 0:Ft.keyboard)??""),((jt=e.details)==null?void 0:jt.socialProfiles.github)!==void 0||((Ut=e.details)==null?void 0:Ut.socialProfiles.twitter)!==void 0||((ds=e.details)==null?void 0:ds.socialProfiles.website)!==void 0)){A=!0;const at=n.find(".socials .value");at.empty();const At=((nl=e.details)==null?void 0:nl.socialProfiles.github)??"";At&&at.append(`<a href='https://github.com/${Ba(At)}/' target="_blank" rel="nofollow me" aria-label="${Ba(At)}" data-balloon-pos="up" class="textButton"><i class="fab fa-fw fa-github"></i></a>`);const Mt=((Dn=e.details)==null?void 0:Dn.socialProfiles.twitter)??"";Mt&&at.append(`<a href='https://x.com/${Ba(Mt)}' target="_blank" rel="nofollow me" aria-label="${Ba(Mt)}" data-balloon-pos="up" class="textButton"><i class="fab fa-fw fa-twitter"></i></a>`);const ga=((il=e.details)==null?void 0:il.socialProfiles.website)??"",Nn=/^https?:\/\/(?:www\.)?([^/]+)/,nn=((rl=ga==null?void 0:ga.match(Nn))==null?void 0:rl[1])??ga;ga&&at.append(`<a href='${Ba(ga)}' target="_blank" rel="nofollow me" aria-label="${Ba(nn??"")}" data-balloon-pos="up" class="textButton"><i class="fas fa-fw fa-globe"></i></a>`)}if(NT(e.xp??0),r)s.find(".leaderboardsPositions").addClass("hidden");else{s.find(".leaderboardsPositions").removeClass("hidden");const at=((Xc=(ol=e.allTimeLbs.time)==null?void 0:ol["15"])==null?void 0:Xc.english)??null,At=((Bi=(ll=e.allTimeLbs.time)==null?void 0:ll["60"])==null?void 0:Bi.english)??null;at===null&&At===null?s.find(".leaderboardsPositions").addClass("hidden"):(at!==null&&(s.find(".leaderboardsPositions .group.t15 .pos").text(ue.rank(at==null?void 0:at.rank)),s.find(".leaderboardsPositions .group.t15 .topPercentage").text(i0(at))),At!==null&&(s.find(".leaderboardsPositions .group.t60 .pos").text(ue.rank(At==null?void 0:At.rank)),s.find(".leaderboardsPositions .group.t60 .topPercentage").text(i0(At))))}const W=y||v;y?n.find(".bio").removeClass("hidden"):n.find(".bio").addClass("hidden"),v?n.find(".keyboard").removeClass("hidden"):n.find(".keyboard").addClass("hidden"),W?(n.find(".bioAndKeyboard").removeClass("hidden"),n.find(".sep2").removeClass("hidden")):(n.find(".bioAndKeyboard").addClass("hidden"),n.find(".sep2").addClass("hidden")),A?(n.find(".socials").removeClass("hidden"),n.find(".sep3").removeClass("hidden")):(n.find(".socials").addClass("hidden"),n.find(".sep3").addClass("hidden")),n.removeClass("none"),n.removeClass("bioAndKey"),n.removeClass("soc"),n.removeClass("both"),!A&&!W?n.addClass("none"):A&&!W?n.addClass("soc"):!A&&W?n.addClass("bioAndKey"):A&&W&&n.addClass("both")}function NT(t){const e=i(" .profile .details .levelAndBar");if(e==null)return;const a=Rf(t),s=a.levelMaxXp,n=a.levelCurrentXp;e.find(".level").text(a.level).attr("aria-label",`${_p(t)} total xp`),e.find(".xp").text(`${_p(n)}/${_p(s)}`).attr("aria-label",`${_p(s-n)} xp until next level`),e.find(".xpBar .bar").css("width",`${n/s*100}%`),e.find(".xpBar").attr("aria-label",`${(n/s*100).toFixed(2)}%`)}function Db(t){if(/^((?!chrome|android).)*safari/i.test(navigator.userAgent))return;let a;if(t==="account"?a=i(".pageAccount .profile .details"):t==="profile"&&(a=i(".pageProfile .profile .details")),!a)return;const s=a.find(".user"),n=s.parent()[0],r=s[0],o=fr(2);if(!r||!n)return;r.style.fontSize="10px";const l=n.clientWidth,u=r.clientWidth,p=l/u*10,f=Math.min(Math.max(p,10),o);r.style.fontSize=`${f}px`}const ej=uv(1e3,()=>{const t=Xe();t&&["account","profile"].includes(t)&&Db(t)});i(window).on("resize",()=>{ej()});function i0(t){return t.rank===void 0?"-":t.rank===1?"GOAT":"Top "+we(t.rank/t.count*100)+"%"}function _p(t){return t<1e3?Math.round(t).toString():kA(t)}let WT;function hh(){return WT}async function tj(){const t=await Z.configuration.get();if(t.status!==200){console.error("Could not fetch configuration",t.message);return}else WT=t.data??void 0}function Hy(){i(".pageAccount .resultBatches").addClass("hidden")}function aj(){i(".pageAccount .resultBatches").removeClass("hidden")}async function sj(){var p,f,m,g,y;const t=(p=S())==null?void 0:p.results;if(t===void 0){console.error("(Result batches) Results are missing but they should be available at the time of drawing the account page?"),Hy();return}nj();const e=((m=(f=S())==null?void 0:f.typingStats)==null?void 0:m.completedTests)??0,a=Math.round(t.length/e*100),s=((g=hh())==null?void 0:g.results.limits)??{regularUser:0,premiumUser:0},n=(y=S())!=null&&y.isPremium?s.premiumUser:s.regularUser,r=Math.round((t==null?void 0:t.length)/n*100),o=i(".pageAccount .resultBatches .bars"),l={downloaded:{fill:o.find(".downloaded .fill"),rightText:o.find(".downloaded.rightText")},limit:{fill:o.find(".limit .fill"),rightText:o.find(".limit.rightText")}};l.downloaded.fill.css("width",Math.min(a,100)+"%"),l.downloaded.rightText.text(`${t==null?void 0:t.length} / ${e} (${a}%)`);const u=await Oi();l.limit.fill.css({width:Math.min(r,100)+"%",background:gs(u.sub,u.error,af(r,50,100,0,1))}),l.limit.rightText.text(`${t==null?void 0:t.length} / ${n} (${r}%)`),i(".pageAccount .resultBatches > .text").text(""),t.length>=e&&(zy(),r0("all results loaded")),t.length>=n&&(zy(),r0("limit reached"))}function zy(){i(".pageAccount .resultBatches button").prop("disabled",!0)}function nj(){i(".pageAccount .resultBatches button").prop("disabled",!1)}function r0(t){i(".pageAccount .resultBatches button").text(t)}function ij(){var s,n,r,o;if(!(((s=S())==null?void 0:s.isPremium)??!1)){Hy();return}const e=((r=(n=S())==null?void 0:n.typingStats)==null?void 0:r.completedTests)??0,a=((o=hh())==null?void 0:o.results.maxBatchSize)??0;if(e<=a){Hy();return}aj()}let ba;function rj(t,e){if(t===void 0){i("#testActivity").addClass("hidden");return}i("#testActivity").removeClass("hidden"),ba=qT(),ZT("current",(e==null?void 0:e.getFullYear())||2022),BT(t)}function BT(t){const e=document.querySelector("#testActivity .activity");if(e===null)return;if(e.innerHTML="",t===void 0){o0([]),i("#testActivity .nodata").removeClass("hidden");return}o0(t.getMonths()),i("#testActivity .nodata").addClass("hidden");const a=document.querySelector("#testActivity .title");a!==null&&(a.innerHTML=t.getTotalTests()+" tests");for(const s of t.getDays()){const n=document.createElement("div");n.setAttribute("data-level",s.level),s.label!==void 0&&(n.setAttribute("aria-label",s.label),n.setAttribute("data-balloon-pos","up")),e.appendChild(n)}}function ZT(t,e){var r,o;const a=new Date().getFullYear(),s=[{text:"last 12 months",value:"current",selected:t==="current"}];for(let l=a;l>=e;l--)(s.length<2||(r=hh())!=null&&r.users.premium.enabled&&((o=S())!=null&&o.isPremium))&&s.push({text:l.toString(),value:l.toString(),selected:l===t});const n=qT();n.setData(s),s.length>1?n.enable():n.disable()}function o0(t){const e=document.querySelector("#testActivity .months");e.innerHTML=t.map(a=>`<div style="grid-column: span ${a.weeks}">${a.text}</div>`).join("")}function qT(){return ba!==void 0||(ba=new Vt({select:"#testActivity .yearSelect",settings:{showSearch:!1},events:{afterChange:async t=>{var s;ba==null||ba.disable();const e=(s=t[0])==null?void 0:s.value,a=await nR(e);BT(a),((ba==null?void 0:ba.getData())??[]).length>1&&(ba==null||ba.enable())}}})),ba}let Gt=!1;function oj(){Gt=!Gt,Gt&&console.log("filterDebug is on")}let bt=[],Ki=0;function gh(t){var a;if(bt===void 0||bt.length===0)return;let e;t&&t>Ki?e=Math.ceil(t/10)*10:e=Ki+10;for(let s=Ki;s<e;s++){const n=bt[s];if(!n)continue;let r=n.difficulty;r===void 0&&(r="normal");let o=`<span aria-label="${(a=n.language)==null?void 0:a.replace("_"," ")}" data-balloon-pos="up"><i class="fas fa-fw fa-globe-americas"></i></span>`;r==="normal"?o+=`<span aria-label="${n.difficulty}" data-balloon-pos="up"><i class="far fa-fw fa-star"></i></span>`:r==="expert"?o+=`<span aria-label="${n.difficulty}" data-balloon-pos="up"><i class="fas fa-fw fa-star-half-alt"></i></span>`:r==="master"&&(o+=`<span aria-label="${n.difficulty}" data-balloon-pos="up"><i class="fas fa-fw fa-star"></i></span>`),n.punctuation&&(o+='<span aria-label="punctuation" data-balloon-pos="up"><i class="fas fa-fw fa-at"></i></span>'),n.numbers&&(o+='<span aria-label="numbers" data-balloon-pos="up"><i class="fas fa-fw fa-hashtag"></i></span>'),n.blindMode&&(o+='<span aria-label="blind mode" data-balloon-pos="up"><i class="fas fa-fw fa-eye-slash"></i></span>'),n.lazyMode&&(o+='<span aria-label="lazy mode" data-balloon-pos="up"><i class="fas fa-fw fa-couch"></i></span>'),n.funbox!=="none"&&n.funbox!==void 0&&(o+=`<span aria-label="${n.funbox.replace(/_/g," ").replace(/#/g,", ")}" data-balloon-pos="up"><i class="fas fa-gamepad"></i></span>`),n.chartData===void 0?o+='<span class="miniResultChartButton" aria-label="No chart data found" data-balloon-pos="up"><i class="fas fa-chart-line"></i></span>':n.chartData==="toolong"?o+='<span class="miniResultChartButton" aria-label="Chart history is not available for long tests" data-balloon-pos="up"><i class="fas fa-chart-line"></i></span>':o+=`<span class="miniResultChartButton" aria-label="View graph" data-balloon-pos="up" filteredResultsId="${s}" style="opacity: 1"><i class="fas fa-chart-line"></i></span>`;let l="no tags";n.tags!==void 0&&n.tags.length>0&&(l="",n.tags.forEach(A=>{var W,$;($=(W=S())==null?void 0:W.tags)==null||$.forEach(se=>{A===se._id&&(l+=se.display+", ")})}),l=l.substring(0,l.length-2));let u;n.tags===void 0?u="[]":u=JSON.stringify(n.tags);const c=n.tags!==void 0&&n.tags.length>0,p=n.tags!==void 0&&n.tags.length>1?"fa-tags":"fa-tag",f=`<button class="textButton resultEditTagsButton ${c?"active":""}" data-result-id="${n._id}" data-tags='${u}' aria-label="${l}" data-balloon-pos="up"><i class="fas fa-fw ${p}"></i></button>`;let m="";n.isPb?m='<i class="fas fa-fw fa-crown"></i>':m="";const g=n.charStats.join("/"),y=n.mode==="custom"?"":n.mode2,v=new Date(n.timestamp);i(".pageAccount .history table tbody").append(`
    <tr class="resultRow" id="result-${s}">
    <td>${m}</td>
    <td>${ue.typingSpeed(n.wpm,{showDecimalPlaces:!0})}</td>
    <td>${ue.typingSpeed(n.rawWpm,{showDecimalPlaces:!0})}</td>
    <td>${ue.percentage(n.acc,{showDecimalPlaces:!0})}</td>
    <td>${ue.percentage(n.consistency,{showDecimalPlaces:!0})}</td>
    <td>${g}</td>
    <td>${n.mode} ${y}</td>
    <td class="infoIcons">${o}</td>
    <td>${f}</td>
    <td>${nt(v,"dd MMM yyyy")}<br>
    ${nt(v,"HH:mm")}
    </td>
    </tr>`)}Ki=e,Ki>=bt.length?i(".pageAccount .loadMoreButton").addClass("hidden"):i(".pageAccount .loadMoreButton").removeClass("hidden")}async function lj(){await de.updateColors(),await vt(0),await si.updateColors(),await vt(0),await uo.updateColors(),await vt(0)}function dj(){i(".pageAccount .history table tbody").empty(),uo.getDataset("count").data=[],si.getDataset("count").data=[],si.getDataset("avgWpm").data=[],de.getDataset("wpm").data=[],de.getDataset("pb").data=[],de.getDataset("acc").data=[],de.getDataset("wpmAvgTen").data=[],de.getDataset("accAvgTen").data=[],de.getDataset("wpmAvgHundred").data=[],de.getDataset("accAvgHundred").data=[]}let Cp=0,va=[],Fr=[];async function FT(){var ga,Nn,nn;If("Displaying stats..."),Rs(100),console.log("updating account page"),$c();const t=S();if(!t)return;jy(t.personalBests),xm("account",t),rj(t.testActivity,new Date(t.addedAt)),sj(),va=[],Fr=[];const e=[];Ki=0;let a=0,s="",n=0,r=0,o=0,l=0,u=0,c=0,p=0,f=0;const m={total:0,count:0,last10Total:0,last10Count:0,max:0};let g=0;Cp=0;let y=0,v=0,A=0,W=0;const $={},se=[],te=ea(d.typingSpeedUnit);bt=[],i(".pageAccount .history table tbody").empty(),(Nn=(ga=S())==null?void 0:ga.results)==null||Nn.forEach(x=>{var rn,dl,tp,ap;try{if(!Et("pb",x.isPb?"yes":"no")){Gt&&console.log("skipping result due to pb filter",x);return}let Na=x.difficulty;if(Na===void 0&&(Na="normal"),!Et("difficulty",Na)){Gt&&console.log("skipping result due to difficulty filter",x);return}if(!Et("mode",x.mode)){Gt&&console.log("skipping result due to mode filter",x);return}if(x.mode==="time"){let Ot="custom";if(["15","30","60","120"].includes(`${x.mode2}`)&&(Ot=`${x.mode2}`),!Et("time",Ot)){Gt&&console.log("skipping result due to time filter",x);return}}else if(x.mode==="words"){let Ot="custom";if(["10","25","50","100","200"].includes(`${x.mode2}`)&&(Ot=`${x.mode2}`),!Et("words",Ot)){Gt&&console.log("skipping result due to word filter",x);return}}if(x.quoteLength!==null){let Ot;if(x.quoteLength===0?Ot="short":x.quoteLength===1?Ot="medium":x.quoteLength===2?Ot="long":x.quoteLength===3&&(Ot="thicc"),Ot!==void 0&&!Et("quoteLength",Ot)){Gt&&console.log("skipping result due to quoteLength filter",x);return}}let qi=Et("language",x.language??"english");if(x.language==="english_expanded"&&Et("language","english_1k")&&(qi=!0),!qi){Gt&&console.log("skipping result due to language filter",x);return}let sp="off";if(x.punctuation&&(sp="on"),!Et("punctuation",sp)){Gt&&console.log("skipping result due to punctuation filter",x);return}let np="off";if(x.numbers&&(np="on"),!Et("numbers",np)){Gt&&console.log("skipping result due to numbers filter",x);return}if(x.funbox==="none"||x.funbox===void 0){if(!Et("funbox","none")){Gt&&console.log("skipping result due to funbox filter",x);return}}else{let Ot=0;for(const Rr of x.funbox.split("#"))if(Et("funbox",Rr)){Ot++;break}if(Ot===0){Gt&&console.log("skipping result due to funbox filter",x);return}}let ya=!0;if(x.tags===void 0||x.tags.length===0)(((dl=(rn=S())==null?void 0:rn.tags)==null?void 0:dl.length)??0)>0?Et("tags","none")&&(ya=!1):ya=!1;else{const Ot=(ap=(tp=S())==null?void 0:tp.tags)==null?void 0:ap.map(Rr=>Rr._id);if(Ot===void 0)return;x.tags.forEach(Rr=>{ya&&(Ot!=null&&Ot.includes(Rr)?Et("tags",Rr)&&(ya=!1):Et("tags","none")&&(ya=!1))})}if(ya){Gt&&console.log("skipping result due to tag filter",x);return}const Ka=Math.abs(x.timestamp-Date.now())/1e3;let sw=!0;if((Et("date","all")||Et("date","last_day")&&Ka<=86400||Et("date","last_week")&&Ka<=604800||Et("date","last_month")&&Ka<=2592e3||Et("date","last_3months")&&Ka<=7776e3)&&(sw=!1),sw){Gt&&console.log("skipping result due to date filter",x);return}bt.push(x)}catch(Na){h("Something went wrong when filtering. Resetting filters.",0),console.log(x),console.error(Na),Rb(),Rn(),jo();return}g+=Math.round(x.wpm/60*x.testDuration);const _t=new Date(x.timestamp);_t.setSeconds(0),_t.setMinutes(0),_t.setHours(0),_t.setMilliseconds(0);const Lt=_t.getTime(),Zi=$[Lt];Zi!==void 0?(Zi.amount++,Zi.time+=x.testDuration+x.incompleteTestSeconds-(x.afkDuration??0),Zi.totalWpm+=x.wpm):$[Lt]={amount:1,time:x.testDuration+x.incompleteTestSeconds-(x.afkDuration??0),totalWpm:x.wpm};const ep=te.histogramDataBucketSize,Pr=Math.floor(Math.round(te.fromWpm(x.wpm))/ep);if(se.length<=Pr)for(let Na=se.length;Na<=Pr;Na++)se.push(0);se[Pr]++;let dt=0;if(x.testDuration===void 0&&x.mode2!=="custom"&&x.mode2!=="zen"?x.mode==="time"?dt=parseInt(x.mode2):x.mode==="words"&&(dt=parseInt(x.mode2)/x.wpm*60):dt=parseFloat(x.testDuration),x.incompleteTestSeconds!==void 0?dt+=x.incompleteTestSeconds:x.restartCount!==void 0&&x.restartCount>0&&(dt+=dt/4*x.restartCount),Cp+=dt,l<10&&(l++,u+=x.wpm,f+=x.acc,x.consistency!==void 0&&(A+=x.consistency)),o++,x.consistency!==void 0&&(W++,v+=x.consistency,x.consistency>y&&(y=x.consistency)),x.rawWpm!==null&&(m.last10Count<10&&(m.last10Count++,m.last10Total+=x.rawWpm),m.total+=x.rawWpm,m.count++,x.rawWpm>m.max&&(m.max=x.rawWpm)),x.acc>c&&(c=x.acc),p+=x.acc,x.restartCount!==void 0&&(n+=x.restartCount),va.push({x:bt.length,y:we(te.fromWpm(x.wpm)),wpm:we(te.fromWpm(x.wpm)),acc:x.acc,mode:x.mode,mode2:x.mode2,punctuation:x.punctuation,language:x.language,timestamp:x.timestamp,difficulty:x.difficulty,raw:we(te.fromWpm(x.rawWpm)),isPb:x.isPb??!1}),e.push(x.wpm),Fr.push({x:bt.length,y:x.acc,errorRate:100-x.acc}),x.wpm>a){const Na=x.punctuation?",<br>with punctuation":"",qi=x.numbers?",<br> "+(x.punctuation?"&":"")+"with numbers":"";a=x.wpm,x.mode==="custom"?s=x.mode:s=x.mode+" "+x.mode2+Na+qi}r+=x.wpm}),i(".pageAccount .group.history table thead tr td:nth-child(2)").text(d.typingSpeedUnit),await vt(0),gh();const b=[],w=[],q=te.historyStepSize;for(const x of Object.keys($)){const _t=parseInt(x),Lt=$[_t];Lt!==void 0&&(b.push({x:_t,y:Lt.time/60,amount:Lt.amount}),w.push({x:_t,y:we(te.fromWpm(Lt.totalWpm)/Lt.amount)}))}const qt=si.options.scales.avgWpm;qt.title.text="Average "+d.typingSpeedUnit,qt.ticks.stepSize=q,si.getDataset("count").data=b,si.getDataset("avgWpm").data=w;const Ft=[],jt=[],Ut=te.histogramDataBucketSize,ds=Ut-(Ut<=1?.01:1);se.forEach((x,_t)=>{const Lt=_t*Ut;jt.push(`${Lt} - ${Lt+ds}`),Ft.push({x:Lt,y:x})}),uo.data.labels=jt,uo.getDataset("count").data=Ft;const Dn=de.options.scales.wpm;if(Dn.title.text=te.fullUnitString,va.length>0){let x=0;const _t=[];for(let dt=va.length-1;dt>=0;dt--){const rn=va[dt];rn.y>x&&(x=rn.y,_t.push(rn))}_t.push({x:1,y:(nn=mi(_t))==null?void 0:nn.y});const Lt=[],Zi=[],ep=[],Pr=[];for(let dt=0;dt<va.length;dt++){const rn=va.slice(dt,dt+10),dl=Fr.slice(dt,dt+10),tp=rn.reduce((ya,{y:Ka})=>ya+Ka,0)/rn.length,ap=dl.reduce((ya,{y:Ka})=>ya+Ka,0)/dl.length;Lt.push({x:dt+1,y:tp}),Zi.push({x:dt+1,y:ap});const Na=va.slice(dt,dt+100),qi=Fr.slice(dt,dt+100),sp=Na.reduce((ya,{y:Ka})=>ya+Ka,0)/Na.length,np=qi.reduce((ya,{y:Ka})=>ya+Ka,0)/qi.length;ep.push({x:dt+1,y:sp}),Pr.push({x:dt+1,y:np})}de.getDataset("wpm").data=va,de.getDataset("pb").data=_t,de.getDataset("acc").data=Fr,de.getDataset("wpmAvgTen").data=Lt,de.getDataset("accAvgTen").data=Zi,de.getDataset("wpmAvgHundred").data=ep,de.getDataset("accAvgHundred").data=Pr,de.getScale("x").max=va.length+1}const il=va.map(x=>x.y),rl=Math.min(...il),ol=Math.max(...il),Xc=isFinite(rl)?rl:0,ll=isFinite(ol)?ol:0,Bi=Math.floor(ll)+(q-Math.floor(ll)%q);if(Dn.max=Bi,Dn.ticks.stepSize=q,de.getScale("pb").max=Bi,de.getScale("wpmAvgTen").max=Bi,de.getScale("wpmAvgHundred").max=Bi,d.startGraphsAtZero)de.getScale("wpm").min=0,de.getScale("pb").min=0,de.getScale("wpmAvgTen").min=0,de.getScale("wpmAvgHundred").min=0;else{const x=Math.floor(Xc/q)*q;de.getScale("wpm").min=x,de.getScale("pb").min=x,de.getScale("wpmAvgTen").min=x,de.getScale("wpmAvgHundred").min=x}va===void 0||va.length===0?(i(".pageAccount .group.noDataError").removeClass("hidden"),i(".pageAccount .group.chart").addClass("hidden"),i(".pageAccount .group.dailyActivityChart").addClass("hidden"),i(".pageAccount .group.histogramChart").addClass("hidden"),i(".pageAccount .group.aboveHistory").addClass("hidden"),i(".pageAccount .group.history").addClass("hidden"),i(".pageAccount .triplegroup.stats").addClass("hidden"),i(".pageAccount .group.estimatedWordsTyped").addClass("hidden")):(i(".pageAccount .group.noDataError").addClass("hidden"),i(".pageAccount .group.chart").removeClass("hidden"),i(".pageAccount .group.dailyActivityChart").removeClass("hidden"),i(".pageAccount .group.histogramChart").removeClass("hidden"),i(".pageAccount .group.aboveHistory").removeClass("hidden"),i(".pageAccount .group.history").removeClass("hidden"),i(".pageAccount .triplegroup.stats").removeClass("hidden"),i(".pageAccount .group.estimatedWordsTyped").removeClass("hidden")),i(".pageAccount .timeTotalFiltered .val").text(Ta(Math.round(Cp),!0,!0));const at=d.typingSpeedUnit;i(".pageAccount .highestWpm .title").text(`highest ${at}`),i(".pageAccount .highestWpm .val").text(ue.typingSpeed(a)),i(".pageAccount .averageWpm .title").text(`average ${at}`),i(".pageAccount .averageWpm .val").text(ue.typingSpeed(r/o)),i(".pageAccount .averageWpm10 .title").text(`average ${at} (last 10 tests)`),i(".pageAccount .averageWpm10 .val").text(ue.typingSpeed(u/l)),i(".pageAccount .highestRaw .title").text(`highest raw ${at}`),i(".pageAccount .highestRaw .val").text(ue.typingSpeed(m.max)),i(".pageAccount .averageRaw .title").text(`average raw ${at}`),i(".pageAccount .averageRaw .val").text(ue.typingSpeed(m.total/m.count)),i(".pageAccount .averageRaw10 .title").text(`average raw ${at} (last 10 tests)`),i(".pageAccount .averageRaw10 .val").text(ue.typingSpeed(m.last10Total/m.last10Count)),i(".pageAccount .highestWpm .mode").html(s),i(".pageAccount .testsTaken .val").text(o),i(".pageAccount .highestAcc .val").text(ue.accuracy(c)),i(".pageAccount .avgAcc .val").text(ue.accuracy(p/o)),i(".pageAccount .avgAcc10 .val").text(ue.accuracy(f/l)),v===0||v===void 0?(i(".pageAccount .avgCons .val").text("-"),i(".pageAccount .avgCons10 .val").text("-")):(i(".pageAccount .highestCons .val").text(ue.percentage(y)),i(".pageAccount .avgCons .val").text(ue.percentage(v/W)),i(".pageAccount .avgCons10 .val").text(ue.percentage(A/Math.min(l,W)))),i(".pageAccount .testsStarted .val").text(`${o+n}`),i(".pageAccount .testsCompleted .val").text(`${o}(${Math.floor(o/(o+n)*100)}%)`),i(".pageAccount .testsCompleted .avgres").text(`
    ${(n/o).toFixed(1)} restarts per completed test
  `);const At=bt.map(x=>x.wpm).reverse(),Mt=_A(At);if(Mt){const _t=(Mt[1][1]-Mt[0][1])*(3600/Cp),Lt=_t>0?"+":"";i(".pageAccount .group.chart .below .text").text(`Speed change per hour spent typing: ${Lt+ue.typingSpeed(_t,{showDecimalPlaces:!0})} ${d.typingSpeedUnit}`)}i(".pageAccount .estimatedWordsTyped .val").text(g),(va.length||Fr.length)&&(lZ(),de.options.animation=!1,de.update(),delete de.options.animation),await vt(0),si.update(),uo.update(),Rs(100,!0),Di(!1),cr(i(".pageAccount .preloader"),i(".pageAccount .content"),250,async()=>{i(".page.pageAccount").css("height","unset")},async()=>{setTimeout(()=>{Db("account")},10)})}async function Nb(t){const e=await Sv(t);if(!e&&!xt()){h("Could not get results - you are offline",-1,{duration:5});return}zZ(),e&&Rn()}async function jo(){if(Rs(0,!0),S()===null)h("Missing account data. Please refresh.",-1),i(".pageAccount .preloader").html("Missing account data. Please refresh.");else{Rs(90),await Nb();try{await vt(0),await FT()}catch(t){console.error(t),h(`Something went wrong: ${t}`,-1)}}}function uj(t,e){var n,r;const a=[];if(e.length>0)for(const o of e)(r=(n=S())==null?void 0:n.tags)==null||r.forEach(l=>{o===l._id&&a.push(l.display)});const s=i(`.pageAccount .resultEditTagsButton[data-result-id='${t}']`);s.attr("data-tags",JSON.stringify(e)),e.length>0?(s.attr("aria-label",a.join(", ")),s.addClass("active"),e.length>1?s.html('<i class="fas fa-fw fa-tags"></i>'):s.html('<i class="fas fa-fw fa-tag"></i>')):(s.attr("aria-label","no tags"),s.removeClass("active"),s.html('<i class="fas fa-fw fa-tag"></i>'))}function Ni(t,e,a=null){var l,u;if(i("td").removeClass("headerSorted"),i("td").children("i").remove(),i(e).addClass("headerSorted"),bt.length<2)return;const s=t;let n=!0;a!==null?a?i(e).append('<i class="fas fa-sort-down" aria-hidden="true"></i>'):(n=!1,i(e).append('<i class="fas fa-sort-up" aria-hidden="true"></i>')):parseInt((l=bt==null?void 0:bt[0])==null?void 0:l[s])<=parseInt((u=bt==null?void 0:bt[bt.length-1])==null?void 0:u[s])?(n=!0,i(e).append('<i class="fas fa-sort-down" aria-hidden="true"></i>')):(n=!1,i(e).append('<i class="fas fa-sort-up", aria-hidden="true"></i>'));const r=[],o=[];for(;r.length<bt.length;){let c=Number.MAX_VALUE,p=-1,f=-1;for(const[m,g]of bt.entries())n?g[s]>=p&&!o.includes(m)&&(p=g[s],f=m):g[s]<=c&&!o.includes(m)&&(c=g[s],f=m);r.push(bt[f]),o.push(f)}bt=r,i(".pageAccount .history table tbody").empty(),Ki=0,gh()}i(".pageAccount button.toggleResultsOnChart").on("click",()=>{MN(d.accountChart[0]!=="on")});i(".pageAccount button.toggleAccuracyOnChart").on("click",()=>{LN(d.accountChart[1]!=="on")});i(".pageAccount button.toggleAverage10OnChart").on("click",()=>{EN(d.accountChart[2]!=="on")});i(".pageAccount button.toggleAverage100OnChart").on("click",()=>{IN(d.accountChart[3]!=="on")});i(".pageAccount .loadMoreButton").on("click",()=>{gh()});i(".pageAccount #accountHistoryChart").on("click",()=>{var n;const t=j1;if(gh(t),window===void 0)return;const e=i(window).height()??0,s=(((n=i(`#result-${t}`).offset())==null?void 0:n.top)??0)-e/2;i([document.documentElement,document.body]).animate({scrollTop:s},500),i(".resultRow").removeClass("active"),i(`#result-${t}`).addClass("active")});i(".pageAccount").on("click",".miniResultChartButton",t=>{var a;console.log("updating");const e=i(t.currentTarget).attr("filteredResultsId");e!==void 0&&(YF((a=bt[parseInt(e)])==null?void 0:a.chartData),QF(),GF(t.pageX-(i(".pageAccount .miniResultChartWrapper").outerWidth()??0),t.pageY+30))});i(".pageAccount .group.history").on("click",".history-wpm-header",()=>{Ni("wpm",".history-wpm-header")});i(".pageAccount .group.history").on("click",".history-raw-header",()=>{Ni("rawWpm",".history-raw-header")});i(".pageAccount .group.history").on("click",".history-acc-header",()=>{Ni("acc",".history-acc-header")});i(".pageAccount .group.history").on("click",".history-correct-chars-header",()=>{Ni("correctChars",".history-correct-chars-header")});i(".pageAccount .group.history").on("click",".history-incorrect-chars-header",()=>{Ni("incorrectChars",".history-incorrect-chars-header")});i(".pageAccount .group.history").on("click",".history-consistency-header",()=>{Ni("consistency",".history-consistency-header")});i(".pageAccount .group.history").on("click",".history-date-header",()=>{Ni("timestamp",".history-date-header")});i(".pageAccount .group.history").on("click",".buttonsAndTitle .buttons button",()=>{Ni("timestamp",".history-date-header",!0)});i(".pageAccount .group.topFilters, .pageAccount .filterButtons").on("click","button",()=>{setTimeout(()=>{jo()},0)});i(".pageAccount .group.presetFilterButtons").on("click",".filterBtns .filterPresets .select-filter-preset",async t=>{await WF(i(t.target).data("id")),jo()});i(".pageAccount .content .group.aboveHistory .exportCSV").on("click",()=>{xA(bt)});i(".pageAccount .profile").on("click",".details .copyLink",()=>{const t=S();if(!t)return;const{name:e}=t,a=`${location.origin}/profile/${e}`;navigator.clipboard.writeText(a).then(function(){h("URL Copied to clipboard",0)},function(){alert("Failed to copy using the Clipboard API. Here's the link: "+a)})});i(".pageAccount button.loadMoreResults").on("click",async()=>{var e,a;const t=((a=(e=S())==null?void 0:e.results)==null?void 0:a.length)??0;Je(),zy(),await Nb(t),await FT(),Te()});mt(t=>{Xe()==="account"&&t==="typingSpeedUnit"&&jo()});const cj=new Pn({name:"account",element:i(".page.pageAccount"),path:"/account",afterHide:async()=>{dj(),VF(),Aa("pageAccount")},beforeShow:async()=>{ss("pageAccount","main");const t=S();(t==null?void 0:t.results)===void 0&&(i(".pageLoading .fill, .pageAccount .fill").css("width","0%"),i(".pageAccount .content").addClass("hidden"),i(".pageAccount .preloader").removeClass("hidden"),await Ix()),await KF(jo),Rn(),await vt(0),ZT("current",t!==void 0?new Date(t.addedAt).getFullYear():2020),jo().then(()=>{var e,a;lj(),i(".pageAccount .content p.accountVerificatinNotice").remove(),((a=(e=Tt)==null?void 0:e.currentUser)==null?void 0:a.emailVerified)===!1&&i(".pageAccount .content").prepend('<p class="accountVerificatinNotice" style="text-align:center">Your account is not verified - <button class="sendVerificationEmail">send the verification email again</button>'),ij()})}});i(()=>{za("pageAccount")});const wt={resultId:"",startingTags:[],tags:[],source:"accountPage"};function jT(t,e,a){if(!xt()){h("You are offline",0,{duration:2});return}if(t===""){h("Failed to show edit result tags modal: result id is empty",-1);return}wt.resultId=t,wt.startingTags=[...e],wt.tags=[...e],wt.source=a,Wb.show({beforeAnimation:async()=>{pj(),HT()}})}function l0(){Wb.hide()}function pj(){var a,s;const t=Wb.getModal().querySelector(".buttons");if(t===null){h("Failed to append buttons to edit result tags modal: could not find buttons element",-1);return}const e=new Set([...((a=S())==null?void 0:a.tags.map(n=>n._id))??[],...wt.tags]);t.innerHTML="";for(const n of e){const r=(s=S())==null?void 0:s.tags.find(l=>l._id===n),o=document.createElement("button");o.classList.add("toggleTag"),o.setAttribute("data-tag-id",n),o.innerHTML=(r==null?void 0:r.display)??"unknown tag",o.addEventListener("click",l=>{fj(n),HT()}),t.appendChild(o)}}function HT(){for(const t of i("#editResultTagsModal .modal .buttons button")){const e=i(t).attr("data-tag-id")??"";wt.tags.includes(e)?i(t).addClass("active"):i(t).removeClass("active")}}function fj(t){wt.tags.includes(t)?wt.tags=wt.tags.filter(e=>e!==t):wt.tags.push(t)}async function mj(){var a,s,n;Je();const t=await Z.results.updateTags(wt.resultId,wt.tags);if(Te(),wt.tags=wt.tags.filter(r=>r!==void 0),t.status!==200){h("Failed to update result tags: "+t.message,-1);return}const e=((a=t.data)==null?void 0:a.tagPbs)??[];h("Tags updated",1,{duration:2}),(n=(s=S())==null?void 0:s.results)==null||n.forEach(r=>{r._id===wt.resultId&&(r.tags=wt.tags)}),wt.source==="accountPage"?uj(wt.resultId,wt.tags):wt.source==="resultPage"&&Kq(wt.tags,e)}const Wb=new et({dialogId:"editResultTagsModal",setup:async t=>{var e;(e=t.querySelector("button.saveButton"))==null||e.addEventListener("click",a=>{if(CA(wt.startingTags,wt.tags)){l0();return}l0(),mj()})}});function zT(t){const e=/((-\s*)?\d+(\.\d+)?\s*[hms]?)/g,a=[...t.toLowerCase().matchAll(e)].map(s=>{const n=s[0],r=parseFloat(n.replace(/\s+/g,""));return n.includes("h")?3600*r:n.includes("m")?60*r:r}).reduce((s,n)=>s+n,0);return Math.floor(a)}function hj(t){const e=Math.floor(t/3600),a=Math.floor(t%3600/60),s=t%3600%60,n=[];return e>0&&n.push(`${e} hour${e===1?"":"s"}`),a>0&&n.push(`${a} minute${a===1?"":"s"}`),s>0&&n.push(`${s} second${s===1?"":"s"}`),n.length===3?`${n[0]}, ${n[1]} and ${n[2]}`:n.length===2?`${n[0]} and ${n[1]}`:`${n[0]}`}function KT(){const t=i("#customTestDurationModal input").val(),e=zT(t);let a="";e<0?a="Negative time? Really?":e===0?a="Infinite test":a=hj(e),i("#customTestDurationModal .preview").text(a)}function VT(t){UT.show({...t,focusFirstInput:"focusAndSelect",beforeAnimation:async e=>{e.querySelector("input").value=`${d.time}`,KT()}})}function gj(t=!1){UT.hide({clearModalChain:t})}function yj(){const t=zT(i("#customTestDurationModal input").val());if(t!==null&&!isNaN(t)&&t>=0&&isFinite(t))Ws(t),tt(),He(),t>=1800?h("Stay safe and take breaks!",0):t===0&&h("Infinite time! Make sure to use Bail Out from the command line to save your result.",0,{duration:7});else{h("Custom time must be a positive number or zero",0);return}gj(!0)}async function vj(t){var e;t.addEventListener("submit",a=>{a.preventDefault(),yj()}),(e=t.querySelector("input"))==null||e.addEventListener("input",a=>{KT()})}const UT=new et({dialogId:"customTestDurationModal",setup:vj}),bj=Qo.recaptchaSiteKey,bn={};function Uc(t,e,a){if(bn[e]!==void 0&&bn[e]!==null)return;const s=grecaptcha.render(t,{sitekey:bj,callback:a});bn[e]=s}function sl(t){bn[t]===void 0||bn[t]===null||grecaptcha.reset(bn[t])}function yh(t){return bn[t]===void 0||bn[t]===null?"":grecaptcha.getResponse(bn[t])}class cc{constructor(e,a){this.textareaElement=e,this.maxLength=a,this.textareaElement.attr("maxlength",this.maxLength.toString()),this.textareaElement.parent().hasClass("textareaWithCounter")||i(this.textareaElement).wrap('<div class="textareaWithCounter"></div>'),this.parentElement=i(this.textareaElement).parent(".textareaWithCounter"),this.parentElement.find(".char-counter").length===0?(this.counterElement=i('<span class="char-counter"></span>'),this.parentElement.append(this.counterElement)):this.counterElement=this.parentElement.find(".char-counter"),this.updateCounter(),this.textareaElement.on("input",()=>this.updateCounter())}updateCounter(){const e=this.maxLength,a=this.textareaElement.val().length,s=e-a;this.counterElement.text(`${a}/${e}`);const n=s/this.maxLength*100;this.counterElement.removeClass("warning"),this.counterElement.removeClass("error"),n===0?this.counterElement.addClass("error"):n<10&&this.counterElement.addClass("warning")}setMaxLength(e){this.maxLength=e,this.updateCounter()}}let d0=!1;async function wj(){if(d0)return;const t=await nk();for(const e of t)e.name!=="swiss_german"&&i("#quoteSubmitModal .newQuoteLanguage").append(`<option value="${e.name}">${e.name.replace(/_/g," ")}</option>`);d0=!0}let Zl;async function kj(){const t=i("#quoteSubmitModal .newQuoteText").val(),e=i("#quoteSubmitModal .newQuoteSource").val(),a=i("#quoteSubmitModal .newQuoteLanguage").val(),s=yh("submitQuote");if(!t||!e||!a){h("Please fill in all fields",0);return}Je();const n=await Z.quotes.submit(t,e,a,s);if(Te(),n.status!==200){h("Failed to submit quote: "+n.message,-1);return}h("Quote submitted.",1),i("#quoteSubmitModal .newQuoteText").val(""),i("#quoteSubmitModal .newQuoteSource").val(""),sl("submitQuote")}async function xj(t){GT.show({...t,mode:"dialog",focusFirstInput:!0,afterAnimation:async()=>{Uc(document.querySelector("#quoteSubmitModal .g-recaptcha"),"submitQuote"),await wj(),Zl=new Vt({select:"#quoteSubmitModal .newQuoteLanguage"}),i("#quoteSubmitModal .newQuoteLanguage").val(Ds(d.language)),i("#quoteSubmitModal .newQuoteLanguage").trigger("change"),i("#quoteSubmitModal input").val(""),new cc(i("#quoteSubmitModal .newQuoteText"),250)}})}function _j(t){GT.hide({clearModalChain:t,afterAnimation:async()=>{sl("submitQuote"),Zl==null||Zl.destroy(),Zl=void 0}})}async function Cj(t){var e;(e=t.querySelector("button"))==null||e.addEventListener("click",()=>{kj(),_j(!0)})}const GT=new et({dialogId:"quoteSubmitModal",setup:Cj});let Ei=[];function vh(){i("#quoteApproveModal .quotes").empty(),Ei.forEach((t,e)=>{const a=i(`
      <div class="quote" data-id="${e}" data-db-id="${t._id}">
        <textarea class="text">${t.text}</textarea>
        <input type="text" class="source" placeholder="Source" value="${t.source}">
        <div class="buttons">
          <button disabled class="textButton undo" aria-label="Undo changes" data-balloon-pos="left"><i class="fas fa-fw fa-undo-alt"></i></button>
          <button class="textButton refuse" aria-label="Refuse quote" data-balloon-pos="left"><i class="fas fa-fw fa-times"></i></button>
          <button class="textButton approve" aria-label="Approve quote" data-balloon-pos="left"><i class="fas fa-fw fa-check"></i></button>
          <button class="textButton edit hidden" aria-label="Edit and approve quote" data-balloon-pos="left"><i class="fas fa-fw fa-pen"></i></button>
        </div>
        <div class="bottom">
          <div class="length ${t.text.length<60?"red":""}"><i class="fas fa-fw fa-ruler"></i>${t.text.length}</div>
          <div class="language"><i class="fas fa-fw fa-globe-americas"></i>${t.language}</div>
          <div class="timestamp"><i class="fas fa-fw fa-calendar"></i>${nt(new Date(t.timestamp),"dd MMM yyyy HH:mm")}</div>
        </div>
      </div>
    `);i("#quoteApproveModal .quotes").append(a),a.find(".source").on("input",()=>{i(`#quoteApproveModal .quote[data-id=${e}] .undo`).prop("disabled",!1),i(`#quoteApproveModal .quote[data-id=${e}] .approve`).addClass("hidden"),i(`#quoteApproveModal .quote[data-id=${e}] .edit`).removeClass("hidden")}),a.find(".text").on("input",()=>{i(`#quoteApproveModal .quote[data-id=${e}] .undo`).prop("disabled",!1),i(`#quoteApproveModal .quote[data-id=${e}] .approve`).addClass("hidden"),i(`#quoteApproveModal .quote[data-id=${e}] .edit`).removeClass("hidden"),QT(e)}),a.find(".undo").on("click",()=>{Tj(e)}),a.find(".approve").on("click",()=>{$j(e,t._id)}),a.find(".refuse").on("click",()=>{Aj(e,t._id)}),a.find(".edit").on("click",()=>{Mj(e,t._id)})})}function QT(t){var a;const e=(a=i(`#quoteApproveModal .quote[data-id=${t}] .text`).val())==null?void 0:a.length;i(`#quoteApproveModal .quote[data-id=${t}] .length`).html(`<i class="fas fa-fw fa-ruler"></i>${e}`),e<60?i(`#quoteApproveModal .quote[data-id=${t}] .length`).addClass("red"):i(`#quoteApproveModal .quote[data-id=${t}] .length`).removeClass("red")}async function YT(){Je();const t=await Z.quotes.get();if(Te(),t.status!==200){h("Failed to get new quotes: "+t.message,-1);return}Ei=t.data??[],vh()}async function Sj(t){Ej.show({...t,beforeAnimation:async()=>{Ei=[],YT()}})}function Bb(t){const e=i(`#quoteApproveModal .quotes .quote[data-id=${t}]`);e.find("button").prop("disabled",!1),e.find(".edit").hasClass("hidden")&&e.find(".undo").prop("disabled",!0)}function Tj(t){var e,a;i(`#quoteApproveModal .quote[data-id=${t}] .text`).val(((e=Ei[t])==null?void 0:e.text)??""),i(`#quoteApproveModal .quote[data-id=${t}] .source`).val(((a=Ei[t])==null?void 0:a.source)??""),i(`#quoteApproveModal .quote[data-id=${t}] .undo`).prop("disabled",!0),i(`#quoteApproveModal .quote[data-id=${t}] .approve`).removeClass("hidden"),i(`#quoteApproveModal .quote[data-id=${t}] .edit`).addClass("hidden"),QT(t)}async function $j(t,e){if(!confirm("Are you sure?"))return;const a=i(`#quoteApproveModal .quotes .quote[data-id=${t}]`);a.find("button").prop("disabled",!0),a.find("textarea, input").prop("disabled",!0),Je();const s=await Z.quotes.approveSubmission(e);if(Te(),s.status!==200){Bb(t),a.find("textarea, input").prop("disabled",!1),h("Failed to approve quote: "+s.message,-1);return}h(`Quote approved. ${s.message??""}`,1),Ei.splice(t,1),vh()}async function Aj(t,e){if(!confirm("Are you sure?"))return;const a=i(`#quoteApproveModal .quotes .quote[data-id=${t}]`);a.find("button").prop("disabled",!0),a.find("textarea, input").prop("disabled",!0),Je();const s=await Z.quotes.rejectSubmission(e);if(Te(),s.status!==200){Bb(t),a.find("textarea, input").prop("disabled",!1),h("Failed to refuse quote: "+s.message,-1);return}h("Quote refused.",1),Ei.splice(t,1),vh()}async function Mj(t,e){if(!confirm("Are you sure?"))return;const a=i(`#quoteApproveModal .quote[data-id=${t}] .text`).val(),s=i(`#quoteApproveModal .quote[data-id=${t}] .source`).val(),n=i(`#quoteApproveModal .quotes .quote[data-id=${t}]`);n.find("button").prop("disabled",!0),n.find("textarea, input").prop("disabled",!0),Je();const r=await Z.quotes.approveSubmission(e,a,s);if(Te(),r.status!==200){Bb(t),n.find("textarea, input").prop("disabled",!1),h("Failed to approve quote: "+r.message,-1);return}h(`Quote edited and approved. ${r.message??""}`,1),Ei.splice(t,1),vh()}async function Lj(t){var e;(e=t.querySelector("button.refreshList"))==null||e.addEventListener("click",()=>{i("#quoteApproveModal .quotes").empty(),YT()})}const Ej=new et({dialogId:"quoteApproveModal",setup:Lj}),fo={quoteToReport:void 0,reasonSelect:void 0};async function JT(t,e){XT.show({mode:"dialog",...e,beforeAnimation:async()=>{var n;Uc(document.querySelector("#quoteReportModal .g-recaptcha"),"quoteReportModal");const a=d.language==="swiss_german"?"german":d.language,{quotes:s}=await ja.getQuotes(a);fo.quoteToReport=s.find(r=>r.id===t),i("#quoteReportModal .quote").text((n=fo.quoteToReport)==null?void 0:n.text),i("#quoteReportModal .reason").val("Grammatical error"),i("#quoteReportModal .comment").val(""),fo.reasonSelect=new Vt({select:"#quoteReportModal .reason",settings:{showSearch:!1}}),new cc(i("#quoteReportModal .comment"),250)}})}async function Ij(t=!1){XT.hide({clearModalChain:t,afterAnimation:async()=>{var e;sl("quoteReportModal"),(e=fo.reasonSelect)==null||e.destroy(),fo.reasonSelect=void 0}})}async function Oj(){var u;const t=yh("quoteReportModal");if(!t){h("Please complete the captcha");return}const e=(u=fo.quoteToReport)==null?void 0:u.id.toString(),a=Ds(d.language),s=i("#quoteReportModal .reason").val(),n=i("#quoteReportModal .comment").val(),r=t;if(e===void 0||e===""){h("Please select a quote");return}if(!s){h("Please select a valid report reason");return}if(!n){h("Please provide a comment");return}const o=n.length-250;if(o>0){h(`Report comment is ${o} character(s) too long`);return}Je();const l=await Z.quotes.report(e,a,s,n,r);if(Te(),l.status!==200){h("Failed to report quote: "+l.message,-1);return}h("Report submitted. Thank you!",1),Ij(!0)}async function Pj(t){var e;(e=t.querySelector("button"))==null||e.addEventListener("click",async()=>{await Oj()})}const XT=new et({dialogId:"quoteReportModal",setup:Pj}),Rj={fuzzyMatchSensitivity:.2,scoreForSimilarMatch:.5,scoreForExactMatch:1};function Dj(t,e){return e===0?0:Math.log10(t/e)}const u0=.4;function Nj(t,e){return u0+(1-u0)*(e.termFrequencies[t]/e.maxTermFrequency)}function c0(t){return t.match(/[^\\\][.,"/#!?$%^&*;:{}=\-_`~()\s]+/g)??[]}const Wj=(t,e,a=Rj)=>{const s={},n={};t.forEach((l,u)=>{const c=c0(e(l)),p={id:u,termFrequencies:{},maxTermFrequency:0};let f=0;c.forEach(m=>{var y,v;const g=cw(m);g in n||(n[g]=new Set),(y=n[g])==null||y.add(m),g in s||(s[g]=new Set),(v=s[g])==null||v.add(p),g in p.termFrequencies||(p.termFrequencies[g]=0),p.termFrequencies[g]++,f=Math.max(f,p.termFrequencies[g])}),p.maxTermFrequency=f});const r=Object.keys(s);return{query:l=>{const u={results:[],matchedQueryTerms:[]},c=new Set(c0(l).map(g=>cw(g)));if(c.size===0)return u;const p=new Map,f=new Set;c.forEach(g=>{r.forEach(y=>{var $;const{similarity:v}=cM(g,y),A=y===g,W=v>=1-a.fuzzyMatchSensitivity;if(A||W){const se=s[y],te=Dj(t.length,se.size);se.forEach(b=>{const w=p.get(b.id)??0,q=Nj(y,b),me=A?a.scoreForExactMatch:0,qt=W?a.scoreForSimilarMatch:0,jt=(me+qt)*te*q;p.set(b.id,w+jt)}),($=n[y])==null||$.forEach(b=>{f.add(b)})}})});const m=[...p].sort((g,y)=>y[1]-g[1]).map(g=>t[g[0]]);return u.results=m,u.matchedQueryTerms=[...f],u}}},rg={},og=100;let ni=1;function Bj(t,e,a){if(t in rg)return rg[t];const s=Wj(e,a);return rg[t]=s,s}function lg(t,e){return e.length===0?t:hR(t,'.,"/#!$%^&*;:{}=-_`~() '.split("")).map(n=>e.find(o=>n.startsWith(o))!==void 0?`<span class="highlight">${n}</span>`:n).join("")}function Zj(t){const e=i("#quoteSearchModal .quoteLengthFilter").val();if(e.length===0)return t;const a=e.map(n=>parseInt(n,10));return t.filter(n=>a.includes(n.group))}function qj(t){const e=document.querySelector(".toggleFavorites").classList.contains("active");return t.filter(s=>e?ja.isQuoteFavorite(s):!0)}function Fj(t,e){let a;t.length<101?a="short":t.length<301?a="medium":t.length<601?a="long":a="thicc";const s=!ce(),n=!s&&ja.isQuoteFavorite(t);return`
  <div class="searchResult" data-quote-id="${t.id}">

    <div class="text">
      ${lg(t.text,e)}
    </div>

    <div class="id">
      <div class="sub">id</div>
      <span class="quote-id">
        ${lg(t.id.toString(),e)}
      </span>
    </div>

    <div class="length">
      <div class="sub">length</div>
      ${a}
    </div>

    <div class="source">
      <div class="sub">source</div>
      ${lg(t.source,e)}
    </div>

    <div class="textButton report ${s&&"hidden"}" aria-label="Report quote" data-balloon-pos="left">
      <i class="fas fa-flag report"></i>
    </div>

    <div class="textButton favorite ${s&&"hidden"}" aria-label="Favorite quote" data-balloon-pos="left">
      <i class="${n?"fas":"far"} fa-heart favorite"></i>
    </div>

  </div>
  `}async function _m(t){var f,m;const{quotes:e}=await ja.getQuotes(d.language),a=Bj(d.language,e,g=>`${g.text} ${g.id} ${g.source}`),{results:s,matchedQueryTerms:n}=a.query(t),r=Zj(qj(t===""?e:s)),o=i("#quoteSearchResults");o.empty();const l=Math.ceil(r.length/og);if(ni>=l?i("#quoteSearchPageNavigator .nextPage").prop("disabled",!0):i("#quoteSearchPageNavigator .nextPage").prop("disabled",!1),ni<=1?i("#quoteSearchPageNavigator .prevPage").prop("disabled",!0):i("#quoteSearchPageNavigator .prevPage").prop("disabled",!1),r.length===0){i("#quoteSearchModal  .pageInfo").html("No search results");return}const u=(ni-1)*og,c=Math.min(ni*og,r.length);i("#quoteSearchModal  .pageInfo").html(`${u+1} - ${c} of ${r.length}`),r.slice(u,c).forEach(g=>{const y=Fj(g,n);o.append(y)});const p=Ar.getModal().querySelectorAll(".searchResult");for(const g of p){const y=parseInt(g.dataset.quoteId);(f=g.querySelector(".textButton.favorite"))==null||f.addEventListener("click",v=>{if(v.stopPropagation(),y===void 0||isNaN(y)){h("Could not toggle quote favorite: quote id is not a number",-1);return}zj(`${y}`)}),(m=g.querySelector(".textButton.report"))==null||m.addEventListener("click",v=>{if(v.stopPropagation(),y===void 0||isNaN(y)){h("Could not open quote report modal: quote id is not a number",-1);return}JT(y,{modalChain:Ar})}),g.addEventListener("click",v=>{Cv(y),Hj(y)})}}let ql;async function e$(t){Ar.show({...t,focusFirstInput:!0,beforeAnimation:async()=>{var a,s,n;ce()?(i("#quoteSearchModal .goToQuoteSubmit").removeClass("hidden"),i("#quoteSearchModal .toggleFavorites").removeClass("hidden")):(i("#quoteSearchModal .goToQuoteSubmit").addClass("hidden"),i("#quoteSearchModal .toggleFavorites").addClass("hidden")),((a=S())==null?void 0:a.quoteMod)!==void 0&&(((s=S())==null?void 0:s.quoteMod)===!0||((n=S())==null?void 0:n.quoteMod)!=="")?i("#quoteSearchModal .goToQuoteApprove").removeClass("hidden"):i("#quoteSearchModal .goToQuoteApprove").addClass("hidden"),ql=new Vt({select:"#quoteSearchModal .quoteLengthFilter",settings:{showSearch:!1,placeholderText:"filter by length",contentLocation:Ar.getModal()},data:[{text:"short",value:"0"},{text:"medium",value:"1"},{text:"long",value:"2"},{text:"thicc",value:"3"}]})},afterAnimation:async()=>{const e=i("#quoteSearchModal input").val();ni=1,_m(e)}})}function jj(t=!1){Ar.hide({clearModalChain:t,afterAnimation:async()=>{ql==null||ql.destroy(),ql=void 0}})}function Hj(t){if(isNaN(t)&&(t=parseInt(document.getElementById("searchBox").value)),t!==null&&!isNaN(t)&&t>=0)mn(-2,!1),Cv(t),tt();else{h("Quote ID must be at least 1",0);return}He(),jj(!0)}const dg=Da(250,()=>{const t=document.getElementById("searchBox").value;ni=1,_m(t)});async function zj(t){const e=d.language;if(e===""||t===""){h("Could not get quote stats!",-1);return}const a={language:e,id:parseInt(t,10)},s=ja.isQuoteFavorite(a),n=i(`#quoteSearchModal .searchResult[data-quote-id=${t}] .textButton.favorite i`);if(S())if(s)try{Je(),await ja.setQuoteFavorite(a,!1),Te(),n.removeClass("fas").addClass("far")}catch(o){Te();const l=Re(o,"Failed to remove quote from favorites");h(l,-1)}else try{Je(),await ja.setQuoteFavorite(a,!0),Te(),n.removeClass("far").addClass("fas")}catch(o){Te();const l=Re(o,"Failed to add quote to favorites");h(l,-1)}}async function Kj(t){var e,a,s,n,r,o,l;(e=t.querySelector(".searchBox"))==null||e.addEventListener("input",u=>{dg()}),(a=t.querySelector("button.toggleFavorites"))==null||a.addEventListener("click",u=>{ce()&&(i(u.target).toggleClass("active"),dg())}),(s=t.querySelector(".goToQuoteApprove"))==null||s.addEventListener("click",u=>{Sj({modalChain:Ar})}),(n=t.querySelector(".goToQuoteSubmit"))==null||n.addEventListener("click",async u=>{var p;Je();const c=((p=(await Z.quotes.isSubmissionEnabled()).data)==null?void 0:p.isEnabled)??!1;if(Te(),!c){h("Quote submission is disabled temporarily due to a large submission queue.",0,{duration:5});return}xj({modalChain:Ar})}),(r=t.querySelector(".quoteLengthFilter"))==null||r.addEventListener("change",dg),(o=t.querySelector(".nextPage"))==null||o.addEventListener("click",()=>{const u=document.getElementById("searchBox").value;ni++,_m(u)}),(l=t.querySelector(".prevPage"))==null||l.addEventListener("click",()=>{const u=document.getElementById("searchBox").value;ni--,_m(u)})}const Ar=new et({dialogId:"quoteSearchModal",setup:Kj}),t$={homeKeys:{display:"home keys",getIncludeString:t=>{const e=t.keys.row3.slice(0,4),a=t.keys.row3.slice(6,10);return[...e,...a]},getExcludeString:t=>{const e=t.keys.row2,a=t.keys.row4,s=t.keys.row3.slice(10),n=t.keys.row3.slice(4,6);return[...e,...n,...s,...a]}},leftHand:{display:"left hand",getIncludeString:t=>{const e=t.keys.row2.slice(0,5),a=t.keys.row3.slice(0,5),s=t.keys.row4.slice(0,5);return[...e,...a,...s]},getExcludeString:t=>{const e=t.keys.row2.slice(5),a=t.keys.row3.slice(5),s=t.keys.row4.slice(5);return[...e,...a,...s]}},rightHand:{display:"right hand",getIncludeString:t=>{const e=t.keys.row2.slice(5),a=t.keys.row3.slice(5),s=t.keys.row4.slice(4);return[...e,...a,...s]},getExcludeString:t=>{const e=t.keys.row2.slice(0,5),a=t.keys.row3.slice(0,5),s=t.keys.row4.slice(0,4);return[...e,...a,...s]}},homeRow:{display:"home row",getIncludeString:t=>t.keys.row3,getExcludeString:t=>{const e=t.keys.row2,a=t.keys.row4;return[...e,...a]}},topRow:{display:"top row",getIncludeString:t=>t.keys.row2,getExcludeString:t=>{const e=t.keys.row3,a=t.keys.row4;return[...e,...a]}},bottomRow:{display:"bottom row",getIncludeString:t=>t.keys.row4,getExcludeString:t=>{const e=t.keys.row2,a=t.keys.row3;return[...e,...a]}}};async function Vj(){i("#wordFilterModal .languageInput").empty(),i("#wordFilterModal .layoutInput").empty(),i("wordFilterModal .presetInput").empty();let t,e;try{t=await ov()}catch(a){console.error(Re(a,"Failed to initialise word filter popup language list"));return}try{e=await Wm()}catch(a){console.error(Re(a,"Failed to initialise word filter popup preset list"));return}t.forEach(a=>{const s=a.replace(/_/gi," ");i("#wordFilterModal .languageInput").append(`
        <option value=${a}>${s}</option>
      `)});for(const a in e){const s=a.replace(/_/gi," ");i("#wordFilterModal .layoutInput").append(`
      <option value=${a}>${s}</option>
    `)}for(const[a,s]of Object.entries(t$))i("#wordFilterModal .presetInput").append(`<option value=${a}>${s.display}</option>`)}let Fl,jl,Hl;async function Uj(t){mo.show({...t,beforeAnimation:async e=>{Fl=new Vt({select:"#wordFilterModal .languageInput",settings:{contentLocation:e}}),jl=new Vt({select:"#wordFilterModal .layoutInput",settings:{contentLocation:mo.getModal()}}),Hl=new Vt({select:"#wordFilterModal .presetInput",settings:{contentLocation:mo.getModal()}}),i("#wordFilterModal .loadingIndicator").removeClass("hidden"),a$()}})}function Gj(t){mo.hide({...t,afterAnimation:async()=>{Fl==null||Fl.destroy(),jl==null||jl.destroy(),Hl==null||Hl.destroy(),Fl=void 0,jl=void 0,Hl=void 0}})}async function Qj(t){let e=i("#wordFilterModal .wordIncludeInput").val();e=nw(e==null?void 0:e.trim()),e=e.replace(/\s+/gi,"|");const a=new RegExp(e,"i");let s=i("#wordFilterModal .wordExcludeInput").val();s=nw(s.trim()),s=s.replace(/\s+/gi,"|");const n=new RegExp(s,"i"),r=[];let o;try{o=await rv(t)}catch(f){return h(Re(f,"Failed to filter language words"),-1),[]}const l=i("#wordFilterModal .wordMaxInput").val(),u=i("#wordFilterModal .wordMinInput").val();let c,p;l===""?c=999:c=parseInt(l),u===""?p=1:p=parseInt(u);for(const f of o.words){const m=a.test(f),g=n.test(f);(m&&!g||m&&s==="")&&f.length<=c&&f.length>=p&&r.push(f)}return r}async function p0(t){const e=i("#wordFilterModal .languageInput").val(),a=await Qj(e);if(a.length===0){h("No words found",0),a$();return}const s=a.join(Wc()?"|":" ");Gj({modalChainData:{text:s,set:t}})}function f0(){for(const t of mo.getModal().querySelectorAll("button"))t.setAttribute("disabled","true")}function a$(){for(const t of mo.getModal().querySelectorAll("button"))t.removeAttribute("disabled")}async function Yj(){await Vj(),i("#wordFilterModal button.generateButton").on("click",async()=>{const t=i("#wordFilterModal .presetInput").val(),e=i("#wordFilterModal .layoutInput").val(),a=t$[t];if(a===void 0){h(`Preset ${t} not found`,-1);return}const s=await vc(e);i("#wordIncludeInput").val(a.getIncludeString(s).map(n=>n[0]).join(" ")),i("#wordExcludeInput").val(a.getExcludeString(s).map(n=>n[0]).join(" "))}),i("#wordFilterModal button.addButton").on("click",()=>{i("#wordFilterModal .loadingIndicator").removeClass("hidden"),f0(),setTimeout(()=>{p0(!1)},0)}),i("#wordFilterModal button.setButton").on("click",()=>{i("#wordFilterModal .loadingIndicator").removeClass("hidden"),f0(),setTimeout(()=>{p0(!0)},0)})}const mo=new et({dialogId:"wordFilterModal",setup:Yj});class ae{constructor(e,a,s,n,r){if(this.configName=e,this.configValue=d[e],this.mode=s,this.configFunction=a,this.setCallback=n,this.updateCallback=r,this.updateUI(),this.mode==="select"){const o=document.querySelector(`.pageSettings .section[data-config-name=${this.configName}] select`);o==null||o.addEventListener("change",l=>{const u=i(l.target);u.hasClass("disabled")||u.hasClass("no-auto-handle")||this.setValue(u.val())})}else if(this.mode==="button")i(".pageSettings").on("click",`.section[data-config-name='${this.configName}'] button`,o=>{const l=i(o.currentTarget);if(l.hasClass("disabled")||l.hasClass("no-auto-handle"))return;const u=l.attr("data-config-value");if(u===void 0||u===""){console.error(`Failed to handle settings button click for ${e}: data-${e} is missing or empty.`),h("Button is missing data property. Please report this.",-1);return}let c=u;c==="true"&&(c=!0),c==="false"&&(c=!1),this.setValue(c)});else if(this.mode==="range"){const o=document.querySelector(`.pageSettings .section[data-config-name=${this.configName}] input[type=range]`);if(!o){h(`Failed to find range element for ${e}`,-1);return}const l=Da(250,u=>{this.setValue(u)});o.addEventListener("input",u=>{const c=i(u.target);if(c.hasClass("disabled")||c.hasClass("no-auto-handle"))return;const p=parseFloat(c.val());this.updateUI(p),l(p)})}}setValue(e){this.configFunction(e),this.updateUI(),this.setCallback&&this.setCallback()}updateUI(e){if(this.configValue=e??d[this.configName],i(`.pageSettings .section[data-config-name='${this.configName}'] button`).removeClass("active"),this.mode==="select"){const a=document.querySelector(`.pageSettings .section[data-config-name='${this.configName}'] select`);if(a===null)return;a.value=this.configValue;const s=a.slim;s==null||s.store.setSelectedBy("value",[this.configValue]),s==null||s.render.renderValues(),s==null||s.render.renderOptions(s.store.getData())}else if(this.mode==="button")i(`.pageSettings .section[data-config-name='${this.configName}'] button[data-config-value='${this.configValue}']`).addClass("active");else if(this.mode==="range"){const a=document.querySelector(`.pageSettings .section[data-config-name='${this.configName}'] input[type=range]`),s=document.querySelector(`.pageSettings .section[data-config-name='${this.configName}'] .value`);if(a===null||s===null)return;a.value=this.configValue,s.textContent=`${this.configValue.toFixed(1)}`}this.updateCallback&&this.updateCallback()}}function Gc(){var e,a;const t=[];try{(a=(e=S())==null?void 0:e.tags)==null||a.forEach(s=>{s.active===!0&&t.push(s._id)}),window.localStorage.setItem("activeTags",JSON.stringify(t))}catch{}}function Jj(t=!1){var a;const e=S();e&&(e.tags=(a=e.tags)==null?void 0:a.map(s=>(s.active=!1,s)),aa(e),Li(),t||Gc())}function Xj(t,e,a=!1){var n;const s=S();s&&(s.tags=(n=s.tags)==null?void 0:n.map(r=>(r._id===t&&(r.active=e),r)),aa(s),Li(),a||Gc())}function s$(t,e=!1){var a,s;(s=(a=S())==null?void 0:a.tags)==null||s.forEach(n=>{n._id===t&&(n.active===void 0?n.active=!0:n.active=!n.active)}),Li(),e||Gc()}function e3(){let t=window.localStorage.getItem("activeTags");if(t!=null&&t!==""){try{t=JSON.parse(t)??[]}catch{t=[]}t.forEach(e=>{s$(e,!0)}),Gc()}}async function t3(t){var s;const e=S();if(!e)return;const a=(s=e.presets)==null?void 0:s.find(n=>n._id===t);if(a===void 0){h("Preset not found",0);return}if(await Rc(a.config),Jj(!0),a.config.tags){for(const n of a.config.tags)Xj(n,!0,!1);Gc()}He(),h("Preset applied",1,{duration:2}),Yo()}function a3(){var e;let t=d.theme;d.randomTheme!=="off"&&d.randomTheme!=="custom"&&Xt!==null&&(t=Xt),document.querySelectorAll(".pageSettings .section.themes .theme").forEach(a=>{a.classList.remove("active")}),(e=document.querySelector(`.pageSettings .section.themes .theme[theme='${t}']`))==null||e.classList.add("active")}function Ho(t,e,a=!1,s=!1){if(a){const u=t.find("input.color").attr("id");u===void 0&&console.error("Could not find color ID!"),!s&&u!==void 0&&document.documentElement.style.setProperty(u,e);const c=t.find("label");c.val(e),c.attr("value",e),c.attr("for")!=="--bg-color"&&c.css("background-color",e),t.find("input.input").val(e),t.find("input.color").attr("value",e);return}const n=[{rule:/\b[0-9]{1,3},\s?[0-9]{1,3},\s?[0-9]{1,3}\s*\b/,start:"rgb(",end:")"},{rule:/\b[A-Z, a-z, 0-9]{6}\b/,start:"#",end:""},{rule:/\b[0-9]{1,3},\s?[0-9]{1,3}%,\s?[0-9]{1,3}%?\s*\b/,start:"hsl(",end:")"}];e=e.replace("","");for(const u of n)if(e.match(u.rule)){e=u.start+e+u.end;break}i(".colorConverter").css("color",e);const r=SA(i(".colorConverter").css("color"));if(r===void 0)return;e=r;const o=t.find("input.color").attr("id");o===void 0&&console.error("Could not find color ID!"),!s&&o!==void 0&&document.documentElement.style.setProperty(o,e);const l=t.find("label");l.val(e),l.attr("value",e),l.attr("for")!=="--bg-color"&&l.css("background-color",e),t.find("input.input").val(e),t.find("input.color").attr("value",e)}async function zo(){var t;if(d.customTheme){const e=i(".pageSettings .section.themes .allCustomThemes.buttons").empty(),a=i(".pageSettings .section.themes .addCustomThemeButton");if(ce())i(".pageSettings .section.themes .customThemeEdit #saveCustomThemeButton").text("save as new");else{i(".pageSettings .section.themes .customThemeEdit #saveCustomThemeButton").text("save");return}a.removeClass("hidden"),(((t=S())==null?void 0:t.customThemes)??[]).forEach(n=>{const r=n.colors[0],o=n.colors[1];e.append(`<div class="customTheme button" customThemeId='${n._id}' 
        style="color:${o};background:${r}">
        <div class="editButton"><i class="fas fa-pen"></i></div>
        <div class="text">${n.name.replace(/_/g," ")}</div>
        <div class="delButton"><i class="fas fa-trash fa-fw"></i></div>
        </div>`)})}else{const e=document.querySelector(".pageSettings .section.themes .favThemes.buttons");e.innerHTML="";let a="";const s=document.querySelector(".pageSettings .section.themes .allThemes.buttons");s.innerHTML="";let n="",r=d.theme;d.randomTheme!=="off"&&d.randomTheme!=="custom"&&Xt!==null&&(r=Xt);let o;try{o=await TA()}catch(l){h(Re(l,"Failed to refresh theme buttons"),-1);return}if(d.favThemes.length>0){e.style.marginBottom="1rem",e.style.marginTop="1rem";for(const l of o)if(d.favThemes.includes(l.name)){const u=r===l.name?"active":"";a+=`<div class="theme button ${u}" theme='${l.name}' style="background: ${l.bgColor}; color: ${l.mainColor};outline: 0 solid ${l.mainColor};">
            <div class="favButton active"><i class="fas fa-star"></i></div>
            <div class="text">${l.name.replace(/_/g," ")}</div>
            <div class="themeBubbles" style="background: ${l.bgColor};outline: 0.25rem solid ${l.bgColor};">
              <div class="themeBubble" style="background: ${l.mainColor}"></div>
              <div class="themeBubble" style="background: ${l.subColor}"></div>
              <div class="themeBubble" style="background: ${l.textColor}"></div>
            </div>
            </div>
            `}e.innerHTML=a}else e.style.marginBottom="0",e.style.marginTop="0";for(const l of o){if(d.favThemes.includes(l.name))continue;const u=r===l.name?"active":"";n+=`<div class="theme button ${u}" theme='${l.name}' style="background: ${l.bgColor}; color: ${l.mainColor};outline: 0 solid ${l.mainColor};">
        <div class="favButton"><i class="far fa-star"></i></div>
        <div class="text">${l.name.replace(/_/g," ")}</div>
        <div class="themeBubbles" style="background: ${l.bgColor};outline: 0.25rem solid ${l.bgColor};">
          <div class="themeBubble" style="background: ${l.mainColor}"></div>
          <div class="themeBubble" style="background: ${l.subColor}"></div>
          <div class="themeBubble" style="background: ${l.textColor}"></div>
        </div>
        </div>
        `}s.innerHTML=n}}function s3(t=!1){i(".pageSettings .section.themes .tabContainer .customTheme .colorPicker").each((e,a)=>{const s=d.customThemeColors[Ln.indexOf(i(a).find("input.color").attr("id"))];Ho(i(a),s,!1,t)})}function n3(t){if(d.favThemes.includes(t))gy(d.favThemes.filter(e=>e!==t));else{const e=d.favThemes;e.push(t),gy(e)}Yo()}function i3(){const t=[];for(const e of Ln)t.push(i(`.pageSettings .customTheme .customThemeEdit #${e}[type='color']`).attr("value"));Fu(t),h("Custom theme saved",1)}function Ky(t=!1){const e=i(".pageSettings .section.themes .tabs button[data-tab='preset']"),a=i(".pageSettings .section.themes .tabs button[data-tab='custom']");d.customTheme?(e.removeClass("active"),(!a.hasClass("active")||t)&&(a.addClass("active"),zo()),cr(i('.pageSettings [tabContent="preset"]'),i('.pageSettings [tabContent="custom"]'),250)):(a.removeClass("active"),(!e.hasClass("active")||t)&&(e.addClass("active"),zo()),cr(i('.pageSettings [tabContent="custom"]'),i('.pageSettings [tabContent="preset"]'),250))}i(".pageSettings .section.themes .tabs button").on("click",t=>{i(".pageSettings .section.themes .tabs button").removeClass("active");const e=i(t.currentTarget);e.addClass("active"),e.attr("data-tab")==="preset"?ui(!1):ui(!0)});i(".pageSettings").on("click"," .section.themes .customTheme.button",t=>{var s,n;if(i(t.target).hasClass("delButton")||i(t.target).hasClass("editButton"))return;const e=i(t.currentTarget).attr("customThemeId")??"",a=(n=(s=S())==null?void 0:s.customThemes)==null?void 0:n.find(r=>r._id===e);if(a===void 0){console.error("Could not find custom theme in snapshot for id ",e);return}Fu(a.colors)});i(".pageSettings").on("click",".section.themes .theme .favButton",t=>{const e=i(t.currentTarget).parents(".theme.button").attr("theme");e!==void 0?n3(e):console.error("Could not find the theme attribute attached to the button clicked!")});i(".pageSettings").on("click",".section.themes .theme.button",t=>{const e=i(t.currentTarget).attr("theme");!i(t.target).hasClass("favButton")&&e!==void 0&&CS(e)});i(".pageSettings .section.themes .tabContainer .customTheme input[type=color]").on("input",t=>{const e=i(t.currentTarget).attr("id"),a=i(t.currentTarget).val();Ho(i(".colorPicker #"+e).parent(),a,!0)});i(".pageSettings .section.themes .tabContainer .customTheme input[type=color]").on("change",t=>{const e=i(t.currentTarget).attr("id"),a=i(t.currentTarget).val();Ho(i(".colorPicker #"+e).parent(),a)});i(".pageSettings .section.themes .tabContainer .customTheme input.input").on("blur",t=>{if(t.target.id==="name")return;const e=i(t.currentTarget).attr("id"),a=i(t.currentTarget).val();Ho(i(".colorPicker #"+e).parent(),a)}).on("keypress",function(t){if(t.target.id!=="name"&&t.code==="Enter"){i(this).attr("disabled","disabled");const e=i(t.currentTarget).attr("id"),a=i(t.currentTarget).val();Ho(i(".colorPicker #"+e).parent(),a),i(this).removeAttr("disabled")}});i(".pageSettings #loadCustomColorsFromPreset").on("click",async()=>{await Q1(d.theme),Ln.forEach(e=>{document.documentElement.style.setProperty(e,"")}),U1();const t=await Oi();Ln.forEach(e=>{let a;e==="--bg-color"?a=t.bg:e==="--main-color"?a=t.main:e==="--sub-color"?a=t.sub:e==="--sub-alt-color"?a=t.subAlt:e==="--caret-color"?a=t.caret:e==="--text-color"?a=t.text:e==="--error-color"?a=t.error:e==="--error-extra-color"?a=t.errorExtra:e==="--colorful-error-color"?a=t.colorfulError:e==="--colorful-error-extra-color"&&(a=t.colorfulErrorExtra),Ho(i(".colorPicker #"+e).parent(),a)})});i(".pageSettings #saveCustomThemeButton").on("click",async()=>{if(i3(),ce()){const t={name:"custom",colors:d.customThemeColors};Je();const e=await UP(t);Te(),e&&Ky(!0)}else Ky(!0)});mt(t=>{t==="customThemeId"&&zo(),t==="theme"&&Xe()==="settings"&&a3()});const cn={mode:"import",value:""};function n$(t,e){cn.mode=t,cn.value="",Vy.show({focusFirstInput:"focusAndSelect",beforeAnimation:async a=>{var s,n,r,o;a.querySelector("input").value=cn.value,cn.mode==="export"?((s=a.querySelector("button"))==null||s.classList.add("hidden"),(n=a.querySelector("input"))==null||n.setAttribute("readonly","true")):cn.mode==="import"&&((r=a.querySelector("button"))==null||r.classList.remove("hidden"),(o=a.querySelector("input"))==null||o.removeAttribute("readonly"))}})}const Vy=new et({dialogId:"importExportSettingsModal",setup:async t=>{var e;(e=t.querySelector("input"))==null||e.addEventListener("input",a=>{cn.value=a.target.value}),t==null||t.addEventListener("submit",async a=>{if(a.preventDefault(),cn.mode==="import"){if(cn.value===""){Vy.hide();return}try{await Rc(JSON.parse(cn.value))}catch(s){h("Failed to import settings: "+s,-1)}Yo(),Vy.hide()}})}}),U={};async function r3(){await OS,U.smoothCaret=new ae("smoothCaret",hS,"button"),U.difficulty=new ae("difficulty",Ps,"button"),U.quickRestart=new ae("quickRestart",vS,"button"),U.showAverage=new ae("showAverage",rS,"button"),U.keymapMode=new ae("keymapMode",Cs,"button",()=>{var t;(t=U.showLiveWpm)==null||t.updateUI()},()=>{d.keymapMode==="off"?(i(".pageSettings .section[data-config-name='keymapStyle']").addClass("hidden"),i(".pageSettings .section[data-config-name='keymapLayout']").addClass("hidden"),i(".pageSettings .section[data-config-name='keymapLegendStyle']").addClass("hidden"),i(".pageSettings .section[data-config-name='keymapShowTopRow']").addClass("hidden"),i(".pageSettings .section[data-config-name='keymapSize']").addClass("hidden")):(i(".pageSettings .section[data-config-name='keymapStyle']").removeClass("hidden"),i(".pageSettings .section[data-config-name='keymapLayout']").removeClass("hidden"),i(".pageSettings .section[data-config-name='keymapLegendStyle']").removeClass("hidden"),i(".pageSettings .section[data-config-name='keymapShowTopRow']").removeClass("hidden"),i(".pageSettings .section[data-config-name='keymapSize']").removeClass("hidden"))}),U.keymapMatrix=new ae("keymapStyle",LS,"button"),U.keymapLayout=new ae("keymapLayout",sr,"select"),U.keymapLegendStyle=new ae("keymapLegendStyle",MS,"button"),U.keymapShowTopRow=new ae("keymapShowTopRow",ES,"button"),U.keymapSize=new ae("keymapSize",Ic,"range"),U.showKeyTips=new ae("showKeyTips",mS,"button",void 0,()=>{d.showKeyTips?i(".pageSettings .tip").removeClass("hidden"):i(".pageSettings .tip").addClass("hidden")}),U.freedomMode=new ae("freedomMode",wS,"button",()=>{var t;(t=U.confidenceMode)==null||t.updateUI()}),U.strictSpace=new ae("strictSpace",aS,"button"),U.oppositeShiftMode=new ae("oppositeShiftMode",sS,"button"),U.confidenceMode=new ae("confidenceMode",kS,"button",()=>{var t,e;(t=U.freedomMode)==null||t.updateUI(),(e=U.stopOnError)==null||e.updateUI()}),U.indicateTypos=new ae("indicateTypos",xS,"button"),U.hideExtraLetters=new ae("hideExtraLetters",oS,"button"),U.blindMode=new ae("blindMode",BC,"button"),U.quickEnd=new ae("quickEnd",YC,"button"),U.repeatQuotes=new ae("repeatQuotes",XC,"button"),U.ads=new ae("ads",JC,"button"),U.alwaysShowWordsHistory=new ae("alwaysShowWordsHistory",UC,"button"),U.britishEnglish=new ae("britishEnglish",AS,"button"),U.singleListCommandLine=new ae("singleListCommandLine",GC,"button"),U.capsLockWarning=new ae("capsLockWarning",QC,"button"),U.flipTestColors=new ae("flipTestColors",eS,"button"),U.showOutOfFocusWarning=new ae("showOutOfFocusWarning",FC,"button"),U.colorfulMode=new ae("colorfulMode",tS,"button"),U.startGraphsAtZero=new ae("startGraphsAtZero",gS,"button"),U.autoSwitchTheme=new ae("autoSwitchTheme",_S,"button"),U.randomTheme=new ae("randomTheme",$S,"button"),U.stopOnError=new ae("stopOnError",Dv,"button",()=>{var t;(t=U.confidenceMode)==null||t.updateUI()}),U.soundVolume=new ae("soundVolume",WC,"range"),U.playSoundOnError=new ae("playSoundOnError",DC,"button",()=>{d.playSoundOnError!=="off"&&eh()}),U.playSoundOnClick=new ae("playSoundOnClick",NC,"button",()=>{d.playSoundOnClick!=="off"&&An("KeyQ")}),U.showAllLines=new ae("showAllLines",Zu,"button"),U.paceCaret=new ae("paceCaret",jC,"button"),U.repeatedPace=new ae("repeatedPace",HC,"button"),U.minWpm=new ae("minWpm",zC,"button"),U.minAcc=new ae("minAcc",KC,"button"),U.minBurst=new ae("minBurst",VC,"button"),U.smoothLineScroll=new ae("smoothLineScroll",yS,"button"),U.lazyMode=new ae("lazyMode",qu,"button"),U.layout=new ae("layout",nr,"select"),U.language=new ae("language",No,"select"),U.fontSize=new ae("fontSize",zm,"button"),U.maxLineWidth=new ae("maxLineWidth",Oc,"button"),U.caretStyle=new ae("caretStyle",nS,"button"),U.paceCaretStyle=new ae("paceCaretStyle",iS,"button"),U.timerStyle=new ae("timerStyle",lS,"button"),U.liveSpeedStyle=new ae("liveSpeedStyle",dS,"button"),U.liveAccStyle=new ae("liveAccStyle",uS,"button"),U.liveBurstStyle=new ae("liveBurstStyle",cS,"button"),U.highlightMode=new ae("highlightMode",Pi,"button"),U.tapeMode=new ae("tapeMode",qv,"button"),U.timerOpacity=new ae("timerOpacity",fS,"button"),U.timerColor=new ae("timerColor",pS,"button"),U.fontFamily=new ae("fontFamily",bS,"button",void 0,()=>{const t=i(".pageSettings .section[data-config-name='fontFamily'] .buttons button[data-config-value='custom']");i(".pageSettings .section[data-config-name='fontFamily'] .buttons .active").length===0?(t.addClass("active"),t.text(`Custom (${d.fontFamily.replace(/_/g," ")})`)):t.text("Custom")}),U.alwaysShowDecimalPlaces=new ae("alwaysShowDecimalPlaces",ZC,"button"),U.typingSpeedUnit=new ae("typingSpeedUnit",qC,"button"),U.customBackgroundSize=new ae("customBackgroundSize",jv,"button")}function o3(){var t,e;i(".pageSettings .section.themes .favThemes.buttons").empty(),i(".pageSettings .section.themes .allThemes.buttons").empty(),i(".pageSettings .section.themes .allCustomThemes.buttons").empty(),i(".pageSettings .section[data-config-name='funbox'] .buttons").empty(),i(".pageSettings .section[data-config-name='fontFamily'] .buttons").empty();for(const a of document.querySelectorAll(".pageSettings select"))(e=(t=a==null?void 0:a.slim)==null?void 0:t.destroy)==null||e.call(t)}let m0=!1;async function l3(){var te;d.showKeyTips?i(".pageSettings .tip").removeClass("hidden"):i(".pageSettings .tip").addClass("hidden");let t;try{t=await nk()}catch(b){console.error(Re(b,"Failed to initialize settings language picker"))}const e=document.querySelector(".pageSettings .section[data-config-name='language'] select");let a="";if(t)for(const b of t){a+=`<optgroup label="${b.name}">`;for(const w of b.languages){const q=w===d.language?"selected":"",me=ki(w);a+=`<option value="${w}" ${q}>${me}</option>`}a+="</optgroup>"}e.innerHTML=a,new Vt({select:e,settings:{searchPlaceholder:"search"}});let s;try{s=await Wm()}catch(b){console.error(Re(b,"Failed to refresh keymap"))}const n=document.querySelector(".pageSettings .section[data-config-name='layout'] select"),r=document.querySelector(".pageSettings .section[data-config-name='keymapLayout'] select");let o='<option value="default">off</option>',l='<option value="overrideSync">emulator sync</option>';if(s)for(const b of Object.keys(s)){const w=`<option value="${b}">${b.replace(/_/g," ")}</option>`;b.toString()!=="korean"&&(o+=w),b.toString()!=="default"&&(l+=w)}n.innerHTML=o,r.innerHTML=l,new Vt({select:n}),new Vt({select:r});let u;try{u=await tk()}catch(b){console.error(Re(b,"Failed to load themes into dropdown boxes"))}const c=document.querySelector(".pageSettings .section[data-config-name='autoSwitchThemeInputs'] select.light"),p=document.querySelector(".pageSettings .section[data-config-name='autoSwitchThemeInputs'] select.dark");let f="",m="";if(u)for(const b of u){const w=`<option value="${b.name}" ${b.name===d.themeLight?"selected":""}>${b.name.replace(/_/g," ")}</option>`;f+=w;const q=`<option value="${b.name}" ${b.name===d.themeDark?"selected":""}>${b.name.replace(/_/g," ")}</option>`;m+=q}c.innerHTML=f,p.innerHTML=m,new Vt({select:c,events:{afterChange:b=>{var w;SS((w=b[0])==null?void 0:w.value)}}}),new Vt({select:p,events:{afterChange:b=>{var w;TS((w=b[0])==null?void 0:w.value)}}});const g=document.querySelector(".pageSettings .section[data-config-name='funbox'] .buttons");g.innerHTML=`<div class="funbox button" data-config-value='none'>none</div>`;let y="",v;try{v=await yc()}catch(b){console.error(Re(b,"Failed to get funbox list"))}if(v){for(const b of v)b.name==="mirror"?y+=`<div class="funbox button" data-config-value='${b.name}' aria-label="${b.info}" data-balloon-pos="up" data-balloon-length="fit" style="transform:scaleX(-1);">${b.name.replace(/_/g," ")}</div>`:b.name==="upside_down"?y+=`<div class="funbox button" data-config-value='${b.name}' aria-label="${b.info}" data-balloon-pos="up" data-balloon-length="fit" style="transform:scaleX(-1) scaleY(-1); z-index:1;">${b.name.replace(/_/g," ")}</div>`:y+=`<div class="funbox button" data-config-value='${b.name}' aria-label="${b.info}" data-balloon-pos="up" data-balloon-length="fit">${b.name.replace(/_/g," ")}</div>`;g.innerHTML=y}let A=!0;const W=document.querySelector(".pageSettings .section[data-config-name='fontFamily'] .buttons");W.innerHTML="";let $="",se;try{se=await $A()}catch(b){console.error(Re(b,"Failed to update fonts settings buttons"))}if(se){for(const b of se){let w=b.name;w==="Helvetica"&&(w="Comic Sans MS"),(b.systemFont??!1)===!1&&(w+=" Preview");const q=d.fontFamily===b.name?" active":"",me=b.display!==void 0?b.display:b.name;d.fontFamily===b.name&&(A=!1),$+=`<button class="${q}" style="font-family:${w}" data-config-value="${b.name.replace(/ /g,"_")}">${me}</button>`}$+=A?`<button class="no-auto-handle active" data-config-value="custom">Custom (${d.fontFamily.replace(/_/g," ")})</button>`:'<button class="no-auto-handle" data-config-value="custom"">Custom</button>',W.innerHTML=$}if(i(".pageSettings .section[data-config-name='customBackgroundSize'] input").val(d.customBackground),u$(),i(".pageSettings .section[data-config-name='fontSize'] input").val(d.fontSize),i(".pageSettings .section[data-config-name='maxLineWidth'] input").val(d.maxLineWidth),i(".pageSettings .section[data-config-name='keymapSize'] input").val(d.keymapSize),i(".pageSettings .section[data-config-name='customLayoutfluid'] input").val(d.customLayoutfluid.replace(/#/g," ")),Cm(!0),!m0)await r3(),m0=!0;else for(const b of Object.keys(U))(te=U[b])==null||te.updateUI();Cm(!1),await zo(),await OS}function i$(){i(".sectionGroupTitle[group='account']").addClass("hidden"),i(".settingsGroup.account").addClass("hidden"),i(".pageSettings .section.needsAccount").addClass("hidden"),i(".pageSettings .quickNav .accountTitleLink").addClass("hidden")}function d3(){var t;i(".sectionGroupTitle[group='account']").removeClass("hidden"),i(".settingsGroup.account").removeClass("hidden"),i(".pageSettings .section.needsAccount").removeClass("hidden"),i(".pageSettings .quickNav .accountTitleLink").removeClass("hidden"),o$(),l$(),bh(),((t=S())==null?void 0:t.lbOptOut)===!0&&i(".pageSettings .section.optOutOfLeaderboards").remove()}function bh(){var t;if(!ce())i(".pageSettings .section.discordIntegration").addClass("hidden");else{if(!S())return;i(".pageSettings .section.discordIntegration").removeClass("hidden"),((t=S())==null?void 0:t.discordId)===void 0?(i(".pageSettings .section.discordIntegration .buttons").removeClass("hidden"),i(".pageSettings .section.discordIntegration .info").addClass("hidden")):(i(".pageSettings .section.discordIntegration .buttons").addClass("hidden"),i(".pageSettings .section.discordIntegration .info").removeClass("hidden"))}}function Ir(){if(i(".pageSettings .section.passwordAuthSettings button").addClass("hidden"),i(".pageSettings .section.googleAuthSettings button").addClass("hidden"),i(".pageSettings .section.githubAuthSettings button").addClass("hidden"),!ce())return;const t=bc(),e=t.providerData.some(n=>n.providerId==="password"),a=t.providerData.some(n=>n.providerId==="google.com"),s=t.providerData.some(n=>n.providerId==="github.com");e?(i(".pageSettings .section.passwordAuthSettings #emailPasswordAuth").removeClass("hidden"),i(".pageSettings .section.passwordAuthSettings #passPasswordAuth").removeClass("hidden"),(a||s)&&i(".pageSettings .section.passwordAuthSettings #removePasswordAuth").removeClass("hidden")):i(".pageSettings .section.passwordAuthSettings #addPasswordAuth").removeClass("hidden"),a?(i(".pageSettings .section.googleAuthSettings #removeGoogleAuth").removeClass("hidden"),e||s?i(".pageSettings .section.googleAuthSettings #removeGoogleAuth").removeClass("disabled"):i(".pageSettings .section.googleAuthSettings #removeGoogleAuth").addClass("disabled")):i(".pageSettings .section.googleAuthSettings #addGoogleAuth").removeClass("hidden"),s?(i(".pageSettings .section.githubAuthSettings #removeGithubAuth").removeClass("hidden"),e||a?i(".pageSettings .section.githubAuthSettings #removeGithubAuth").removeClass("disabled"):i(".pageSettings .section.githubAuthSettings #removeGithubAuth").addClass("disabled")):i(".pageSettings .section.githubAuthSettings #addGithubAuth").removeClass("hidden")}function r$(){i(".pageSettings .section[data-config-name='funbox'] .button").removeClass("active"),i(".pageSettings .section[data-config-name='funbox'] .button").removeClass("disabled"),yc().then(t=>{t.forEach(e=>{!Mv(d.funbox,e.name)&&!d.funbox.split("#").includes(e.name)&&i(`.pageSettings .section[data-config-name='funbox'] .button[data-config-value='${e.name}']`).addClass("disabled")})}).catch(t=>{h(`Failed to update funbox buttons: ${t.message}`,-1)}),d.funbox.split("#").forEach(t=>{i(`.pageSettings .section[data-config-name='funbox'] .button[data-config-value='${t}']`).addClass("active")})}function o$(){var t,e;if(ce()&&S()){const a=i(".pageSettings .section.tags .tagsList").empty();(e=(t=S())==null?void 0:t.tags)==null||e.forEach(s=>{a.append(`

      <div class="buttons tag" data-id="${s._id}" data-name="${s.name}" data-display="${s.display}">
        <button class="tagButton ${s.active?"active":""}" active="${s.active}">
          ${s.display}
        </button>
        <button class="clearPbButton">
          <i class="fas fa-crown fa-fw"></i>
        </button>
        <button class="editButton">
          <i class="fas fa-pen fa-fw"></i>
        </button>
        <button class="removeButton">
          <i class="fas fa-trash fa-fw"></i>
        </button>
      </div>

      `)}),i(".pageSettings .section.tags").removeClass("hidden")}else i(".pageSettings .section.tags").addClass("hidden")}function l$(){var t,e;if(ce()&&S()){const a=i(".pageSettings .section.presets .presetsList").empty();(e=(t=S())==null?void 0:t.presets)==null||e.forEach(s=>{a.append(`
      <div class="buttons preset" data-id="${s._id}" data-name="${s.name}" data-display="${s.display}">
        <button class="presetButton">${s.display}</button>
        <button class="editButton">
          <i class="fas fa-pen fa-fw"></i>
        </button>
        <button class="removeButton">
          <i class="fas fa-trash fa-fw"></i>
        </button>
      </div>
      
      `)}),i(".pageSettings .section.presets").removeClass("hidden")}else i(".pageSettings .section.presets").addClass("hidden")}async function ii(t=!0){var n;if(t)for(const r of Object.keys(U))(n=U[r])==null||n.updateUI();o$(),l$(),r$(),bh(),Ir(),await vt(0),Ky(!0),s3(!0),i(".pageSettings .section[data-config-name='paceCaret'] input.customPaceCaretSpeed").val(ea(d.typingSpeedUnit).fromWpm(d.paceCaretCustomSpeed)),i(".pageSettings .section[data-config-name='minWpm'] input.customMinWpmSpeed").val(ea(d.typingSpeedUnit).fromWpm(d.minWpmCustomSpeed)),i(".pageSettings .section[data-config-name='minAcc'] input.customMinAcc").val(d.minAccCustom),i(".pageSettings .section[data-config-name='minBurst'] input.customMinBurst").val(ea(d.typingSpeedUnit).fromWpm(d.minBurstCustomSpeed)),d.autoSwitchTheme?i(".pageSettings .section[data-config-name='autoSwitchThemeInputs']").removeClass("hidden"):i(".pageSettings .section[data-config-name='autoSwitchThemeInputs']").addClass("hidden"),d.customBackground!==""?i(".pageSettings .section[data-config-name='customBackgroundFilter']").removeClass("hidden"):i(".pageSettings .section[data-config-name='customBackgroundFilter']").addClass("hidden"),u$(),i(".pageSettings .section[data-config-name='customBackgroundSize'] input").val(d.customBackground),ce()?d3():i$(),G1();const e=window.navigator.userAgent.toLowerCase(),a=e.includes("mac")&&!e.includes("firefox")?"cmd":"ctrl",s=d.quickRestart==="esc"?"tab":"esc";i(".pageSettings .tip").html(`
    tip: You can also change all these settings quickly using the
    command line (<key>${s}</key> or <key>${a}</key> + <key>shift</key> + <key>p</key>)`)}function d$(t){const e=i(`.pageSettings .settingsGroup.${t}`);e.stop(!0,!0).slideToggle(250).toggleClass("slideup"),e.hasClass("slideup")?i(`.pageSettings .sectionGroupTitle[group=${t}]`).addClass("rotateIcon"):i(`.pageSettings .sectionGroupTitle[group=${t}]`).removeClass("rotateIcon")}function u$(){const t=i(".pageSettings .section[data-config-name='customBackgroundSize'] button.remove");d.customBackground!==void 0&&d.customBackground.length>0?t.removeClass("hidden"):t.addClass("hidden")}i(".pageSettings .section[data-config-name='paceCaret']").on("focusout","input.customPaceCaretSpeed",()=>{const t=parseInt(i(".pageSettings .section[data-config-name='paceCaret'] input.customPaceCaretSpeed").val()),e=ea(d.typingSpeedUnit).toWpm(t);Nv(e)});i(".pageSettings .section[data-config-name='paceCaret']").on("click","button.save",()=>{const t=parseInt(i(".pageSettings .section[data-config-name='paceCaret'] input.customPaceCaretSpeed").val()),e=ea(d.typingSpeedUnit).toWpm(t);Nv(e)});i(".pageSettings .section[data-config-name='minWpm']").on("focusout","input.customMinWpmSpeed",()=>{const t=parseInt(i(".pageSettings .section[data-config-name='minWpm'] input.customMinWpmSpeed").val()),e=ea(d.typingSpeedUnit).toWpm(t);Wv(e)});i(".pageSettings .section[data-config-name='minWpm']").on("click","button.save",()=>{const t=parseInt(i(".pageSettings .section[data-config-name='minWpm'] input.customMinWpmSpeed").val()),e=ea(d.typingSpeedUnit).toWpm(t);Wv(e)});i(".pageSettings .section[data-config-name='minAcc']").on("focusout","input.customMinAcc",()=>{Bv(parseInt(i(".pageSettings .section[data-config-name='minAcc'] input.customMinAcc").val()))});i(".pageSettings .section[data-config-name='minAcc']").on("click","button.save",()=>{Bv(parseInt(i(".pageSettings .section[data-config-name='minAcc'] input.customMinAcc").val()))});i(".pageSettings .section[data-config-name='minBurst']").on("focusout","input.customMinBurst",()=>{const t=parseInt(i(".pageSettings .section[data-config-name='minBurst'] input.customMinBurst").val()),e=ea(d.typingSpeedUnit).toWpm(t);Zv(e)});i(".pageSettings .section[data-config-name='minBurst']").on("click","button.save",()=>{const t=parseInt(i(".pageSettings .section[data-config-name='minBurst'] input.customMinBurst").val()),e=ea(d.typingSpeedUnit).toWpm(t);Zv(e)});i(".pageSettings .section[data-config-name='funbox']").on("click",".button",t=>{const e=i(t.currentTarget).attr("data-config-value");F1(e),r$()});i(".pageSettings .section.tags").on("click",".tagsList .tag .tagButton",t=>{const e=t.currentTarget,a=i(e).parent(".tag").attr("data-id");s$(a),i(e).toggleClass("active")});i(".pageSettings .section.presets").on("click",".presetsList .preset .presetButton",async t=>{const e=t.currentTarget,a=i(e).parent(".preset").attr("data-id");await t3(a),ii()});i("#importSettingsButton").on("click",()=>{n$("import")});i("#exportSettingsButton").on("click",()=>{const t=JSON.stringify(d);navigator.clipboard.writeText(t).then(function(){h("JSON Copied to clipboard",0)},function(){n$("export")})});i(".pageSettings .sectionGroupTitle").on("click",t=>{d$(i(t.currentTarget).attr("group"))});i(".pageSettings .section[data-config-name='customBackgroundSize'] .inputAndButton button.save").on("click",()=>{Pc(i(".pageSettings .section[data-config-name='customBackgroundSize'] .inputAndButton input").val())});i(".pageSettings .section[data-config-name='customBackgroundSize'] .inputAndButton button.remove").on("click",()=>{Pc("")});i(".pageSettings .section[data-config-name='customBackgroundSize'] .inputAndButton input").on("keypress",t=>{t.key==="Enter"&&Pc(i(".pageSettings .section[data-config-name='customBackgroundSize'] .inputAndButton input").val())});i(".pageSettings .section[data-config-name='fontSize'] .inputAndButton button.save").on("click",()=>{zm(parseFloat(i(".pageSettings .section[data-config-name='fontSize'] .inputAndButton input").val()))&&h("Saved",1,{duration:1})});i(".pageSettings .section[data-config-name='fontSize'] .inputAndButton input").on("keypress",t=>{t.key==="Enter"&&zm(parseFloat(i(".pageSettings .section[data-config-name='fontSize'] .inputAndButton input").val()))&&h("Saved",1,{duration:1})});i(".pageSettings .section[data-config-name='maxLineWidth'] .inputAndButton button.save").on("click",()=>{Oc(parseFloat(i(".pageSettings .section[data-config-name='maxLineWidth'] .inputAndButton input").val()))&&h("Saved",1,{duration:1})});i(".pageSettings .section[data-config-name='maxLineWidth'] .inputAndButton input").on("focusout",()=>{Oc(parseFloat(i(".pageSettings .section[data-config-name='maxLineWidth'] .inputAndButton input").val()))&&h("Saved",1,{duration:1})});i(".pageSettings .section[data-config-name='maxLineWidth'] .inputAndButton input").on("keypress",t=>{t.key==="Enter"&&Oc(parseFloat(i(".pageSettings .section[data-config-name='maxLineWidth'] .inputAndButton input").val()))&&h("Saved",1,{duration:1})});i(".pageSettings .section[data-config-name='keymapSize'] .inputAndButton button.save").on("click",()=>{Ic(parseFloat(i(".pageSettings .section[data-config-name='keymapSize'] .inputAndButton input").val()))&&h("Saved",1,{duration:1})});i(".pageSettings .section[data-config-name='keymapSize'] .inputAndButton input").on("focusout",()=>{Ic(parseFloat(i(".pageSettings .section[data-config-name='keymapSize'] .inputAndButton input").val()))&&h("Saved",1,{duration:1})});i(".pageSettings .section[data-config-name='keymapSize'] .inputAndButton input").on("keypress",t=>{t.key==="Enter"&&Ic(parseFloat(i(".pageSettings .section[data-config-name='keymapSize'] .inputAndButton input").val()))&&h("Saved",1,{duration:1})});i(".pageSettings .section[data-config-name='customLayoutfluid'] .inputAndButton button.save").on("click",()=>{Fv(i(".pageSettings .section[data-config-name='customLayoutfluid'] .inputAndButton input").val()).then(t=>{t&&h("Custom layoutfluid saved",1)})});i(".pageSettings .section[data-config-name='customLayoutfluid'] .inputAndButton .input").on("keypress",t=>{t.key==="Enter"&&Fv(i(".pageSettings .section[data-config-name='customLayoutfluid'] .inputAndButton input").val()).then(e=>{e&&h("Custom layoutfluid saved",1)})});i(".pageSettings .quickNav .links a").on("click",t=>{const e=t.target.innerText;i(`.pageSettings .settingsGroup.${e}`).hasClass("slideup")&&d$(e)});i(".pageSettings .section.discordIntegration .getLinkAndGoToOauth").on("click",()=>{Z.users.getOauthLink().then(t=>{var e;window.open((e=t.data)==null?void 0:e.url,"_self")})});let c$=!1;function Cm(t){c$=t}mt(t=>{t==="fullConfigChange"&&Cm(!0),t==="fullConfigChangeFinished"&&Cm(!1),!(c$||t==="saveToLocalStorage")&&Xe()==="settings"&&t!=="theme"&&ii()});const u3=new Pn({name:"settings",element:i(".page.pageSettings"),path:"/settings",afterHide:async()=>{o3(),Aa("pageSettings")},beforeShow:async()=>{ss("pageSettings","main"),await l3(),await ii(!1)}});i(async()=>{za("pageSettings")});class Wi{constructor(e,a){var n;this.inputElement=e,i(this.inputElement).wrap('<div class="inputAndIndicator"></div>'),this.parentElement=i(this.inputElement).parent(".inputAndIndicator"),this.options=a,this.currentStatus=null;let s='<div class="statusIndicator">';for(const[r,o]of Object.entries(a))s+=`
      <div
        class="indicator level${o.level} hidden"
        data-option-id="${r}"
        
        ${(((n=o.message)==null?void 0:n.length)??0)>27?'data-balloon-length="large"':""}
        data-balloon-pos="up"
        ${o.message??""?`aria-label="${o.message}"`:""}
      >
        <i class="fas fa-fw ${o.icon} ${o.spinIcon?"fa-spin":""}"></i>
      </div>
      `;s+="</div>",this.parentElement.append(s)}hide(){this.parentElement.find(".statusIndicator div").addClass("hidden"),this.currentStatus=null,i(this.inputElement).css("padding-right","0.5em")}show(e,a){this.hide(),this.currentStatus=e;const s=this.parentElement.find(`[data-option-id="${e}"]`);s.removeClass("hidden"),a!==void 0&&a!==""&&(a.length>20?s.attr("data-balloon-length","large"):s.removeAttr("data-balloon-length"),s.attr("aria-label",a)),i(this.inputElement).css("padding-right","2.1em")}get(){return this.currentStatus}}const c3=["gmaill.com","gamil.com","gnail.com","gmil.com","gamail.com","hotmai.com","gmial.com","hotmal.com","yaho.com","outlokk.com","gmil.com","hotmial.com","yahooo.com","otulook.com","gamil.com","hotnail.com","yaoo.com","outlok.com","gmail.cmo","hotmail.cmo","yahho.com","outloook.com","gmaail.com","hottmail.com","yaho.com","outllok.com","gmai.com","hotmil.com","yhaoo.com","outlookk.com","gmil.com","htmial.com","yaahoo.com","otlook.com","gamail.com","hotnail.com","yaoho.com","outlok.com","gemail.com","hotmiall.com","yahhoo.com","outloookk.com","gmal.com","hottmail.com","yahio.com","outlokkk.com",".comm",".con",".cmo",".coom",".cim",".vom","-online.de","-tonline.de","acor.de","aecor.de","ahoo.de","al.com","ao.com","aol.cm","aol.con","aol.ocm","aol.om","aoll.com","apl.com","arco.de","arocr.de","aror.de","feenet.de","freeenet.de","freeent.de","freeet.de","freemet.de","freeneet.de","freent.de","frenet.de","gm.de","gm.net","gm.xde","gmc.de","gmx.ded","gmx.dw","gmxx.de","gmy.de","gx.de","hmx.de","homail.de","hotmai.de","hotmal.de","mx.de","mx.net","otmail.com","r-online.de","rcor.de","reenet.de","t--online.de","t-0nline.de","t-nline.de","t-oline.de","t-omline.de","t-onine.de","t-onlien.de","t-onliine.de","t-onlin.de","t-onlinde.de","t-onlinr.de","t-onlione.de","t-onlline.de","t-onlne.de","t-onlone.de","t.-online.de","t.online.de","tonline.de","wb.de","we.de","web.ded","web.dw","wed.de","weeb.de","wen.de","wweb.de","yaho.de","yahooo.de","yaoo.de","yhoo.de","yahhoo.de"];function Zb(){i(".page.pageLogin .register.side button").prop("disabled",!1)}function Qc(){i(".page.pageLogin .register.side button").prop("disabled",!0)}function _a(){i(".pageLogin input").prop("disabled",!1),i(".pageLogin button").prop("disabled",!1)}function qb(){i(".pageLogin input").prop("disabled",!0),i(".pageLogin button").prop("disabled",!0)}function Fb(){i(".pageLogin .preloader").removeClass("hidden")}function ka(){i(".pageLogin .preloader").addClass("hidden")}const Ca=()=>{ri.get()!=="available"||Fs.get()!=="valid"&&Fs.get()!=="typo"&&Fs.get()!=="edu"||Ko.get()!=="match"||oi.get()!=="good"||Vo.get()!=="match"?Qc():Zb()},p3=Da(1e3,async()=>{const t=i(".page.pageLogin .register.side .usernameInput").val();if(!t){Ca();return}const e=await Z.users.getNameAvailability(t);e.status===200?ri.show("available",e.message):e.status===422?ri.show("unavailable",e.message):e.status===409?ri.show("taken",e.message):(ri.show("unavailable",e.message),h("Failed to check name availability: "+e.message,-1)),Ca()}),f3=()=>{const t=i(".page.pageLogin .register.side .emailInput").val(),e=/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,a=/@.*(education|school|\.edu$|\.edu\.|\.ac\.|\.sch\.)/i,s=c3.some(n=>t.endsWith(n));e.test(t)?s?Fs.show("typo","Please check your email address, it may contain a typo."):a.test(t)?Fs.show("edu","Some education emails will fail to receive our messages, or disable the account as soon as you graduate. Consider using a personal email address."):Fs.show("valid"):Fs.show("invalid"),Ca()},p$=()=>{const t=i(".page.pageLogin .register.side .emailInput").val(),e=i(".page.pageLogin .register.side .verifyEmailInput").val();t===e?Ko.show("match"):Ko.show("mismatch"),Ca()},f$=()=>{const t=i(".page.pageLogin .register.side .passwordInput").val();lv(t)?oi.show("good","Password is good"):t.length<8?oi.show("short","Password must be at least 8 characters"):t.length>64?oi.show("long","Password must be at most 64 characters"):oi.show("weak","Password must contain at least one capital letter, number, and special character"),Ca()},m$=()=>{const t=i(".page.pageLogin .register.side .passwordInput").val(),e=i(".page.pageLogin .register.side .verifyPasswordInput").val();t===e?Vo.show("match"):Vo.show("mismatch"),Ca()},ri=new Wi(i(".page.pageLogin .register.side input.usernameInput"),{available:{icon:"fa-check",level:1},unavailable:{icon:"fa-times",level:-1},taken:{icon:"fa-user",level:-1},checking:{icon:"fa-circle-notch",spinIcon:!0,level:0}}),Fs=new Wi(i(".page.pageLogin .register.side input.emailInput"),{valid:{icon:"fa-check",level:1},invalid:{icon:"fa-times",level:-1},typo:{icon:"fa-exclamation-triangle",level:1},edu:{icon:"fa-exclamation-triangle",level:1}}),Ko=new Wi(i(".page.pageLogin .register.side input.verifyEmailInput"),{match:{icon:"fa-check",level:1},mismatch:{icon:"fa-times",level:-1}}),oi=new Wi(i(".page.pageLogin .register.side input.passwordInput"),{good:{icon:"fa-check",level:1},short:{icon:"fa-times",level:-1},long:{icon:"fa-times",level:-1},weak:{icon:"fa-times",level:-1}}),Vo=new Wi(i(".page.pageLogin .register.side input.verifyPasswordInput"),{match:{icon:"fa-check",level:1},mismatch:{icon:"fa-times",level:-1}});i(".page.pageLogin .register.side .usernameInput").on("input",()=>{setTimeout(()=>{if(i(".page.pageLogin .register.side .usernameInput").val()===""){ri.hide();return}else ri.show("checking"),p3()},1)});i(".page.pageLogin .register.side .emailInput").on("input",()=>{const t=i(".page.pageLogin .register.side .emailInput").val(),e=i(".page.pageLogin .register.side .verifyEmailInput").val();if(!t&&!e){Fs.hide(),Ko.hide();return}f3(),p$()});i(".page.pageLogin .register.side .verifyEmailInput").on("input",()=>{const t=i(".page.pageLogin .register.side .emailInput").val(),e=i(".page.pageLogin .register.side .verifyEmailInput").val();if(!t&&!e){Fs.hide(),Ko.hide();return}p$()});i(".page.pageLogin .register.side .passwordInput").on("input",()=>{const t=i(".page.pageLogin .register.side .passwordInput").val(),e=i(".page.pageLogin .register.side .verifyPasswordInput").val();if(!t&&!e){oi.hide(),Vo.hide();return}f$(),m$()});i(".page.pageLogin .register.side .verifyPasswordInput").on("input",()=>{const t=i(".page.pageLogin .register.side .passwordInput").val(),e=i(".page.pageLogin .register.side .verifyPasswordInput").val();if(!t&&!e){oi.hide(),Vo.hide();return}f$(),m$()});const m3=new Pn({name:"login",element:i(".page.pageLogin"),path:"/login",afterHide:async()=>{i(".pageLogin input").val(""),ri.hide(),Fs.hide(),Ko.hide(),oi.hide(),Vo.hide(),Aa("pageLogin")},beforeShow:async()=>{ss("pageLogin","main"),_a(),Qc()}});i(()=>{za("pageLogin")});let Sm,h$=new Promise(t=>{Sm=t});function h3(){g$.show({mode:"dialog",beforeAnimation:async t=>{h$=new Promise(e=>{Sm=e}),sl("register"),Uc(t.querySelector(".g-recaptcha"),"register",e=>{Sm(e),Uy()})}})}function Uy(t=!1){t&&Sm(),g$.hide()}const g$=new et({dialogId:"registerCaptchaModal",customEscapeHandler:async()=>{Uy(!0)},customWrapperClickHandler:async()=>{Uy(!0)}});async function g3(t){if(!t)return;const e=new URLSearchParams(t.slice(1));if(e.has("access_token")){history.replaceState(null,"","/");const a=e.get("access_token"),s=e.get("token_type"),n=e.get("state");Je();const r=await Z.users.linkDiscord(s,a,n);if(Te(),r.status!==200){h("Failed to link Discord: "+r.message,-1);return}if(r.data===null){h("Failed to link Discord: data returned was null",-1);return}h(r.message,1);const o=S();if(!o)return;const{discordId:l,discordAvatar:u}=r.data;l!==void 0?o.discordId=l:o.discordAvatar=u,aa(o),Hm(void 0,l,u),bh()}}function y3(t){const e=dv("customTheme",t);if(e===null)return;let a=null;try{a=JSON.parse(atob(e))}catch{h("Invalid custom theme ",0);return}let s=[],n,r,o;if(Array.isArray(a.c)&&a.c.length===10?(s=a.c,n=a.i,r=a.s,o=a.f):Array.isArray(a)&&a.length===10&&(s=a),s.length===0){h("Invalid custom theme ",0);return}const l=d.customTheme,u=d.customThemeColors;try{Fu(s),h("Custom theme applied",1),n!==void 0&&(Pc(n),jv(r),Hv(o)),d.customTheme||ui(!0)}catch(c){h("Something went wrong. Reverting to previous state.",0),console.error(c),ui(l),Fu(u)}}function v3(t){const e=dv("testSettings",t);if(e===null)return;const a=JSON.parse(pM.decompressFromURI(e)??""),s={};if(a[0]!==null&&(zt(a[0],!0),s.mode=a[0]),a[1]!==null&&(d.mode==="time"?Ws(parseInt(a[1],10),!0):d.mode==="words"?Ti(parseInt(a[1],10),!0):d.mode==="quote"&&(mn(-2,!1),Cv(parseInt(a[1],10)),tt()),s.mode2=a[1]),a[2]!==null){const r=a[2];Tn(r.text),ci(r.limit.mode),ir(r.limit.value),Wo(r.pipeDelimiter),s["custom text settings"]=""}a[3]!==null&&(tn(a[3],!0),s.punctuation=a[3]?"on":"off"),a[4]!==null&&(os(a[4],!0),s.numbers=a[4]?"on":"off"),a[5]!==null&&(No(a[5],!0),s.language=a[5]),a[6]!==null&&(Ps(a[6],!0),s.difficulty=a[6]),a[7]!==null&&(pn(a[7],!0),s.funbox=a[7]),He({nosave:!0});let n="";Object.keys(s).forEach(r=>{const o=s[r];o!==void 0&&(n+=`${r}${Ba(o?": "+o:"")}<br>`)}),n!==""&&h("Settings applied from URL:<br><br>"+n,1,{duration:10,allowHTML:!0})}function b3(t){const e=(dv("challenge",t)??"").toLowerCase();e!==""&&(h("Loading challenge",0),VZ(e).then(a=>{a&&(h("Challenge loaded",1),He({nosave:!0}))}).catch(a=>{h("Failed to load challenge",-1),console.error(a)}))}let Ss=[],y$=0,fn=[],lr=[];const fi={notifications:[],psas:[]};function ug(){v$(!1),w$.hide({afterAnimation:async()=>{var o;i("#alertsPopup .notificationHistory .list").empty(),i("#alertsPopup .psas .list").empty();const t=[];let e=0;if(fn.length===0&&lr.length===0)return;const a=await Z.users.updateInbox({mailIdsToMarkRead:fn.length>0?fn:void 0,mailIdsToDelete:lr.length>0?lr:void 0}),s=a.status,n=a.message;if(s!==200){h(`Failed to update inbox: ${n}`,-1);return}const r=Ss.filter(l=>l.rewards.length>0&&fn.includes(l.id)).map(l=>l.rewards).reduce(function(l,u){return l.concat(u)},[]);for(const l of r)if(l.type==="xp")e+=l.item;else if(l.type==="badge"){const u=XF(l.item.id);u&&(t.push(u.name),aR(l.item))}if(t.length>0&&h(`New badge${t.length>1?"s":""} unlocked: ${t.join(", ")}`,1,{duration:5,customTitle:"Reward",customIcon:"gift"}),e>0){const l=((o=S())==null?void 0:o.xp)??0;Kx(l,e),NT(l+e),Zx(e)}}})}async function w3(){w$.show({beforeAnimation:async()=>{ce()?(i("#alertsPopup .accountAlerts").removeClass("hidden"),i("#alertsPopup .separator.accountSeparator").removeClass("hidden"),i("#alertsPopup .accountAlerts .list").html(`
          <div class="preloader"><i class="fas fa-fw fa-spin fa-circle-notch"></i></div>`)):(i("#alertsPopup .accountAlerts").addClass("hidden"),i("#alertsPopup .separator.accountSeparator").addClass("hidden")),Ss=[],lr=[],fn=[],C3(),_3()},afterAnimation:async()=>{ce()&&k3()}})}async function k3(){if(!xt()){i("#alertsPopup .accountAlerts .list").html(`
    <div class="nothing">
    You are offline
    </div>
    `);return}const t=await Z.users.getInbox();if(t.status===503){i("#alertsPopup .accountAlerts .list").html(`
    <div class="nothing">
    Account inboxes are temporarily unavailable
    </div>
    `);return}else if(t.status!==200){i("#alertsPopup .accountAlerts .list").html(`
    <div class="nothing">
    Error getting inbox: ${t.message} Please try again later
    </div>
    `);return}const e=t.data;if(Ss=e.inbox,jb(),Ss.length===0){i("#alertsPopup .accountAlerts .list").html(`
    <div class="nothing">
    Nothing to show
    </div>
    `);return}y$=e.maxMail,b$(),i("#alertsPopup .accountAlerts .list").empty();for(const a of Ss){!a.read&&a.rewards.length===0&&fn.push(a.id);let s="";a.rewards.length>0&&!a.read&&(s=`<div class="rewards">
        <i class="fas fa-fw fa-gift"></i>
        <span>${a.rewards.length}</span>
      </div>`),i("#alertsPopup .accountAlerts .list").append(`
    
      <div class="item" data-id="${a.id}">
        <div class="indicator ${a.read?"":"main"}"></div>
        <div class="timestamp">${lk(new Date(a.timestamp))} ago</div>
        <div class="title">${a.subject}</div>
        <div class="body">
          ${a.body}

${s}
        </div>
        <div class="buttons">
          ${a.rewards.length>0&&!a.read?'<button class="markReadAlert textButton" aria-label="Claim" data-balloon-pos="left"><i class="fas fa-gift"></i></button>':""}
          ${a.rewards.length>0&&a.read||a.rewards.length===0?'<button class="deleteAlert textButton" aria-label="Delete" data-balloon-pos="left"><i class="fas fa-trash"></i></button>':""}
        </div>
      </div>
    
    `)}}function x3(t,e){fi.psas.push({message:t,level:e})}function _3(){if(fi.psas.length===0)i("#alertsPopup .psas .list").html('<div class="nothing">Nothing to show</div>');else{i("#alertsPopup .psas .list").empty();for(const t of fi.psas){const{message:e,level:a}=t;let s="";a===-1?s="error":a===1?s="main":a===0&&(s="sub"),i("#alertsPopup .psas .list").prepend(`
        <div class="item">
        <div class="indicator ${s}"></div>
        <div class="body">
          ${Ba(e)}
        </div>
      </div>
      `)}}}function C3(){if(fi.notifications.length===0)i("#alertsPopup .notificationHistory .list").html('<div class="nothing">Nothing to show</div>');else{i("#alertsPopup .notificationHistory .list").empty();for(const t of fi.notifications){const{message:e,level:a,customTitle:s}=t;let n="Notice",r="sub";a===-1?(r="error",n="Error"):a===1&&(r="main",n="Success"),s!==void 0&&(n=s),i("#alertsPopup .notificationHistory .list").prepend(`
      <div class="item">
      <div class="indicator ${r}"></div>
      <div class="title">${n}</div>
      <div class="body">
        ${Ba(e)}
      </div>
    </div>
    `)}}}function v$(t){t?i("header nav .showAlerts .notificationBubble").removeClass("hidden"):i("header nav .showAlerts .notificationBubble").addClass("hidden")}function b$(){i("#alertsPopup .accountAlerts .title .right").text(`${Ss.length}/${y$}`)}function h0(t){lr.push(t),i(`#alertsPopup .accountAlerts .list .item[data-id="${t}"]`).remove(),i("#alertsPopup .accountAlerts .list .item").length==0&&i("#alertsPopup .accountAlerts .list").html(`
    <div class="nothing">
    Nothing to show
    </div>
    `),jb(),b$()}function g0(t){fn.push(t);const e=i(`#alertsPopup .accountAlerts .list .item[data-id="${t}"]`);jb(),e.find(".indicator").removeClass("main"),e.find(".buttons").empty(),e.find(".buttons").append('<button class="deleteAlert textButton" aria-label="Delete" data-balloon-pos="left"><i class="fas fa-trash"></i></button>'),e.find(".rewards").animate({opacity:0,height:0,marginTop:0},250,"easeOutCubic",()=>{e.find(".rewards").remove()})}function jb(){const t=i("#alertsPopup .accountAlerts .claimAll"),e=i("#alertsPopup .accountAlerts .deleteAll");if(t.addClass("hidden"),e.addClass("hidden"),Ss.length>0){let a=0;for(const s of Ss)!s.read&&!fn.includes(s.id)&&(a+=s.rewards.length);a>0?t.removeClass("hidden"):e.removeClass("hidden")}lr.length===Ss.length&&e.addClass("hidden")}i("header nav .showAlerts").on("click",()=>{w3()});AM((t,e,a)=>{fi.notifications.push({message:t,level:e,customTitle:a}),fi.notifications.length>25&&fi.notifications.shift()});const w$=new et({dialogId:"alertsPopup",customAnimations:{show:{modal:{from:{marginRight:"-10rem"},to:{marginRight:"0"},easing:"easeOutCirc"}},hide:{modal:{from:{marginRight:"0"},to:{marginRight:"-10rem"},easing:"easeInCirc"}}},customEscapeHandler:()=>{ug()},customWrapperClickHandler:()=>{ug()},setup:async()=>{i("#alertsPopup .accountAlerts").on("click",".claimAll",()=>{for(const t of Ss)!t.read&&!fn.includes(t.id)&&g0(t.id)}),i("#alertsPopup .accountAlerts").on("click",".deleteAll",()=>{for(const t of Ss)lr.includes(t.id)||h0(t.id)}),i("#alertsPopup .mobileClose").on("click",()=>{ug()}),i("#alertsPopup .accountAlerts .list").on("click",".item .buttons .deleteAlert",t=>{const e=i(t.currentTarget).closest(".item").attr("data-id");h0(e)}),i("#alertsPopup .accountAlerts .list").on("click",".item .buttons .markReadAlert",t=>{const e=i(t.currentTarget).closest(".item").attr("data-id");g0(e)})}}),Sp=i("header .signInOut");function S3(){Tt?Sp.removeClass("hidden"):Sp.addClass("hidden"),ce()?Sp.find(".icon").html('<i class="fas fa-fw fa-sign-out-alt"></i>'):Sp.find(".icon").html('<i class="far fa-fw fa-user"></i>')}const k$=[];function T3(t){k$.push(t)}function $3(t,e){k$.forEach(a=>{try{a(t,e)}catch(s){console.error("Google Sign Up event subscriber threw an error"),console.error(s)}})}const A3=new Pn({name:"test",element:i(".page.pageTest"),path:"/",beforeHide:async()=>{tt(),He(),to(),Li(),i("#wordsInput").trigger("focusout")},afterHide:async()=>{wm(!0)},beforeShow:async()=>{wm(!1),A1(),tt(),He({noAnim:!0}),$q(),Sb(),bm()}});function M3(){i(".pageAbout .contributors").empty(),i(".pageAbout .supporters").empty(),co.getDataset("count").data=[],co.updateColors()}let Tm,Gn;function L3(){var t;if(Tm){co.updateColors();const e=O3(Tm);co.data.labels=e.labels,co.getDataset("count").data=e.data}if(Gn){const e=Math.round(Gn.timeTyping),a=fM({start:0,end:e*1e3});i(".pageAbout #totalTimeTypingStat .val").text(((t=a.years)==null?void 0:t.toString())??""),i(".pageAbout #totalTimeTypingStat .valSmall").text("years"),i(".pageAbout #totalTimeTypingStat").attr("aria-label",Sh(Math.round(e/3600))+" hours");const s=iw(Gn.testsStarted);i(".pageAbout #totalStartedTestsStat .val").text(s.rounded<10?s.roundedTo2:s.rounded),i(".pageAbout #totalStartedTestsStat .valSmall").text(s.orderOfMagnitude),i(".pageAbout #totalStartedTestsStat").attr("aria-label",Sh(Gn.testsStarted)+" tests");const n=iw(Gn.testsCompleted);i(".pageAbout #totalCompletedTestsStat .val").text(n.rounded<10?n.roundedTo2:n.rounded),i(".pageAbout #totalCompletedTestsStat .valSmall").text(n.orderOfMagnitude),i(".pageAbout #totalCompletedTestsStat").attr("aria-label",Sh(Gn.testsCompleted)+" tests")}}async function E3(){if(Tm&&Gn)return;if(!xt()){h("Cannot update all time stats - offline",0);return}const t=await Z.publicStats.getSpeedHistogram({language:"english",mode:"time",mode2:"60"});t.status>=200&&t.status<300?Tm=t.data:h(`Failed to get global speed stats for histogram: ${t.message}`,-1);const e=await Z.publicStats.getTypingStats();e.status>=200&&e.status<300?Gn=e.data:h(`Failed to get global typing stats: ${t.message}`,-1)}async function I3(){let t;try{t=await AA()}catch(o){h(Re(o,"Failed to get supporters"),-1),t=[]}let e;try{e=await MA()}catch(o){h(Re(o,"Failed to get contributors"),-1),e=[]}E3().then(()=>{L3()});const a=document.querySelector(".pageAbout .supporters");let s="";for(const o of t)s+=`<div>${o}</div>`;a&&(a.innerHTML=s);const n=document.querySelector(".pageAbout .contributors");let r="";for(const o of e)r+=`<div>${o}</div>`;n&&(n.innerHTML=r)}function O3(t){const e=[],a=[],s=Object.keys(t).sort((n,r)=>parseInt(n,10)-parseInt(r,10));for(const[n,r]of s.entries()){const o=s[n+1],l=parseInt(r,10);if(e.push({x:l,y:t[l]}),a.push(`${l} - ${l+9}`),o!==void 0&&l+10!==parseInt(o,10))for(let u=l+10;u<parseInt(o,10);u+=10)e.push({x:u,y:0}),a.push(`${u} - ${u+9}`)}return{data:e,labels:a}}const P3=new Pn({name:"about",element:i(".page.pageAbout"),path:"/about",afterHide:async()=>{M3(),Aa("pageAbout")},beforeShow:async()=>{ss("pageAbout","main"),I3()}});i(()=>{za("pageAbout")});const $m={userUid:void 0,lbOptOut:void 0};let zl;async function R3(t){if(!ce()){h("You must be logged in to submit a report",0);return}x$.show({mode:"dialog",focusFirstInput:!0,beforeAnimation:async e=>{Uc(e.querySelector(".g-recaptcha"),"userReportModal");const{name:a}=t;$m.userUid=t.uid,$m.lbOptOut=t.lbOptOut,e.querySelector(".user").textContent=a,e.querySelector(".reason").value="Inappropriate name",e.querySelector(".comment").value="",zl=new Vt({select:e.querySelector(".reason"),settings:{showSearch:!1,contentLocation:e}})}}),new cc(i("#userReportModal .comment"),250)}async function D3(){x$.hide({afterAnimation:async()=>{zl==null||zl.destroy(),zl=void 0,sl("userReportModal")}})}async function N3(){const t=yh("userReportModal");if(!t){h("Please complete the captcha");return}const e=i("#userReportModal .reason").val(),a=i("#userReportModal .comment").val(),s=t;if(!e){h("Please select a valid report reason");return}if(!a){h("Please provide a comment");return}if(e==="Suspected cheating"&&$m.lbOptOut){h("You cannot report this user for suspected cheating as they have opted out of the leaderboards.",0,{duration:10});return}const n=a.length-250;if(n>0){h(`Report comment is ${n} character(s) too long`);return}Je();const r=await Z.users.report($m.userUid,e,a,s);if(Te(),r.status!==200){h("Failed to report user: "+r.message,-1);return}h("Report submitted. Thank you!",1),D3()}const x$=new et({dialogId:"userReportModal",setup:async t=>{var e;(e=t.querySelector("button"))==null||e.addEventListener("click",()=>{N3()})}});function y0(){i(".page.pageProfile .preloader").removeClass("hidden"),i(".page.pageProfile .profile").html(`
      <div class="details none">
        <div class="avatarAndName">
          <div class="avatars">
            <div class="placeholderAvatar">
              <i class="fas fa-user-circle"></i>
            </div>
            <div class="avatar"></div>
          </div>
          <div>
             <div class="user">
              <div class="name">-</div>
              <div class="userFlags"></div>
            </div>
            <div class="badges"></div>
            <div class="allBadges"></div>
            <div class="joined" data-balloon-pos="up">-</div>
	          <div class="streak" data-balloon-pos="up">-</div>
          </div>
          <div class="levelAndBar">
            <div class="level" data-balloon-pos="up">-</div>
            <div class="xpBar" data-balloon-pos="up">
              <div class="bar" style="width: 0%;"></div>
            </div>
            <div class="xp" data-balloon-pos="up">-/-</div>
          </div>
        </div>
        <div class="separator sep1"></div>
        <div class="typingStats vertical">
          <div class="started">
            <div class="title">tests started</div>
            <div class="value">-</div>
          </div>
          <div class="completed">
            <div class="title">tests completed</div>
            <div class="value">-</div>
          </div>
          <div class="timeTyping">
            <div class="title">time typing</div>
            <div class="value">-</div>
          </div>
        </div>
        <div class="separator sep2 hidden"></div>

        <div class="bioAndKeyboard vertical hidden">
          <div class="bio">
            <div class="title">bio</div>
            <div class="value">-</div>
          </div>
          <div class="keyboard hidden">
            <div class="title">keyboard</div>
            <div class="value">-</div>
          </div>
        </div>
        <div class="separator sep3 hidden"></div>

        <div class="socials big hidden">
          <div class="title">socials</div>
          <div class="value">-</div>
        </div>
        <div class="buttonGroup">
          <button
            class="userReportButton"
            data-balloon-pos="left"
            aria-label="Report user"
          >
            <i class="fas fa-flag"></i>
          </button>
        </div>
      </div>
      <div class="leaderboardsPositions">
        <div class="title">All-Time English Leaderboards</div>
        <div class="group t15">
          <div class="testType">15 seconds</div>
          <div class="pos">-</div>
          <div class="topPercentage">-</div>
        </div>
        <div class="group t60">
          <div class="testType">60 seconds</div>
          <div class="pos">-</div>
          <div class="topPercentage">-</div>
        </div>
      </div>
      <div class="pbsWords">
        <div class="group">
          <div class="quick">
            <div class="test">10 words</div>
            <div class="wpm">-</div>
            <div class="acc">-</div>
          </div>
        </div>
        <div class="group">
          <div class="quick">
            <div class="test">25 words</div>
            <div class="wpm">-</div>
            <div class="acc">-</div>
          </div>
        </div>
        <div class="group">
          <div class="quick">
            <div class="test">50 words</div>
            <div class="wpm">-</div>
            <div class="acc">-</div>
          </div>
        </div>
        <div class="group">
          <div class="quick">
            <div class="test">100 words</div>
            <div class="wpm">-</div>
            <div class="acc">-</div>
          </div>
        </div>
      </div>
      <div class="pbsTime">
        <div class="group">
          <div class="quick">
            <div class="test">15 seconds</div>
            <div class="wpm">-</div>
            <div class="acc">-</div>
          </div>
        </div>
        <div class="group">
          <div class="quick">
            <div class="test">30 seconds</div>
            <div class="wpm">-</div>
            <div class="acc">-</div>
          </div>
        </div>
        <div class="group">
          <div class="quick">
            <div class="test">60 seconds</div>
            <div class="wpm">-</div>
            <div class="acc">-</div>
          </div>
        </div>
        <div class="group">
          <div class="quick">
            <div class="test">120 seconds</div>
            <div class="wpm">-</div>
            <div class="acc">-</div>
          </div>
        </div>
      </div><div class="lbOptOutReminder hidden"></div>`)}async function W3(t){const e=LA("isUid");if(t.data)i(".page.pageProfile .preloader").addClass("hidden"),await xm("profile",t.data),jy(t.data.personalBests,!0);else if(t.uidOrName!==void 0&&t.uidOrName!==""){const a=e?await Z.users.getProfileByUid(t.uidOrName):await Z.users.getProfileByName(t.uidOrName);if(i(".page.pageProfile .preloader").addClass("hidden"),a.status===404||a.data===null){const s=e?"User not found":`User ${t.uidOrName} not found`;i(".page.pageProfile .preloader").addClass("hidden"),i(".page.pageProfile .error").removeClass("hidden"),i(".page.pageProfile .error .message").text(s)}else if(a.status!==200){h("Failed to load profile: "+a.message,-1);return}else window.history.replaceState(null,"",`/profile/${a.data.name}`),await xm("profile",a.data),jy(a.data.personalBests,!0)}else h("Missing update parameter!",-1)}i(".page.pageProfile").on("click",".profile .userReportButton",()=>{const t=i(".page.pageProfile .profile").attr("uid")??"",e=i(".page.pageProfile .profile").attr("name")??"",a=(i(".page.pageProfile .profile").attr("lbOptOut")??"false")==="true";R3({uid:t,name:e,lbOptOut:a})});const B3=new Pn({name:"profile",element:i(".page.pageProfile"),path:"/profile",afterHide:async()=>{Aa("pageProfile"),y0()},beforeShow:async t=>{var a;ss("pageProfile","main");const e=((a=t==null?void 0:t.params)==null?void 0:a.uidOrName)??"";e?(i(".page.pageProfile .preloader").removeClass("hidden"),i(".page.pageProfile .search").addClass("hidden"),i(".page.pageProfile .content").removeClass("hidden"),y0(),W3({uidOrName:e,data:t==null?void 0:t.data})):(i(".page.pageProfile .preloader").addClass("hidden"),i(".page.pageProfile .search").removeClass("hidden"),i(".page.pageProfile .content").addClass("hidden"))}});za("pageProfile");const Z3=new Pn({name:"profileSearch",element:i(".page.pageProfileSearch"),path:"/profile",afterHide:async()=>{Aa("pageProfileSearch")},beforeShow:async()=>{ss("pageProfileSearch","main"),i(".page.pageProfileSearch input").val("")},afterShow:async()=>{i(".page.pageProfileSearch input").trigger("focus")}}),q3=new Pn({name:"404",element:i(".page.page404"),path:"/404",afterHide:async()=>{Aa("page404")},beforeShow:async()=>{ss("page404","main")}});za("page404");async function ln(t,e={}){return e={...{force:!1},...e},new Promise(s=>{if(ld()){console.debug(`change page to ${t} stopped, page transition is true`),s(!1);return}if(!e.force&&Xe()===t){console.debug(`change page ${t} stoped, page already active`),s(!1);return}else console.log(`changing page ${t}`);const n={loading:qP,test:A3,settings:u3,about:P3,account:cj,login:m3,profile:B3,profileSearch:Z3,404:q3},r=n[Xe()],o=n[t];r==null||r.beforeHide().then(()=>{mr(!0),i(".page").removeClass("active"),cr(r.element,o.element,250,async()=>{mr(!1),o.element.addClass("active"),s(!0),await(o==null?void 0:o.afterShow()),mq()},async()=>{o.name==="test"?rw():rw(Ac(o.name)+" | Monkeytype"),Di(!1),$W(o.name),await(r==null?void 0:r.afterHide()),await(o==null?void 0:o.beforeShow({params:e.params,data:e.data}))})})})}const Hb="leaderboardsWrapper";let Ha="allTime",In="english",Uo=!1,la={15:[],60:[]},$a={15:{},60:{}},Mr={15:[],60:[]};const Tp={15:!1,60:!1},Go=50;let Gy;function Am(t){t==="15"?i("#leaderboardsWrapper table.left tbody").empty():t==="60"&&i("#leaderboardsWrapper table.right tbody").empty()}function v0(t){t==="15"?i("#leaderboardsWrapper table.left tfoot").empty():t==="60"&&i("#leaderboardsWrapper table.right tfoot").empty()}function F3(){la={15:[],60:[]},$a={15:{},60:{}},Mr={15:[],60:[]}}function j3(){clearInterval(Gy),Gy=void 0,i("#leaderboards .subTitle").text("-")}function b0(){if(Ha==="daily"){const t=new Date;t.setUTCHours(0,0,0,0),t.setDate(t.getDate()+1);const e=new Date;e.setUTCMilliseconds(0);const a=mM(t,e);i("#leaderboards .subTitle").text("Next reset in: "+Ta(a,!0))}else{const t=new Date,e=14-t.getMinutes()%15,a=60-t.getSeconds(),s=e*60+a;i("#leaderboards .subTitle").text("Next update in: "+Ta(s,!0))}}function H3(){b0(),Gy=setInterval(()=>{b0()},1e3)}function Mm(t){t==="15"?i("#leaderboardsWrapper .leftTableLoader").removeClass("hidden"):t==="60"&&i("#leaderboardsWrapper .rightTableLoader").removeClass("hidden")}function dr(t){t==="15"?i("#leaderboardsWrapper .leftTableLoader").addClass("hidden"):t==="60"&&i("#leaderboardsWrapper .rightTableLoader").addClass("hidden")}function z3(t){var r,o,l,u;let e;if(t==="15"?e="left":e="right",!ce()){i(`#leaderboardsWrapper table.${e} tfoot`).html(`
    <tr>
      <td colspan="6" style="text-align:center;"></>
    </tr>
    `);return}if((((o=(r=S())==null?void 0:r.typingStats)==null?void 0:o.timeTyping)??0)<7200){i(`#leaderboardsWrapper table.${e} tfoot`).html(`
    <tr>
      <td colspan="6" style="text-align:center;">Your account must have 2 hours typed to be placed on the leaderboard.</>
    </tr>
    `);return}if(((l=S())==null?void 0:l.lbOptOut)===!0){i(`#leaderboardsWrapper table.${e} tfoot`).html(`
    <tr>
      <td colspan="6" style="text-align:center;">You have opted out of the leaderboards</>
    </tr>
    `);return}const a=$a[t];if(Ha==="daily"&&a!==null&&a.minWpm===void 0){i(`#leaderboardsWrapper table.${e} tfoot`).html(`
    <tr>
      <td colspan="6" style="text-align:center;">Looks like the server returned data in a new format, please refresh</>
    </tr>
    `);return}let s="";if(Ha==="allTime"&&a!==void 0&&(a!=null&&a.rank)){const c=we(a.rank/$a[t].count*100);$a[t].rank===1?s="GOAT":s=`Top ${c}%`,s=`<br><span class="sub">${s}</span>`}const n=a==null?void 0:a.entry;if(n){const c=new Date(n.timestamp);i(`#leaderboardsWrapper table.${e} tfoot`).html(`
    <tr>
    <td>${a.rank}</td>
    <td><span class="top">You</span>${s||""}</td>
    <td class="alignRight">${ue.typingSpeed(n.wpm,{showDecimalPlaces:!0})}<br>
    <div class="sub">${ue.percentage(n.acc,{showDecimalPlaces:!0})}</div></td>
    <td class="alignRight">${ue.typingSpeed(n.raw,{showDecimalPlaces:!0})}<br>
    <div class="sub">${ue.percentage(n.consistency,{showDecimalPlaces:!0})}</div></td>
    <td class="alignRight">${nt(c,"dd MMM yyyy")}<br>
    <div class='sub'>${nt(c,"HH:mm")}</div></td>
  </tr>
  `)}else Ha==="daily"?i(`#leaderboardsWrapper table.${e} tfoot`).html(`
    <tr>
      <td colspan="6" style="text-align:center;">Not qualified ${`(min speed required: ${(u=$a[t])==null?void 0:u.minWpm} wpm)`}</>
    </tr>
    `):i(`#leaderboardsWrapper table.${e} tfoot`).html(`
    <tr>
      <td colspan="6" style="text-align:center;">Not qualified</>
    </tr>
    `)}function K3(t){var n,r,o,l,u;if(Ha==="daily")return;let e;t==="15"?e="left":e="right";const a=((l=(o=(r=(n=S())==null?void 0:n.lbMemory)==null?void 0:r.time)==null?void 0:o[t])==null?void 0:l.english)??0,s=(u=$a[t])==null?void 0:u.rank;if(s){const c=a-s;c>0?(Mw("time",t,"english",s,!0),a!==0&&i(`#leaderboardsWrapper table.${e} tfoot tr td .top`).append(` (<i class="fas fa-fw fa-angle-up"></i>${Math.abs(c)} since you last checked)`)):c<0?(Mw("time",t,"english",s,!0),a!==0&&i(`#leaderboardsWrapper table.${e} tfoot tr td .top`).append(` (<i class="fas fa-fw fa-angle-down"></i>${Math.abs(c)} since you last checked)`)):a!==0&&i(`#leaderboardsWrapper table.${e} tfoot tr td .top`).append(" ( = since you last checked)")}}async function zb(t){var n;if(la[t]===void 0)return;let e;t==="15"?e="left":e="right",la[t].length===0&&i(`#leaderboardsWrapper table.${e} tbody`).html("<tr><td colspan='7'>No results found</td></tr>");const a=(n=S())==null?void 0:n.name;let s="";for(let r=0;r<la[t].length;r++){const o=la[t][r];if(o===void 0)break;let l="";o.name===a&&(l=' class="me"');const u=new Date(o.timestamp);Ha==="daily"&&!o.rank&&(o.rank=r+1);let c='<div class="avatarPlaceholder"><i class="fas fa-user-circle"></i></div>';o.discordAvatar!==void 0&&(c='<div class="avatarPlaceholder"><i class="fas fa-circle-notch fa-spin"></i></div>'),s+=`
    <tr ${l}>
    <td>${o.rank===1?'<i class="fas fa-fw fa-crown"></i>':o.rank}</td>
    <td>
    <div class="avatarNameBadge">
      <div class="lbav">${c}</div>
      <a href="${location.origin}/profile/${o.uid}?isUid" class="entryName" uid=${o.uid} router-link>${o.name}</a>
      <div class="flagsAndBadge">
        ${sh(o)}
        ${o.badgeId?km(o.badgeId):""}
      </div>
    </div>
    </td>
    <td class="alignRight">${ue.typingSpeed(o.wpm,{showDecimalPlaces:!0})}<br>
    <div class="sub">${ue.percentage(o.acc,{showDecimalPlaces:!0})}</div></td>
    <td class="alignRight">${ue.typingSpeed(o.raw,{showDecimalPlaces:!0})}<br>
    <div class="sub">${ue.percentage(o.consistency,{showDecimalPlaces:!0})}</div></td>
    <td class="alignRight">${nt(u,"dd MMM yyyy")}<br>
    <div class='sub'>${nt(u,"HH:mm")}</div></td>
  </tr>
  `}i(`#leaderboardsWrapper table.${e} tbody`).html(s)}const w0=i("#leaderboardsWrapper .showYesterdayButton"),k0=i("#leaderboardsWrapper .showYesterdayButton .text");function Kb(){i("#leaderboardsWrapper").stop(!0,!0).css("opacity",1).animate({opacity:0},100,()=>{Sa==null||Sa.destroy(),Sa=void 0,Am("15"),Am("60"),v0("15"),v0("60"),F3(),j3(),Uo=!1,Vb(),i("#leaderboardsWrapper").addClass("hidden"),Aa(Hb)})}function _$(){const t=i("#leaderboardsWrapper .mainTitle"),e=Ha==="daily"?"Daily":"All-Time",a=In.charAt(0).toUpperCase()+In.slice(1);let s=`${e} ${a} Leaderboards`;Uo&&Ha!=="allTime"&&(s+=" (Yesterday)"),t.text(s)}function Vb(){w0.addClass("hidden"),Ha==="daily"&&w0.removeClass("hidden"),Uo?k0.text("Show today"):k0.text("Show yesterday")}function Lm(){const t=Ha==="daily";return{isDaily:t,daysBefore:t&&Uo?1:0}}async function pc(){var f;an=!1,fc=!1,Mm("15"),Mm("60");const t=["15","60"],e=t.map(async m=>Z.leaderboards.get({language:In,mode:"time",mode2:m,...Lm()})),a=[];ce()&&a.push(...t.map(async m=>Z.leaderboards.getRank({language:In,mode:"time",mode2:m,...Lm()})));const s=await Promise.all(e),n=await Promise.all(a),r=[...s.filter(m=>m.status!==200)??[],...n.filter(m=>m.status!==200)??[]];if(r.length>0){dr("15"),dr("60"),h("Failed to load leaderboards: "+((f=r[0])==null?void 0:f.message),-1);return}const[o,l]=s.map(m=>m.data),[u,c]=n.map(m=>m.data);o!=null&&(la[15]=o),l!=null&&(la[60]=l),u!=null&&($a[15]=u),c!=null&&($a[60]=c),["15","60"].forEach(async m=>{dr(m),Am(m),z3(m),K3(m),await zb(m),Ub(la[m]).then(g=>{Mr[m]=g,Gb(m)})}),i("#leaderboardsWrapper .leftTableWrapper").removeClass("invisible"),i("#leaderboardsWrapper .rightTableWrapper").removeClass("invisible"),_$(),Vb(),i("#leaderboardsWrapper .buttons .button").removeClass("active"),i("#leaderboardsWrapper .buttonGroup.timeRange .button."+Ha).addClass("active"),i("#leaderboardsWrapper #leaderboards .leftTableWrapper").scrollTop(0),i("#leaderboardsWrapper #leaderboards .rightTableWrapper").scrollTop(0),an=!0,fc=!0}async function V3(t,e=!1){var o,l,u;if(e&&((o=la[t][0])==null?void 0:o.rank)===1||Tp[t])return;Tp[t]=!0,Mm(t);let a=(l=mi(la[t]))==null?void 0:l.rank;e&&(a=(((u=la[t][0])==null?void 0:u.rank)??0)-Go);let s;a<0&&(s=Math.abs(a)-1,a=0);const n=await Z.leaderboards.get({language:In,mode:"time",mode2:t,skip:a,limit:s,...Lm()}),r=n.data;if(n.status!==200||r===null||r.length===0){dr(t),Tp[t]=!1;return}e?la[t].unshift(...r):la[t].push(...r),e&&!s&&(s=Go-1),await zb(t),Ub(r).then(c=>{e?Mr[t].unshift(...c):Mr[t].push(...c),Gb(t)}),dr(t),Tp[t]=!1}async function wh(t,e){Mm(t);const a=await Z.leaderboards.get({language:In,mode:"time",mode2:t,skip:e,...Lm()}),s=a.data;if(a.status===503){h("Leaderboards are currently updating - please try again later",-1);return}if(Am(t),la[t]=[],Mr[t]=[],a.status!==200||s===null||s.length===0){dr(t);return}la[t]=s,await zb(t),Ub(s).then(n=>{Mr[t]=n,Gb(t)}),dr(t)}async function Ub(t){return Promise.allSettled(t.map(async e=>nv(e.discordId,e.discordAvatar))).then(e=>e.map(a=>a.status==="fulfilled"?a.value:null))}function Gb(t){const a=i(`#leaderboardsWrapper table.${t==="15"?"left":"right"} tbody .lbav`);for(const[s,n]of Mr[t].entries()){const r=a[s];n!==null?i(r).html(`<div class="avatar" style="background-image:url(${n})"></div>`):i(r).html('<div class="avatarPlaceholder"><i class="fas fa-user-circle"></i></div>')}}function U3(){if(!xt()){h("You can't view leaderboards while offline",0);return}ss(Hb,"popups"),da("leaderboardsWrapper")||(ce()?(i("#leaderboardsWrapper #leaderboards .rightTableJumpToMe").removeClass("disabled"),i("#leaderboardsWrapper #leaderboards .leftTableJumpToMe").removeClass("disabled")):(i("#leaderboardsWrapper #leaderboards .rightTableJumpToMe").addClass("disabled"),i("#leaderboardsWrapper #leaderboards .leftTableJumpToMe").addClass("disabled")),i("#leaderboards table thead tr td:nth-child(3)").html(d.typingSpeedUnit+'<br><div class="sub">accuracy</div>'),Sa=new Vt({select:"#leaderboardsWrapper #leaderboards .leaderboardsTop .buttonGroup.timeRange .languageSelect",settings:{showSearch:!1},data:["english","spanish","german","french","portuguese","indonesian","italian"].map(t=>({value:t,text:t,selected:t===In})),events:{afterChange:t=>{var e;In=(e=t[0])==null?void 0:e.value,_$(),pc()}}}),i("#leaderboardsWrapper").stop(!0,!0).css("opacity",0).removeClass("hidden").animate({opacity:1},125,()=>{pc(),H3()}))}i("#leaderboardsWrapper").on("click",t=>{i(t.target).attr("id")==="leaderboardsWrapper"&&Kb()});let Sa,an=!0;i("#leaderboardsWrapper #leaderboards .leftTableWrapper").on("scroll",t=>{if(!an)return;const e=i(t.currentTarget);Math.round(e.scrollTop())<=50&&kh("15",!0)});const kh=Da(500,V3);i("#leaderboardsWrapper #leaderboards .leftTableWrapper").on("scroll",t=>{if(!an)return;const e=i(t.currentTarget);e===void 0||e[0]===void 0||Math.round(e[0].scrollHeight-e.scrollTop())<=Math.round(e.outerHeight())+50&&kh("15")});let fc=!0;i("#leaderboardsWrapper #leaderboards .rightTableWrapper").on("scroll",t=>{if(!fc)return;const e=i(t.currentTarget);Math.round(e.scrollTop())<=50&&kh("60",!0)});i("#leaderboardsWrapper #leaderboards .rightTableWrapper").on("scroll",t=>{const e=i(t.currentTarget);e===void 0||e[0]===void 0||Math.round(e[0].scrollHeight-e.scrollTop())<=Math.round(e.outerHeight()+50)&&kh("60")});i("#leaderboardsWrapper #leaderboards .leftTableJumpToTop").on("click",async()=>{an=!1,i("#leaderboardsWrapper #leaderboards .leftTableWrapper").scrollTop(0),await wh("15",0),an=!0});i("#leaderboardsWrapper #leaderboards .leftTableJumpToMe").on("click",async()=>{var e;if(!((e=$a[15])!=null&&e.rank))return;an=!1,await wh("15",$a[15].rank-Go/2);const t=i("#leaderboardsWrapper #leaderboards .leftTableWrapper table tbody td").outerHeight();i("#leaderboardsWrapper #leaderboards .leftTableWrapper").animate({scrollTop:t*Math.min($a[15].rank,Go/2)-i("#leaderboardsWrapper #leaderboards .leftTableWrapper").outerHeight()/2.25},0,()=>{an=!0})});i("#leaderboardsWrapper #leaderboards .rightTableJumpToTop").on("click",async()=>{fc=!1,i("#leaderboardsWrapper #leaderboards .rightTableWrapper").scrollTop(0),await wh("60",0),fc=!0});i("#leaderboardsWrapper #leaderboards .rightTableJumpToMe").on("click",async()=>{var e;if(!((e=$a[60])!=null&&e.rank))return;an=!1,await wh("60",$a[60].rank-Go/2);const t=i("#leaderboardsWrapper #leaderboards .rightTableWrapper table tbody td").outerHeight();i("#leaderboardsWrapper #leaderboards .rightTableWrapper").animate({scrollTop:t*Math.min($a[60].rank,Go/2)-i("#leaderboardsWrapper #leaderboards .rightTableWrapper").outerHeight()/2.25},0,()=>{an=!0})});i("#leaderboardsWrapper #leaderboards .leaderboardsTop .buttonGroup.timeRange .allTime").on("click",()=>{Ha="allTime",In="english",Sa==null||Sa.disable(),Sa==null||Sa.setSelected("english"),pc()});i("#leaderboardsWrapper #leaderboards .leaderboardsTop .buttonGroup.timeRange .daily").on("click",()=>{Ha="daily",Vb(),Sa==null||Sa.enable(),pc()});i("#leaderboardsWrapper .showYesterdayButton").on("click",()=>{Uo=!Uo,pc()});i(document).on("keydown",t=>{t.key==="Escape"&&da("leaderboardsWrapper")&&(Kb(),t.preventDefault())});i("header nav").on("click",".textButton",t=>{i(t.currentTarget).hasClass("leaderboards")&&U3()});za(Hb);function G3(t){return new RegExp("^"+t.replace(/\//g,"\\/").replace(/:\w+/g,"(.+)")+"$")}function Q3(t){const e=t.result.slice(1),s=Array.from(t.route.path.matchAll(/:(\w+)/g)).map(n=>n[1]).map((n,r)=>[n,e[r]]);return Object.fromEntries(s)}const Y3={path:"404",load:()=>{ln("404")}},J3=[{path:"/",load:()=>{ln("test")}},{path:"/verify",load:()=>{ln("test")}},{path:"/about",load:()=>{ln("about")}},{path:"/settings",load:()=>{ln("settings")}},{path:"/login",load:()=>{if(!Tt){Ma("/");return}if(ce()){Ma("/account");return}ln("login")}},{path:"/account",load:(t,e)=>{if(!Tt){Ma("/");return}ln("account",{data:e.data})}},{path:"/profile",load:t=>{ln("profileSearch")}},{path:"/profile/:uidOrName",load:(t,e)=>{ln("profile",{force:!0,params:{uidOrName:t.uidOrName},data:e.data})}}];function Ma(t=window.location.pathname+window.location.search,e={}){if(Ra||Cr||ld()){console.debug(`navigate: ${t} ignored, page is busy (testRestarting: ${Ra}, resultCalculating: ${Cr}, pageTransition: ${ld()})`);return}t=t.replace(/\/$/,""),t===""&&(t="/"),history.pushState(null,"",t),C$(e)}async function C$(t={}){const a=J3.map(s=>({route:s,result:location.pathname.match(G3(s.path))})).find(s=>s.result!==null);if(a===void 0){Y3.load({},{});return}a.route.load(Q3(a),t)}window.addEventListener("popstate",()=>{C$()});document.addEventListener("DOMContentLoaded",()=>{document.body.addEventListener("click",t=>{const e=t==null?void 0:t.target;e.matches("[router-link]")&&(e!=null&&e.href)&&(t.preventDefault(),Ma(e.href))})});i("#popups").on("click","#leaderboards a.entryName",()=>{Kb()});let S$=!1;const Qb=new hM,Yb=new gM;async function T$(){if(Tt===void 0){h("Authentication uninitialized",-1,{duration:3});return}Je(),i(".sendVerificationEmail").prop("disabled",!0);const t=await Z.users.verificationEmail();i(".sendVerificationEmail").prop("disabled",!1),t.status!==200?(Te(),h("Failed to request verification email: "+t.message,-1)):(Te(),h("Verification email sent",1))}async function X3(){try{console.log("getting account data"),window.location.pathname!=="/account"?Rs(90):Rs(45),If("Downloading user data..."),await Ix(),await VP()}catch(a){const s=a;Ja(!1),s.responseCode===429&&(h("Doing so will save you bandwidth, make the next test be ready faster and will not sign you out (which could mean your new personal best would not save to your account).",0,{duration:0}),h("You will run into this error if you refresh the website to restart the test. It is NOT recommended to do that. Instead, use tab + enter or just tab (with quick tab mode enabled) to restart the test.",0,{duration:0}));const n=s.message||"Unknown error";return h("Failed to get user data: "+n,-1),console.error(s),_a(),i("header nav .account").css("opacity",1),!1}Xe()==="loading"?Rs(100):Rs(45),If("Applying settings...");const t=S();i("nav .textButton.account > .text").text(t.name),i("nav .textButton.account > .text").append(sh(t,{iconsOnly:!0})),Mq(),HF(t.tags),Promise.all([ov(),yc()]).then(a=>{const[s,n]=a;s.forEach(r=>{Wa.language[r]=!0}),n.forEach(r=>{Wa.funbox[r.name]=!0}),NF()}).catch(a=>{console.log(Re(a,"Something went wrong while loading the filters"))}),t.needsToChangeName&&od("You need to update your account name. <a class='openNameChange'>Click here</a> to change it and learn more about why.",-1,void 0,!0,void 0,!0);const e=JSON.stringify(d)===JSON.stringify(t.config);return(PC===void 0||!e)&&(console.log("no local config or local and db configs are different - applying db"),await Rc(t.config),Yo(!0)),Ja(!1),e3(),window.location.pathname==="/account"&&(Rs(90),await Nb()),window.location.pathname==="/login"?Ma("/account"):Ma(),!0}async function Yc(t){mr(!1),Ja(!0),await X3()||Or();const{discordId:e,discordAvatar:a,xp:s,inboxUnreadSize:n}=S();if(Hm(s,e,a),v$(n>0),ka(),i("header .signInOut .icon").html('<i class="fas fa-fw fa-sign-out-alt"></i>'),oa!==null&&!S$){Lb(t.uid);const r=await Z.results.save(oa);if(r.status!==200){h("Failed to save last result: "+r.message,-1);return}MF(),h("Last test result saved",1)}}async function x0(t,e){const a=window.location.search,s=window.location.hash;console.debug("account controller ready"),t?(console.debug(`auth state changed, user ${!!e}`),console.debug(e),e?await Yc(e):(window.location.pathname==="/account"&&window.history.replaceState("","","/login"),mr(!1),Ma())):(console.debug("auth not initialised or not connected"),window.location.pathname==="/account"&&window.history.replaceState("","","/login"),mr(!1),Ma()),S3(),y3(a),v3(a),b3(a),g3(s),Ir()}let xh;var q0;Tt&&xt()?xh=(q0=Tt)==null?void 0:q0.onAuthStateChanged(function(t){x0(!0,t)}):i(()=>{x0(!1,null)});async function e4(t,e){if(Tt===void 0){h("Authentication uninitialized",-1);return}if(!xt()){h("You are offline",0,{duration:2});return}if(xh(),Fb(),qb(),Qc(),t===""||e===""){h("Please fill in all fields",0),ka(),_a(),Zb();return}const a=i(".pageLogin .login #rememberMe input").prop("checked")?dk:uk;return await ck(Tt,a),yM(Tt,t,e).then(async s=>{await Yc(s.user)}).catch(function(s){console.error(s);let n=s.message;s.code==="auth/wrong-password"?n="Incorrect password":s.code==="auth/user-not-found"?n="User not found":s.code==="auth/invalid-email"?n="Invalid email format (make sure you are using your email to login - not your username)":s.code==="auth/invalid-credential"&&(n="Email/password is incorrect or your account does not have password authentication enabled."),h(n,-1),ka(),_a(),Ca()})}async function $$(t){if(Tt===void 0){h("Authentication uninitialized",-1,{duration:3});return}if(!xt()){h("You are offline",0,{duration:2});return}Fb(),qb(),Qc(),xh();const e=i(".pageLogin .login #rememberMe input").prop("checked")?dk:uk;await ck(Tt,e),wM(Tt,t).then(async a=>{var s;(s=cv(a))!=null&&s.isNewUser?$3(a,!0):await Yc(a.user)}).catch(a=>{console.log(a);let s=a.message;a.code==="auth/wrong-password"?s="Incorrect password":a.code==="auth/user-not-found"?s="User not found":a.code==="auth/invalid-email"?s="Invalid email format (make sure you are using your email to login - not your username)":a.code==="auth/popup-closed-by-user"?s="":a.code==="auth/popup-blocked"?s="Sign in popup was blocked by the browser. Check the address bar for a blocked popup icon, or update your browser settings to allow popups.":a.code==="auth/user-cancelled"?s="":a.code==="auth/account-exists-with-different-credential"&&(s="Account already exists, but its using a different authentication method. Try signing in with a different method"),s!==""&&h(s,-1),ka(),_a(),Ca()})}async function t4(){return $$(Qb)}async function a4(){return $$(Yb)}async function s4(){return A$("Google",Qb)}async function n4(){return A$("GitHub",Yb)}async function A$(t,e){if(!xt()){h("You are offline",0,{duration:2});return}if(Tt===void 0){h("Authentication uninitialized",-1,{duration:3});return}Je(),ce()&&vM(bc(),e).then(function(){Te(),h(`${t} authentication added`,1),Ir()}).catch(function(a){Te(),h(`Failed to add ${t} authentication: `+a.message,-1)})}function Or(){if(Tt===void 0){h("Authentication uninitialized",-1,{duration:3});return}ce()&&Tt.signOut().then(function(){h("Signed out",0,{duration:2}),i$(),Hm(),Ma("/login"),aa(void 0),i("header .signInOut .icon").html('<i class="far fa-fw fa-user"></i>'),setTimeout(()=>{Lq()},125)}).catch(function(t){h(t.message,-1)})}async function i4(){if(Tt===void 0){h("Authentication uninitialized",-1,{duration:3});return}if(!xt()){h("You are offline",0,{duration:2});return}h3();const t=await h$;if(t===void 0||t===""){h("Please complete the captcha",-1);return}qb(),Qc(),Fb();const e=i(".pageLogin .register input")[0].value,a=i(".pageLogin .register input")[1].value,s=i(".pageLogin .register input")[2].value,n=i(".pageLogin .register input")[3].value,r=i(".pageLogin .register input")[4].value;if(e===""||a===""||s===""||n===""){ka(),_a(),Ca(),h("Please fill in all fields",0);return}if(!a.match(/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/)){h("Invalid email",0),ka(),_a(),Ca();return}if(a!==s){h("Emails do not match",0),ka(),_a(),Ca();return}if(n!==r){h("Passwords do not match",0),ka(),_a(),Ca();return}if(!lv(n)){h("Password must contain at least one capital letter, number, a special character and must be between 8 and 64 characters long",0,{duration:4}),ka(),_a(),Ca();return}xh();try{const o=await bM(Tt,a,n),l=await Z.users.create(e,t,a,o.user.uid);if(l.status!==200)throw new Error(`Failed to sign in: ${l.message}`);if(await pk(o.user,{displayName:e}),await T$(),i("nav .textButton.account .text").text(e),ka(),await Yc(o.user),oa!==null&&(Lb(o.user.uid),(await Z.results.save(oa)).status===200)){const c=oa;Tv(c),$v(1,c.testDuration+c.incompleteTestSeconds-c.afkDuration)}h("Account created",1)}catch(o){let l=Re(o,"Failed to create account");o instanceof Error&&"code"in o&&o.code==="auth/email-already-in-use"&&(l=Re({message:"Email already in use"},"Failed to create account")),h(l,-1),ka(),_a(),Ca(),Or();return}}i(".pageLogin .login form").on("submit",t=>{t.preventDefault();const e=i(".pageLogin .login input")[0].value??"",a=i(".pageLogin .login input")[1].value??"";e4(e,a)});i(".pageLogin .login button.signInWithGoogle").on("click",()=>{t4()});i(".pageLogin .login button.signInWithGitHub").on("click",()=>{a4()});i("header .signInOut").on("click",()=>{if(Tt===void 0){h("Authentication uninitialized",-1,{duration:3});return}ce()?(Or(),S$=!0):Ma("/login")});i(".pageLogin .register form").on("submit",t=>{t.preventDefault(),i4()});i(".pageSettings #addGoogleAuth").on("click",async()=>{s4()});i(".pageSettings #addGithubAuth").on("click",async()=>{n4()});i(".pageAccount").on("click",".sendVerificationEmail",()=>{if(!xt()){h("You are offline",0,{duration:2});return}T$()});function $p({tagname:t,classes:e,attributes:a,innerHTML:s}){let n=`<${t}`;return e!==void 0&&(n+=` class="${e.join(" ")}"`),a!==void 0&&(n+=" "+Object.entries(a).filter(r=>r[1]!==void 0).sort((r,o)=>r[0].localeCompare(o[0])).map(r=>r[1]===!0?`${r[0]}`:`${r[0]}="${r[1]}"`).join(" ")),s!==void 0?n+=`>${s}</${t}>`:n+=" />",n}let ur=null;const rt={updateEmail:void 0,updateName:void 0,updatePassword:void 0,removeGoogleAuth:void 0,removeGithubAuth:void 0,removePasswordAuth:void 0,addPasswordAuth:void 0,deleteAccount:void 0,resetAccount:void 0,clearTagPb:void 0,optOutOfLeaderboards:void 0,applyCustomFont:void 0,resetPersonalBests:void 0,resetSettings:void 0,revokeAllTokens:void 0,unlinkDiscord:void 0,generateApeKey:void 0,viewApeKey:void 0,deleteApeKey:void 0,editApeKey:void 0,deleteCustomText:void 0,deleteCustomTextLong:void 0,resetProgressCustomTextLong:void 0,updateCustomTheme:void 0,deleteCustomTheme:void 0,forgotPassword:void 0,devGenerateData:void 0},Kl=new et({dialogId:"simpleModal",setup:async t=>{t.addEventListener("submit",e=>{e.preventDefault(),ur==null||ur.exec()})},customEscapeHandler:t=>{_0()},customWrapperClickHandler:t=>{_0()}});class lt{constructor(e){this.parameters=[],this.id=e.id,this.execFn=e.execFn,this.title=e.title,this.inputs=e.inputs??[],this.text=e.text,this.textAllowHtml=e.textAllowHtml??!1,this.wrapper=Kl.getWrapper(),this.element=Kl.getModal(),this.buttonText=e.buttonText,this.beforeInitFn=e.beforeInitFn,this.beforeShowFn=e.beforeShowFn,this.canClose=e.canClose??!0,this.onlineOnly=e.onlineOnly??!1,this.hideCallsExec=e.hideCallsExec??!1,this.showLabels=e.showLabels??!1}reset(){this.element.innerHTML=`
    <div class="title"></div>
    <div class="inputs"></div>
    <div class="text"></div>
    <button type="submit" class="submitButton"></button>`}init(){const e=i(this.element);e.find("input").val(""),this.reset(),e.attr("data-popup-id",this.id),e.find(".title").text(this.title),this.textAllowHtml?e.find(".text").html(this.text??""):e.find(".text").text(this.text??""),this.initInputs(),this.buttonText===""?e.find(".submitButton").remove():e.find(".submitButton").text(this.buttonText),(this.text??"")===""?e.find(".text").addClass("hidden"):e.find(".text").removeClass("hidden")}initInputs(){const e=i(this.element);if(this.inputs.every(n=>n.hidden)||this.inputs.length===0){e.find(".inputs").addClass("hidden");return}const s=e.find(".inputs");this.showLabels&&s.addClass("withLabel"),this.inputs.forEach((n,r)=>{var p,f,m,g;const o=`${this.id}_${r}`;this.showLabels&&!n.hidden&&s.append(`<label for="${o}">${n.label??""}</label>`);const l=n.type==="textarea"?"textarea":"input",u=n.hidden?["hidden"]:void 0,c={id:o,placeholder:n.placeholder??"",autocomplete:"off"};if(n.type!=="textarea"&&(c.value=((p=n.initVal)==null?void 0:p.toString())??"",c.type=n.type),!n.hidden&&!n.optional&&(c.required=!0),n.disabled&&(c.disabled=!0),n.type==="textarea")s.append($p({tagname:l,classes:u,attributes:c,innerHTML:n.initVal}));else if(n.type==="checkbox"){let y=$p({tagname:l,classes:u,attributes:c});n.description!==void 0&&(y+=`<span>${n.description}</span>`),this.showLabels?y=`<div>${y}</div>`:y=`
          <label class="checkbox">
            ${y}
            <div>${n.label}</div>
          </label>
        `,s.append(y)}else if(n.type==="range")s.append(`
          <div>
            ${$p({tagname:l,classes:u,attributes:{...c,min:n.min.toString(),max:n.max.toString(),step:(f=n.step)==null?void 0:f.toString(),oninput:"this.nextElementSibling.innerHTML = this.value"}})}
            <span>${n.initVal??""}</span>
          </div>
          `);else{switch(n.type){case"text":case"password":case"email":break;case"datetime-local":{n.min!==void 0&&(c.min=nt(n.min,"yyyy-MM-dd'T'HH:mm:ss")),n.max!==void 0&&(c.max=nt(n.max,"yyyy-MM-dd'T'HH:mm:ss")),n.initVal!==void 0&&(c.value=nt(n.initVal,"yyyy-MM-dd'T'HH:mm:ss"));break}case"date":{n.min!==void 0&&(c.min=nt(n.min,"yyyy-MM-dd")),n.max!==void 0&&(c.max=nt(n.max,"yyyy-MM-dd")),n.initVal!==void 0&&(c.value=nt(n.initVal,"yyyy-MM-dd"));break}case"number":{c.min=(m=n.min)==null?void 0:m.toString(),c.max=(g=n.max)==null?void 0:g.toString();break}}s.append($p({tagname:l,classes:u,attributes:c}))}n.oninput!==void 0&&(document.querySelector("#"+c.id).oninput=n.oninput)}),e.find(".inputs").removeClass("hidden")}exec(){if(!this.canClose)return;const e=[];for(const s of i("#simpleModal input, #simpleModal textarea"))i(s).is(":checkbox")?e.push(i(s).is(":checked")?"true":"false"):e.push(i(s).val());const a=[];for(let s=0;s<this.inputs.length;s++)a.push({...this.inputs[s],currentValue:e[s]});if(a.filter(s=>s.hidden!==!0&&s.optional!==!0).some(s=>s.currentValue===void 0||s.currentValue==="")){h("Please fill in all fields",0);return}this.disableInputs(),Je(),this.execFn(this,...e).then(s=>{Te(),(s.showNotification??!0)&&h(s.message,s.status,s.notificationOptions),s.status===1?this.hide(!0,s.hideOptions).then(()=>{s.afterHide&&s.afterHide()}):(this.enableInputs(),i(i("#simpleModal").find("input")[0]).trigger("focus"))})}disableInputs(){i("#simpleModal input").prop("disabled",!0),i("#simpleModal button").prop("disabled",!0),i("#simpleModal textarea").prop("disabled",!0),i("#simpleModal .checkbox").addClass("disabled")}enableInputs(){i("#simpleModal input").prop("disabled",!1),i("#simpleModal button").prop("disabled",!1),i("#simpleModal textarea").prop("disabled",!1),i("#simpleModal .checkbox").removeClass("disabled")}show(e=[],a){ur=this,this.parameters=e,Kl.show({focusFirstInput:!0,...a,beforeAnimation:async()=>{var s,n;(s=this.beforeInitFn)==null||s.call(this,this),this.init(),(n=this.beforeShowFn)==null||n.call(this,this)}})}async hide(e,a){this.canClose&&(this.hideCallsExec&&!e?this.exec():(ur=null,await Kl.hide(a)))}}function _0(){if(ur){ur.hide();return}}function r4(t){const a=["password","github.com","google.com"].filter(s=>s!==t);for(const s of a)if(_h(s))return s}function sn(){return _h("password")}function o4(){return _h("github.com")}function l4(){return _h("google.com")}function _h(t){var e,a;return((a=(e=Tt)==null?void 0:e.currentUser)==null?void 0:a.providerData.some(s=>s.providerId===t))||!1}async function ls(t){if(Tt===void 0)return{status:-1,message:"Authentication is not initialized"};if(!ce())return{status:-1,message:"User is not signed in"};const e=bc(),a=r4(t.excludeMethod);try{if(a===void 0)return{status:-1,message:"Failed to reauthenticate: there is no valid authentication present on the account."};if(a==="password"){if(t.password===void 0)return{status:-1,message:"Failed to reauthenticate using password: password missing."};const s=fk.credential(e.email,t.password);await xM(e,s)}else await _M(e,a==="github.com"?Yb:Qb);return{status:1,message:"Reauthenticated",user:e}}catch(s){const n=s;return n.code==="auth/wrong-password"?{status:0,message:"Incorrect password"}:{status:-1,message:"Failed to reauthenticate: "+((n==null?void 0:n.message)??JSON.stringify(s))}}}rt.updateEmail=new lt({id:"updateEmail",title:"Update email",inputs:[{placeholder:"Password",type:"password",initVal:""},{type:"text",placeholder:"New email",initVal:""},{type:"text",placeholder:"Confirm new email",initVal:""}],buttonText:"update",onlineOnly:!0,execFn:async(t,e,a,s)=>{if(a!==s)return{status:0,message:"Emails don't match"};const n=await ls({password:e});if(n.status!==1)return{status:n.status,message:n.message};const r=await Z.users.updateEmail(a,n.user.email);return r.status!==200?{status:-1,message:"Failed to update email: "+r.message}:(Or(),{status:1,message:"Email updated"})},beforeInitFn:t=>{ce()&&(sn()||(t.inputs=[],t.buttonText="",t.text="Password authentication is not enabled"))}});rt.removeGoogleAuth=new lt({id:"removeGoogleAuth",title:"Remove Google authentication",inputs:[{placeholder:"Password",type:"password",initVal:""}],onlineOnly:!0,buttonText:"remove",execFn:async(t,e)=>{const a=await ls({password:e,excludeMethod:"google.com"});if(a.status!==1)return{status:a.status,message:a.message};try{await pv(a.user,"google.com")}catch(s){return{status:-1,message:Re(s,"Failed to unlink Google account")}}return Ir(),On(3),{status:1,message:"Google authentication removed"}},beforeInitFn:t=>{ce()&&(sn()||(t.inputs=[],o4()||(t.buttonText="",t.text="Password or GitHub authentication is not enabled")))}});rt.removeGithubAuth=new lt({id:"removeGithubAuth",title:"Remove GitHub authentication",inputs:[{placeholder:"Password",type:"password",initVal:""}],onlineOnly:!0,buttonText:"remove",execFn:async(t,e)=>{const a=await ls({password:e,excludeMethod:"github.com"});if(a.status!==1)return{status:a.status,message:a.message};try{await pv(a.user,"github.com")}catch(s){return{status:-1,message:Re(s,"Failed to unlink GitHub account")}}return Ir(),On(3),{status:1,message:"GitHub authentication removed"}},beforeInitFn:t=>{ce()&&(sn()||(t.inputs=[],l4()||(t.buttonText="",t.text="Password or Google authentication is not enabled")))}});rt.removePasswordAuth=new lt({id:"removePaswordAuth",title:"Remove Password authentication",inputs:[{type:"checkbox",label:"I understand I will lose access to my Monkeytype account if my Google/GitHub account is lost or disabled."}],onlineOnly:!0,buttonText:"reauthenticate to remove",execFn:async t=>{const e=await ls({excludeMethod:"password"});if(e.status!==1)return{status:e.status,message:e.message};try{await pv(e.user,"password")}catch(a){return{status:-1,message:Re(a,"Failed to remove password authentication")}}return Ir(),On(3),{status:1,message:"Password authentication removed"}},beforeInitFn:()=>{ce()}});rt.updateName=new lt({id:"updateName",title:"Update name",inputs:[{placeholder:"password",type:"password",initVal:""},{placeholder:"new name",type:"text",initVal:""}],buttonText:"update",onlineOnly:!0,execFn:async(t,e,a)=>{const s=await ls({password:e});if(s.status!==1)return{status:s.status,message:s.message};const n=await Z.users.getNameAvailability(a);if(n.status===409)return{status:0,message:"Name not available"};if(n.status!==200)return{status:-1,message:"Failed to check name: "+n.message};const r=await Z.users.updateName(a);if(r.status!==200)return{status:-1,message:"Failed to update name: "+r.message};const o=S();return o&&(o.name=a,o.needsToChangeName&&On(2)),i("nav .textButton.account .text").text(a),{status:1,message:"Name updated"}},beforeInitFn:t=>{if(!ce())return;const e=S();e&&(sn()||(t.inputs[0].hidden=!0,t.buttonText="reauthenticate to update"),e.needsToChangeName===!0&&(t.text="You need to change your account name. This might be because you have a duplicate name, no account name or your name is not allowed (contains whitespace or invalid characters). Sorry for the inconvenience."))}});rt.updatePassword=new lt({id:"updatePassword",title:"Update password",inputs:[{placeholder:"current password",type:"password",initVal:""},{placeholder:"new password",type:"password",initVal:""},{placeholder:"confirm new password",type:"password",initVal:""}],buttonText:"update",onlineOnly:!0,execFn:async(t,e,a,s)=>{if(a!==s)return{status:0,message:"New passwords don't match"};if(a===e)return{status:0,message:"New password must be different from previous password"};if(!lv(a))return{status:0,message:"New password must contain at least one capital letter, number, a special character and must be between 8 and 64 characters long"};const n=await ls({password:e});if(n.status!==1)return{status:n.status,message:n.message};const r=await Z.users.updatePassword(a);return r.status!==200?{status:-1,message:"Failed to update password: "+r.message}:(Or(),{status:1,message:"Password updated"})},beforeInitFn:t=>{ce()&&(sn()||(t.inputs=[],t.buttonText="",t.text="Password authentication is not enabled"))}});rt.addPasswordAuth=new lt({id:"addPasswordAuth",title:"Add password authentication",inputs:[{placeholder:"email",type:"email",initVal:""},{placeholder:"confirm email",type:"email",initVal:""},{placeholder:"new password",type:"password",initVal:""},{placeholder:"confirm new password",type:"password",initVal:""}],buttonText:"reauthenticate to add",onlineOnly:!0,execFn:async(t,e,a,s,n)=>{if(e!==a)return{status:0,message:"Emails don't match"};if(s!==n)return{status:0,message:"Passwords don't match"};const r=await ls({password:s});if(r.status!==1)return{status:r.status,message:r.message};try{const l=fk.credential(e,s);await kM(r.user,l)}catch(l){return{status:-1,message:Re(l,"Failed to add password authentication")}}const o=await Z.users.updateEmail(e,r.user.email);return o.status!==200?{status:-1,message:"Password authentication added but updating the database email failed. This shouldn't happen, please contact support. Error: "+o.message}:(Ir(),{status:1,message:"Password authentication added"})}});rt.deleteAccount=new lt({id:"deleteAccount",title:"Delete account",inputs:[{placeholder:"password",type:"password",initVal:""}],text:"This is the last time you can change your mind. After pressing the button everything is gone.",buttonText:"delete",onlineOnly:!0,execFn:async(t,e)=>{const a=await ls({password:e});if(a.status!==1)return{status:a.status,message:a.message};h("Deleting all data...",0);const s=await Z.users.delete();return s.status!==200?{status:-1,message:"Failed to delete user data: "+s.message}:(On(3),{status:1,message:"Account deleted, goodbye"})},beforeInitFn:t=>{ce()&&(sn()||(t.inputs=[],t.buttonText="reauthenticate to delete"))}});rt.resetAccount=new lt({id:"resetAccount",title:"Reset account",inputs:[{placeholder:"password",type:"password",initVal:""}],text:"This is the last time you can change your mind. After pressing the button everything is gone.",buttonText:"reset",onlineOnly:!0,execFn:async(t,e)=>{const a=await ls({password:e});if(a.status!==1)return{status:a.status,message:a.message};h("Resetting settings...",0),await zv(),h("Resetting account...",0);const s=await Z.users.reset();return s.status!==200?{status:-1,message:"Failed to reset account: "+s.message}:(On(3),{status:1,message:"Account reset"})},beforeInitFn:t=>{ce()&&(sn()||(t.inputs=[],t.buttonText="reauthenticate to reset"))}});rt.optOutOfLeaderboards=new lt({id:"optOutOfLeaderboards",title:"Opt out of leaderboards",inputs:[{placeholder:"password",type:"password",initVal:""}],text:"Are you sure you want to opt out of leaderboards?",buttonText:"opt out",onlineOnly:!0,execFn:async(t,e)=>{const a=await ls({password:e});if(a.status!==1)return{status:a.status,message:a.message};const s=await Z.users.optOutOfLeaderboards();return s.status!==200?{status:-1,message:"Failed to opt out: "+s.message}:(On(3),{status:1,message:"Leaderboards opt out successful"})},beforeInitFn:t=>{ce()&&(sn()||(t.inputs=[],t.buttonText="reauthenticate to opt out"))}});rt.clearTagPb=new lt({id:"clearTagPb",title:"Clear tag PB",text:"Are you sure you want to clear this tags PB?",buttonText:"clear",execFn:async t=>{var n,r;const e=t.parameters[0],a=await Z.users.deleteTagPersonalBest(e);if(a.status!==200)return{status:-1,message:"Failed to clear tag PB: "+a.message};const s=(r=(n=S())==null?void 0:n.tags)==null?void 0:r.filter(o=>o._id===e)[0];return s===void 0?{status:-1,message:"Tag not found"}:(s.personalBests={time:{},words:{},quote:{},zen:{},custom:{}},i(`.pageSettings .section.tags .tagsList .tag[id="${e}"] .clearPbButton`).attr("aria-label","No PB found"),{status:1,message:"Tag PB cleared"})},beforeInitFn:t=>{t.text=`Are you sure you want to clear PB for tag ${t.parameters[1]}?`}});rt.applyCustomFont=new lt({id:"applyCustomFont",title:"Custom font",inputs:[{type:"text",placeholder:"Font name",initVal:""}],text:"Make sure you have the font installed on your computer before applying",buttonText:"apply",execFn:async(t,e)=>{var a;return(a=U.fontFamily)==null||a.setValue(e.replace(/\s/g,"_")),{status:1,message:"Font applied"}}});rt.resetPersonalBests=new lt({id:"resetPersonalBests",title:"Reset personal bests",inputs:[{placeholder:"password",type:"password",initVal:""}],buttonText:"reset",onlineOnly:!0,execFn:async(t,e)=>{const a=await ls({password:e});if(a.status!==1)return{status:a.status,message:a.message};const s=await Z.users.deletePersonalBests();if(s.status!==200)return{status:-1,message:"Failed to reset personal bests: "+s.message};const n=S();return n?(n.personalBests={time:{},words:{},quote:{},zen:{},custom:{}},{status:1,message:"Personal bests reset"}):{status:-1,message:"Failed to reset personal bests: no snapshot"}},beforeInitFn:t=>{ce()&&(sn()||(t.inputs=[],t.buttonText="reauthenticate to reset"))}});rt.resetSettings=new lt({id:"resetSettings",title:"Reset settings",text:"Are you sure you want to reset all your settings?",buttonText:"reset",onlineOnly:!0,execFn:async()=>(await zv(),{status:1,message:"Settings reset"})});rt.revokeAllTokens=new lt({id:"revokeAllTokens",title:"Revoke all tokens",inputs:[{placeholder:"password",type:"password",initVal:""}],text:"Are you sure you want to this? This will log you out of all devices.",buttonText:"revoke all",onlineOnly:!0,execFn:async(t,e)=>{const a=await ls({password:e});if(a.status!==1)return{status:a.status,message:a.message};const s=await Z.users.revokeAllTokens();return s.status!==200?{status:-1,message:"Failed to revoke tokens: "+s.message}:(On(3),{status:1,message:"Tokens revoked"})},beforeInitFn:t=>{!ce()||!S()||sn()||(t.inputs[0].hidden=!0,t.buttonText="reauthenticate to revoke all tokens")}});rt.unlinkDiscord=new lt({id:"unlinkDiscord",title:"Unlink Discord",text:"Are you sure you want to unlink your Discord account?",buttonText:"unlink",onlineOnly:!0,execFn:async()=>{const t=S();if(!t)return{status:-1,message:"Failed to unlink Discord: no snapshot"};const e=await Z.users.unlinkDiscord();return e.status!==200?{status:-1,message:"Failed to unlink Discord: "+e.message}:(t.discordAvatar=void 0,t.discordId=void 0,Hm(),aa(t),bh(),{status:1,message:"Discord unlinked"})}});rt.generateApeKey=new lt({id:"generateApeKey",title:"Generate new Ape key",inputs:[{type:"text",placeholder:"Name",initVal:""}],buttonText:"generate",onlineOnly:!0,execFn:async(t,e)=>{const a=await Z.apeKeys.add({body:{name:e,enabled:!1}});if(a.status!==200)return{status:-1,message:"Failed to generate key: "+a.body.message};const s=a.body.data,n=Kl.getPreviousModalInChain();return{status:1,message:"Key generated",hideOptions:{clearModalChain:!0,animationMode:"modalOnly"},afterHide:()=>{ft("viewApeKey",[s.apeKey],{modalChain:n,animationMode:"modalOnly"})}}}});rt.viewApeKey=new lt({id:"viewApeKey",title:"Ape key",inputs:[{type:"textarea",disabled:!0,placeholder:"key",initVal:""}],textAllowHtml:!0,text:`
    This is your new Ape Key. Please keep it safe. You will only see it once!<br><br>
    <strong>Note:</strong> Ape Keys are disabled by default, you need to enable them before they can be used.`,buttonText:"close",hideCallsExec:!0,execFn:async t=>({status:1,message:"Key generated",showNotification:!1,hideOptions:{clearModalChain:!0}}),beforeInitFn:t=>{t.inputs[0].initVal=t.parameters[0]},beforeShowFn:t=>{t.canClose=!1,i("#simpleModal textarea").css("height","110px"),i("#simpleModal .submitButton").addClass("hidden"),setTimeout(()=>{t.canClose=!0,i("#simpleModal .submitButton").removeClass("hidden")},5e3)}});rt.deleteApeKey=new lt({id:"deleteApeKey",title:"Delete Ape key",text:"Are you sure?",buttonText:"delete",onlineOnly:!0,execFn:async t=>{const e=await Z.apeKeys.delete({params:{apeKeyId:t.parameters[0]??""}});return e.status!==200?{status:-1,message:"Failed to delete key: "+e.body.message}:{status:1,message:"Key deleted",hideOptions:{clearModalChain:!0}}}});rt.editApeKey=new lt({id:"editApeKey",title:"Edit Ape key",inputs:[{type:"text",placeholder:"name",initVal:""}],buttonText:"edit",onlineOnly:!0,execFn:async(t,e)=>{const a=await Z.apeKeys.save({params:{apeKeyId:t.parameters[0]??""},body:{name:e}});return a.status!==200?{status:-1,message:"Failed to update key: "+a.body.message}:{status:1,message:"Key updated",hideOptions:{clearModalChain:!0}}}});rt.deleteCustomText=new lt({id:"deleteCustomText",title:"Delete custom text",text:"Are you sure?",buttonText:"delete",execFn:async t=>(VS(t.parameters[0],!1),Mi("",void 0),{status:1,message:"Custom text deleted"}),beforeInitFn:t=>{t.text=`Are you sure you want to delete custom text ${t.parameters[0]}?`}});rt.deleteCustomTextLong=new lt({id:"deleteCustomTextLong",title:"Delete custom text",text:"Are you sure?",buttonText:"delete",execFn:async t=>(VS(t.parameters[0],!0),Mi("",void 0),{status:1,message:"Custom text deleted"}),beforeInitFn:t=>{t.text=`Are you sure you want to delete custom text ${t.parameters[0]}?`}});rt.resetProgressCustomTextLong=new lt({id:"resetProgressCustomTextLong",title:"Reset progress for custom text",text:"Are you sure?",buttonText:"reset",execFn:async t=>{wy(t.parameters[0],0);const e=im(t.parameters[0],!0);return Tn(e),{status:1,message:"Custom text progress reset"}},beforeInitFn:t=>{t.text=`Are you sure you want to reset your progress for custom text ${t.parameters[0]}?`}});rt.updateCustomTheme=new lt({id:"updateCustomTheme",title:"Update custom theme",inputs:[{type:"text",placeholder:"name",initVal:""},{type:"checkbox",initVal:!1,label:"Update custom theme to current colors",optional:!0}],buttonText:"update",onlineOnly:!0,execFn:async(t,e,a)=>{var u;const s=S();if(!s)return{status:-1,message:"Failed to update custom theme: no snapshot"};const n=(u=s.customThemes)==null?void 0:u.find(c=>c._id===t.parameters[0]);if(n===void 0)return{status:-1,message:"Failed to update custom theme: theme not found"};let r=[];if(a==="true")for(const c of Ln)r.push(i(`.pageSettings .customTheme .customThemeEdit #${c}[type='color']`).attr("value"));else r=n.colors;const o={name:e.replaceAll(" ","_"),colors:r};return await GP(n._id,o)?(Fu(r),zo(),{status:1,message:"Custom theme updated"}):{status:-1,message:"Failed to update custom theme"}},beforeInitFn:t=>{var s;const e=S();if(!e)return;const a=(s=e.customThemes)==null?void 0:s.find(n=>n._id===t.parameters[0]);a&&(t.inputs[0].initVal=a.name)}});rt.deleteCustomTheme=new lt({id:"deleteCustomTheme",title:"Delete custom theme",text:"Are you sure?",buttonText:"delete",onlineOnly:!0,execFn:async t=>(await QP(t.parameters[0]),zo(),{status:1,message:"Custom theme deleted"})});rt.forgotPassword=new lt({id:"forgotPassword",title:"Forgot password",inputs:[{type:"text",placeholder:"email",initVal:""}],buttonText:"send",execFn:async(t,e)=>{const a=await Z.users.forgotPasswordEmail(e.trim());return a.status!==200?{status:-1,message:"Failed to send password reset email: "+a.message}:{status:1,message:a.message,notificationOptions:{duration:8}}},beforeInitFn:t=>{const e=i('.pageLogin .login input[name="current-email"]').val();e&&(t.inputs[0].initVal=e)}});rt.devGenerateData=new lt({id:"devGenerateData",title:"Generate data",showLabels:!0,inputs:[{type:"text",label:"username",placeholder:"username",oninput:t=>{const e=t.target,a=document.querySelector("#devGenerateData_1 + span");a.innerHTML=`if checked, user will be created with ${e.value}@example.com and password: password`}},{type:"checkbox",label:"create user",description:"if checked, user will be created with {username}@example.com and password: password",optional:!0},{type:"date",label:"first test",optional:!0},{type:"date",label:"last test",max:new Date,optional:!0},{type:"range",label:"min tests per day",initVal:0,min:0,max:200,step:10},{type:"range",label:"max tests per day",initVal:50,min:0,max:200,step:10}],buttonText:"generate (might take a while)",execFn:async(t,e,a,s,n,r,o)=>{const l={username:e,createUser:a==="true"};s!==void 0&&s.length>0&&(l.firstTestTimestamp=Date.parse(s)),n!==void 0&&n.length>0&&(l.lastTestTimestamp=Date.parse(n)),r!==void 0&&r.length>0&&(l.minTestsPerDay=Number.parseInt(r)),o!==void 0&&o.length>0&&(l.maxTestsPerDay=Number.parseInt(o));const u=await Z.dev.generateData(l);return{status:u.status===200?1:-1,message:u.message,hideOptions:{clearModalChain:!0}}}});function ft(t,e=[],a={}){const s=rt[t];if(s===void 0){h("Failed to show popup - popup is not defined",-1);return}if(s.onlineOnly&&!xt()){h("You are offline",0,{duration:2});return}s.show(e,a)}i(".pageLogin #forgotPasswordButton").on("click",()=>{ft("forgotPassword")});i(".pageSettings .section.discordIntegration #unlinkDiscordButton").on("click",()=>{ft("unlinkDiscord")});i(".pageSettings #removeGoogleAuth").on("click",()=>{ft("removeGoogleAuth")});i(".pageSettings #removeGithubAuth").on("click",()=>{ft("removeGithubAuth")});i(".pageSettings #removePasswordAuth").on("click",()=>{ft("removePasswordAuth")});i("#resetSettingsButton").on("click",()=>{ft("resetSettings")});i("#revokeAllTokens").on("click",()=>{ft("revokeAllTokens")});i(".pageSettings #resetPersonalBestsButton").on("click",()=>{ft("resetPersonalBests")});i(".pageSettings #updateAccountName").on("click",()=>{ft("updateName")});i("#bannerCenter").on("click",".banner .text .openNameChange",()=>{ft("updateName")});i(".pageSettings #addPasswordAuth").on("click",()=>{ft("addPasswordAuth")});i(".pageSettings #emailPasswordAuth").on("click",()=>{ft("updateEmail")});i(".pageSettings #passPasswordAuth").on("click",()=>{ft("updatePassword")});i(".pageSettings #deleteAccount").on("click",()=>{ft("deleteAccount")});i(".pageSettings #resetAccount").on("click",()=>{ft("resetAccount")});i(".pageSettings #optOutOfLeaderboardsButton").on("click",()=>{ft("optOutOfLeaderboards")});i(".pageSettings").on("click",".section.themes .customTheme .delButton",t=>{const a=i(t.currentTarget).parent(".customTheme.button").attr("customThemeId");ft("deleteCustomTheme",[a])});i(".pageSettings").on("click",".section.themes .customTheme .editButton",t=>{const a=i(t.currentTarget).parent(".customTheme.button").attr("customThemeId");ft("updateCustomTheme",[a],{focusFirstInput:"focusAndSelect"})});i(".pageSettings").on("click",".section[data-config-name='fontFamily'] button[data-config-value='custom']",()=>{ft("applyCustomFont")});async function M$(){const t=ky(),e=i("#savedTextsModal .list").empty();let a="";if(t.length===0)a+="<div>No saved custom texts found</div>";else for(const o of t)a+=`<div class="savedText" data-name="${Ba(o)}">
      <div class="button name">${Ba(o)}</div>
      <div class="button delete">
      <i class="fas fa-fw fa-trash"></i>
      </div>
      </div>`;e.html(a);const s=ky(!0),n=i("#savedTextsModal .listLong").empty();let r="";if(s.length===0)r+="<div>No saved long custom texts found</div>";else for(const o of s)r+=`<div class="savedLongText" data-name="${Ba(o)}">
      <div class="button name">${Ba(o)}</div>
      <div class="button ${Qv(o)<=0?"disabled":""} resetProgress">reset</div>
      <div class="button delete">
      <i class="fas fa-fw fa-trash"></i>
      </div>
      </div>`;n.html(r),i("#savedTextsModal .list .savedText .button.delete").on("click",o=>{const l=i(o.target).closest(".savedText").data("name");ft("deleteCustomText",[l],{modalChain:nd})}),i("#savedTextsModal .listLong .savedLongText .button.delete").on("click",o=>{const l=i(o.target).closest(".savedLongText").data("name");ft("deleteCustomTextLong",[l],{modalChain:nd})}),i("#savedTextsModal .listLong .savedLongText .button.resetProgress").on("click",o=>{const l=i(o.target).closest(".savedLongText").data("name");ft("resetProgressCustomTextLong",[l],{modalChain:nd})}),i("#savedTextsModal .list .savedText .button.name").on("click",o=>{const l=i(o.target).text();Mi(l,!1);const u=S0(l,!1);C0({modalChainData:{text:u,long:!1}})}),i("#savedTextsModal .listLong .savedLongText .button.name").on("click",o=>{const l=i(o.target).text();Mi(l,!0);const u=S0(l,!0);C0({modalChainData:{text:u,long:!0}})})}async function d4(t){nd.show({...t,beforeAnimation:async()=>{M$()}})}function C0(t){nd.hide({...t})}function S0(t,e){let a=im(t,e);return e&&(a=a.slice(Qv(t))),a.join(" ")}async function u4(){}const nd=new et({dialogId:"savedTextsModal",setup:u4,showOptionsWhenInChain:{beforeAnimation:async()=>{M$()}}});let Yt;const Em={textToSave:[]};async function c4(t){Em.textToSave=[],L$.show({...t,beforeAnimation:async(e,a)=>{Em.textToSave=(a==null?void 0:a.text)??[],i("#saveCustomTextModal .textName").val(""),i("#saveCustomTextModal .isLongText").prop("checked",!1),i("#saveCustomTextModal button.save").prop("disabled",!0)}})}function p4(){L$.hide()}function f4(){const t=i("#saveCustomTextModal .textName").val(),e=i("#saveCustomTextModal .isLongText").prop("checked");return t?Em.textToSave.length===0?(h("Custom text can't be empty",0),!1):(eW(t,Em.textToSave,e),Mi(t,e),h("Custom text saved",1),!0):(h("Custom text needs a name",0),!1)}function m4(){const t=i("#saveCustomTextModal .textName").val(),e=i("#saveCustomTextModal .isLongText").prop("checked");t?ky(e).includes(t)?(Yt==null||Yt.show("unavailable"),i("#saveCustomTextModal button.save").prop("disabled",!0)):(Yt==null||Yt.show("available"),i("#saveCustomTextModal button.save").prop("disabled",!1)):(Yt==null||Yt.hide(),i("#saveCustomTextModal button.save").addClass("disabled"))}const T0=Da(500,m4);async function h4(t){var e,a;Yt=new Wi(i("#saveCustomTextModal .textName"),{available:{icon:"fa-check",level:1},unavailable:{icon:"fa-times",level:-1},loading:{icon:"fa-circle-notch",spinIcon:!0,level:0}}),t.addEventListener("submit",s=>{s.preventDefault(),f4()&&p4()}),(e=t.querySelector(".textName"))==null||e.addEventListener("input",s=>{s.target.value.length>0&&(Yt==null||Yt.show("loading"),T0())}),(a=t.querySelector(".isLongText"))==null||a.addEventListener("input",s=>{s.target.value.length>0&&(Yt==null||Yt.show("loading"),T0())})}const L$=new et({dialogId:"saveCustomTextModal",setup:h4}),$e="#customTextModal .modal",M={textarea:Ym().join(Wc()?"|":" "),longCustomTextWarning:!1,challengeWarning:!1,customTextMode:"simple",customTextLimits:{word:"",time:"",section:""},removeFancyTypographyEnabled:!0,replaceControlCharactersEnabled:!0,customTextPipeDelimiter:!1,replaceNewlines:"off"};function Ua(){i(`${$e} .inputs .group[data-id="mode"] button`).removeClass("active"),i(`${$e} .inputs .group[data-id="mode"] button[value="${M.customTextMode}"]`).addClass("active"),i(`${$e} .inputs .group[data-id="limit"] input.words`).addClass("hidden"),i(`${$e} .inputs .group[data-id="limit"] input.sections`).addClass("hidden"),i(`${$e} .inputs .group[data-id="limit"] input.words`).val(M.customTextLimits.word),i(`${$e} .inputs .group[data-id="limit"] input.time`).val(M.customTextLimits.time),i(`${$e} .inputs .group[data-id="limit"] input.sections`).val(M.customTextLimits.section),M.customTextLimits.word!==""&&i(`${$e} .inputs .group[data-id="limit"] input.words`).removeClass("hidden"),M.customTextLimits.section!==""&&i(`${$e} .inputs .group[data-id="limit"] input.sections`).removeClass("hidden"),M.customTextPipeDelimiter?(i(`${$e} .inputs .group[data-id="limit"] input.sections`).removeClass("hidden"),i(`${$e} .inputs .group[data-id="limit"] input.words`).addClass("hidden")):(i(`${$e} .inputs .group[data-id="limit"] input.words`).removeClass("hidden"),i(`${$e} .inputs .group[data-id="limit"] input.sections`).addClass("hidden")),M.customTextMode==="simple"?(i(`${$e} .inputs .group[data-id="limit"]`).addClass("disabled"),i(`${$e} .inputs .group[data-id="limit"] input`).val(""),i(`${$e} .inputs .group[data-id="limit"] input`).prop("disabled",!0)):(i(`${$e} .inputs .group[data-id="limit"]`).removeClass("disabled"),i(`${$e} .inputs .group[data-id="limit"] input`).prop("disabled",!1)),i(`${$e} .inputs .group[data-id="fancy"] button`).removeClass("active"),i(`${$e} .inputs .group[data-id="fancy"] button[value="${M.removeFancyTypographyEnabled}"]`).addClass("active"),i(`${$e} .inputs .group[data-id="control"] button`).removeClass("active"),i(`${$e} .inputs .group[data-id="control"] button[value="${M.replaceControlCharactersEnabled}"]`).addClass("active"),i(`${$e} .inputs .group[data-id="delimiter"] button`).removeClass("active"),i(`${$e} .inputs .group[data-id="delimiter"] button[value="${M.customTextPipeDelimiter}"]`).addClass("active"),i(`${$e} .inputs .group[data-id="newlines"] button`).removeClass("active"),i(`${$e} .inputs .group[data-id="newlines"] button[value="${M.replaceNewlines}"]`).addClass("active"),i(`${$e} textarea`).val(M.textarea),M.longCustomTextWarning?(i(`${$e} .longCustomTextWarning`).removeClass("hidden"),i(`${$e} .randomWordsCheckbox input`).prop("checked",!1),i(`${$e} .delimiterCheck input`).prop("checked",!1),i(`${$e} .typographyCheck`).prop("checked",!0),i(`${$e} .replaceNewlineWithSpace input`).prop("checked",!1),i(`${$e} .inputs`).addClass("disabled")):(i(`${$e} .longCustomTextWarning`).addClass("hidden"),i(`${$e} .inputs`).removeClass("disabled")),M.challengeWarning?(i(`${$e} .challengeWarning`).removeClass("hidden"),i(`${$e} .randomWordsCheckbox input`).prop("checked",!1),i(`${$e} .delimiterCheck input`).prop("checked",!1),i(`${$e} .typographyCheck`).prop("checked",!0),i(`${$e} .replaceNewlineWithSpace input`).prop("checked",!1),i(`${$e} .inputs`).addClass("disabled")):(i(`${$e} .challengeWarning`).addClass("hidden"),i(`${$e} .inputs`).removeClass("disabled"))}async function E$(t,e){if(M.customTextMode=Vp(),M.customTextMode==="repeat"&&St()==="word"&&gt()===Ym().length&&(M.customTextMode="simple"),M.customTextLimits.word="",M.customTextLimits.time="",M.customTextLimits.section="",St()==="word"?M.customTextLimits.word=`${gt()}`:St()==="time"?M.customTextLimits.time=`${gt()}`:St()==="section"&&(M.customTextLimits.section=`${gt()}`),M.customTextPipeDelimiter=Wc(),M.longCustomTextWarning=Mn()??!1,(e==null?void 0:e.text)!==void 0){e.long!==!0&&Mn()&&(Mi("",void 0),h("Disabled long custom text progress tracking",0,{duration:5}),M.longCustomTextWarning=!1);const a=e.set??!0?e.text:M.textarea+" "+e.text;M.textarea=a,M.customTextMode="simple",M.customTextLimits.word=`${Im().length}`,M.customTextLimits.time="",M.customTextLimits.section=""}Ua()}async function I$(){!M.challengeWarning&&!M.longCustomTextWarning&&i(`${$e} textarea`).trigger("focus")}function O$(t){M.textarea=Ym().join(Wc()?"|":" "),id.show({...t,beforeAnimation:E$,afterAnimation:I$})}function Qy(){id.hide()}function g4(){var e;const t=(e=i("#fileInput")[0].files)==null?void 0:e[0];if(t){if(t.type!=="text/plain"){h("File is not a text file",-1,{duration:5});return}const a=new FileReader;a.readAsText(t,"UTF-8"),a.onload=s=>{var r;const n=(r=s.target)==null?void 0:r.result;M.textarea=n,Ua(),i("#fileInput").val("")},a.onerror=()=>{h("Failed to read file",-1,{duration:5})}}}function Im(){let t=M.textarea;return t===""?[]:(t=t.normalize().trim(),t=t.replace(/[\u2000-\u200A\u202F\u205F\u00A0]/g," "),t=t.replace(/[\u200B-\u200D\u2060\uFEFF]/g,""),M.replaceControlCharactersEnabled&&(t=t.replace(/([^\\]|^)\\t/gm,"$1	"),t=t.replace(/\\n/g,` 
`),t=t.replace(/([^\\]|^)\\n/gm,`$1
`),t=t.replace(/\\\\t/gm,"\\t"),t=t.replace(/\\\\n/gm,"\\n")),t=t.replace(/ +/gm," "),t=t.replace(/( *(\r\n|\r|\n) *)/g,`
 `),M.removeFancyTypographyEnabled&&(t=Gx(t)),M.replaceNewlines!=="off"&&(M.replaceNewlines==="periodSpace"?(t=t.replace(/\n/gm,". "),t=t.replace(/\.\. /gm,". "),t=t.replace(/ +/gm," ")):(t=t.replace(/\n/gm," "),t=t.replace(/ +/gm," "))),t.split(M.customTextPipeDelimiter?"|":" ").filter(a=>a!==""))}function y4(){if(M.textarea===""){h("Text cannot be empty",0);return}if([M.customTextLimits.word,M.customTextLimits.time,M.customTextLimits.section].filter(e=>e!=="").length>1){h("You can only specify one limit",0,{duration:5});return}if(M.customTextMode!=="simple"&&M.customTextLimits.word===""&&M.customTextLimits.time===""&&M.customTextLimits.section===""){h("You need to specify a limit",0,{duration:5});return}(M.customTextLimits.section==="0"||M.customTextLimits.word==="0"||M.customTextLimits.time==="0")&&h("Infinite test! Make sure to use Bail Out from the command line to save your result.",0,{duration:7});const t=Im();M.customTextMode==="simple"?(Uu("repeat"),M.customTextLimits.word=`${t.length}`,M.customTextLimits.time="",M.customTextLimits.section=""):Uu(M.customTextMode),Wo(M.customTextPipeDelimiter),Tn(t),M.customTextLimits.word!==""?(ci("word"),ir(parseInt(M.customTextLimits.word))):M.customTextLimits.time!==""?(ci("time"),ir(parseInt(M.customTextLimits.time))):M.customTextLimits.section!==""&&(ci("section"),ir(parseInt(M.customTextLimits.section))),iT(),tt(),d.mode!=="custom"&&zt("custom"),He(),Qy()}function v4(){let t=M.textarea.split(M.customTextPipeDelimiter?" ":"|").join(M.customTextPipeDelimiter?"|":" ");t=t.replace(/\n /g,`
`),M.textarea=t}async function b4(t){var s,n,r,o,l,u,c,p,f,m;(s=t.querySelector("#fileInput"))==null||s.addEventListener("change",g4);const e=t.querySelectorAll(".group[data-id='mode'] button");for(const g of e)g.addEventListener("click",y=>{if(M.customTextMode=y.target.value,M.customTextMode==="simple"){const v=Im();M.customTextLimits.word=`${v.length}`,M.customTextLimits.time="",M.customTextLimits.section=""}Ua()});for(const g of t.querySelectorAll(".group[data-id='fancy'] button"))g.addEventListener("click",y=>{M.removeFancyTypographyEnabled=y.target.value==="true",Ua()});for(const g of t.querySelectorAll(".group[data-id='control'] button"))g.addEventListener("click",y=>{M.replaceControlCharactersEnabled=y.target.value==="true",Ua()});for(const g of t.querySelectorAll(".group[data-id='delimiter'] button"))g.addEventListener("click",y=>{M.customTextPipeDelimiter=y.target.value==="true",M.customTextPipeDelimiter&&M.customTextLimits.word!==""&&(M.customTextLimits.word=""),!M.customTextPipeDelimiter&&M.customTextLimits.section!==""&&(M.customTextLimits.section=""),v4(),Ua()});for(const g of t.querySelectorAll(".group[data-id='newlines'] button"))g.addEventListener("click",y=>{M.replaceNewlines=y.target.value,Ua()});(n=t.querySelector(".group[data-id='limit'] input.words"))==null||n.addEventListener("input",g=>{M.customTextLimits.word=g.target.value,M.customTextLimits.time="",M.customTextLimits.section="",Ua()}),(r=t.querySelector(".group[data-id='limit'] input.time"))==null||r.addEventListener("input",g=>{M.customTextLimits.time=g.target.value,M.customTextLimits.word="",M.customTextLimits.section="",Ua()}),(o=t.querySelector(".group[data-id='limit'] input.sections"))==null||o.addEventListener("input",g=>{M.customTextLimits.section=g.target.value,M.customTextLimits.word="",M.customTextLimits.time="",Ua()});const a=t.querySelector("textarea");a==null||a.addEventListener("input",g=>{M.textarea=g.target.value}),a==null||a.addEventListener("keydown",g=>{if(g.key!=="Tab")return;g.preventDefault();const y=g.target,v=y.selectionStart,A=y.selectionEnd;y.value=y.value.substring(0,v)+"	"+y.value.substring(A),y.selectionStart=y.selectionEnd=v+1,M.textarea=y.value}),a==null||a.addEventListener("keypress",g=>{if(M.longCustomTextWarning||M.challengeWarning){g.preventDefault();return}g.code==="Enter"&&g.ctrlKey&&i(`${$e} .button.apply`).trigger("click"),Mn()&&db()!==""&&(Mi("",void 0),M.longCustomTextWarning=!1,h("Disabled long custom text progress tracking",0,{duration:5}))}),(l=t.querySelector(".button.apply"))==null||l.addEventListener("click",()=>{y4()}),(u=t.querySelector(".button.wordfilter"))==null||u.addEventListener("click",()=>{Uj({modalChain:id})}),(c=t.querySelector(".button.showSavedTexts"))==null||c.addEventListener("click",()=>{d4({modalChain:id})}),(p=t.querySelector(".button.saveCustomText"))==null||p.addEventListener("click",()=>{c4({modalChain:id,modalChainData:{text:Im()}})}),(f=t.querySelector(".longCustomTextWarning"))==null||f.addEventListener("click",()=>{M.longCustomTextWarning=!1,Ua()}),(m=t.querySelector(".challengeWarning"))==null||m.addEventListener("click",()=>{M.challengeWarning=!1,Ua()})}const id=new et({dialogId:"customTextModal",setup:b4,customEscapeHandler:async()=>{Qy()},customWrapperClickHandler:async()=>{Qy()},showOptionsWhenInChain:{beforeAnimation:E$,afterAnimation:I$}});function P$(){const t=i("#mobileTestConfigModal");if(t.find("button").removeClass("active"),t.find(`.modeGroup button[data-mode='${d.mode}']`).addClass("active"),t.find(".timeGroup").addClass("hidden"),t.find(".wordsGroup").addClass("hidden"),t.find(".quoteGroup").addClass("hidden"),t.find(".customGroup").addClass("hidden"),t.find(`.${d.mode}Group`).removeClass("hidden"),d.punctuation?t.find(".punctuation").addClass("active"):t.find(".punctuation").removeClass("active"),d.numbers?t.find(".numbers").addClass("active"):t.find(".numbers").removeClass("active"),d.mode==="time")t.find(`.timeGroup button[data-time='${d.time}']`).addClass("active"),t.find(".punctuation").removeClass("disabled"),t.find(".numbers").removeClass("disabled");else if(d.mode==="words")t.find(`.wordsGroup button[data-words='${d.words}']`).addClass("active"),t.find(".punctuation").removeClass("disabled"),t.find(".numbers").removeClass("disabled");else if(d.mode==="quote"){for(const e of d.quoteLength)t.find(`.quoteGroup button[data-quoteLength='${e}']`).addClass("active");t.find(".punctuation").addClass("disabled"),t.find(".numbers").addClass("disabled")}else d.mode==="zen"?(t.find(".punctuation").addClass("disabled"),t.find(".numbers").addClass("disabled")):d.mode==="custom"&&(t.find(".punctuation").removeClass("disabled"),t.find(".numbers").removeClass("disabled"))}function w4(){Vl.show({beforeAnimation:async()=>{P$()}})}async function k4(t){var o,l,u;const e=t.querySelectorAll(".wordsGroup button");for(const c of e)c.addEventListener("click",p=>{const m=p.currentTarget.getAttribute("data-words");if(m==="custom")IT({modalChain:Vl});else if(m!==void 0){const g=parseInt(m);Ti(g),tt(),He()}});const a=t.querySelectorAll(".modeGroup button");for(const c of a)c.addEventListener("click",p=>{const m=p.currentTarget.getAttribute("data-mode");m!==d.mode&&(zt(m),tt(),He())});const s=t.querySelectorAll(".timeGroup button");for(const c of s)c.addEventListener("click",p=>{const m=p.currentTarget.getAttribute("data-time");if(m==="custom")VT({modalChain:Vl});else if(m!==void 0){const g=parseInt(m);Ws(g),tt(),He()}});const n=t.querySelectorAll(".quoteGroup button");for(const c of n)c.addEventListener("click",p=>{const f=p.currentTarget,m=parseInt(f.getAttribute("data-quoteLength")??"0",10);if(m===-2)e$({modalChain:Vl});else{let g=m;m===-1&&(g=[0,1,2,3]),mn(g,!1,p.shiftKey),tt(),He()}});(o=t.querySelector(".customChange"))==null||o.addEventListener("click",()=>{O$({modalChain:Vl})}),(l=t.querySelector(".punctuation"))==null||l.addEventListener("click",()=>{tn(!d.punctuation),tt(),He()}),(u=t.querySelector(".numbers"))==null||u.addEventListener("click",()=>{os(!d.numbers),tt(),He()});const r=t.querySelectorAll("button");for(const c of r)c.addEventListener("click",()=>{P$()})}const Vl=new et({dialogId:"mobileTestConfigModal",setup:k4}),li={missed:"words",slow:!1},jr="#practiseWordsModal .modal";function cg(){i(`${jr} .group[data-id="missed"] button`).removeClass("active"),i(`${jr} .group[data-id="missed"] button[value="${li.missed}"]`).addClass("active"),i(`${jr} .group[data-id="slow"] button`).removeClass("active"),i(`${jr} .group[data-id="slow"] button[value="${li.slow}"]`).addClass("active"),li.missed==="off"&&!li.slow?i(`${jr} .start`).prop("disabled",!0):i(`${jr} .start`).prop("disabled",!1)}async function x4(t){var e;for(const a of t.querySelectorAll(".group[data-id='missed'] button"))a.addEventListener("click",s=>{li.missed=s.target.value,cg()});for(const a of t.querySelectorAll(".group[data-id='slow'] button"))a.addEventListener("click",s=>{li.slow=s.target.value==="true",cg()});(e=t.querySelector(".start"))==null||e.addEventListener("click",()=>{$0()}),t.addEventListener("submit",a=>{a.preventDefault(),$0()}),cg()}function _4(t){R$.show(t)}function C4(t=!1){R$.hide({clearModalChain:t})}function $0(){oB(li.missed,li.slow),C4(!0),He({practiseMissed:!0})}const R$=new et({dialogId:"practiseWordsModal",setup:x4});i(".pageTest").on("click","#testModesNotice .textButton",async t=>{const e=i(t.currentTarget).attr("commands");e!==void 0&&(await Jo()).show({subgroupOverride:e})});i(".pageTest").on("click","#testConfig .wordCount .textButton",t=>{i(t.currentTarget).attr("wordCount")==="custom"&&IT()});i(".pageTest").on("click","#testConfig .time .textButton",t=>{i(t.currentTarget).attr("timeconfig")==="custom"&&VT()});i(".pageTest").on("click",".tags .editTagsButton",()=>{var t,e;if((((e=(t=S())==null?void 0:t.tags)==null?void 0:e.length)??0)>0){const a=i(".pageTest .tags .editTagsButton").attr("data-result-id"),s=i(".pageTest .tags .editTagsButton").attr("data-active-tag-ids"),n=s===""?[]:s.split(",");jT(a,n,"resultPage")}});i(".pageTest").on("click","#mobileTestConfigButton",()=>{w4()});i(".pageTest #rateQuoteButton").on("click",async()=>{if(ze===null){h("Failed to show quote rating popup: no quote",-1);return}JZ(ze)});i(".pageTest #reportQuoteButton").on("click",async()=>{if(ze===null){h("Failed to show quote report popup: no quote",-1);return}JT(ze==null?void 0:ze.id)});i(".pageTest").on("click","#testConfig .quoteLength .textButton",t=>{parseInt(i(t.currentTarget).attr("quoteLength")??"0")===-2&&e$()});i(".pageTest").on("click","#testConfig .customText .textButton",()=>{O$()});i(".pageTest").on("click","#practiseWordsButton",()=>{if(d.mode==="zen"){h("Practice words is unsupported in zen mode",0);return}_4()});var F0;(F0=document.querySelector("#pageAbout #supportMeAboutButton"))==null||F0.addEventListener("click",()=>{PS()});var j0;(j0=document.querySelector("#pageAbout #contactPopupButton2"))==null||j0.addEventListener("click",()=>{DS()});const Jb={includeBackground:!1};function S4(){Yy.show({beforeAnimation:async t=>{t.querySelector("input[type='checkbox']").checked=!1,Jb.includeBackground=!1}})}async function T4(){const t={c:Ln.map(e=>i(`.pageSettings .customTheme .customThemeEdit #${e}[type='color']`).attr("value"))};return Jb.includeBackground&&(t.i=d.customBackground,t.s=d.customBackgroundSize,t.f=d.customBackgroundFilter),window.location.origin+"?customTheme="+btoa(JSON.stringify(t))}async function $4(){const t=await T4();try{await navigator.clipboard.writeText(t),h("URL Copied to clipboard",1),Yy.hide()}catch{h("Looks like we couldn't copy the link straight to your clipboard. Please copy it manually.",0,{duration:5}),Jy.show({modalChain:Yy,focusFirstInput:"focusAndSelect",beforeAnimation:async a=>{a.querySelector("input").value=t}})}}const Yy=new et({dialogId:"shareCustomThemeModal",setup:async t=>{var e,a;(e=t.querySelector("button"))==null||e.addEventListener("click",$4),(a=t.querySelector("input[type='checkbox']"))==null||a.addEventListener("change",s=>{Jb.includeBackground=s.target.checked})}}),Jy=new et({dialogId:"shareCustomThemeUrlModal",customEscapeHandler:async()=>{await Jy.hide({clearModalChain:!0})},customWrapperClickHandler:async()=>{await Jy.hide({clearModalChain:!0})}});function A4(){const t=localStorage.getItem("acceptedCookies")??"";return t?JSON.parse(t):null}function pg(t){localStorage.setItem("acceptedCookies",JSON.stringify(t))}function M4(){A4()===null&&D$()}function D$(t){mc.show({beforeAnimation:async()=>{t&&N$()},afterAnimation:async()=>{da("cookiesModal")||mc.destroy()}})}function N$(){var t,e;(t=mc.getModal().querySelector(".main"))==null||t.classList.add("hidden"),(e=mc.getModal().querySelector(".settings"))==null||e.classList.remove("hidden")}async function fg(){mc.hide({afterAnimation:async()=>{nh()}})}const mc=new et({dialogId:"cookiesModal",customEscapeHandler:()=>{},customWrapperClickHandler:()=>{},setup:async t=>{var e,a,s,n,r;(e=t.querySelector(".acceptAll"))==null||e.addEventListener("click",()=>{pg({security:!0,analytics:!0}),Gg(),fg()}),(a=t.querySelector(".rejectAll"))==null||a.addEventListener("click",()=>{pg({security:!0,analytics:!1}),fg()}),(s=t.querySelector(".openSettings"))==null||s.addEventListener("click",()=>{N$()}),(n=t.querySelector(".cookie.ads .textButton"))==null||n.addEventListener("click",()=>{try{gq()}catch{console.error("Failed to open ad consent UI"),h("Failed to open Ad consent popup. Do you have an ad or cookie popup blocker enabled?",-1)}}),(r=t.querySelector(".acceptSelected"))==null||r.addEventListener("click",()=>{const o=t.querySelector(".cookie.analytics input").checked;pg({security:!0,analytics:o}),fg(),o&&Gg()})}});function L4(){if(!xt()){h("You are offline",0,{duration:2});return}hc.show({focusFirstInput:!0,beforeAnimation:async t=>{var e,a,s,n;((e=S())==null?void 0:e.streakHourOffset)!==void 0?((a=t.querySelector("input"))==null||a.remove(),(s=t.querySelector(".preview"))==null||s.remove(),(n=t.querySelector("button"))==null||n.remove(),t.querySelector(".text").textContent="You have already set your streak hour offset."):(t.querySelector("input").value="0",W$())}})}function W$(){var n;const t=parseInt((n=hc.getModal().querySelector("input"))==null?void 0:n.value,10),e=hc.getModal().querySelector(".preview"),a=new Date;a.setUTCHours(0),a.setUTCMinutes(0),a.setUTCSeconds(0),a.setUTCMilliseconds(0);const s=new Date;s.setUTCHours(0),s.setUTCMinutes(0),s.setUTCSeconds(0),s.setUTCMilliseconds(0),s.setHours(s.getHours()- -1*t),e.innerHTML=`
    <div class="row"><div>Current local reset time:</div><div>${a.toLocaleTimeString()}</div></div>
    <div class="row"><div>New local reset time:</div><div>${s.toLocaleTimeString()}</div></div>
  `}function E4(){hc.hide()}async function I4(){var a;const t=parseInt((a=hc.getModal().querySelector("input"))==null?void 0:a.value,10);if(isNaN(t)){h("Streak hour offset must be a number",0);return}if(t<-11||t>12){h("Streak hour offset must be between -11 and 12",0);return}Je();const e=await Z.users.setStreakHourOffset(t);if(Te(),e.status!==200)h("Failed to set streak hour offset: "+e.message,-1);else{h("Streak hour offset set",1);const s=S();s.streakHourOffset=t,aa(s),E4()}}const hc=new et({dialogId:"streakHourOffsetModal",setup:async t=>{var e,a;(e=t.querySelector("input"))==null||e.addEventListener("input",()=>{W$()}),(a=t.querySelector("button"))==null||a.addEventListener("click",()=>{I4()})}});function mg(t,e,a){if(!xt()){h("You are offline",0,{duration:2});return}B$.show({focusFirstInput:!0,beforeAnimation:async()=>{i("#editPresetModal .modal .text").addClass("hidden"),t==="add"?(i("#editPresetModal .modal").attr("data-action","add"),i("#editPresetModal .modal .title").html("Add new preset"),i("#editPresetModal .modal button").html("add"),i("#editPresetModal .modal input").val(""),i("#editPresetModal .modal input").removeClass("hidden"),i("#editPresetModal .modal label").addClass("hidden")):t==="edit"&&e!==void 0&&a!==void 0?(i("#editPresetModal .modal").attr("data-action","edit"),i("#editPresetModal .modal").attr("data-preset-id",e),i("#editPresetModal .modal .title").html("Edit preset"),i("#editPresetModal .modal button").html("save"),i("#editPresetModal .modal input").val(a),i("#editPresetModal .modal input").removeClass("hidden"),i("#editPresetModal .modal label input").prop("checked",!1),i("#editPresetModal .modal label").removeClass("hidden")):t==="remove"&&e!==void 0&&a!==void 0&&(i("#editPresetModal .modal").attr("data-action","remove"),i("#editPresetModal .modal").attr("data-preset-id",e),i("#editPresetModal .modal .title").html("Delete preset"),i("#editPresetModal .modal button").html("delete"),i("#editPresetModal .modal input").addClass("hidden"),i("#editPresetModal .modal label").addClass("hidden"),i("#editPresetModal .modal .text").removeClass("hidden"),i("#editPresetModal .modal .text").text(`Are you sure you want to delete the preset ${a}?`))}})}function O4(){B$.hide()}async function P4(){var l,u;const t=i("#editPresetModal .modal").attr("data-action"),e=i("#editPresetModal .modal input").val(),a=e.replaceAll(" ","_"),s=i("#editPresetModal .modal").attr("data-preset-id"),n=i("#editPresetModal .modal label input").prop("checked");let r={};if(n&&t==="edit"||t==="add"){r=WN();const p=(((l=S())==null?void 0:l.tags)??[]).filter(f=>f.active).map(f=>f._id);r.tags=p}const o=((u=S())==null?void 0:u.presets)??[];if(O4(),Je(),t==="add"){const c=await Z.presets.add({body:{name:a,config:r}});c.status!==200||c.body.data===null?h("Failed to add preset: "+c.body.message.replace(a,e),-1):(h("Preset added",1,{duration:2}),o.push({name:a,config:r,display:e,_id:c.body.data.presetId}))}else if(t==="edit"){const c=await Z.presets.save({body:{_id:s,name:a,config:r}});if(c.status!==200)h("Failed to edit preset: "+c.body.message,-1);else{h("Preset updated",1);const p=o.filter(f=>f._id===s)[0];p.name=a,p.display=a.replace(/_/g," "),n&&(p.config=r)}}else if(t==="remove"){const c=await Z.presets.delete({params:{presetId:s}});c.status!==200?h("Failed to remove preset: "+c.body.message,-1):(h("Preset removed",1),o.forEach((p,f)=>{p._id===s&&o.splice(f,1)}))}ii(),Te()}const B$=new et({dialogId:"editPresetModal",setup:async t=>{t.addEventListener("submit",e=>{e.preventDefault(),P4()})}});function Ap(t,e,a,s){if(!xt()){h("You are offline",0,{duration:2});return}Z$.show({focusFirstInput:!0,modalChain:s,beforeAnimation:async()=>{i("#editTagModal .modal .text").addClass("hidden"),t==="add"?(i("#editTagModal .modal").attr("data-action","add"),i("#editTagModal .modal .title").html("Add new tag"),i("#editTagModal .modal button").html("add"),i("#editTagModal .modal input").val(""),i("#editTagModal .modal input").removeClass("hidden")):t==="edit"&&e!==void 0&&a!==void 0?(i("#editTagModal .modal").attr("data-action","edit"),i("#editTagModal .modal").attr("data-tag-id",e),i("#editTagModal .modal .title").html("Edit tag"),i("#editTagModal .modal button").html("save"),i("#editTagModal .modal input").val(a),i("#editTagModal .modal input").removeClass("hidden")):t==="remove"&&e!==void 0&&a!==void 0?(i("#editTagModal .modal").attr("data-action","remove"),i("#editTagModal .modal").attr("data-tag-id",e),i("#editTagModal .modal .title").html("Delete tag"),i("#editTagModal .modal .text").removeClass("hidden"),i("#editTagModal .modal .text").html(`Are you sure you want to delete tag ${a}?`),i("#editTagModal .modal button").html("delete"),i("#editTagModal .modal input").addClass("hidden")):t==="clearPb"&&e!==void 0&&a!==void 0&&(i("#editTagModal .modal").attr("data-action","clearPb"),i("#editTagModal .modal").attr("data-tag-id",e),i("#editTagModal .modal .title").html("Clear personal bests"),i("#editTagModal .modal .text").removeClass("hidden"),i("#editTagModal .modal .text").html(`Are you sure you want to clear personal bests for tag ${a}?`),i("#editTagModal .modal button").html("clear"),i("#editTagModal .modal input").addClass("hidden"))}})}function R4(t=!1){Z$.hide({clearModalChain:t})}async function D4(){var n,r,o,l,u,c,p,f;const t=i("#editTagModal .modal").attr("data-action"),e=i("#editTagModal .modal input").val(),a=e.replaceAll(" ","_"),s=i("#editTagModal .modal").attr("data-tag-id");if(R4(!0),Je(),t==="add"){const m=await Z.users.createTag(a);if(m.status!==200)h("Failed to add tag: "+m.message.replace(a,e),-1);else{if(m.data===null){h("Tag was added but data returned was null",-1),Te();return}h("Tag added",1),(r=(n=S())==null?void 0:n.tags)==null||r.push({display:e,name:m.data.name,_id:m.data._id,personalBests:{time:{},words:{},quote:{},zen:{},custom:{}}}),ii()}}else if(t==="edit"){const m=await Z.users.editTag(s,a);m.status!==200?h("Failed to edit tag: "+m.message,-1):(h("Tag updated",1),(l=(o=S())==null?void 0:o.tags)==null||l.forEach(g=>{g._id===s&&(g.name=a,g.display=e)}),ii())}else if(t==="remove"){const m=await Z.users.deleteTag(s);m.status!==200?h("Failed to remove tag: "+m.message,-1):(h("Tag removed",1),(c=(u=S())==null?void 0:u.tags)==null||c.forEach((g,y)=>{var v,A;g._id===s&&((A=(v=S())==null?void 0:v.tags)==null||A.splice(y,1))}),ii())}else if(t==="clearPb"){const m=await Z.users.deleteTagPersonalBest(s);m.status!==200?h("Failed to clear tag pb: "+m.message,-1):(h("Tag PB cleared",1),(f=(p=S())==null?void 0:p.tags)==null||f.forEach(g=>{g._id===s&&(g.personalBests={time:{},words:{},quote:{},zen:{},custom:{}})}),ii())}Te()}const Z$=new et({dialogId:"editTagModal",setup:async t=>{t.addEventListener("submit",e=>{e.preventDefault(),D4()})}});let ao={};async function N4(){Je();const t=await Z.apeKeys.get();if(Te(),t.status!==200){h("Error getting ape keys: "+t.body.message,-1);return}ao=t.body.data}function q$(){var s,n,r;const t=ao;if(t==null)return;const e=i("#apeKeysModal table tbody");e.empty();const a=Object.keys(t);if(a.length===0){e.append("<tr><td colspan='6' style='text-align: center;'>No keys found</td></tr>");return}a.forEach(o=>{const l=t[o];e.append(`
      <tr keyId="${o}">
        <td>
          <button class="textButton toggleActive">
            ${l.enabled?'<i class="fas fa-fw fa-check-square"></i>':'<i class="far fa-fw fa-square"></i>'}
          </button>
        </td>
        <td>${l.name}</td>
        <td>${nt(new Date(l.createdOn),"dd MMM yyyy HH:mm")}</td>
        <td>${nt(new Date(l.modifiedOn),"dd MMM yyyy HH:mm")}</td>
        <td>${l.lastUsedOn===-1?"-":nt(new Date(l.lastUsedOn),"dd MMM yyyy HH:mm")}</td>
        <td>
          <div class="keyButtons">
            <button class="editButton">
              <i class="fas fa-fw fa-pen"></i>
            </button>
            <button class="deleteButton">
              <i class="fas fa-fw fa-trash-alt"></i>
            </button>
          </div>
        </td>
      </tr>
    `)});for(const o of e.find("tr")){const l=o.getAttribute("keyid");(s=o.querySelector("button.deleteButton"))==null||s.addEventListener("click",u=>{ft("deleteApeKey",[l],{modalChain:Om})}),(n=o.querySelector("button.editButton"))==null||n.addEventListener("click",u=>{ft("editApeKey",[l],{modalChain:Om})}),(r=o.querySelector("button.toggleActive"))==null||r.addEventListener("click",u=>{B4(l)})}}async function W4(t){if(!xt()){h("You are offline",0,{duration:2});return}Om.show({...t,beforeAnimation:async()=>{await N4(),q$()}})}async function B4(t){const e=ao==null?void 0:ao[t];if(!e||ao===void 0)return;Je();const a=await Z.apeKeys.save({params:{apeKeyId:t},body:{enabled:!e.enabled}});if(Te(),a.status!==200){h("Failed to update key: "+a.body.message,-1);return}e.enabled=!e.enabled,q$(),e.enabled?h("Key active",1):h("Key inactive",1)}async function Z4(t){var e;(e=t.querySelector(".generateApeKey"))==null||e.addEventListener("click",async()=>{ft("generateApeKey",[],{modalChain:Om})})}const Om=new et({dialogId:"apeKeysModal",setup:Z4}),Zt=document.querySelector("#pageSettings");var H0;(H0=Zt==null?void 0:Zt.querySelector("#shareCustomThemeButton"))==null||H0.addEventListener("click",()=>{S4()});var z0;(z0=Zt==null?void 0:Zt.querySelector(".section.updateCookiePreferences button"))==null||z0.addEventListener("click",()=>{D$(!0)});var K0;(K0=Zt==null?void 0:Zt.querySelector("#setStreakHourOffset"))==null||K0.addEventListener("click",()=>{L4()});var V0;(V0=Zt==null?void 0:Zt.querySelector(".section.presets"))==null||V0.addEventListener("click",t=>{var a,s,n,r;const e=t.target;if(e.classList.contains("addPresetButton"))mg("add");else if(e.classList.contains("editButton")){const o=(a=e.parentElement)==null?void 0:a.getAttribute("data-id"),l=(s=e.parentElement)==null?void 0:s.getAttribute("data-display");if(o===void 0||l===void 0||o===""||l===""||o===null||l===null){h("Failed to edit preset: Could not find preset id or name",-1);return}mg("edit",o,l)}else if(e.classList.contains("removeButton")){const o=(n=e.parentElement)==null?void 0:n.getAttribute("data-id"),l=(r=e.parentElement)==null?void 0:r.getAttribute("data-display");if(o===void 0||l===void 0||o===""||l===""||o===null||l===null){h("Failed to remove preset: Could not find preset id or name",-1);return}mg("remove",o,l)}});var U0;(U0=Zt==null?void 0:Zt.querySelector(".section.tags"))==null||U0.addEventListener("click",t=>{var a,s,n,r,o,l;const e=t.target;if(e.classList.contains("addTagButton"))Ap("add");else if(e.classList.contains("editButton")){const u=(a=e.parentElement)==null?void 0:a.getAttribute("data-id"),c=(s=e.parentElement)==null?void 0:s.getAttribute("data-display");if(u===void 0||c===void 0||u===""||c===""||u===null||c===null){h("Failed to edit tag: Could not find tag id or name",-1);return}Ap("edit",u,c)}else if(e.classList.contains("clearPbButton")){const u=(n=e.parentElement)==null?void 0:n.getAttribute("data-id"),c=(r=e.parentElement)==null?void 0:r.getAttribute("data-display");if(u===void 0||c===void 0||u===""||c===""||u===null||c===null){h("Failed to clear tag PB: Could not find tag id or name",-1);return}Ap("clearPb",u,c)}else if(e.classList.contains("removeButton")){const u=(o=e.parentElement)==null?void 0:o.getAttribute("data-id"),c=(l=e.parentElement)==null?void 0:l.getAttribute("data-display");if(u===void 0||c===void 0||u===""||c===""||u===null||c===null){h("Failed to remove tag: Could not find tag id or name",-1);return}Ap("remove",u,c)}});var G0;(G0=Zt==null?void 0:Zt.querySelector(".section.apeKeys #showApeKeysPopup"))==null||G0.addEventListener("click",()=>{W4()});function q4(t){var o;const e=j$.getModal();e.querySelector("table tbody").innerHTML="",e.querySelector("table thead tr td").textContent=t,e.querySelector("table thead tr td span.unit").textContent=d.typingSpeedUnit;const a=S();if(!a)return;const s=(o=a.personalBests)==null?void 0:o[t];if(s===void 0)return;const n=[];Object.keys(s).forEach(function(l){let u=s[l]??[];u=u.sort(function(c,p){return p.wpm-c.wpm}),u.forEach(function(c){c.mode2=l,n.push(c)})});let r;n.forEach(l=>{var p;let u='-<br><span class="sub">-</span>';const c=new Date(l.timestamp);l.timestamp&&(u=nt(c,"dd MMM yyyy")+"<br><div class='sub'>"+nt(c,"HH:mm")+"</div>"),(p=e.querySelector("table tbody"))==null||p.insertAdjacentHTML("beforeend",`
      <tr>
        <td>${r===l.mode2?"":l.mode2}</td>
        <td>
          ${ue.typingSpeed(l.wpm)}
          <br />
          <span class="sub">${ue.accuracy(l.acc)}</span>
        </td>
        <td>
          ${ue.typingSpeed(l.raw)}
          <br />
          <span class="sub">${ue.percentage(l.consistency)}</span>
        </td>
        <td>${l.difficulty}</td>
        <td>${l.language?ki(l.language):"-"}</td>
        <td>${l.punctuation?'<i class="fas fa-check"></i>':""}</td>
        <td>${l.numbers?'<i class="fas fa-check"></i>':""}</td>
        <td>${l.lazyMode?'<i class="fas fa-check"></i>':""}</td>
        <td>${u}</td>
      </tr>
    `),r=l.mode2})}function F$(t){j$.show({beforeAnimation:async()=>{q4(t)}})}const j$=new et({dialogId:"pbTablesModal"});function F4(){if(!xt()){h("You are offline",0,{duration:2});return}V$.show({beforeAnimation:async()=>{H4(),z4()}})}function j4(){V$.hide({afterAnimation:async()=>{const t=S();t&&xm("account",t)}})}const Xb=i("#editProfileModal .bio"),ew=i("#editProfileModal .keyboard"),H$=i("#editProfileModal .twitter"),z$=i("#editProfileModal .github"),K$=i("#editProfileModal .website"),Mp=i("#editProfileModal .badgeSelectionContainer");let so=-1;function H4(){var r;const t=S();if(!t)return;const e=((r=t.inventory)==null?void 0:r.badges)??[],{bio:a,keyboard:s,socialProfiles:n}=t.details??{};so=-1,Xb.val(a??""),ew.val(s??""),H$.val((n==null?void 0:n.twitter)??""),z$.val((n==null?void 0:n.github)??""),K$.val((n==null?void 0:n.website)??""),Mp.html(""),e==null||e.forEach(o=>{o.selected&&(so=o.id);const l=km(o.id,!1,!0),u=`<button type="button" class="badgeSelectionItem ${o.selected?"selected":""}" selection-id=${o.id}>${l}</button>`;Mp.append(u)}),Mp.prepend(`<button type="button" class="badgeSelectionItem ${so===-1?"selected":""}" selection-id=-1>
      <div class="badge">
        <i class="fas fa-frown-open"></i>
        <div class="text">none</div>
      </div>
    </button>`),i(".badgeSelectionItem").on("click",({currentTarget:o})=>{const l=i(o).attr("selection-id");so=parseInt(l,10),Mp.find(".badgeSelectionItem").removeClass("selected"),i(o).addClass("selected")})}function z4(){new cc(Xb,250),new cc(ew,75)}function K4(){const t=Xb.val()??"",e=ew.val()??"",a=H$.val()??"",s=z$.val()??"",n=K$.val()??"";return{bio:t,keyboard:e,socialProfiles:{twitter:a,github:s,website:n}}}async function V4(){var r;const t=S();if(!t)return;const e=K4(),a=39;if(e.socialProfiles.github!==void 0&&e.socialProfiles.github.length>a){h(`GitHub username exceeds maximum allowed length (${a} characters).`,-1);return}const s=20;if(e.socialProfiles.twitter!==void 0&&e.socialProfiles.twitter.length>s){h(`Twitter username exceeds maximum allowed length (${s} characters).`,-1);return}Je();const n=await Z.users.updateProfile(e,so);if(Te(),n.status!==200){h("Failed to update profile: "+n.message,-1);return}t.details=n.data??e,(r=t.inventory)==null||r.badges.forEach(o=>{o.id===so?o.selected=!0:delete o.selected}),h("Profile updated",1),j4()}const V$=new et({dialogId:"editProfileModal",setup:async t=>{t.addEventListener("submit",async e=>{e.preventDefault(),await V4()})}});function U4(t){U$.show({...t,focusFirstInput:!0,beforeAnimation:async e=>{e.querySelector("input").value=""}})}function G4(t=!1){U$.hide({clearModalChain:t})}function Q4(){const t=i("#newFilterPresetModal input").val();if(t===""){h("Name cannot be empty",0);return}ZF(t),G4(!0)}async function Y4(t){t.addEventListener("submit",e=>{e.preventDefault(),Q4()})}const U$=new et({dialogId:"newFilterPresetModal",setup:Y4}),Jc=document.querySelector("#pageAccount");i(Jc).on("click",".pbsTime .showAllButton",()=>{F$("time")});i(Jc).on("click",".pbsWords .showAllButton",()=>{F$("words")});i(Jc).on("click",".editProfileButton",()=>{if(!ce()){h("You must be logged in to edit your profile",0);return}const t=S();if(!t){h("Failed to open edit profile modal: No user snapshot found",-1);return}if(t.banned===!0){h("Banned users cannot edit their profile",0);return}F4()});i(Jc).on("click",".group.history .resultEditTagsButton",t=>{const e=i(t.target).attr("data-result-id"),a=i(t.target).attr("data-tags");jT(e??"",JSON.parse(a??"[]"),"accountPage")});i(Jc).find("button.createFilterPresetBtn").on("click",()=>{U4()});let ra;function J4(t){G$.show({mode:"dialog",focusFirstInput:!0,beforeAnimation:async()=>{sl("googleSignUpModal"),Uc(i("#googleSignUpModal .captcha")[0],"googleSignUpModal"),t5(),tw(),ra=t}})}async function Pm(){G$.hide({afterAnimation:async()=>{var t;ra!==void 0&&(h("Sign up process cancelled",0,{duration:5}),ka(),_a(),(t=cv(ra))!=null&&t.isNewUser&&(await Z.users.delete(),await ra.user.delete()),Or(),ra=void 0)}})}async function X4(){var a;if(!ra){h("Missing user credential. Please close the popup and try again.",-1);return}const t=yh("googleSignUpModal");if(!t){h("Please complete the captcha",0);return}a5(),tw(),Je();const e=i("#googleSignUpModal input").val();try{if(e.length===0)throw new Error("Name cannot be empty");const s=await Z.users.create(e,t);if(s.status!==200)throw new Error(`Failed to create user: ${s.message}`);if(s.status===200){if(await pk(ra.user,{displayName:e}),await CM(ra.user),h("Account created",1),i("nav .textButton.account .text").text(e),_a(),ka(),await Yc(ra.user),oa!==null&&(Lb(ra.user.uid),(await Z.results.save(oa)).status===200)){const r=oa;Tv(r),$v(1,r.testDuration+r.incompleteTestSeconds-r.afkDuration)}ra=void 0,Te(),Pm()}}catch(s){console.log(s);const n=Re(s,"Failed to sign in with Google");h(n,-1),ka(),_a(),Zb(),ra&&((a=cv(ra))!=null&&a.isNewUser)&&(await Z.users.delete(),await ra.user.delete()),Or(),ra=void 0,Pm(),Te();return}}function e5(){i("#googleSignUpModal button").prop("disabled",!1)}function tw(){i("#googleSignUpModal button").prop("disabled",!0)}function t5(){i("#googleSignUpModal input").prop("disabled",!1)}function a5(){i("#googleSignUpModal input").prop("disabled",!0)}const no=new Wi(i("#googleSignUpModal input"),{available:{icon:"fa-check",level:1},unavailable:{icon:"fa-times",level:-1},taken:{icon:"fa-user",level:-1},checking:{icon:"fa-circle-notch",spinIcon:!0,level:0}}),s5=Da(1e3,async()=>{const t=i("#googleSignUpModal input").val();if(!t)return;const e=await Z.users.getNameAvailability(t);if(e.status===200){no.show("available",e.message),e5();return}if(e.status===422){no.show("unavailable",e.message);return}if(e.status===409){no.show("taken",e.message);return}if(e.status!==200){no.show("unavailable"),h("Failed to check name availability: "+e.message,-1);return}});async function n5(t){var e;t.addEventListener("submit",a=>{a.preventDefault(),X4()}),(e=t.querySelector("input"))==null||e.addEventListener("input",()=>{if(tw(),i("#googleSignUpModal input").val()===""){no.hide();return}else no.show("checking"),s5()})}T3((t,e)=>{t!==void 0&&e&&J4(t)});const G$=new et({dialogId:"googleSignUpModal",setup:n5,customEscapeHandler:async()=>{Pm()},customWrapperClickHandler:async()=>{Pm()}}),Q$=console.log,i5=console.warn,r5=console.error;let Ul=localStorage.getItem("debugLogs")==="true";function o5(){Ul=!Ul,Y$(`Debug logs ${Ul?"enabled":"disabled"}`),localStorage.setItem("debugLogs",Ul.toString())}function Y$(...t){Q$("%cINFO","background:#4CAF50;color: #111;padding:0 5px;border-radius:10px",...t)}function l5(...t){i5("%cWRN","background:#FFC107;color: #111;padding:0 5px;border-radius:10px",...t)}function d5(...t){r5("%cERR","background:#F44336;color: #111;padding:0 5px;border-radius:10px",...t)}function u5(...t){Ul&&Q$("%cDEBG","background:#2196F3;color: #111;padding:0 5px;border-radius:10px",...t)}console.log=Y$;console.warn=l5;console.error=d5;console.debug=u5;let Xy=!1;function c5(t){document.documentElement.style.setProperty("--font",'"'+t.replace(/_/g," ")+'", "Roboto Mono", "Vazirmatn"'),Xy=!0}function Zz(){Xy&&(c5(d.fontFamily),Xy=!1)}function p5(){const t=window.navigator.userAgent.toLowerCase(),e=t.includes("mac")&&!t.includes("firefox")?"cmd":"ctrl",a=d.quickRestart==="esc"?"tab":"esc";i("footer .keyTips").html(`
    <key>${d.quickRestart}</key> - restart test<br>
    <key>${a}</key> or <key>${e}</key>+<key>shift</key>+<key>p</key> - command line`)}window.addEventListener("keydown",function(t){t.code==="Space"&&t.target===document.body&&t.preventDefault()});window.addEventListener("beforeunload",t=>{qm(d.mode,d.words,d.time,Er(),Mn()??!1)||$t&&(t.preventDefault(),t.returnValue="")});const f5=Da(250,()=>{if($n(),Xe()==="test"&&!It)if(d.tapeMode!=="off")Fc();else{const t=document.querySelectorAll("#words .word")[Pt-1];if(t){const e=Math.floor(t.offsetTop);lb(e)}}setTimeout(()=>{i("#wordsInput").is(":focus")&&YS()},250)}),m5=uv(250,()=>{Bc()});i(window).on("resize",()=>{m5(),f5()});mt(t=>{t==="quickRestart"&&p5()});let ev=!1;const h5=new RegExp("\\p{P}","u");async function g5(t){function e(u,c){let p=u.shiftKey;const f=ev&&c.length>2?2:0,m=!h5.test(c.slice(f,f+2));un&&m&&(p=!u.shiftKey);const g=c[(p?1:0)+f]??"",y=c[p?1:0]??"",v=c[0];return g||y||v}let a;try{a=await vc(d.layout)}catch(u){return h(Re(u,"Failed to emulate event"),-1),null}let s=[];if(a.type==="ansi"?s=["Backquote","Digit1","Digit2","Digit3","Digit4","Digit5","Digit6","Digit7","Digit8","Digit9","Digit0","Minus","Equal","KeyQ","KeyW","KeyE","KeyR","KeyT","KeyY","KeyU","KeyI","KeyO","KeyP","BracketLeft","BracketRight","Backslash","KeyA","KeyS","KeyD","KeyF","KeyG","KeyH","KeyJ","KeyK","KeyL","Semicolon","Quote","KeyZ","KeyX","KeyC","KeyV","KeyB","KeyN","KeyM","Comma","Period","Slash","Space"]:a.type==="iso"?s=["Backquote","Digit1","Digit2","Digit3","Digit4","Digit5","Digit6","Digit7","Digit8","Digit9","Digit0","Minus","Equal","KeyQ","KeyW","KeyE","KeyR","KeyT","KeyY","KeyU","KeyI","KeyO","KeyP","BracketLeft","BracketRight","KeyA","KeyS","KeyD","KeyF","KeyG","KeyH","KeyJ","KeyK","KeyL","Semicolon","Quote","Backslash","IntlBackslash","KeyZ","KeyX","KeyC","KeyV","KeyB","KeyN","KeyM","Comma","Period","Slash","Space"]:a.type==="matrix"&&(s=["Backquote","Digit1","Digit2","Digit3","Digit4","Digit5","Digit6","Digit7","Digit8","Digit9","Digit0","Minus","Equal","KeyQ","KeyW","KeyE","KeyR","KeyT","KeyY","KeyU","KeyI","KeyO","KeyP","BracketLeft","BracketRight","Backslash","KeyA","KeyS","KeyD","KeyF","KeyG","KeyH","KeyJ","KeyK","KeyL","Semicolon","Quote","KeyZ","KeyX","KeyC","KeyV","KeyB","KeyN","KeyM","Comma","Period","Slash","Space"]),!s.includes(t.code))return null;const n=a.keys,r=n.row1.concat(n.row2).concat(n.row3).concat(n.row4).concat(n.row5),o=s.indexOf(t.code);if(o===-1)return t.code.includes("Numpad")?t.key:null;const l=e(t,r[o]??"");return l!==void 0?l:null}function J$(t){const e=t.code==="AltLeft"&&navigator.userAgent.includes("Mac");t.code!=="AltRight"&&!e||(t.type==="keydown"&&(ev=!0),t.type==="keyup"&&(ev=!1))}i(document).on("keydown",J$);i(document).on("keyup",J$);const X$=["MediaTrackNext","MediaTrackPrevious","MediaPlayPause","AudioVolumeUp","AudioVolumeDown","AudioVolumeMute"],y5=["Alt","AltGraph","CapsLock","Control","Fn","FnLock","Hyper","Meta","OS","NumLock","ScrollLock","Scroll","Shift","Super","Symbol","SymbolLock"];let Rm=!1,Dm=!0,hg=!1,eA,gg=0;const A0=document.getElementById("wordsInput"),tA=document.getElementById("koInputVisual");function js(t){t!==A0.value&&(A0.value=t)}function tv(){var e;const t=we(Hc());if(isNaN(t)||pB(t),d.keymapMode==="next"&&d.mode!=="zen")if(!d.language.startsWith("korean"))ai(E.getCurrent().charAt(T.current.length).toString());else{const a=Bt.disassemble(E.getCurrent(),!0),s=Bt.disassemble(T.current,!0),n=s.length-1;if(s[n]){const r=s[n].length;try{const o=a[n][r]??a[s.length][r-a[n].length];ai(o)}catch{ai("")}}else{const r=(e=a==null?void 0:a[0])==null?void 0:e[0];r!==void 0&&ai(r)}}}function aA(){var a,s,n,r;if(!$t||T.history.length===0||Pt===0)return;const t=document.querySelectorAll("#words > .word");if(T.history[E.currentIndex-1]==E.get(E.currentIndex-1)&&!d.freedomMode||(a=t[E.currentIndex-1])!=null&&a.classList.contains("hidden")||d.confidenceMode==="on"||d.confidenceMode==="max")return;const e=(n=(s=t[E.currentIndex])==null?void 0:s.children[0])==null?void 0:n.classList.contains("incorrect");if(d.stopOnError==="letter"&&e&&Zs(),T.current=T.popHistory(),Dt.popHistory(),Ae(d.funbox).find(o=>{var l;return(l=o.properties)==null?void 0:l.includes("nospace")})&&(T.current=T.current.slice(0,-1),js(" "+T.current+" ")),E.decreaseCurrentIndex(),ib(Pt-1),ih(!0),vm(E.getCurrent()),Zs(),d.mode==="zen"){zc();const o=((r=document.querySelector("#words"))==null?void 0:r.children)??[];for(let l=o.length-1;l>=0;l--){const u=o[l];if(u.classList.contains("newline"))u.remove();else break}}$n(),rr("backWord")}async function M0(){var o,l,u;if(!$t||T.current===""||or()&&d.language.startsWith("chinese"))return;d.mode==="zen"&&(i("#words .word.active").removeClass("active"),i("#words").append("<div class='word active'></div>"));const t=E.getCurrent();for(const c of Ae(d.funbox))(o=c.functions)!=null&&o.handleSpace&&c.functions.handleSpace();Rm=!0;const e=M1();cB(Math.round(e)),KS(e);const a=Ae(d.funbox).find(c=>{var p;return(p=c.properties)==null?void 0:p.includes("nospace")})!==void 0,s=t===T.current||d.mode==="zen";if(CT(s,!0),ZS(s),s)d.stopOnError==="letter"&&Zs(),e0(!0,t),T.pushHistory(),E.increaseCurrentIndex(),vm(E.getCurrent()),vy(),by(E.currentIndex),a||An(),rr("submitCorrectWord");else{a||(d.playSoundOnError==="off"||d.blindMode?An():eh()),jS(E.getCurrent()),BS();const c=T.current.length;if(c<=E.getCurrent().length&&(c>=Dt.current.length?Dt.current+="_":Dt.current=Dt.current.substring(0,c)+"_"+Dt.current.substring(c+1)),d.stopOnError!=="off"){if(d.difficulty==="expert"||d.difficulty==="master"){ad("difficulty");return}d.stopOnError==="word"&&(Rm=!1,rr("incorrectLetter","_"),Zs(),$n());return}e0(!1,t),d.blindMode?d.highlightMode!=="off"&&GW(Pt):UW(Pt),T.pushHistory(),E.increaseCurrentIndex(),vm(E.getCurrent()),vy(),by(E.currentIndex),rr("submitErrorWord"),(d.difficulty==="expert"||d.difficulty==="master")&&ad("difficulty")}if(Eb()&&E.currentIndex===E.length){qo();return}let n;d.mode==="zen"?n=T.current.length:n=E.getCurrent().length;const r=EA(d.minBurstCustomSpeed,n);if(d.minBurst==="fixed"&&e<d.minBurstCustomSpeed||d.minBurst==="flex"&&e<r){ad("min burst");return}if(Dt.pushHistory(),d.keymapMode==="react"&&W1(" ",!0),(d.mode==="words"||d.mode==="custom"||d.mode==="quote"||d.mode==="zen")&&zc(),(d.mode==="time"||d.mode==="words"||d.mode==="custom"||d.mode==="quote")&&await EF(),ib(Pt+1),ih(),$n(),!d.showAllLines||d.mode==="time"||d.mode==="custom"&&gt()===0||d.mode==="custom"&&St()==="time"){const c=Math.floor(((l=document.querySelectorAll("#words .word")[Pt-1])==null?void 0:l.offsetTop)??0);let p;try{p=Math.floor(((u=document.querySelectorAll("#words .word")[Pt])==null?void 0:u.offsetTop)??0)}catch{p=0}p>c&&lb(c)}}function v5(t,e){var n;if(!Dm)return!1;if(d.mode==="zen")return!0;if(T.getKoreanStatus()){const o=Bt.disassemble(E.getCurrent())[e];return o===void 0?!1:o===t}const a=E.getCurrent()[e];if(a===void 0)return!1;if(a===t)return!0;const s=Ae(d.funbox).find(r=>{var o;return(o=r.functions)==null?void 0:o.isCharCorrect});return(n=s==null?void 0:s.functions)!=null&&n.isCharCorrect?s.functions.isCharCorrect(t,a):!!(d.language.startsWith("russian")&&(t===""||t===""||t==="e")&&(a===""||a===""||a==="e")||(t===""||t===""||t==="'"||t===""||t==="")&&(a===""||a===""||a==="'"||a===""||a==="")||(t==='"'||t===""||t===""||t==="")&&(a==='"'||a===""||a===""||a==="")||(t===""||t===""||t==="-")&&(a==="-"||a===""||a===""))}function qa(t,e,a){var g,y,v,A,W;if(Cr||It)return;if(t===""&&E.getCurrent()[e]!==""){for(let $=0;$<3;$++)qa(".",e+$);return}if(t===""&&E.getCurrent()[e]!==""){qa("o",e),qa("e",e+1);return}if(t===""&&E.getCurrent()[e]!==""){qa("a",e),qa("e",e+1);return}console.debug("Handling char",t,e,a);const s=performance.now(),n=T.getKoreanStatus();for(const $ of Ae(d.funbox))(g=$.functions)!=null&&g.handleChar&&(t=$.functions.handleChar(t));const r=Ae(d.funbox).find($=>{var se;return(se=$.properties)==null?void 0:se.includes("nospace")})!==void 0;if(t!==`
`&&t!=="	"&&/\s/.test(t)){if(r)return;if(M0(),d.difficulty!=="normal"||d.strictSpace&&d.mode!=="zen"||d.stopOnError==="word"&&e>0){if(Rm){Rm=!1;return}}else return}if(d.mode!=="zen"&&E.getCurrent()[e]!==`
`&&t===`
`||!$t&&!LF(s))return;Di(!0),GS();const o=v5(t,e);let l;if(o&&d.mode!=="zen"&&(t=n?Bt.disassemble(E.getCurrent())[e]??"":E.getCurrent().charAt(e)),!o&&t===`
`){if(T.current==="")return;t=" "}if(T.current===""&&GN(s),n||d.language.startsWith("korean")?(l=(a??"").slice(1),tA.innerText=l.slice(-1)):d.language.startsWith("chinese")?l=(a??"").slice(1):l=T.current.substring(0,e)+t+T.current.substring(e+1),!o&&or()&&!d.language.startsWith("korean")){T.current=l,Zs(),$n();return}if(CT(o),ZS(o),o||(BS(),jS(E.getCurrent())),PB(d.mode==="zen"?t:E.getCurrent()[e]??"",o),o||d.playSoundOnError==="off"||d.blindMode?An():eh(),d.keymapMode==="react"&&W1(t,o),d.difficulty!=="master")if(Dm)gg=0;else{gg++,gg>=5&&h("Opposite shift mode is on.",0,{important:!0,customTitle:"Reminder"});return}if(Dt.current==="")Dt.current+=n?Bt.disassemble(l).join(""):l;else{const $=n?Bt.disassemble(Dt.current).length:Dt.current.length;e>=$?Dt.current+=n?Bt.disassemble(t).concat():t:o||(Dt.current=Dt.current.substring(0,e)+t+Dt.current.substring(e+1))}if(vy(),by(E.currentIndex),d.difficulty!=="master"&&d.stopOnError==="letter"&&!o){d.blindMode||Zs(T.current+t);return}if(rr(o?"correctLetter":"incorrectLetter",t),(n?Bt.disassemble(T.current).length:T.current.length)===1&&E.currentIndex===0&&((y=document.querySelector("#words .active"))==null||y.offsetTop,void 0),d.mode==="zen"&&e<30||d.mode!=="zen"&&l.length<E.getCurrent().length+20?T.current=l:console.error("Hitting word limit"),!o&&d.difficulty==="master"){ad("difficulty");return}if(d.mode!=="zen"){const $=E.getCurrent(),te=E.currentIndex===E.length-1,b=Eb(),w=$===T.current,q=d.quickEnd&&!d.language.startsWith("korean")&&$.length===T.current.length&&d.stopOnError==="off",me=d.language.startsWith("chinese");if(te&&b&&(w||q)&&(!me||a!==void 0&&e+2==a.length)){qo();return}}const c=(v=document.querySelector("#words .word.active"))==null?void 0:v.offsetTop;if(Zs(),!d.hideExtraLetters){const $=(A=document.querySelector("#words .word.active"))==null?void 0:A.offsetTop;if(c<$&&!$y&&T.current.length>1)if(d.mode==="zen"){const se=Math.floor(((W=document.querySelectorAll("#words .word")[Pt-1])==null?void 0:W.offsetTop)??0);d.showAllLines||lb(se)}else T.current=T.current.slice(0,-1),Zs()}(r&&T.current.length===E.getCurrent().length||t===`
`&&o)&&M0();const p=E.getCurrent(),f=/^\t+/.test(E.getCurrent()),m=p[T.current.length]==="	";setTimeout(()=>{if(o&&d.language.startsWith("code")&&f&&m){const $=new KeyboardEvent("keydown",{key:"Tab",code:"Tab"});document.dispatchEvent($)}},0),t!==`
`&&$n()}function b5(t,e){if(Cr){t.preventDefault();return}let a=!1;(d.mode==="zen"&&!t.shiftKey||ju&&!t.shiftKey)&&(a=!0);const s=da("commandLineWrapper")||e;if(d.quickRestart==="esc"){if(s||Xe()==="login")return;if(t.preventDefault(),!It&&a){qa("	",T.current.length),js(" "+T.current);return}}else if(d.quickRestart==="tab"){if(s||Xe()==="login")return;if(Xe()!=="test"){Ma("/");return}if(t.shiftKey?tt():Hu(),!It&&a){t.preventDefault(),qa("	",T.current.length),js(" "+T.current);return}He({event:t})}else{if(s||Xe()!=="test"||It)return;if(a){t.preventDefault(),qa("	",T.current.length),js(" "+T.current);return}setTimeout(()=>{var n;((n=document.activeElement)==null?void 0:n.id)!=="wordsInput"&&Di(!1)},0)}}i("#wordsInput").on("keydown",t=>{const e=Xe()==="test",a=da("commandLineWrapper"),s=da("leaderboardsWrapper"),n=Bm();e&&!a&&!s&&!n&&!It&&t.key!=="Enter"||t.preventDefault()});let yg=-1;i(document).on("keydown",async t=>{var u,c;if(Xe()==="loading"){console.debug("Ignoring keydown event on loading page.");return}if(X$.includes(t.key)){console.debug(`Key ${t.key} is on the list of ignored keys. Stopping keydown event.`);return}const e=i("#wordsInput").is(":focus"),a=Xe()==="test",s=da("commandLineWrapper"),n=da("leaderboardsWrapper"),r=Bm(),o=a&&!s&&!n&&!r&&!It&&(e||t.key!=="Enter");if(o&&!e&&!["Enter"," ","Escape","Tab",...y5].includes(t.key)&&(nh(),d.showOutOfFocusWarning&&!t.ctrlKey&&!t.metaKey&&t.preventDefault()),t.key==="Tab"&&b5(t,r),t.key==="Escape"&&d.quickRestart==="esc"){if(da("commandLineWrapper")||r)return;if(Xe()!=="test"){Ma("/");return}t.shiftKey?tt():Hu(),He({event:t})}if(t.key==="Enter"&&d.quickRestart==="enter"){const p=document.activeElement;if((p==null?void 0:p.tagName)==="BUTTON"||(p==null?void 0:p.tagName)==="A"||(p==null?void 0:p.classList.contains("button"))||(p==null?void 0:p.classList.contains("textButton"))||(p==null?void 0:p.tagName)==="INPUT"&&(p==null?void 0:p.id)!=="wordsInput"||da("commandLineWrapper")||r)return;if(Xe()!=="test"){Ma("/");return}if(It){He({event:t});return}d.mode==="zen"||(!am&&!d.funbox.includes("58008")||(am||d.funbox.includes("58008"))&&t.shiftKey)&&(t.shiftKey?tt():Hu(),He({event:t}))}if(!o)return;if(!((u=t.originalEvent)!=null&&u.isTrusted)||Ra){t.preventDefault();return}if(WS(),t.key==="Backspace"&&(An(),/INPUT|SELECT|TEXTAREA/i.test(t.target.tagName)||t.preventDefault(),d.confidenceMode==="max")){t.preventDefault();return}if($Z(),t.key==="Backspace"&&T.current.length===0&&(aA(),T.current&&js(" "+T.current+" ")),t.key==="Enter")if(t.shiftKey){if(d.mode==="zen")qo();else if(!qm(d.mode,d.words,d.time,Er(),Mn()??!1)){const p=Date.now()-yg;yg===-1||p>200?(yg=Date.now(),p>=5e3&&h("Please double tap shift+enter to confirm bail out",0,{important:!0,duration:5})):(Dx(!0),qo())}}else qa(`
`,T.current.length),js(" "+T.current);if(t.key==="Dead"&&!or()){An();const p=document.querySelector("#words .word.active"),f=T.current.length,m=p==null?void 0:p.querySelectorAll("letter")[f];m&&m.classList.toggle("dead")}if(d.oppositeShiftMode!=="off")if(d.oppositeShiftMode==="keymap"&&d.keymapLayout!=="overrideSync"){const p=await vc(d.keymapLayout).catch(()=>{});if(p===void 0){h("Failed to load keymap layout",-1);return}const f=e1(t.key,p);Dm=f===void 0?!0:xy(f)}else Dm=xy(t.code);const l=Ae(d.funbox).find(p=>{var f;return(f=p.functions)==null?void 0:f.preventDefaultEvent});if((c=l==null?void 0:l.functions)!=null&&c.preventDefaultEvent&&await l.functions.preventDefaultEvent(t)&&(t.preventDefault(),qa(t.key,T.current.length),tv(),js(" "+T.current)),d.layout!=="default"&&!(t.ctrlKey||t.altKey&&window.navigator.platform.search("Linux")>-1)){const p=await g5(t);p!==null&&(t.preventDefault(),qa(p,T.current.length),tv(),js(" "+T.current))}eA=t.key==="Backspace"||t.key==="delete"});i("#wordsInput").on("keydown",t=>{var a;if((a=t.originalEvent)!=null&&a.repeat){console.log("spacing debug keydown STOPPED - repeat",t.key,t.code,t.which);return}t.code==="NumpadEnter"&&d.funbox.includes("58008")&&(t.code="Space"),t.code.includes("Arrow")&&d.funbox.includes("arrows")&&(t.code="NoCode");const e=performance.now();setTimeout(()=>{const s=t.code===""||t.which===231?"NoCode":t.code;YN(e,s)},0)});i("#wordsInput").on("keyup",t=>{var a;if((a=t.originalEvent)!=null&&a.repeat){console.log("spacing debug keydown STOPPED - repeat",t.key,t.code,t.which);return}t.code==="NumpadEnter"&&d.funbox.includes("58008")&&(t.code="Space"),t.code.includes("Arrow")&&d.funbox.includes("arrows")&&(t.code="NoCode");const e=performance.now();setTimeout(()=>{const s=t.code===""||t.which===231?"NoCode":t.code;qS(e,s)},0)});i("#wordsInput").on("keyup",t=>{var e;if(!((e=t.originalEvent)!=null&&e.isTrusted)||Ra){t.preventDefault();return}X$.includes(t.key)||It||AZ()});i("#wordsInput").on("beforeinput",t=>{var e;(e=t.originalEvent)!=null&&e.isTrusted&&t.target.value===""&&(t.target.value=" ")});i("#wordsInput").on("input",t=>{var u;if(!((u=t.originalEvent)!=null&&u.isTrusted)||Ra){t.target.value=" ";return}if(Bm()){t.preventDefault();return}WS(),(d.layout==="default"||d.layout==="korean")&&t.target.value.normalize().match(/[\uac00-\ud7af]|[\u1100-\u11ff]|[\u3130-\u318f]|[\ua960-\ua97f]|[\ud7b0-\ud7ff]/g)&&T.setKoreanStatus(!0);const a=T.getKoreanStatus(),s=d.language.startsWith("chinese"),n=t.target.value.normalize(),r=a?Bt.disassemble(n).join("").slice(1):n.slice(1),o=a?Bt.disassemble(T.current).join(""):T.current;if(a&&!eA&&(hg||n.slice(1).length<T.current.length&&Bt.disassemble(T.current.slice(-1)).length>1)){hg=!hg;return}if(d.layout!=="default"&&r.length>=o.length){js(" "+o);return}if(n.length===0&&o.length===0)aA();else if(r.length<o.length){if(s)if(o.length-r.length<=2&&o.startsWith(o))T.current=r;else{let c=0;for(;r[c]===o[c];)c++;let p=0;d.stopOnError!=="word"&&/.+ .+/.test(r)&&(p=r.indexOf(" ")+1);for(let f=c;f<r.length;f++)qa(r[f],f-p,n)}else if(a){const c=t.target.value.normalize().slice(1);T.current=c,tA.innerText=c.slice(-1)}else T.current=r;Zs(),$n(),or()||((t==null?void 0:t.originalEvent).inputType==="deleteWordBackward"?rr("setLetterIndex",0):rr("setLetterIndex",o.length-1))}if(r!==o){let c=0;for(;r[c]===o[c];)c++;let p=0;d.stopOnError!=="word"&&/.+ .+/.test(r)&&(p=r.indexOf(" ")+1);for(let f=c;f<r.length;f++)qa(r[f],f-p,n)}js(" "+T.current),tv();const l=or();setTimeout(()=>{const c=or();l!==c&&Zs(),t.target.selectionStart!==t.target.value.length&&(!Un.test(t.target.value)||(t.target.selectionStart??0)<t.target.value.search(Un))&&(t.target.selectionStart=t.target.selectionEnd=t.target.value.length)},0)});i("#wordsInput").on("focus",t=>{t.target.selectionStart=t.target.selectionEnd=t.target.value.length});i("#wordsInput").on("copy paste",t=>{t.preventDefault()});i("#wordsInput").on("select selectstart",t=>{t.preventDefault()});i("#wordsInput").on("keydown",t=>{t.key.startsWith("Arrow")&&t.preventDefault()});i("#wordsInput").on("compositionstart",()=>{d.layout==="default"&&(u1(!0),bW(T.current.length))});i("#wordsInput").on("compositionend",()=>{d.layout==="default"&&u1(!1)});function w5(){window.localStorage.setItem("confirmedPSAs",JSON.stringify([]))}function sA(){return JSON.parse(window.localStorage.getItem("confirmedPSAs")??"[]")??[]}function k5(t){const e=sA();e.push(t),window.localStorage.setItem("confirmedPSAs",JSON.stringify(e))}async function x5(){const t=await Z.psas.get();return t.status===500?(od("Looks like the server is experiencing maintenance or some unexpected down time.<br>Check the <a target= '_blank' href='https://monkeytype.instatus.com/'>status page</a> or <a target= '_blank' href='https://x.com/monkeytype'>Twitter</a> for more information.",-1,"exclamation-triangle",!1,void 0,!0),null):t.status===503?(od("Server is currently under maintenance. <a target= '_blank' href='https://monkeytype.instatus.com/'>Check the status page</a> for more info.",-1,"bullhorn",!0,void 0,!0),null):t.status!==200?null:t.data}async function _5(){const t=await x5();if(t===null)return;if(t.length===0){w5();return}const e=sA();t.forEach(a=>{if(a.date){const s=new Date(a.date),n=a.date-Date.now(),r=Ta(n/1e3,!1,!1,"text",!1,!0);a.message=a.message.replace("{dateDifference}",r),a.message=a.message.replace("{dateNoTime}",nt(s,"dd MMM yyyy")),a.message=a.message.replace("{date}",nt(s,"dd MMM yyyy HH:mm"))}x3(a.message,a.level??-1),!(e.includes(a._id)&&!(a.sticky??!1))&&od(a.message,a.level,"bullhorn",a.sticky,()=>{k5(a._id)},!0)})}i(()=>{ow("/css/slimselect.min.css",!0),ow("/css/balloon.min.css",!0),M4(),i("body").css("transition","background .25s, transform .05s"),window.localStorage.getItem("merchbannerclosed")==="true"||MM('Check out our merchandise, available at <a target="_blank" rel="noopener" href="https://monkeytype.store/">monkeytype.store</a>',1,"./images/merch2.png",!1,()=>{window.localStorage.setItem("merchbannerclosed","true")},!0),setTimeout(()=>{Ae(d.funbox).forEach(e=>{var a,s;return(s=(a=e.functions)==null?void 0:a.applyGlobalCSS)==null?void 0:s.call(a)})},500),i("#app").css("opacity","0").removeClass("hidden").stop(!0,!0).animate({opacity:1},250),xt()&&(_5(),tj().then(()=>{var e;(e=hh())!=null&&e.users.signUp||(i(".signInOut").addClass("hidden"),i(".register").addClass("hidden"),i(".login").addClass("hidden"),i(".disabledNotification").removeClass("hidden"))})),eF(),new SM("https://keymash.io/")});let Lp=!1;i(document).on("click",".scrollToTopButton",()=>{window.scrollTo({top:0,behavior:"smooth"})});i(window).on("scroll",()=>{const t=Xe();if(t!=="test"&&(t==="about"||t==="settings"||t==="account")){const e=window.scrollY;!Lp&&e>100?(i(".scrollToTopButton").removeClass("invisible"),Lp=!0):Lp&&e<100&&(i(".scrollToTopButton").addClass("invisible"),Lp=!1)}});i("#nocss .requestedStylesheets").html("Requested stylesheets:<br>"+[...document.querySelectorAll("link[rel=stylesheet")].map(t=>t.href).filter(t=>/\/css\/style/gi.test(t)).join("<br>"));i("#nocss .requestedJs").html("Requested Javascript files:<br>"+[...document.querySelectorAll("script")].map(t=>t.src).filter(t=>/(\/js\/mon|\/js\/vendor)/gi.test(t)).join("<br>")+"<br><br>Client version:<br>"+Qo.clientVersion);window.navigator.userAgent.toLowerCase().includes("mac")?i("#nocss .keys").html(`
    <span
      style="
        padding: 1rem;
        display: inline-block;
        border-radius: 1rem;
        background: #2c2e31;
        margin-top: 1rem;
        margin-bottom: 1rem;
      "
    >
      Cmd
    </span>
    +
    <span
      style="
        padding: 1rem;
        display: inline-block;
        border-radius: 1rem;
        background: #2c2e31;
      "
    >
      Shift
    </span>
    +
    <span
      style="
        padding: 1rem;
        display: inline-block;
        border-radius: 1rem;
        background: #2c2e31;
      "
    >
      R
    </span>
  `):i("#nocss .keys").html(`
    <span
      style="
        padding: 1rem;
        display: inline-block;
        border-radius: 1rem;
        background: #2c2e31;
        margin-bottom: 1rem;
      "
    >
      Ctrl
    </span>
    +
    <span
      style="
        padding: 1rem;
        display: inline-block;
        border-radius: 1rem;
        background: #2c2e31;
      "
    >
      Shift
    </span>
    +
    <span
      style="
        padding: 1rem;
        display: inline-block;
        border-radius: 1rem;
        background: #2c2e31;
      "
    >
      R
    </span>
  `);const gc="videoAdPopupWrapper";async function C5(){if(ss(gc,"popups"),await Ab(),mh){h("Looks like you're using an adblocker. Video ads will not work until you disable it.",0,{duration:6});return}if(await Mb(),dc){h("Looks like you're using a cookie popup blocker. Video ads will not work without giving your consent through the popup.",0,{duration:7});return}da(gc)||i("#videoAdPopupWrapper").stop(!0,!0).css("opacity",0).removeClass("hidden").animate({opacity:1},125,()=>{window.dataLayer.push({event:"EG_Video"})})}function L0(){da(gc)&&i("#videoAdPopupWrapper").stop(!0,!0).css("opacity",1).animate({opacity:0},125,()=>{i("#videoAdPopupWrapper").addClass("hidden"),Aa(gc)})}function S5(t){const e=t.event;e==="started"||(e==="finished"?L0():e==="empty"&&(h("Failed to load video ad. Please try again later",-1,{duration:3}),L0()))}i(".pageTest #watchVideoAdButton").on("click",()=>{C5()});za(gc);let di;async function nA(t=d.language){if(!di)return;const a=(await rv(t)).bcp47??"en-US";di.lang=a}async function iA(){di=new SpeechSynthesisUtterance,await nA()}function T5(){di=void 0}async function $5(t){window.speechSynthesis.cancel(),di===void 0&&await iA(),di!==void 0&&(di.text=t,window.speechSynthesis.speak(di))}mt((t,e)=>{t==="funbox"&&(e==="none"?T5():e==="tts"&&iA()),t==="language"&&d.funbox.split("#").includes("tts")&&nA()});$B(t=>{$5(t)});let tf=0,rA,av,aw=!0;const Vi=document.querySelector("#fpsCounter");function oA(t){if(aw)return;const e=t-av;if(tf++,e>500){const a=we(tf*1e3/e).toFixed(2);tf=0,av=t,A5(a)}window.requestAnimationFrame(oA)}function qz(){aw=!1,tf=0,av=performance.now(),rA=window.requestAnimationFrame(oA),Vi.classList.remove("hidden")}function Fz(){cancelAnimationFrame(rA),aw=!0,Vi.classList.add("hidden")}async function A5(t){Vi.innerHTML=`FPS ${t}`;const e=parseFloat(t);Vi.classList.remove("error"),Vi.classList.remove("main"),e<30?Vi.classList.add("error"):e>55&&Vi.classList.add("main")}const bl=new Wi(i(".page.pageProfileSearch .search input"),{notFound:{icon:"fa-user-slash",level:-1},error:{icon:"fa-times",level:-1},checking:{icon:"fa-circle-notch",spinIcon:!0,level:1}});function M5(){i(".page.pageProfileSearch .search button").addClass("disabled"),i(".page.pageProfileSearch .search input").attr("disabled","disabled")}function L5(){i(".page.pageProfileSearch .search button").removeClass("disabled"),i(".page.pageProfileSearch .search input").removeAttr("disabled")}function E5(){return i(".page.pageProfileSearch .search input").attr("disabled")!==void 0}function E0(){i(".page.pageProfileSearch .search input").trigger("focus")}async function I5(){bl.hide();const t=i(".page.pageProfileSearch .search input").val();if(t==="")return;bl.show("checking"),M5(),await vt(500);const e=await Z.users.getProfileByName(t);if(L5(),e.status===404){E0(),bl.show("notFound","User not found");return}else if(e.status!==200){E0(),bl.show("error",`Error: ${e.message}`);return}bl.hide(),Ma(`/profile/${t}`,{data:e.data})}i(".page.pageProfileSearch form").on("submit",t=>{t.preventDefault(),!E5()&&I5()});za("pageProfileSearch");const lA="lastSeenVersion";let sv=null,Nm=null;function O5(t){window.localStorage.setItem(lA,t)}function P5(){return window.localStorage.getItem(lA)??""}async function R5(){const t=await IA(),e=P5();sv=t,Nm=e===""?!1:e!==t,(Nm||e==="")&&(O5(t),D5())}function D5(){caches.keys().then(function(t){for(const e of t)caches.delete(e)})}async function N5(){return(sv===null||Nm===null)&&await R5(),{version:sv,isNew:Nm}}function W5(t){i("footer .currentVersion .text").text(t)}function B5(t){t?i("#newVersionIndicator").removeClass("hidden"):i("#newVersionIndicator").addClass("hidden")}async function Z5(){const{version:t,isNew:e}=await N5();W5(t),B5(e)}function q5(t){for(const[e,a]of Object.entries(t))window[e]=a}DN();Z5();Di(!0,!0);q5({snapshot:S,config:d,toggleFilterDebug:oj,glarsesMode:xq,stats:XW,replay:gW,enableTimerDebug:EZ,getTimerStats:ZZ,toggleUnsmoothedRaw:Eq,egVideoListener:S5,toggleDebugLogs:o5});export{Zv as $,Li as A,DC as B,eh as C,WC as D,An as E,eS as F,yS as G,ZC as H,qC as I,gS as J,qu as K,Zu as L,tS as M,FC as N,GC as O,QC as P,NC as Q,Bz as R,pW as S,Zw as T,zC as U,ea as V,d as W,Wv as X,KC as Y,Bv as Z,VC as _,zt as a,bS as a$,ui as a0,$S as a1,Ps as a2,iS as a3,jC as a4,Nv as a5,nS as a6,HC as a7,lS as a8,pS as a9,jW as aA,T as aB,E as aC,jv as aD,Hv as aE,Xt as aF,gy as aG,Ap as aH,aa as aI,X1 as aJ,Gc as aK,S as aL,s$ as aM,vZ as aN,Fu as aO,Cm as aP,t3 as aQ,ii as aR,mg as aS,nr as aT,Ac as aU,XB as aV,Mv as aW,F1 as aX,CS as aY,VZ as aZ,c5 as a_,fS as aa,Pi as ab,qv as ac,AS as ad,Cs as ae,LS as af,MS as ag,ES as ah,Ic as ai,JC as aj,RN as ak,Mn as al,St as am,Wz as an,gt as ao,Dx as ap,qo as aq,ja as ar,ze as as,fz as at,Ma as au,zm as av,Oc as aw,It as ax,_4 as ay,k1 as az,tt as b,Zz as b0,ki as b1,No as b2,sr as b3,et as b4,Er as b5,O$ as b6,e$ as b7,Fv as b8,Pc as b9,wZ as ba,PN as bb,C5 as bc,Rc as bd,Yo as be,XW as bf,qz as bg,Fz as bh,Di as bi,Xw as bj,_n as bk,Tc as bl,iR as bm,Xe as bn,nh as bo,Ws as c,Ti as d,kS as e,mn as f,Dv as g,os as h,hS as i,vS as j,XC as k,dS as l,uS as m,cS as n,rS as o,mS as p,wS as q,He as r,tn as s,aS as t,BC as u,UC as v,xS as w,oS as x,YC as y,sS as z};